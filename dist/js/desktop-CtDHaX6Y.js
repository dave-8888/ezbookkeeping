import"./modulepreload-polyfill-B5Qt9EMX.js";import{f as Oe,r as P,w as Ft,t as c,o as l,y as a,A as q,z as i,W as t,v as e,g as xe,c as E,B as Ve,h as g,m as be,i as o,l as r,a6 as ha,ab as za,av as Gt,N as ht,ae as Ka,F as fe,s as $e,k as pn,X as _t,aj as Qn,a5 as Go,am as ji,n as kl,aw as ro,ax as Hi,at as Wi,au as Gi,ay as Ki,az as Qi,aA as Ji,aB as Zi,x as Xi}from"./vendor-common-M0sdHW0p.js";import{V as Ko,a as H,u as Rl,b as Kt,c as er,d as Na,e as ie,m as tr,f as bl,g as ar,h as vt,i as zs,j as lr,k as Qo,l as Os,n as Rs,o as qs,p as Ys,q as Dn,r as Jo,s as nr,t as ql,v as it,w as or,x as sr,y as ir,z as ol,A as wt,B as rn,C as mt,D as Je,E as ve,F as rt,G as Zo,H as nt,I as rr,J as js,K as ur,L as dr,M as Hs,N as Ze,O as Ae,P as R,Q as Me,R as ge,S as jt,T as ot,U as Ws,W as Gs,X as qa,Y as zt,Z as Ge,_ as Ea,$ as Yl,a0 as jl,a1 as Hl,a2 as Wl,a3 as On,a4 as ba,a5 as Xe,a6 as xt,a7 as Xo,a8 as Ks,a9 as Un,aa as To,ab as sa,ac as ft,ad as da,ae as Ma,af as Ta,ag as cr,ah as mr,ai as Qs,aj as pr,ak as Js,al as uo,am as Zs,an as ua,ao as Ja,ap as Wt,aq as ea,ar as Jt,as as Oa,at as vr,au as fr,av as yr,aw as Gl,ax as Fl,ay as gr,az as es,aA as ts,aB as Kl,aC as vl,aD as sl,aE as Ul,aF as hr,aG as Xs,aH as nl,aI as vn,aJ as fn,aK as Ba,aL as Jn,aM as an,aN as br,aO as Tr,aP as Cn,aQ as hn,aR as il,aS as co,aT as Pn,aU as Ql,aV as Il,aW as Rn,aX as Jl,aY as Zl,aZ as Xl,a_ as Zn,a$ as wo,b0 as ei,b1 as kr,b2 as as,b3 as _r,b4 as Po,b5 as ti,b6 as ai,b7 as xr,b8 as Bo,b9 as $n,ba as bs,bb as li,bc as Cr,bd as ni,be as oi,bf as wr,bg as si,bh as ii,bi as bn,bj as Ar,bk as Sr,bl as Vr,bm as Ir,bn as Dr,bo as $r,bp as Nr,bq as yn,br as Fr,bs as Er,bt as Mr,bu as ri,bv as Ur,bw as Pr,bx as Br,by as Lr,bz as ls,bA as Ts,bB as zr,bC as Or,bD as ks,bE as Rr,bF as qr,bG as Yr,bH as jr,bI as Hr,bJ as Wr,bK as Gr,bL as Kr,bM as Qr,bN as ui,bO as Jr,bP as Zr,bQ as Xr,bR as eu,bS as tu,bT as au,bU as lu,bV as ns,bW as _s,bX as Lo,bY as zo,bZ as di,b_ as nu,b$ as ou,c0 as su,c1 as iu,c2 as ru,c3 as uu,c4 as du,c5 as cu,c6 as mu,c7 as pu,c8 as vu,c9 as fu,ca as yu,cb as gu,cc as hu,cd as bu,ce as Tu,cf as ku,cg as _u,ch as xu,ci as Cu,cj as wu,ck as Au,cl as Su}from"./vendor-desktop-CVgA5DMB.js";import{u as je,i as zl,a as Va,b as Za,c as Ya,d as ta,e as ci,T as $t,g as os,s as Oo,A as fl,f as Vu,h as mi,j as gn,K as Tl,k as _l,l as ln,m as Iu,n as un,o as Du,p as $u,q as pi,r as xl,t as ss,v as Ro,w as Nu,x as xs,y as Fu,z as Eu,B as Mu,C as Uu,D as Pu,E as Bu,F as Xt,G as Lu,H as is,I as Ia,J as Tn,L as zu,M as Ou,N as pe,O as Ru,P as pa,Q as va,R as vi,S as qu,U as Yu,V as Lt,W as ju,X as qn,Y as El,Z as Hu,_ as rl,$ as en,a0 as rs,a1 as tt,a2 as Wu,a3 as Mt,a4 as qo,a5 as yl,a6 as Da,a7 as hl,a8 as Gu,a9 as Bn,aa as Ln,ab as Xn,ac as Ao,ad as vo,ae as Ku,af as Qu,ag as st,ah as $a,ai as Qa,aj as fi,ak as yi,al as us,am as Ju,an as Bt,ao as Cs,ap as Ra,aq as So,ar as eo,as as gi,at as Zu,au as Zt,av as La,aw as hi,ax as ds,ay as tn,az as Yo,aA as fo,aB as Xu,aC as bi,aD as Ht,aE as ed,aF as Dl,aG as Vo,aH as ws,aI as cs,aJ as cn,aK as jo,aL as As,aM as td,aN as ad,aO as yo,aP as Io,aQ as go,aR as Ti,aS as Ss,aT as Ho,aU as ld,aV as ki,aW as Vs,aX as nd,aY as od,aZ as sd,a_ as id,a$ as rd,b0 as Pl,b1 as ud,b2 as dd,b3 as cd,b4 as md,b5 as pd,b6 as vd,b7 as oa,b8 as fd,b9 as yd,ba as gd,bb as hd,bc as bd,bd as Td,be as kd,bf as _d,bg as Sl,bh as nn,bi as xd,bj as ca,bk as Cd,bl as gl,bm as zn,bn as ll,bo as wn,bp as wd,bq as _i,br as Ad,bs as ma,bt as Bl,bu as mn,bv as ho,bw as Sd,bx as Nn,by as Vd,bz as Ol,bA as Id,bB as Is,bC as Ds,bD as Wo,bE as Dd,bF as Yt,bG as $s,bH as Fn,bI as dn,bJ as En,bK as Ll,bL as Do,bM as $d,bN as Vn,bO as Mn,bP as Nd,bQ as et,bR as At,bS as Ns,bT as to,bU as $o,bV as Yn,bW as ao,bX as wa,bY as An,bZ as Ga,b_ as Vl,b$ as Aa,c0 as Fd,c1 as Ed,c2 as No,c3 as Md,c4 as Ud,c5 as Pd,c6 as Bd,c7 as pl,c8 as bo,c9 as Ld,ca as zd,cb as Fo,cc as Od,cd as Rd,ce as qd,cf as Yd,cg as jd,ch as Hd,ci as Wd,cj as Gd,ck as Kd,cl as Qd,cm as Jd,cn as Zd,co as xi,cp as ms,cq as mo,cr as po,cs as Xd,ct as on,cu as ec,cv as tc,cw as ac,cx as lc,cy as nc,cz as oc,cA as sc,cB as ic,cC as lo,cD as rc,cE as uc,cF as dc,cG as cc,cH as mc,cI as pc,cJ as vc,cK as ps,cL as Fs,cM as Es,cN as fc,cO as Ml,cP as yc,cQ as gc,cR as hc,cS as bc,cT as Tc,cU as no,cV as oo,cW as Ci,cX as kc,cY as wi,cZ as _c,c_ as Sn,c$ as so,d0 as xc,d1 as Cc,d2 as Eo,d3 as Mo,d4 as wc,d5 as Ac,d6 as Sc,d7 as Vc,d8 as Ai,d9 as Ic,da as Dc,db as $c,dc as Nc,dd as Ms,de as Fc,df as Us,dg as Ec,dh as Mc,di as Uc,dj as Pc,dk as Bc,dl as Ps,dm as Lc,dn as qt,dp as zc,dq as Oc,dr as Rc,ds as qc,dt as Yc,du as jc,dv as Hc,dw as Wc,dx as Gc,dy as Kc}from"./common-B96FbeRZ.js";import{_ as kn}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./moment-CIPJ811N.js";import"./locales-CDQiBxHT.js";const ct=Oe({__name:"SnackBar",emits:["update:show"],setup(v,{expose:_,emit:n}){const s=n,{tt:h,te:d}=je(),y=P(!1),f=P("");function b(u,m){y.value=!0,m?f.value=h(u,m):f.value=h(u)}function x(u){y.value=!0,zl(u)&&"message"in u&&u.message?f.value=d(u.message):(zl(u)&&"error"in u||Va(u))&&(f.value=d(u))}return Ft(y,u=>{s("update:show",u)}),_({showMessage:b,showError:x}),(u,m)=>(l(),c(Ko,{modelValue:y.value,"onUpdate:modelValue":m[1]||(m[1]=k=>y.value=k)},{actions:a(()=>[t(H,{color:"primary",variant:"text",onClick:m[0]||(m[0]=k=>y.value=!1)},{default:a(()=>[q(i(e(h)("Close")),1)]),_:1})]),default:a(()=>[q(i(f.value)+" ",1)]),_:1},8,["modelValue"]))}}),Qc={class:"nav-header"},Jc={class:"d-flex"},Zc=["src"],Xc={class:"font-weight-medium text-xl"},em={class:"nav-link home-link"},tm={class:"nav-item-title"},am={class:"nav-section-title"},lm={class:"title-wrapper"},nm={class:"title-text"},om={class:"nav-link"},sm={class:"nav-item-title d-inline-block"},im={class:"nav-link"},rm={class:"nav-item-title"},um={class:"nav-link"},dm={class:"nav-item-title"},cm={class:"nav-section-title"},mm={class:"title-wrapper"},pm={class:"title-text"},vm={class:"nav-link"},fm={class:"nav-item-title"},ym={class:"nav-link"},gm={class:"nav-item-title"},hm={class:"nav-link"},bm={class:"nav-item-title"},Tm={class:"nav-link"},km={class:"nav-item-title"},_m={key:0,class:"nav-link"},xm={class:"nav-item-title"},Cm={class:"nav-section-title"},wm={class:"title-wrapper"},Am={class:"title-text"},Sm={class:"nav-link"},Vm={class:"nav-item-title"},Im={class:"nav-link"},Dm={class:"nav-item-title"},$m={class:"nav-link"},Nm={class:"nav-item-title"},Fm={class:"layout-content-wrapper"},Em={class:"layout-navbar navbar-blur"},Mm={class:"navbar-content-container"},Um={class:"d-flex h-100 align-center"},Pm={key:0,class:"app-logo d-flex align-center gap-x-3 app-title-wrapper"},Bm={class:"d-flex"},Lm=["src"],zm={class:"font-weight-medium text-xl"},Om={class:"d-flex align-center justify-center fill-height bg-light-primary"},Rm={class:"d-flex align-center justify-center fill-height bg-light-primary"},qm={class:"layout-page-content"},Ym={class:"page-content-container"},jm=Oe({__name:"MainLayout",setup(v){const _=Rl(),n=Kt(),s=er(),h=Na(),{tt:d,initLocale:y}=je(),f=Za(),b=Ya(),x=ta(),u=ci(),m=xe("snackbar"),k=P(!1),N=P(!1),V=P(!1),p=P(!1),T=P(!1),A=E(()=>_.mdAndDown.value),w=E(()=>s.path),I=E(()=>x.currentUserNickname||d("User")),F=E(()=>x.getUserAvatarUrl(x.currentUserBasicInfo,!0)),S=E({get:()=>b.appSettings.theme,set:D=>{D!==b.appSettings.theme&&(b.setTheme(D),D===$t.Light||D===$t.Dark?n.change(D):n.change(os()))}}),j=E(()=>b.appSettings.showAddTransactionButtonInDesktopNavbar),B=E(()=>b.appSettings.applicationLock);function U(D){N.value=D.target.scrollTop>0}function X(){f.lock(),h.replace("/unlock")}function oe(){k.value=!0,p.value=!0,f.logout().then(()=>{k.value=!1,p.value=!1,b.clearAppSettings();const D=y(x.currentUserLanguage,b.appSettings.timeZone);b.updateLocalizedDefaultSettings(D),Oo(x.currentUserExpenseAmountColor,x.currentUserIncomeAmountColor),h.replace("/login")}).catch(D=>{k.value=!1,p.value=!1,D.processed||m.value?.showError(D)})}function W(){u.setShowAddTransactionDialogInTransactionList()}return(D,$)=>{const C=Ve("router-link"),M=Ve("perfect-scrollbar"),ee=Ve("router-view"),ye=Ve("switch-to-mobile-dialog");return l(),g("div",{class:be(["layout-wrapper layout-nav-type-vertical layout-navbar-static layout-footer-static layout-content-width-fluid",{"layout-overlay-nav":A.value}])},[o("div",{class:be(["layout-vertical-nav",{visible:V.value,scrolled:N.value,"overlay-nav":A.value}])},[o("div",Qc,[t(C,{to:"/",class:"app-logo d-flex align-center gap-x-3 app-title-wrapper"},{default:a(()=>[o("div",Jc,[o("img",{alt:"logo",class:"main-logo",src:e(fl)},null,8,Zc)]),o("h1",Xc,i(e(d)("global.app.title")),1)]),_:1})]),t(M,{tag:"ul",class:"nav-items",options:{wheelPropagation:!1},onPsScrollY:U},{default:a(()=>[o("li",em,[t(C,{to:"/"},{default:a(()=>[t(ie,{class:"nav-item-icon",icon:e(tr)},null,8,["icon"]),o("span",tm,i(e(d)("Overview")),1)]),_:1})]),o("li",am,[o("div",lm,[o("span",nm,i(e(d)("Transaction Data")),1)])]),o("li",om,[t(C,{to:"/transaction/list?pageType=0&dateType=7"},{default:a(()=>[t(ie,{class:"nav-item-icon",icon:e(bl)},null,8,["icon"]),o("span",sm,i(e(d)("Transaction Details")),1),j.value?(l(),c(H,{key:0,density:"compact",color:"secondary",variant:"text",size:"22",class:"ms-1",icon:!0,onClick:W},{default:a(()=>[t(ie,{icon:e(ar),size:"22"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(d)("Add Transaction")),1)]),_:1})]),_:1})):r("",!0)]),_:1})]),o("li",im,[t(C,{to:"/statistics/transaction"},{default:a(()=>[t(ie,{class:"nav-item-icon",icon:e(zs)},null,8,["icon"]),o("span",rm,i(e(d)("Statistics & Analysis")),1)]),_:1})]),o("li",um,[t(C,{to:"/insights/explore"},{default:a(()=>[t(ie,{class:"nav-item-icon",icon:e(lr)},null,8,["icon"]),o("span",dm,i(e(d)("Insights & Explore")),1)]),_:1})]),o("li",cm,[o("div",mm,[o("span",pm,i(e(d)("Basis Data")),1)])]),o("li",vm,[t(C,{to:"/account/list"},{default:a(()=>[t(ie,{class:"nav-item-icon",icon:e(Qo)},null,8,["icon"]),o("span",fm,i(e(d)("Accounts")),1)]),_:1})]),o("li",ym,[t(C,{to:"/category/list"},{default:a(()=>[t(ie,{class:"nav-item-icon",icon:e(Os)},null,8,["icon"]),o("span",gm,i(e(d)("Transaction Categories")),1)]),_:1})]),o("li",hm,[t(C,{to:"/tag/list"},{default:a(()=>[t(ie,{class:"nav-item-icon",icon:e(Rs)},null,8,["icon"]),o("span",bm,i(e(d)("Transaction Tags")),1)]),_:1})]),o("li",Tm,[t(C,{to:"/template/list"},{default:a(()=>[t(ie,{class:"nav-item-icon",icon:e(qs)},null,8,["icon"]),o("span",km,i(e(d)("Transaction Templates")),1)]),_:1})]),e(Vu)()?(l(),g("li",_m,[t(C,{to:"/schedule/list"},{default:a(()=>[t(ie,{class:"nav-item-icon",icon:e(Ys)},null,8,["icon"]),o("span",xm,i(e(d)("Scheduled Transactions")),1)]),_:1})])):r("",!0),o("li",Cm,[o("div",wm,[o("span",Am,i(e(d)("Miscellaneous")),1)])]),o("li",Sm,[t(C,{to:"/exchange_rates"},{default:a(()=>[t(ie,{class:"nav-item-icon",icon:e(Dn)},null,8,["icon"]),o("span",Vm,i(e(d)("Exchange Rates Data")),1)]),_:1})]),o("li",Im,[o("a",{href:"javascript:void(0);",onClick:$[0]||($[0]=L=>T.value=!0)},[t(ie,{class:"nav-item-icon",icon:e(Jo)},null,8,["icon"]),o("span",Dm,i(e(d)("Use on Mobile Device")),1)])]),o("li",$m,[t(C,{to:"/about"},{default:a(()=>[t(ie,{class:"nav-item-icon",icon:e(nr)},null,8,["icon"]),o("span",Nm,i(e(d)("About")),1)]),_:1})])]),_:1})],2),o("div",Fm,[o("div",Em,[o("div",Mm,[o("div",Um,[t(H,{class:"ms-n3 me-2 d-lg-none",color:"default",variant:"text",icon:!0,onClick:$[1]||($[1]=L=>V.value=!0)},{default:a(()=>[t(ie,{icon:e(ql),size:"24"},null,8,["icon"])]),_:1}),A.value?(l(),g("div",Pm,[o("div",Bm,[o("img",{alt:"logo",class:"main-logo",src:e(fl)},null,8,Lm)]),o("h1",zm,i(e(d)("global.app.title")),1)])):r("",!0),t(it),t(H,{color:"primary",variant:"text",class:"me-2",icon:!0,onClick:$[2]||($[2]=L=>S.value==="light"?S.value="dark":S.value==="dark"?S.value="auto":S.value="light")},{default:a(()=>[t(ie,{icon:S.value==="light"?e(or):S.value==="dark"?e(sr):e(ir),size:"24"},null,8,["icon"])]),_:1}),t(ol,{class:"cursor-pointer",variant:"tonal",color:F.value?"rgba(0,0,0,0)":"primary"},{default:a(()=>[F.value?(l(),c(wt,{key:0,src:F.value},{placeholder:a(()=>[o("div",Om,[t(ie,{color:"primary",icon:e(rn)},null,8,["icon"])])]),_:1},8,["src"])):F.value?r("",!0):(l(),c(ie,{key:1,icon:e(rn)},null,8,["icon"])),t(mt,{activator:"parent",width:"230",location:"bottom end",offset:"14px"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,null,{prepend:a(()=>[t(Zo,null,{default:a(()=>[t(ol,{variant:"tonal",color:F.value?"rgba(0,0,0,0)":"primary"},{default:a(()=>[F.value?(l(),c(wt,{key:0,src:F.value},{placeholder:a(()=>[o("div",Rm,[t(ie,{color:"primary",icon:e(rn)},null,8,["icon"])])]),_:1},8,["src"])):F.value?r("",!0):(l(),c(ie,{key:1,icon:e(rn)},null,8,["icon"]))]),_:1},8,["color"])]),_:1})]),default:a(()=>[t(rt,{class:"ms-2"},{default:a(()=>[q(i(I.value),1)]),_:1})]),_:1}),t(nt,{class:"my-2"}),t(ve,{"prepend-icon":e(rr),title:e(d)("User Settings"),to:"/user/settings"},null,8,["prepend-icon","title"]),t(ve,{"prepend-icon":e(js),title:e(d)("Application Settings"),to:"/app/settings"},null,8,["prepend-icon","title"]),t(nt,{class:"my-2"}),B.value?(l(),c(ve,{key:0,"prepend-icon":e(ur),title:e(d)("Lock Application"),onClick:X},null,8,["prepend-icon","title"])):r("",!0),t(ve,{disabled:k.value,"prepend-icon":e(dr),title:e(d)("Log Out"),onClick:oe},null,8,["disabled","prepend-icon","title"])]),_:1})]),_:1})]),_:1},8,["color"])])])]),o("div",qm,[o("div",Ym,[(l(),c(ee,{key:w.value}))])])]),t(ye,{show:T.value,"onUpdate:show":$[3]||($[3]=L=>T.value=L)},null,8,["show"]),o("div",{class:be(["layout-overlay",{visible:V.value}]),onClick:$[4]||($[4]=L=>V.value=!1)},null,2),t(Hs,{class:"justify-center align-center",persistent:!0,modelValue:p.value,"onUpdate:modelValue":$[5]||($[5]=L=>p.value=L)},{default:a(()=>[t(Ze,{indeterminate:""})]),_:1},8,["modelValue"]),t(ct,{ref_key:"snackbar",ref:m},null,512)],2)}}}),Hm={class:"layout-wrapper"},Wm={class:"auth-logo d-flex align-start gap-x-3"},Gm=["src"],Km={class:"font-weight-medium leading-normal text-2xl"},Qm={key:0,class:"d-flex auth-img-footer"},Jm={key:1,class:"d-flex auth-img-footer"},Zm={class:"d-flex align-center justify-center w-100 pt-10"},Xm={class:"d-flex align-center justify-center h-100"},ep={class:"text-h4 mb-2"},tp={key:0,class:"mb-0"},ap={key:1,class:"mt-1 mb-0"},lp={class:"d-flex align-center justify-space-between flex-wrap"},np={class:"nav-item-title"},op={class:"me-1"},sp={class:"d-flex align-center justify-center"},ip=Oe({__name:"LoginPage",setup(v){const _=Na(),n=Kt(),{tt:s}=je(),h=Za(),{version:d,username:y,password:f,passcode:b,backupCode:x,tempToken:u,twoFAVerifyType:m,oauth2ClientSessionId:k,loggingInByPassword:N,loggingInByOAuth2:V,verifying:p,inputIsEmpty:T,twoFAInputIsEmpty:A,oauth2LoginUrl:w,oauth2LoginDisplayName:I,tips:F,doAfterLogin:S}=mi("desktop"),j=xe("passwordInput"),B=xe("passcodeInput"),U=xe("snackbar"),X=P(!1),oe=P(!1),W=E(()=>n.global.name.value===$t.Dark);function D(){if(!y.value){U.value?.showMessage("Username cannot be blank");return}if(!f.value){U.value?.showMessage("Password cannot be blank");return}if(u.value){X.value=!0;return}N.value||(N.value=!0,h.authorize({loginName:y.value,password:f.value}).then(C=>{if(N.value=!1,C.need2FA){u.value=C.token,X.value=!0,ha(()=>{B.value&&(B.value.focus(),B.value.select())});return}S(C),_.replace("/")}).catch(C=>{if(N.value=!1,gn()&&C.error&&C.error.errorCode===Tl.UserEmailNotVerified&&C.error.context&&C.error.context.email){_.push(`/verify_email?email=${encodeURIComponent(C.error.context.email)}&emailSent=${C.error.context.hasValidEmailVerifyToken||!1}`);return}C.processed||U.value?.showError(C)}))}function $(){if(!(A.value||p.value)){if(m.value==="passcode"&&!b.value){U.value?.showMessage("Passcode cannot be blank");return}else if(m.value==="backupcode"&&!x.value){U.value?.showMessage("Backup code cannot be blank");return}p.value=!0,h.authorize2FA({token:u.value,passcode:m.value==="passcode"?b.value:null,recoveryCode:m.value==="backupcode"?x.value:null}).then(C=>{p.value=!1,S(C),_.replace("/")}).catch(C=>{p.value=!1,C.processed||U.value?.showError(C)})}}return k.value=_l(),(C,M)=>{const ee=Ve("router-link"),ye=Ve("language-select-button"),L=Ve("switch-to-mobile-dialog");return l(),g("div",Hm,[t(ee,{to:"/"},{default:a(()=>[o("div",Wm,[o("img",{alt:"logo",class:"login-page-logo",src:e(fl)},null,8,Gm),o("h1",Km,i(e(s)("global.app.title")),1)])]),_:1}),t(Ae,{"no-gutters":"",class:"auth-wrapper"},{default:a(()=>[t(R,{cols:"12",md:"8",class:"auth-image-background d-none d-md-flex align-center justify-center position-relative"},{default:a(()=>[W.value?r("",!0):(l(),g("div",Qm,[t(wt,{class:"img-with-direction",src:"img/desktop/background.svg"})])),W.value?(l(),g("div",Jm,[t(wt,{class:"img-with-direction",src:"img/desktop/background-dark.svg"})])):r("",!0),o("div",Zm,[W.value?W.value?(l(),c(wt,{key:1,class:"img-with-direction","max-width":"600px",src:"img/desktop/people1-dark.svg"})):r("",!0):(l(),c(wt,{key:0,class:"img-with-direction","max-width":"600px",src:"img/desktop/people1.svg"}))])]),_:1}),t(R,{cols:"12",md:"4",class:"auth-card d-flex flex-column"},{default:a(()=>[o("div",Xm,[t(Me,{variant:"flat",class:"w-100 mt-0 px-4 pt-12","max-width":"500"},{default:a(()=>[t(ge,null,{default:a(()=>[o("h4",ep,i(e(s)("Welcome to ezBookkeeping")),1),e(ln)()?(l(),g("p",tp,i(e(s)("Please log in with your ezBookkeeping account")),1)):r("",!0),e(F)?(l(),g("p",ap,i(e(F)),1)):r("",!0)]),_:1}),t(ge,{class:"pb-0 mb-6"},{default:a(()=>[t(jt,null,{default:a(()=>[t(Ae,null,{default:a(()=>[e(ln)()?(l(),c(R,{key:0,cols:"12"},{default:a(()=>[t(e(ot),{type:"text",autocomplete:"username",autofocus:!0,disabled:X.value||e(N)||e(V)||e(p),label:e(s)("Username"),placeholder:e(s)("Your username or email"),modelValue:e(y),"onUpdate:modelValue":M[0]||(M[0]=Y=>ht(y)?y.value=Y:null),onInput:M[1]||(M[1]=Y=>u.value=""),onKeyup:M[2]||(M[2]=Gt(Y=>j.value?.focus(),["enter"]))},null,8,["disabled","label","placeholder","modelValue"])]),_:1})):r("",!0),e(ln)()?(l(),c(R,{key:1,cols:"12"},{default:a(()=>[t(e(ot),{autocomplete:"current-password",ref_key:"passwordInput",ref:j,type:"password",disabled:X.value||e(N)||e(V)||e(p),label:e(s)("Password"),placeholder:e(s)("Your password"),modelValue:e(f),"onUpdate:modelValue":M[3]||(M[3]=Y=>ht(f)?f.value=Y:null),onInput:M[4]||(M[4]=Y=>u.value=""),onKeyup:Gt(D,["enter"])},null,8,["disabled","label","placeholder","modelValue"])]),_:1})):r("",!0),za(t(R,{cols:"12"},{default:a(()=>[e(m)==="passcode"?(l(),c(e(ot),{key:0,type:"number",autocomplete:"one-time-code",ref_key:"passcodeInput",ref:B,disabled:e(N)||e(V)||e(p),label:e(s)("Passcode"),placeholder:e(s)("Passcode"),"append-inner-icon":e(Ws),modelValue:e(b),"onUpdate:modelValue":M[5]||(M[5]=Y=>ht(b)?b.value=Y:null),"onClick:appendInner":M[6]||(M[6]=Y=>m.value="backupcode"),onKeyup:Gt($,["enter"])},null,8,["disabled","label","placeholder","append-inner-icon","modelValue"])):r("",!0),e(m)==="backupcode"?(l(),c(e(ot),{key:1,type:"text",disabled:e(N)||e(V)||e(p),label:e(s)("Backup Code"),placeholder:e(s)("Backup Code"),"append-inner-icon":e(Gs),modelValue:e(x),"onUpdate:modelValue":M[7]||(M[7]=Y=>ht(x)?x.value=Y:null),"onClick:appendInner":M[8]||(M[8]=Y=>m.value="passcode"),onKeyup:Gt($,["enter"])},null,8,["disabled","label","placeholder","append-inner-icon","modelValue"])):r("",!0)]),_:1},512),[[Ka,X.value]]),t(R,{cols:"12",class:"py-0 mt-1 mb-4"},{default:a(()=>[o("div",lp,[o("a",{href:"javascript:void(0);",class:be({disabled:e(N)||e(V)||e(p)}),onClick:M[9]||(M[9]=Y=>oe.value=!0)},[o("span",np,i(e(s)("Use on Mobile Device")),1)],2),t(it),t(ee,{class:be(["text-primary",{disabled:!e(Iu)()||e(N)||e(V)||e(p)}]),to:"/forgetpassword"},{default:a(()=>[q(i(e(s)("Forget Password?")),1)]),_:1},8,["class"])])]),_:1}),t(R,{cols:"12"},{default:a(()=>[e(ln)()&&!X.value?(l(),c(H,{key:0,block:"",disabled:e(T)||e(N)||e(V)||e(p),onClick:D},{default:a(()=>[q(i(e(s)("Log In"))+" ",1),e(N)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])):r("",!0),e(ln)()&&e(un)()?(l(),c(R,{key:1,cols:"12",class:"d-flex align-center px-0"},{default:a(()=>[t(nt,{class:"me-3"}),q(" "+i(e(s)("or"))+" ",1),t(nt,{class:"ms-3"})]),_:1})):r("",!0),e(un)()?(l(),c(H,{key:2,block:"",disabled:e(N)||e(V)||e(p),href:e(w),onClick:M[10]||(M[10]=Y=>V.value=!0)},{default:a(()=>[q(i(e(I))+" ",1),e(V)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled","href"])):X.value?(l(),c(H,{key:3,block:"",disabled:e(A)||e(N)||e(V)||e(p),onClick:$},{default:a(()=>[q(i(e(s)("Continue"))+" ",1),e(p)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])):r("",!0)]),_:1}),e(ln)()?(l(),c(R,{key:2,cols:"12",class:"text-center text-base"},{default:a(()=>[o("span",op,i(e(s)("Don't have an account?")),1),t(ee,{class:be(["text-primary",{disabled:!e(Du)()||e(N)||e(V)||e(p)}]),to:"/signup"},{default:a(()=>[q(i(e(s)("Create an account")),1)]),_:1},8,["class"])]),_:1})):r("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),t(it),o("div",sp,[t(Me,{variant:"flat",class:"w-100 px-4 pb-4","max-width":"500"},{default:a(()=>[t(ge,{class:"pt-0"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",class:"text-center"},{default:a(()=>[t(ye,{disabled:e(N)||e(V)||e(p)},null,8,["disabled"])]),_:1}),t(R,{cols:"12",class:"d-flex align-center pt-0"},{default:a(()=>[t(nt)]),_:1}),t(R,{cols:"12",class:"text-center text-sm"},{default:a(()=>[M[12]||(M[12]=o("span",null,"Powered by ",-1)),M[13]||(M[13]=o("a",{href:"https://github.com/mayswind/ezbookkeeping",target:"_blank"},"ezBookkeeping",-1)),M[14]||(M[14]=q(" ",-1)),o("span",null,i(e(d)),1)]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),t(L,{show:oe.value,"onUpdate:show":M[11]||(M[11]=Y=>oe.value=Y)},null,8,["show"]),t(ct,{ref_key:"snackbar",ref:U},null,512)])}}}),rp={class:"layout-wrapper"},up={class:"auth-logo d-flex align-start gap-x-3"},dp=["src"],cp={class:"font-weight-medium leading-normal text-2xl"},mp={key:0,class:"d-flex auth-img-footer"},pp={key:1,class:"d-flex auth-img-footer"},vp={class:"d-flex align-center justify-center w-100 pt-10"},fp={class:"text-h4 mb-1"},yp={class:"text-sm mt-2 mb-5"},gp={class:"text-h4 mb-1"},hp={class:"text-sm mt-2 mb-2"},bp={class:"mb-3"},Tp={class:"ms-3"},kp={class:"ms-3"},_p={class:"text-h4 mb-1"},xp={class:"my-5"},Cp={class:"d-flex justify-sm-space-between gap-4 flex-wrap justify-center mt-5"},wp=Oe({__name:"SignupPage",setup(v){const _=Na(),n=Kt(),{tt:s,getAllWeekDays:h,getAllTransactionDefaultCategories:d}=je(),{user:y,submitting:f,languageTitle:b,currentLocale:x,inputEmptyProblemMessage:u,inputInvalidProblemMessage:m,getCategoryTypeName:k,doAfterSignupSuccess:N}=$u(),V=Za(),p=xe("snackbar"),T=P("basicSetting"),A=P(!1),w=P(null),I=P(!1),F=E(()=>h()),S=E(()=>d(0,x.value)),j=E(()=>n.global.name.value===$t.Dark),B=E(()=>{const C=[{name:"basicSetting",title:s("User Information"),subTitle:s("Basic Information")},{name:"presetCategories",title:s("Transaction Categories"),subTitle:s("Preset Categories")}];return w.value&&C.push({name:"finalResult",title:s("Complete"),subTitle:s("Registration Completed")}),C});function U(C){if(!(f.value||T.value==="finalResult"||I.value)){if(C==="basicSetting")T.value="basicSetting";else if(C==="presetCategories"){const M=u.value||m.value;if(M){p.value?.showMessage(M);return}T.value="presetCategories"}}}function X(){U("basicSetting")}function oe(){U("presetCategories")}function W(){const C=u.value||m.value;if(C){p.value?.showMessage(C);return}I.value=!1,f.value=!0;let M=[];A.value&&(M=pi(S.value)),V.register({user:y.value,presetCategories:M}).then(ee=>{if(!xl()){f.value=!1,A.value&&!ee.presetCategoriesSaved?(w.value=s("You have been successfully registered, but there was an failure when adding preset categories. You can re-add preset categories in settings page anytime."),T.value="finalResult"):ee.needVerifyEmail?(w.value=s("You have been successfully registered. An account activation link has been sent to your email address, please activate your account first."),T.value="finalResult"):(p.value?.showMessage("You have been successfully registered"),I.value=!0);return}N(ee),f.value=!1,A.value&&!ee.presetCategoriesSaved?p.value?.showMessage("You have been successfully registered, but there was an failure when adding preset categories. You can re-add preset categories in settings page anytime."):(p.value?.showMessage("You have been successfully registered"),_.replace("/")),I.value=!0}).catch(ee=>{f.value=!1,ee.processed||p.value?.showError(ee)})}function D(){_.push("/")}function $(C){!C&&I.value&&_.replace("/")}return(C,M)=>{const ee=Ve("router-link"),ye=Ve("steps-bar"),L=Ve("language-select"),Y=Ve("currency-select"),O=Ve("language-select-button"),J=Ve("ItemIcon");return l(),g("div",rp,[t(ee,{to:"/"},{default:a(()=>[o("div",up,[o("img",{alt:"logo",class:"login-page-logo",src:e(fl)},null,8,dp),o("h1",cp,i(e(s)("global.app.title")),1)])]),_:1}),t(Ae,{"no-gutters":"",class:"auth-wrapper"},{default:a(()=>[t(R,{cols:"12",md:"4",class:"auth-image-background d-none d-md-flex align-center justify-center position-relative"},{default:a(()=>[j.value?r("",!0):(l(),g("div",mp,[t(wt,{class:"img-with-direction",src:"img/desktop/background.svg"})])),j.value?(l(),g("div",pp,[t(wt,{class:"img-with-direction",src:"img/desktop/background-dark.svg"})])):r("",!0),o("div",vp,[j.value?j.value?(l(),c(wt,{key:1,class:"img-with-direction","max-width":"320px",src:"img/desktop/people2-dark.svg"})):r("",!0):(l(),c(wt,{key:0,class:"img-with-direction","max-width":"320px",src:"img/desktop/people2.svg"}))])]),_:1}),t(R,{cols:"12",md:"8",class:"auth-card d-flex align-center justify-center pa-10"},{default:a(()=>[t(Me,{variant:"flat",class:"mt-12 mt-sm-0 pt-sm-12 pt-md-0"},{default:a(()=>[t(ye,{"min-width":"700",steps:B.value,"current-step":T.value,"onStep:change":U},null,8,["steps","current-step"]),t(qa,{class:"mt-5 disable-tab-transition",style:{"max-width":"700px"},modelValue:T.value,"onUpdate:modelValue":M[10]||(M[10]=ae=>T.value=ae)},{default:a(()=>[t(jt,null,{default:a(()=>[t(zt,{value:"basicSetting"},{default:a(()=>[o("h4",fp,i(e(s)("Basic Information")),1),o("p",yp,[o("span",null,i(e(s)("Already have an account?")),1),t(ee,{class:"ms-1",to:"/login"},{default:a(()=>[q(i(e(s)("Click here to log in")),1)]),_:1})]),t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(ot,{type:"text",autocomplete:"username",disabled:e(f)||I.value,label:e(s)("Username"),placeholder:e(s)("Your username"),modelValue:e(y).username,"onUpdate:modelValue":M[0]||(M[0]=ae=>e(y).username=ae)},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(ot,{type:"text",autocomplete:"nickname",disabled:e(f)||I.value,label:e(s)("Nickname"),placeholder:e(s)("Your nickname"),modelValue:e(y).nickname,"onUpdate:modelValue":M[1]||(M[1]=ae=>e(y).nickname=ae)},null,8,["disabled","label","placeholder","modelValue"])]),_:1})]),_:1}),t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"12"},{default:a(()=>[t(ot,{type:"email",autocomplete:"email",disabled:e(f)||I.value,label:e(s)("E-mail"),placeholder:e(s)("Your email address"),modelValue:e(y).email,"onUpdate:modelValue":M[2]||(M[2]=ae=>e(y).email=ae)},null,8,["disabled","label","placeholder","modelValue"])]),_:1})]),_:1}),t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(ot,{autocomplete:"new-password",type:"password",disabled:e(f)||I.value,label:e(s)("Password"),placeholder:e(s)("Your password, at least 6 characters"),modelValue:e(y).password,"onUpdate:modelValue":M[3]||(M[3]=ae=>e(y).password=ae)},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(ot,{autocomplete:"new-password",type:"password",disabled:e(f)||I.value,label:e(s)("Confirm Password"),placeholder:e(s)("Re-enter the password"),modelValue:e(y).confirmPassword,"onUpdate:modelValue":M[4]||(M[4]=ae=>e(y).confirmPassword=ae)},null,8,["disabled","label","placeholder","modelValue"])]),_:1})]),_:1}),t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"12"},{default:a(()=>[t(L,{disabled:e(f)||I.value,label:e(b),placeholder:e(b),"use-model-value":!0,modelValue:e(x),"onUpdate:modelValue":M[5]||(M[5]=ae=>ht(x)?x.value=ae:null)},null,8,["disabled","label","placeholder","modelValue"])]),_:1})]),_:1}),t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Y,{disabled:e(f)||I.value,label:e(s)("Default Currency"),placeholder:e(s)("Default Currency"),modelValue:e(y).defaultCurrency,"onUpdate:modelValue":M[6]||(M[6]=ae=>e(y).defaultCurrency=ae)},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type",disabled:e(f)||I.value,label:e(s)("First Day of Week"),placeholder:e(s)("First Day of Week"),items:F.value,modelValue:e(y).firstDayOfWeek,"onUpdate:modelValue":M[7]||(M[7]=ae=>e(y).firstDayOfWeek=ae)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1}),t(zt,{value:"presetCategories",class:"signup-preset-categories"},{default:a(()=>[o("h4",gp,i(e(s)("Preset Categories")),1),o("p",hp,i(e(s)("Set whether to use preset transaction categories")),1),t(Ae,null,{default:a(()=>[t(R,{cols:"12",sm:"6"},{default:a(()=>[t(Ea,{class:"mb-2",disabled:e(f)||I.value,label:e(s)("Use Preset Transaction Categories"),modelValue:A.value,"onUpdate:modelValue":M[8]||(M[8]=ae=>A.value=ae)},null,8,["disabled","label","modelValue"])]),_:1}),t(R,{cols:"12",sm:"6",class:"text-end-sm"},{default:a(()=>[t(O,{disabled:e(f)||I.value,"use-model-value":!0,modelValue:e(x),"onUpdate:modelValue":M[9]||(M[9]=ae=>ht(x)?x.value=ae:null)},null,8,["disabled","modelValue"])]),_:1})]),_:1}),o("div",{class:be(["overflow-y-auto px-3",{disabled:!A.value||e(f)||I.value}]),style:{"max-height":"323px"}},[(l(!0),g(fe,null,$e(S.value,(ae,Z)=>(l(),c(Ae,{key:Z},{default:a(()=>[t(R,{cols:"12",md:"12"},{default:a(()=>[o("h4",bp,i(e(k)(parseInt(Z))),1),t(Yl,{class:"border rounded",variant:"accordion",multiple:""},{default:a(()=>[(l(!0),g(fe,null,$e(ae,(le,z)=>(l(),c(jl,{key:z},{default:a(()=>[t(Hl,{class:"py-0"},{default:a(()=>[t(J,{"icon-type":"category","icon-id":le.icon,color:le.color},null,8,["icon-id","color"]),o("span",Tp,i(le.name),1)]),_:2},1024),le.subCategories.length?(l(),c(Wl,{key:0},{default:a(()=>[t(Je,{rounded:"",density:"comfortable",class:"pa-0"},{default:a(()=>[(l(!0),g(fe,null,$e(le.subCategories,(se,ue)=>(l(),g(fe,{key:ue},[t(ve,null,{prepend:a(()=>[t(J,{"icon-type":"category","icon-id":se.icon,color:se.color},null,8,["icon-id","color"])]),default:a(()=>[o("span",kp,i(se.name),1)]),_:2},1024),ue!==le.subCategories.length-1?(l(),c(nt,{key:0})):r("",!0)],64))),128))]),_:2},1024)]),_:2},1024)):r("",!0)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))],2)]),_:1}),w.value?(l(),c(zt,{key:0,value:"finalResult"},{default:a(()=>[o("h4",_p,i(e(s)("Registration Completed")),1),o("p",xp,i(w.value),1)]),_:1})):r("",!0)]),_:1})]),_:1},8,["modelValue"]),o("div",Cp,[t(H,{class:"button-icon-with-direction",color:T.value==="basicSetting"||T.value==="finalResult"?"default":"primary",disabled:T.value==="basicSetting"||T.value==="finalResult"||e(f)||I.value,"prepend-icon":e(On),onClick:X},{default:a(()=>[q(i(e(s)("Previous")),1)]),_:1},8,["color","disabled","prepend-icon"]),T.value==="basicSetting"?(l(),c(H,{key:0,class:"button-icon-with-direction",color:"primary",disabled:e(f)||I.value,"append-icon":e(ba),onClick:oe},{default:a(()=>[q(i(e(s)("Next")),1)]),_:1},8,["disabled","append-icon"])):r("",!0),T.value==="presetCategories"?(l(),c(H,{key:1,color:"teal",disabled:e(f)||I.value,"append-icon":e(f)?void 0:e(Xe),onClick:W},{default:a(()=>[q(i(e(s)("Submit"))+" ",1),e(f)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled","append-icon"])):r("",!0),T.value==="finalResult"?(l(),c(H,{key:2,class:"button-icon-with-direction","append-icon":e(ba),onClick:D},{default:a(()=>[q(i(e(s)("Continue")),1)]),_:1},8,["append-icon"])):r("",!0)])]),_:1})]),_:1})]),_:1}),t(ct,{ref_key:"snackbar",ref:p,"onUpdate:show":$},null,512)])}}}),ka=Oe({__name:"ConfirmDialog",props:{show:{type:Boolean},color:{},title:{},text:{}},emits:["update:show"],setup(v,{expose:_,emit:n}){const s=v,h=n,{tt:d}=je(),y=P(!1),f=P(s.title||d("global.app.title")),b=P(s.text||""),x=P(s.color||"primary");let u=null,m=null;function k(p,T,A){if(y.value=!0,!T||zl(T))if(f.value=d("global.app.title"),!T)b.value=d(p);else{const w=T;b.value=d(p,w)}else Va(T)&&(A?(f.value=d(p,A),b.value=d(T,A)):(f.value=d(p),b.value=d(T)));return T&&zl(T)&&Va(T.color)?x.value=T.color||"primary":A&&Va(A.color)&&(x.value=A.color||"primary"),new Promise((w,I)=>{u=w,m=I})}function N(){u&&u(),y.value=!1,h("update:show",!1)}function V(){m&&m(),y.value=!1,h("update:show",!1)}return Ft(y,p=>{h("update:show",p)}),_({open:k}),(p,T)=>(l(),c(xt,{persistent:"","min-width":"320",width:"auto",modelValue:y.value,"onUpdate:modelValue":T[0]||(T[0]=A=>y.value=A)},{default:a(()=>[t(Me,null,{default:a(()=>[t(Xo,{color:x.value},{default:a(()=>[t(Ks,null,{default:a(()=>[q(i(f.value),1)]),_:1})]),_:1},8,["color"]),b.value?(l(),c(ge,{key:0,class:"pa-4 pb-6"},{default:a(()=>[q(i(b.value),1)]),_:1})):r("",!0),t(Un,{class:"px-4 pb-4"},{default:a(()=>[t(it),t(H,{color:"gray",onClick:V},{default:a(()=>[q(i(e(d)("Cancel")),1)]),_:1}),t(H,{color:x.value,onClick:N},{default:a(()=>[q(i(e(d)("OK")),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ap={class:"layout-wrapper"},Sp={class:"auth-logo d-flex align-start gap-x-3"},Vp=["src"],Ip={class:"font-weight-medium leading-normal text-2xl"},Dp={key:0,class:"d-flex auth-img-footer"},$p={key:1,class:"d-flex auth-img-footer"},Np={class:"d-flex align-center justify-center w-100 pt-10"},Fp={class:"d-flex align-center justify-center h-100"},Ep={class:"text-h4 mb-2"},Mp={key:0,class:"mb-0"},Up={key:1,class:"mb-0"},Pp={key:2,class:"mb-0"},Bp={key:3,class:"mb-0"},Lp={key:4,class:"mb-0"},zp={key:0},Op={key:1},Rp={class:"d-flex align-center justify-center"},qp=Oe({__name:"VerifyEmailPage",props:{email:{},token:{},hasValidEmailVerifyToken:{type:Boolean}},setup(v){const _=v,n=Na(),s=Kt(),{tt:h,te:d}=je(),y=Za(),f=`${ss()}`,b=xe("confirmDialog"),x=xe("snackbar"),u=P(""),m=P(!0),k=P(!1),N=P(!1),V=P(""),p=E(()=>s.global.name.value===$t.Dark);function T(){if(N.value=!1,m.value=!0,!_.token){m.value=!1;return}y.verifyEmail({token:_.token,requestNewToken:!xl()}).then(()=>{m.value=!1,N.value=!0,x.value?.showMessage("Email address is verified")}).catch(I=>{m.value=!1,N.value=!1,I.processed||(V.value=d(I.message||I),x.value?.showError(I))})}function A(){k.value=!0,y.resendVerifyEmailByUnloginUser({email:_.email,password:u.value}).then(()=>{k.value=!1,x.value?.showMessage("Validation email has been sent")}).catch(I=>{k.value=!1,I.processed||x.value?.showError(I)})}function w(I){!I&&N.value&&xl()&&n.replace("/")}return T(),(I,F)=>{const S=Ve("router-link"),j=Ve("language-select-button");return l(),g("div",Ap,[t(S,{to:"/"},{default:a(()=>[o("div",Sp,[o("img",{alt:"logo",class:"login-page-logo",src:e(fl)},null,8,Vp),o("h1",Ip,i(e(h)("global.app.title")),1)])]),_:1}),t(Ae,{"no-gutters":"",class:"auth-wrapper"},{default:a(()=>[t(R,{cols:"12",md:"8",class:"auth-image-background d-none d-md-flex align-center justify-center position-relative"},{default:a(()=>[p.value?r("",!0):(l(),g("div",Dp,[t(wt,{class:"img-with-direction",src:"img/desktop/background.svg"})])),p.value?(l(),g("div",$p,[t(wt,{class:"img-with-direction",src:"img/desktop/background-dark.svg"})])):r("",!0),o("div",Np,[p.value?p.value?(l(),c(wt,{key:1,class:"img-with-direction","max-width":"320px",src:"img/desktop/people2-dark.svg"})):r("",!0):(l(),c(wt,{key:0,class:"img-with-direction","max-width":"320px",src:"img/desktop/people2.svg"}))])]),_:1}),t(R,{cols:"12",md:"4",class:"auth-card d-flex flex-column"},{default:a(()=>[o("div",Fp,[t(Me,{variant:"flat",class:"w-100 mt-0 px-4 pt-12","max-width":"500"},{default:a(()=>[t(ge,null,{default:a(()=>[o("h4",Ep,i(e(h)("Verify your email")),1),v.token&&m.value?(l(),g("p",Mp,i(e(h)("Verifying...")),1)):r("",!0),v.token&&N.value?(l(),g("p",Up,i(e(h)("Email address is verified")),1)):r("",!0),v.token&&!N.value&&V.value?(l(),g("p",Pp,i(V.value),1)):r("",!0),!v.token&&!v.email?(l(),g("p",Bp,i(e(h)("Parameter Invalid")),1)):r("",!0),!v.token&&v.email?(l(),g("p",Lp,i(e(h)(v.hasValidEmailVerifyToken?"format.misc.accountActivationAndResendValidationEmailTip":"format.misc.resendValidationEmailTip",{email:v.email})),1)):r("",!0)]),_:1}),t(ge,{class:"pb-0 mb-6"},{default:a(()=>[t(jt,null,{default:a(()=>[t(Ae,null,{default:a(()=>[!m.value&&!v.token&&v.email&&e(gn)()?(l(),c(R,{key:0,cols:"12"},{default:a(()=>[t(ot,{autocomplete:"password",type:"password",disabled:m.value||k.value,label:e(h)("Password"),placeholder:e(h)("Your password"),modelValue:u.value,"onUpdate:modelValue":F[0]||(F[0]=B=>u.value=B),onKeyup:Gt(A,["enter"])},null,8,["disabled","label","placeholder","modelValue"])]),_:1})):r("",!0),!m.value&&!v.token&&v.email&&e(gn)()?(l(),c(R,{key:1,cols:"12"},{default:a(()=>[t(H,{block:"",type:"submit",disabled:m.value||k.value||!u.value,onClick:A},{default:a(()=>[q(i(e(h)("Resend Validation Email"))+" ",1),k.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])]),_:1})):r("",!0),t(R,{cols:"12"},{default:a(()=>[t(S,{class:be(["d-flex align-center justify-center",{disabled:m.value||k.value}]),to:N.value?"/":"/login"},{default:a(()=>[t(ie,{class:"icon-with-direction",icon:e(To)},null,8,["icon"]),N.value?N.value?(l(),g("span",Op,i(e(h)("Back to home page")),1)):r("",!0):(l(),g("span",zp,i(e(h)("Back to login page")),1))]),_:1},8,["to","class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),t(it),o("div",Rp,[t(Me,{variant:"flat",class:"w-100 px-4 pb-4","max-width":"500"},{default:a(()=>[t(ge,{class:"pt-0"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",class:"text-center"},{default:a(()=>[t(j,{disabled:k.value},null,8,["disabled"])]),_:1}),t(R,{cols:"12",class:"d-flex align-center pt-0"},{default:a(()=>[t(nt)]),_:1}),t(R,{cols:"12",class:"text-center text-sm"},{default:a(()=>[F[1]||(F[1]=o("span",null,"Powered by ",-1)),F[2]||(F[2]=o("a",{href:"https://github.com/mayswind/ezbookkeeping",target:"_blank"},"ezBookkeeping",-1)),F[3]||(F[3]=q(" ",-1)),o("span",null,i(f))]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),t(ka,{ref_key:"confirmDialog",ref:b},null,512),t(ct,{ref_key:"snackbar",ref:x,"onUpdate:show":w},null,512)])}}}),Yp={class:"layout-wrapper"},jp={class:"auth-logo d-flex align-start gap-x-3"},Hp=["src"],Wp={class:"font-weight-medium leading-normal text-2xl"},Gp={key:0,class:"d-flex auth-img-footer"},Kp={key:1,class:"d-flex auth-img-footer"},Qp={class:"d-flex align-center justify-center w-100 pt-10"},Jp={class:"d-flex align-center justify-center h-100"},Zp={class:"text-h4 mb-2"},Xp={class:"mb-0"},ev={class:"d-flex align-center justify-center"},tv=Oe({__name:"ForgetPasswordPage",setup(v){const _=Kt(),{tt:n}=je(),s=Za(),h=`${ss()}`,d=xe("snackbar"),y=P(""),f=P(!1),b=E(()=>_.global.name.value===$t.Dark);function x(){if(!y.value){d.value?.showMessage("Email address cannot be blank");return}f.value=!0,s.requestResetPassword({email:y.value}).then(()=>{f.value=!1,d.value?.showMessage("Password reset email has been sent")}).catch(u=>{f.value=!1,u.processed||d.value?.showError(u)})}return(u,m)=>{const k=Ve("router-link"),N=Ve("language-select-button");return l(),g("div",Yp,[t(k,{to:"/"},{default:a(()=>[o("div",jp,[o("img",{alt:"logo",class:"login-page-logo",src:e(fl)},null,8,Hp),o("h1",Wp,i(e(n)("global.app.title")),1)])]),_:1}),t(Ae,{"no-gutters":"",class:"auth-wrapper"},{default:a(()=>[t(R,{cols:"12",md:"8",class:"auth-image-background d-none d-md-flex align-center justify-center position-relative"},{default:a(()=>[b.value?r("",!0):(l(),g("div",Gp,[t(wt,{class:"img-with-direction",src:"img/desktop/background.svg"})])),b.value?(l(),g("div",Kp,[t(wt,{class:"img-with-direction",src:"img/desktop/background-dark.svg"})])):r("",!0),o("div",Qp,[b.value?b.value?(l(),c(wt,{key:1,class:"img-with-direction","max-width":"600px",src:"img/desktop/people4-dark.svg"})):r("",!0):(l(),c(wt,{key:0,class:"img-with-direction","max-width":"600px",src:"img/desktop/people4.svg"}))])]),_:1}),t(R,{cols:"12",md:"4",class:"auth-card d-flex flex-column"},{default:a(()=>[o("div",Jp,[t(Me,{variant:"flat",class:"w-100 mt-0 px-4 pt-12","max-width":"500"},{default:a(()=>[t(ge,null,{default:a(()=>[o("h4",Zp,i(e(n)("Forget Password?")),1),o("p",Xp,i(e(n)("Please enter your email address used for registration and we'll send you an email with a reset password link")),1)]),_:1}),t(ge,{class:"pb-0 mb-6"},{default:a(()=>[t(jt,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(ot,{type:"email",autocomplete:"email",autofocus:!0,disabled:f.value,label:e(n)("E-mail"),placeholder:e(n)("Your email address"),modelValue:y.value,"onUpdate:modelValue":m[0]||(m[0]=V=>y.value=V),onKeyup:Gt(x,["enter"])},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(H,{block:"",type:"submit",disabled:!y.value||f.value,onClick:x},{default:a(()=>[q(i(e(n)("Send Reset Link"))+" ",1),f.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(k,{class:be(["d-flex align-center justify-center",{disabled:f.value}]),to:"/login"},{default:a(()=>[t(ie,{class:"icon-with-direction",icon:e(To)},null,8,["icon"]),o("span",null,i(e(n)("Back to login page")),1)]),_:1},8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),t(it),o("div",ev,[t(Me,{variant:"flat",class:"w-100 px-4 pb-4","max-width":"500"},{default:a(()=>[t(ge,{class:"pt-0"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",class:"text-center"},{default:a(()=>[t(N,{disabled:f.value},null,8,["disabled"])]),_:1}),t(R,{cols:"12",class:"d-flex align-center pt-0"},{default:a(()=>[t(nt)]),_:1}),t(R,{cols:"12",class:"text-center text-sm"},{default:a(()=>[m[1]||(m[1]=o("span",null,"Powered by ",-1)),m[2]||(m[2]=o("a",{href:"https://github.com/mayswind/ezbookkeeping",target:"_blank"},"ezBookkeeping",-1)),m[3]||(m[3]=q(" ",-1)),o("span",null,i(h))]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),t(ct,{ref_key:"snackbar",ref:d},null,512)])}}}),av={class:"layout-wrapper"},lv={class:"auth-logo d-flex align-start gap-x-3"},nv=["src"],ov={class:"font-weight-medium leading-normal text-2xl"},sv={key:0,class:"d-flex auth-img-footer"},iv={key:1,class:"d-flex auth-img-footer"},rv={class:"d-flex align-center justify-center w-100 pt-10"},uv={class:"d-flex align-center justify-center h-100"},dv={class:"text-h4 mb-2"},cv={class:"mb-0"},mv={class:"d-flex align-center justify-center"},pv=Oe({__name:"ResetPasswordPage",props:{token:{}},setup(v){const _=v,n=Na(),s=Kt(),{tt:h}=je(),d=Za(),y=`${ss()}`,f=xe("passwordInput"),b=xe("confirmPasswordInput"),x=xe("confirmDialog"),u=xe("snackbar"),m=P(""),k=P(""),N=P(""),V=P(!1),p=P(!1),T=E(()=>s.global.name.value===$t.Dark),A=E(()=>m.value?!k.value&&!N.value?"Nothing has been modified":!k.value&&N.value?"New password cannot be blank":k.value&&!N.value?"Password confirmation cannot be blank":k.value&&N.value&&k.value!==N.value?"Password and password confirmation do not match":null:"Email address cannot be blank");function w(F){!F&&p.value&&n.replace("/login")}function I(){p.value=!1;const F=A.value;if(F){u.value?.showMessage(F);return}V.value=!0,d.resetPassword({token:_.token,email:m.value,password:k.value}).then(()=>{V.value=!1,p.value=!0,u.value?.showMessage("Password has been updated")}).catch(S=>{V.value=!1,p.value=!1,S.processed||u.value?.showError(S)})}return(F,S)=>{const j=Ve("router-link"),B=Ve("language-select-button");return l(),g("div",av,[t(j,{to:"/"},{default:a(()=>[o("div",lv,[o("img",{alt:"logo",class:"login-page-logo",src:e(fl)},null,8,nv),o("h1",ov,i(e(h)("global.app.title")),1)])]),_:1}),t(Ae,{"no-gutters":"",class:"auth-wrapper"},{default:a(()=>[t(R,{cols:"12",md:"8",class:"auth-image-background d-none d-md-flex align-center justify-center position-relative"},{default:a(()=>[T.value?r("",!0):(l(),g("div",sv,[t(wt,{class:"img-with-direction",src:"img/desktop/background.svg"})])),T.value?(l(),g("div",iv,[t(wt,{class:"img-with-direction",src:"img/desktop/background-dark.svg"})])):r("",!0),o("div",rv,[T.value?T.value?(l(),c(wt,{key:1,class:"img-with-direction","max-width":"600px",src:"img/desktop/people4-dark.svg"})):r("",!0):(l(),c(wt,{key:0,class:"img-with-direction","max-width":"600px",src:"img/desktop/people4.svg"}))])]),_:1}),t(R,{cols:"12",md:"4",class:"auth-card d-flex flex-column"},{default:a(()=>[o("div",uv,[t(Me,{variant:"flat",class:"w-100 mt-0 px-4 pt-12","max-width":"500"},{default:a(()=>[t(ge,null,{default:a(()=>[o("h4",dv,i(e(h)("Reset Password")),1),o("p",cv,i(e(h)("Please re-enter your email address, and then enter a new password.")),1)]),_:1}),t(ge,{class:"pb-0 mb-6"},{default:a(()=>[t(jt,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(e(ot),{type:"email",autocomplete:"email",autofocus:!0,disabled:V.value,label:e(h)("E-mail"),placeholder:e(h)("Your email address"),modelValue:m.value,"onUpdate:modelValue":S[0]||(S[0]=U=>m.value=U),onKeyup:S[1]||(S[1]=Gt(U=>f.value?.focus(),["enter"]))},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(e(ot),{autocomplete:"new-password",ref_key:"passwordInput",ref:f,type:"password",disabled:V.value,label:e(h)("Password"),placeholder:e(h)("Your password"),modelValue:k.value,"onUpdate:modelValue":S[2]||(S[2]=U=>k.value=U),onKeyup:S[3]||(S[3]=Gt(U=>b.value?.focus(),["enter"]))},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(e(ot),{ref_key:"confirmPasswordInput",ref:b,type:"password",disabled:V.value,label:e(h)("Confirm Password"),placeholder:e(h)("Re-enter the password"),modelValue:N.value,"onUpdate:modelValue":S[4]||(S[4]=U=>N.value=U),onKeyup:Gt(I,["enter"])},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(H,{block:"",disabled:!m.value||!k.value||!N.value||V.value,onClick:I},{default:a(()=>[q(i(e(h)("Update Password"))+" ",1),V.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(j,{class:be(["d-flex align-center justify-center",{disabled:V.value}]),to:"/login"},{default:a(()=>[t(ie,{class:"icon-with-direction",icon:e(To)},null,8,["icon"]),o("span",null,i(e(h)("Back to login page")),1)]),_:1},8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),t(it),o("div",mv,[t(Me,{variant:"flat",class:"w-100 px-4 pb-4","max-width":"500"},{default:a(()=>[t(ge,{class:"pt-0"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",class:"text-center"},{default:a(()=>[t(B,{disabled:V.value},null,8,["disabled"])]),_:1}),t(R,{cols:"12",class:"d-flex align-center pt-0"},{default:a(()=>[t(nt)]),_:1}),t(R,{cols:"12",class:"text-center text-sm"},{default:a(()=>[S[5]||(S[5]=o("span",null,"Powered by ",-1)),S[6]||(S[6]=o("a",{href:"https://github.com/mayswind/ezbookkeeping",target:"_blank"},"ezBookkeeping",-1)),S[7]||(S[7]=q(" ",-1)),o("span",null,i(y))]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),t(ka,{ref_key:"confirmDialog",ref:x},null,512),t(ct,{ref_key:"snackbar",ref:u,"onUpdate:show":w},null,512)])}}}),vv={class:"layout-wrapper"},fv={class:"auth-logo d-flex align-start gap-x-3"},yv=["src"],gv={class:"font-weight-medium leading-normal text-2xl"},hv={key:0,class:"d-flex auth-img-footer"},bv={key:1,class:"d-flex auth-img-footer"},Tv={class:"d-flex align-center justify-center w-100 pt-10"},kv={class:"d-flex align-center justify-center h-100"},_v={class:"text-h4 mb-2"},xv={key:0,class:"mb-0"},Cv={key:1,class:"mb-0"},wv={key:2,class:"mb-0"},Av={key:3,class:"mb-0"},Sv={key:4,class:"mb-0"},Vv={class:"d-flex align-center justify-center"},Iv=Oe({__name:"OAuth2CallbackPage",props:{token:{},provider:{},platform:{},userName:{},errorCode:{},errorMessage:{}},setup(v){const _=v,n=Na(),s=Kt(),{tt:h,te:d,getLocalizedOAuth2ProviderName:y,getLocalizedOAuth2LoginText:f}=je(),b=Za(),{version:x,password:u,loggingInByOAuth2:m,doAfterLogin:k}=mi("desktop"),N=xe("snackbar"),V=P(""),p=P(!1),T=E(()=>s.global.name.value===$t.Dark),A=E(()=>y(_.provider??"",Ro())),w=E(()=>f(_.provider??"",Ro())),I=E(()=>{if(_.errorCode&&_.errorMessage)return Nu(parseInt(_.errorCode),_.errorMessage)}),F=E(()=>u.value?null:"Password cannot be blank");function S(){_.platform==="desktop"?xs("desktop"):_.platform==="mobile"?xs("mobile"):n.replace("/")}function j(){const B=F.value;if(B){N.value?.showMessage(B);return}m.value=!0,b.authorizeOAuth2({password:u.value,passcode:V.value,callbackToken:_.token||""}).then(U=>{m.value=!1,k(U),S()}).catch(U=>{if(m.value=!1,gn()&&U.error&&U.error.errorCode===Tl.UserEmailNotVerified&&U.error.context&&U.error.context.email){n.push(`/verify_email?email=${encodeURIComponent(U.error.context.email)}&emailSent=${U.error.context.hasValidEmailVerifyToken||!1}`);return}else if(U.error&&U.error.errorCode===Tl.TwoFactorAuthorizationPasscodeEmpty){p.value=!0;return}U.processed||N.value?.showError(U)})}return!I.value&&_.platform&&_.token&&!_.userName&&(m.value=!0,b.authorizeOAuth2({callbackToken:_.token}).then(B=>{m.value=!1,k(B),S()}).catch(B=>{if(m.value=!1,gn()&&B.error&&B.error.errorCode===Tl.UserEmailNotVerified&&B.error.context&&B.error.context.email){n.push(`/verify_email?email=${encodeURIComponent(B.error.context.email)}&emailSent=${B.error.context.hasValidEmailVerifyToken||!1}`);return}B.processed||N.value?.showError(B)})),(B,U)=>{const X=Ve("router-link"),oe=Ve("language-select-button");return l(),g("div",vv,[t(X,{to:"/"},{default:a(()=>[o("div",fv,[o("img",{alt:"logo",class:"login-page-logo",src:e(fl)},null,8,yv),o("h1",gv,i(e(h)("global.app.title")),1)])]),_:1}),t(Ae,{"no-gutters":"",class:"auth-wrapper"},{default:a(()=>[t(R,{cols:"12",md:"8",class:"auth-image-background d-none d-md-flex align-center justify-center position-relative"},{default:a(()=>[T.value?r("",!0):(l(),g("div",hv,[t(wt,{class:"img-with-direction",src:"img/desktop/background.svg"})])),T.value?(l(),g("div",bv,[t(wt,{class:"img-with-direction",src:"img/desktop/background-dark.svg"})])):r("",!0),o("div",Tv,[T.value?T.value?(l(),c(wt,{key:1,class:"img-with-direction","max-width":"300px",src:"img/desktop/people2-dark.svg"})):r("",!0):(l(),c(wt,{key:0,class:"img-with-direction","max-width":"300px",src:"img/desktop/people2.svg"}))])]),_:1}),t(R,{cols:"12",md:"4",class:"auth-card d-flex flex-column"},{default:a(()=>[o("div",kv,[t(Me,{variant:"flat",class:"w-100 mt-0 px-4 pt-12","max-width":"500"},{default:a(()=>[t(ge,null,{default:a(()=>[o("h4",_v,i(w.value),1),!I.value&&!v.errorMessage&&v.platform&&v.token&&!v.userName?(l(),g("p",xv,i(e(h)("Logging in...")),1)):!I.value&&!v.errorMessage&&v.userName?(l(),g("p",Cv,i(e(h)("format.misc.oauth2bindTip",{providerName:A.value,userName:v.userName})),1)):I.value?(l(),g("p",wv,i(e(d)({error:I.value})),1)):v.errorMessage?(l(),g("p",Av,i(v.errorMessage),1)):(l(),g("p",Sv,i(e(h)("An error occurred")),1))]),_:1}),!I.value&&v.userName?(l(),c(ge,{key:0,class:"pb-0 mb-6"},{default:a(()=>[t(jt,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(ot,{type:"password",autocomplete:"password",autofocus:!0,disabled:p.value||e(m),label:e(h)("Password"),placeholder:e(h)("Your password"),modelValue:e(u),"onUpdate:modelValue":U[0]||(U[0]=W=>ht(u)?u.value=W:null),onKeyup:Gt(j,["enter"])},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),za(t(R,{cols:"12"},{default:a(()=>[t(ot,{type:"number",autocomplete:"one-time-code",ref:"passcodeInput",disabled:e(m),label:e(h)("Passcode"),placeholder:e(h)("Passcode"),modelValue:V.value,"onUpdate:modelValue":U[1]||(U[1]=W=>V.value=W),onKeyup:Gt(j,["enter"])},null,8,["disabled","label","placeholder","modelValue"])]),_:1},512),[[Ka,p.value]]),t(R,{cols:"12"},{default:a(()=>[t(H,{block:"",type:"submit",disabled:!e(u)||e(m),onClick:j},{default:a(()=>[q(i(e(h)("Continue"))+" ",1),e(m)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(X,{class:be(["d-flex align-center justify-center",{disabled:e(m)}]),to:"/login"},{default:a(()=>[t(ie,{class:"icon-with-direction",icon:e(To)},null,8,["icon"]),o("span",null,i(e(h)("Back to login page")),1)]),_:1},8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})):r("",!0)]),_:1})]),t(it),o("div",Vv,[t(Me,{variant:"flat",class:"w-100 px-4 pb-4","max-width":"500"},{default:a(()=>[t(ge,{class:"pt-0"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",class:"text-center"},{default:a(()=>[t(oe,{disabled:e(m)},null,8,["disabled"])]),_:1}),t(R,{cols:"12",class:"d-flex align-center pt-0"},{default:a(()=>[t(nt)]),_:1}),t(R,{cols:"12",class:"text-center text-sm"},{default:a(()=>[U[2]||(U[2]=o("span",null,"Powered by ",-1)),U[3]||(U[3]=o("a",{href:"https://github.com/mayswind/ezbookkeeping",target:"_blank"},"ezBookkeeping",-1)),U[4]||(U[4]=q(" ",-1)),o("span",null,i(e(x)),1)]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),t(ct,{ref_key:"snackbar",ref:N},null,512)])}}}),Dv={class:"layout-wrapper"},$v={class:"auth-logo d-flex align-start gap-x-3"},Nv=["src"],Fv={class:"font-weight-medium leading-normal text-2xl"},Ev={key:0,class:"d-flex auth-img-footer"},Mv={key:1,class:"d-flex auth-img-footer"},Uv={class:"d-flex align-center justify-center w-100 pt-10"},Pv={class:"d-flex align-center justify-center h-100"},Bv={class:"text-h4 mb-2"},Lv={key:0,class:"mb-0"},zv={key:1,class:"mb-0"},Ov={class:"me-1"},Rv={class:"d-flex align-center justify-center"},qv=Oe({__name:"UnlockPage",setup(v){const _=Na(),n=Kt(),{tt:s}=je(),{version:h,pinCode:d,isWebAuthnAvailable:y,isPinCodeValid:f,doAfterUnlocked:b,doRelogin:x}=Fu(),u=Ya(),m=ta(),k=xe("confirmDialog"),N=xe("snackbar"),V=P(!1),p=E(()=>n.global.name.value===$t.Dark);function T(){const I=Eu();if(!m.currentUserBasicInfo||!I){N.value?.showMessage("An error occurred");return}if(!u.appSettings.applicationLockWebAuthn||!Mu()){N.value?.showMessage("WebAuthn is not enabled");return}if(!Uu()){N.value?.showMessage("WebAuth is not supported on this device");return}V.value=!0,Pu(m.currentUserBasicInfo,I).then(({id:F,userName:S,userSecret:j})=>{V.value=!1,Bu(F,S,j),b(),_.replace("/")}).catch(F=>{V.value=!1,Xt.error("failed to use webauthn to verify",F),F.notSupported?N.value?.showMessage("WebAuth is not supported on this device"):F.name==="NotAllowedError"?N.value?.showMessage("User has canceled authentication"):F.invalid?N.value?.showMessage("Failed to authenticate with WebAuthn"):N.value?.showMessage("User has canceled or this device does not support WebAuthn")})}function A(I){if(!f(I))return;const F=m.currentUserBasicInfo;if(!F||!F.username){N.value?.showMessage("An error occurred");return}try{Lu(F.username,I),b(),_.replace("/")}catch(S){Xt.error("failed to unlock with pin code",S),N.value?.showMessage("Incorrect PIN code")}}function w(){k.value?.open("Are you sure you want to re-login?").then(()=>{x(),_.replace("/login")})}return(I,F)=>{const S=Ve("router-link"),j=Ve("pin-code-input"),B=Ve("language-select-button");return l(),g("div",Dv,[t(S,{to:"/"},{default:a(()=>[o("div",$v,[o("img",{alt:"logo",class:"login-page-logo",src:e(fl)},null,8,Nv),o("h1",Fv,i(e(s)("global.app.title")),1)])]),_:1}),t(Ae,{"no-gutters":"",class:"auth-wrapper"},{default:a(()=>[t(R,{cols:"12",md:"8",class:"auth-image-background d-none d-md-flex align-center justify-center position-relative"},{default:a(()=>[p.value?r("",!0):(l(),g("div",Ev,[t(wt,{class:"img-with-direction",src:"img/desktop/background.svg"})])),p.value?(l(),g("div",Mv,[t(wt,{class:"img-with-direction",src:"img/desktop/background-dark.svg"})])):r("",!0),o("div",Uv,[p.value?p.value?(l(),c(wt,{key:1,class:"img-with-direction","max-width":"600px",src:"img/desktop/people3-dark.svg"})):r("",!0):(l(),c(wt,{key:0,class:"img-with-direction","max-width":"600px",src:"img/desktop/people3.svg"}))])]),_:1}),t(R,{cols:"12",md:"4",class:"auth-card d-flex flex-column"},{default:a(()=>[o("div",Pv,[t(Me,{variant:"flat",class:"w-100 mt-0 px-4 pt-12","max-width":"500"},{default:a(()=>[t(ge,null,{default:a(()=>[o("h4",Bv,i(e(s)("Unlock Application")),1),e(y)?(l(),g("p",Lv,i(e(s)("Please enter your PIN code or use WebAuthn to unlock application")),1)):e(y)?r("",!0):(l(),g("p",zv,i(e(s)("Please enter your PIN code to unlock application")),1))]),_:1}),t(ge,{class:"pb-0 mb-6"},{default:a(()=>[t(jt,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(j,{disabled:V.value,autofocus:!0,secure:!0,length:6,"auto-confirm":!0,modelValue:e(d),"onUpdate:modelValue":F[0]||(F[0]=U=>ht(d)?d.value=U:null),"onPincode:confirm":A},null,8,["disabled","modelValue"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(H,{block:"",disabled:!e(f)(e(d))||V.value,onClick:F[1]||(F[1]=U=>A(e(d)))},{default:a(()=>[q(i(e(s)("Unlock with PIN Code")),1)]),_:1},8,["disabled"])]),_:1}),e(y)?(l(),c(R,{key:0,cols:"12"},{default:a(()=>[t(H,{block:"",variant:"tonal",disabled:V.value,onClick:T},{default:a(()=>[q(i(e(s)("Unlock with WebAuthn"))+" ",1),V.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])]),_:1})):r("",!0),t(R,{cols:"12",class:"text-center"},{default:a(()=>[o("span",Ov,i(e(s)("Can't Unlock?")),1),o("a",{class:"text-primary",href:"javascript:void(0);",onClick:w},i(e(s)("Re-login")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),t(it),o("div",Rv,[t(Me,{variant:"flat",class:"w-100 px-4 pb-4","max-width":"500"},{default:a(()=>[t(ge,{class:"pt-0"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",class:"text-center"},{default:a(()=>[t(B,{disabled:V.value},null,8,["disabled"])]),_:1}),t(R,{cols:"12",class:"d-flex align-center pt-0"},{default:a(()=>[t(nt)]),_:1}),t(R,{cols:"12",class:"text-center text-sm"},{default:a(()=>[F[2]||(F[2]=o("span",null,"Powered by ",-1)),F[3]||(F[3]=o("a",{href:"https://github.com/mayswind/ezbookkeeping",target:"_blank"},"ezBookkeeping",-1)),F[4]||(F[4]=q(" ",-1)),o("span",null,i(e(h)),1)]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),t(ka,{ref_key:"confirmDialog",ref:k},null,512),t(ct,{ref_key:"snackbar",ref:N},null,512)])}}}),Yv={class:"font-weight-bold ms-3"},jv={key:0,class:"text-truncate text-h4 text-income me-2 mb-2"},Hv={key:2,class:"text-truncate text-h5 text-expense"},Wv={key:4,class:"text-truncate text-h5 mt-2 mb-7",style:{"padding-bottom":"2px"}},Gv={class:"text-caption"},io=Oe({__name:"IncomeExpenseOverviewCard",props:{loading:{type:Boolean},disabled:{type:Boolean},icon:{},title:{},expenseAmount:{},incomeAmount:{},datetime:{}},setup(v){const{tt:_}=je();return(n,s)=>(l(),c(Me,{class:be({disabled:v.disabled})},{default:a(()=>[t(ge,{class:"d-flex align-center"},{default:a(()=>[t(ol,{color:"grey",size:"38"},{default:a(()=>[t(ie,{size:"24",icon:v.icon},null,8,["icon"])]),_:1}),o("span",Yv,i(v.title),1),t(it),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",icon:!0},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[pn(n.$slots,"menus")]),_:3})]),_:3})]),_:3})]),_:3}),t(ge,{class:"mt-1 pb-1"},{default:a(()=>[!v.loading||v.incomeAmount?(l(),g("div",jv,i(v.incomeAmount),1)):v.loading&&!v.incomeAmount?(l(),c(ft,{key:1,class:"skeleton-no-margin mt-4 mb-8",type:"text",width:"120px",loading:!0})):r("",!0),!v.loading||v.expenseAmount?(l(),g("div",Hv,i(v.expenseAmount),1)):v.loading&&!v.expenseAmount?(l(),c(ft,{key:3,class:"skeleton-no-margin mb-1",style:{"padding-bottom":"2px"},type:"text",width:"120px",loading:!0})):r("",!0),!v.loading&&!v.incomeAmount&&!v.expenseAmount?(l(),g("div",Wv,i(e(_)("No data")),1)):r("",!0)]),_:1}),t(ge,{class:"mt-6"},{default:a(()=>[o("span",Gv,i(v.datetime),1)]),_:1})]),_:3},8,["class"]))}}),Kv={class:"overview-monthly-chart-skeleton-container h-100",style:{"margin-top":"-30px"}},Qv={class:"d-flex flex-column align-center justify-center w-100 h-100"},Jv={style:{"margin-top":"-40px"}},Zv=Oe({__name:"MonthlyIncomeAndExpenseCard",props:{loading:{type:Boolean},data:{},disabled:{type:Boolean},isDarkMode:{type:Boolean},enableClickItem:{type:Boolean}},emits:["click"],setup(v,{emit:_}){const n=v,s=_,{tt:h,getCurrentLanguageTextDirection:d,formatDateTimeToGregorianLikeShortMonth:y,formatAmountToLocalizedNumeralsWithCurrency:f}=je(),b=Ya(),x=ta(),u=E(()=>d()),m=E(()=>b.appSettings.showAmountInHomePage),k=E(()=>x.currentUserDefaultCurrency),N=E(()=>{if(!n.data||!n.data.length||n.data.length<1)return!1;for(const F of n.data)if(F.incomeAmount>0||F.incomeAmount<0||F.expenseAmount>0||F.expenseAmount<0)return!0;return!1}),V=E(()=>{const F=[],S=[],j=[];let B=0,U=0;const X=is(x.currentUserExpenseAmountColor,x.currentUserIncomeAmountColor,n.isDarkMode);if(n.data)for(const W of n.data){const D=Ia(W.monthStartTime),$=y(D);F.push($),S.push(W.incomeAmount),j.push(-W.expenseAmount),W.incomeAmount>U&&(U=W.incomeAmount),-W.expenseAmount>U&&(U=-W.expenseAmount),W.incomeAmount<B&&(B=W.incomeAmount),-W.expenseAmount<B&&(B=-W.expenseAmount)}const oe=U-B;return{tooltip:{trigger:"axis",axisPointer:{type:"shadow",shadowStyle:{color:n.isDarkMode?"rgba(210, 210, 210, 0.05)":"rgba(120, 120, 120, 0.05)"}},backgroundColor:n.isDarkMode?"#333":"#fff",borderColor:n.isDarkMode?"#333":"#fff",textStyle:{color:n.isDarkMode?"#eee":"#333"},formatter:W=>{let D=null,$=null;for(const C of W){const M=C.dataIndex,ee=n.data[M];C.seriesId==="seriesIncome"?D=A(ee):C.seriesId==="seriesExpense"&&($=w(ee))}return`<table><thead><tr><td colspan="2" class="text-start">${W[0]?.name}</td></tr></thead><tbody>`+(D!==null?`<tr><td><span class="overview-monthly-chart-tooltip-indicator bg-income me-1"></span><span class="me-4">${h("Income")}</span></td><td><strong>${D}</strong></td></tr>`:"")+($!==null?`<tr><td><span class="overview-monthly-chart-tooltip-indicator bg-expense me-1"></span><span class="me-4">${h("Expense")}</span></td><td><strong>${$}</strong></td></tr>`:"")+"</tbody></table>"}},legend:{bottom:20,itemWidth:14,itemHeight:14,textStyle:{color:n.isDarkMode?"#eee":"#333"},icon:"circle",data:[h("Income"),h("Expense")]},grid:{left:"20px",right:"20px",top:"10px",bottom:"100px"},xAxis:[{type:"category",data:F,inverse:u.value===Tn.RTL,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{padding:[20,0,0,0]}}],yAxis:[{type:"value",min:B-oe/20,max:U,splitNumber:10,axisLabel:{show:!1},splitLine:{show:!1}},{type:"value",min:B,max:U+oe/20,splitNumber:10,axisLabel:{show:!1},splitLine:{show:!1}}],series:[{type:"bar",id:"seriesIncome",name:h("Income"),yAxisIndex:0,stack:"Total",itemStyle:{color:X.incomeAmountColor,borderRadius:16},emphasis:{focus:"series",labelLine:{show:!1}},barMaxWidth:16,data:S},{type:"bar",id:"seriesExpense",name:h("Expense"),yAxisIndex:1,stack:"Total",itemStyle:{color:X.expenseAmountColor,borderRadius:16},emphasis:{focus:"series",labelLine:{show:!1}},barMaxWidth:16,data:j}]}});function p(F,S){return f(F,S)}function T(F,S){return m.value?p(F,k.value)+(S?Ou:""):p(zu,k.value)}function A(F){return T(F.incomeAmount,F.incompleteIncomeAmount)}function w(F){return T(F.expenseAmount,F.incompleteExpenseAmount)}function I(F){if(!n.enableClickItem||!n.data||F.componentType!=="series")return;const S=n.data[F.dataIndex];S&&F.seriesId==="seriesIncome"?s("click",{transactionType:pe.Income,monthStartTime:S.monthStartTime}):S&&F.seriesId==="seriesExpense"&&s("click",{transactionType:pe.Expense,monthStartTime:S.monthStartTime})}return(F,S)=>{const j=Ve("v-chart");return l(),c(Me,{class:be({disabled:v.disabled})},{title:a(()=>[o("span",null,i(e(h)("Income and Expense Trends")),1)]),default:a(()=>[v.loading&&!N.value?(l(),c(ge,{key:0,class:"overview-monthly-chart-container overview-monthly-chart-overlay"},{default:a(()=>[o("div",Kv,[(l(),g(fe,null,$e([1,2,3,4,5,6,7,8,9,10,11,12],B=>o("div",{class:"d-flex w-100 h-100 align-center justify-center",key:B},[t(ft,{width:"16",height:"200",loading:!0})])),64))])]),_:1})):!v.loading&&!N.value?(l(),c(ge,{key:1,class:"overview-monthly-chart-container overview-monthly-chart-overlay"},{default:a(()=>[o("div",Qv,[o("h2",Jv,i(e(h)("No data")),1)])]),_:1})):r("",!0),t(j,{autoresize:"",class:be(["overview-monthly-chart-container",{readonly:!N.value}]),option:V.value,onClick:I},null,8,["class","option"])]),_:1},8,["class"])}}}),Xv={class:"d-flex align-center"},ef={class:"d-flex align-baseline"},tf={class:"text-2xl font-weight-bold"},af={style:{"font-size":"1rem"}},lf={class:"text-2xl font-weight-medium text-primary"},nf={key:0},of={class:"mt-1 mb-3"},sf={class:"me-2"},rf={key:0},uf={class:"mb-8"},df={key:0,class:"text-body-1"},cf={class:"d-flex align-center"},mf={class:"me-3"},pf={class:"d-flex flex-column"},vf={class:"text-caption"},ff={key:0,class:"text-h5"},yf={class:"d-flex align-center"},gf={class:"me-3"},hf={class:"d-flex flex-column"},bf={class:"text-caption"},Tf={key:0,class:"text-h5"},kf={class:"d-flex align-center"},_f={class:"me-3"},xf={class:"d-flex flex-column"},Cf={class:"text-caption"},wf={key:0,class:"text-h5"},Af=Oe({__name:"HomePage",setup(v){const _=Na(),n=Kt(),{tt:s,getCurrentNumeralSystemType:h}=je(),{showAmountInHomePage:d,allAccounts:y,netAssets:f,totalAssets:b,totalLiabilities:x,displayDateRange:u,transactionOverview:m,getDisplayIncomeAmount:k,getDisplayExpenseAmount:N}=Ru(),V=pa(),p=va(),T=vi(),A=xe("snackbar"),w=P(!0),I=E(()=>n.global.name.value===$t.Dark),F=E(()=>h()),S=E(()=>y.value?F.value.formatNumber(y.value.length):F.value.digitZero);function j(X){const oe=X.monthStartTime,W=qu(Yu(oe,1,"months"),1,"seconds"),D=X.transactionType;_.push(`/transaction/list?${T.getTransactionListPageParams({type:D,dateType:Lt.Custom.type,minTime:oe,maxTime:W})}`)}const B=E(()=>{const X=[];if(!m.value||!m.value.thisMonth||!m.value.thisMonth.valid)return X;for(const oe of ju){const W=T.transactionDataRange[oe];if(!W)continue;const D=m.value[oe];X.push({monthStartTime:W.startTime,incomeAmount:D?.incomeAmount||0,expenseAmount:D?.expenseAmount||0,incompleteIncomeAmount:D?D.incompleteIncomeAmount:!0,incompleteExpenseAmount:D?D.incompleteExpenseAmount:!0})}return X});function U(X){w.value=!0;const oe=[V.loadAllAccounts({force:!1}),p.loadAllCategories({force:!1}),T.loadTransactionOverview({force:X,loadLast11Months:!0})];Promise.all(oe).then(()=>{w.value=!1,X&&A.value?.showMessage("Data has been updated")}).catch(W=>{w.value=!1,W.processed||A.value?.showError(W)})}return xl()&&qn()&&U(!1),(X,oe)=>(l(),g(fe,null,[t(Ae,{class:"match-height"},{default:a(()=>[t(R,{cols:"12",lg:"4",md:"12"},{default:a(()=>[t(Me,{class:be({disabled:w.value})},{title:a(()=>[o("div",Xv,[o("div",ef,[o("span",tf,i(e(u)?.thisMonth?.displayTime),1),oe[2]||(oe[2]=o("span",null,"·",-1)),o("span",af,i(e(s)("Expense")),1)]),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,loading:w.value,onClick:oe[0]||(oe[0]=W=>U(!0))},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(s)("Refresh")),1)]),_:1})]),_:1},8,["loading"])])]),default:a(()=>[t(ge,null,{default:a(()=>[o("h4",lf,[!w.value||e(m)&&e(m).thisMonth&&e(m).thisMonth.valid?(l(),g("span",nf,i(e(m)&&e(m).thisMonth?e(N)(e(m).thisMonth):"-"),1)):w.value&&(!e(m)||!e(m).thisMonth||!e(m).thisMonth.valid)?(l(),c(ft,{key:1,class:"d-inline-block skeleton-no-margin mt-3 pb-1",width:"120px",type:"text",loading:!0})):r("",!0),t(H,{class:"ms-1",density:"compact",color:"default",variant:"text",icon:!0,onClick:oe[1]||(oe[1]=W=>d.value=!e(d))},{default:a(()=>[t(ie,{icon:e(d)?e(da):e(Ma),size:"20"},null,8,["icon"])]),_:1})]),o("div",of,[o("span",sf,i(e(s)("Monthly income")),1),!w.value||e(m)&&e(m).thisMonth&&e(m).thisMonth.valid?(l(),g("span",rf,i(e(m)&&e(m).thisMonth?e(k)(e(m).thisMonth):"-"),1)):w.value&&(!e(m)||!e(m).thisMonth||!e(m).thisMonth.valid)?(l(),c(ft,{key:1,class:"d-inline-block skeleton-no-margin mt-2",width:"120px",type:"text",loading:!0})):r("",!0)]),t(H,{size:"small",to:`/transaction/list?${e(T).getTransactionListPageParams({dateType:e(Lt).ThisMonth.type})}`},{default:a(()=>[q(i(e(s)("View Details")),1)]),_:1},8,["to"]),t(wt,{class:"overview-card-background img-with-direction",src:"img/desktop/card-background.png"}),t(wt,{class:"overview-card-background-image img-with-direction",width:"116px",src:"img/desktop/document.svg"})]),_:1})]),_:1},8,["class"])]),_:1}),t(R,{cols:"12",lg:"8",md:"12"},{default:a(()=>[t(Me,{class:be({disabled:w.value})},{title:a(()=>[o("span",null,i(e(s)("Asset Summary")),1)]),default:a(()=>[t(ge,null,{default:a(()=>[o("div",uf,[!w.value||e(y)&&e(y).length?(l(),g("span",df,i(e(s)("format.misc.youHaveAccounts",{count:S.value})),1)):w.value&&(!e(y)||!e(y).length)?(l(),c(ft,{key:1,class:"skeleton-no-margin mt-1 mb-2 pb-1",width:"200px",type:"text",loading:!0})):r("",!0)]),t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"4"},{default:a(()=>[o("div",cf,[o("div",mf,[t(ol,{rounded:"",color:"grey",size:"42",class:"elevation-1"},{default:a(()=>[t(ie,{size:"24",icon:e(cr)},null,8,["icon"])]),_:1})]),o("div",pf,[o("span",vf,i(e(s)("Total assets")),1),!w.value||e(y)&&e(y).length?(l(),g("span",ff,i(e(b)),1)):w.value&&(!e(y)||!e(y).length)?(l(),c(ft,{key:1,class:"skeleton-no-margin mt-3 mb-2",width:"120px",type:"text",loading:!0})):r("",!0)])])]),_:1}),t(R,{cols:"12",md:"4"},{default:a(()=>[o("div",yf,[o("div",gf,[t(ol,{rounded:"",color:"expense",size:"42",class:"elevation-1"},{default:a(()=>[t(ie,{size:"24",icon:e(Qo)},null,8,["icon"])]),_:1})]),o("div",hf,[o("span",bf,i(e(s)("Total liabilities")),1),!w.value||e(y)&&e(y).length?(l(),g("span",Tf,i(e(x)),1)):w.value&&(!e(y)||!e(y).length)?(l(),c(ft,{key:1,class:"skeleton-no-margin mt-3 mb-2",width:"120px",type:"text",loading:!0})):r("",!0)])])]),_:1}),t(R,{cols:"12",md:"4"},{default:a(()=>[o("div",kf,[o("div",_f,[t(ol,{rounded:"",color:"primary",size:"42",class:"elevation-1"},{default:a(()=>[t(ie,{size:"24",icon:e(mr)},null,8,["icon"])]),_:1})]),o("div",xf,[o("span",Cf,i(e(s)("Net assets")),1),!w.value||e(y)&&e(y).length?(l(),g("span",wf,i(e(f)),1)):w.value&&(!e(y)||!e(y).length)?(l(),c(ft,{key:1,class:"skeleton-no-margin mt-3 mb-2",width:"120px",type:"text",loading:!0})):r("",!0)])])]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(io,{loading:w.value,disabled:w.value,icon:e(Qs),title:e(s)("Today"),"expense-amount":e(m).today&&e(m).today.valid?e(N)(e(m).today):"","income-amount":e(m).today&&e(m).today.valid?e(k)(e(m).today):"",datetime:e(u)?.today?.displayTime||""},{menus:a(()=>[t(ve,{"prepend-icon":e(bl),to:`/transaction/list?${e(T).getTransactionListPageParams({dateType:e(Lt).Today.type})}`},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(s)("View Details")),1)]),_:1})]),_:1},8,["prepend-icon","to"])]),_:1},8,["loading","disabled","icon","title","expense-amount","income-amount","datetime"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(io,{loading:w.value,disabled:w.value,icon:e(pr),title:e(s)("This Week"),"expense-amount":e(m).thisWeek&&e(m).thisWeek.valid?e(N)(e(m).thisWeek):"","income-amount":e(m).thisWeek&&e(m).thisWeek.valid?e(k)(e(m).thisWeek):"",datetime:e(u)?.thisWeek?.startTime+"-"+e(u)?.thisWeek?.endTime},{menus:a(()=>[t(ve,{"prepend-icon":e(bl),to:`/transaction/list?${e(T).getTransactionListPageParams({dateType:e(Lt).ThisWeek.type})}`},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(s)("View Details")),1)]),_:1})]),_:1},8,["prepend-icon","to"])]),_:1},8,["loading","disabled","icon","title","expense-amount","income-amount","datetime"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(io,{loading:w.value,disabled:w.value,icon:e(Js),title:e(s)("This Month"),"expense-amount":e(m).thisMonth&&e(m).thisMonth.valid?e(N)(e(m).thisMonth):"","income-amount":e(m).thisMonth&&e(m).thisMonth.valid?e(k)(e(m).thisMonth):"",datetime:e(u)?.thisMonth?.startTime+"-"+e(u)?.thisMonth?.endTime},{menus:a(()=>[t(ve,{"prepend-icon":e(bl),to:`/transaction/list?${e(T).getTransactionListPageParams({dateType:e(Lt).ThisMonth.type})}`},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(s)("View Details")),1)]),_:1})]),_:1},8,["prepend-icon","to"])]),_:1},8,["loading","disabled","icon","title","expense-amount","income-amount","datetime"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(io,{loading:w.value,disabled:w.value,icon:e(uo),title:e(s)("This Year"),"expense-amount":e(m).thisYear&&e(m).thisYear.valid?e(N)(e(m).thisYear):"","income-amount":e(m).thisYear&&e(m).thisYear.valid?e(k)(e(m).thisYear):"",datetime:e(u)?.thisYear?.displayTime||""},{menus:a(()=>[t(ve,{"prepend-icon":e(bl),to:`/transaction/list?${e(T).getTransactionListPageParams({dateType:e(Lt).ThisYear.type})}`},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(s)("View Details")),1)]),_:1})]),_:1},8,["prepend-icon","to"])]),_:1},8,["loading","disabled","icon","title","expense-amount","income-amount","datetime"])]),_:1})]),_:1})]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Zv,{data:B.value,"is-dark-mode":I.value,loading:w.value,disabled:w.value,"enable-click-item":!0,onClick:j},null,8,["data","is-dark-mode","loading","disabled"])]),_:1})]),_:1}),t(ct,{ref_key:"snackbar",ref:A},null,512)],64))}}),jn=Oe({__name:"PaginationButtons",props:{density:{},disabled:{type:Boolean},totalPageCount:{},totalVisible:{},modelValue:{}},emits:["update:modelValue"],setup(v,{emit:_}){const n=v,s=_,{tt:h,getCurrentNumeralSystemType:d}=je(),y=P({}),f=E(()=>d());function b(m){return f.value.replaceWesternArabicDigitsToLocalizedDigits(m.toString())}const x=E(()=>{const m=[];for(let k=1;k<=n.totalPageCount;k++)m.push({value:k,name:b(k)});return m}),u=E({get:()=>n.modelValue,set:m=>{if(m&&m>=1&&m<=n.totalPageCount){s("update:modelValue",m);for(const k of El(y.value))y.value[k]=!1}}});return(m,k)=>(l(),c(Zs,{density:v.density,disabled:v.disabled,"total-visible":v.totalVisible??7,length:v.totalPageCount,modelValue:u.value,"onUpdate:modelValue":k[1]||(k[1]=N=>u.value=N)},{item:a(({key:N,page:V,isActive:p})=>[V!=="..."?(l(),c(H,{key:0,variant:"text",density:v.density,disabled:v.disabled,icon:!0,color:p?"primary":"default",onClick:T=>u.value=parseInt(V)},{default:a(()=>[o("span",null,i(b(V)),1)]),_:2},1032,["density","disabled","color","onClick"])):r("",!0),V==="..."?(l(),c(H,{key:1,variant:"text",color:"default",density:v.density,disabled:v.disabled,icon:!0},{default:a(()=>[o("span",null,i(V),1),t(mt,{activator:"parent",disabled:v.disabled,"close-on-content-click":!1,modelValue:y.value[N],"onUpdate:modelValue":T=>y.value[N]=T},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{class:"text-sm",density:v.density},{default:a(()=>[t(rt,{class:"cursor-pointer"},{default:a(()=>[t(ua,{width:"100","item-title":"name","item-value":"value","auto-select-first":"exact",density:v.density,items:x.value,"no-data-text":e(h)("No results"),modelValue:u.value,"onUpdate:modelValue":k[0]||(k[0]=T=>u.value=T)},null,8,["density","items","no-data-text","modelValue"])]),_:1})]),_:1},8,["density"])]),_:1})]),_:1},8,["disabled","modelValue","onUpdate:modelValue"])]),_:2},1032,["density","disabled"])):r("",!0)]),_:1},8,["density","disabled","total-visible","length","modelValue"]))}}),Sf={class:"d-flex align-center justify-center"},Vf={class:"d-flex align-center"},If={class:"text-h4"},Df={class:"d-flex align-center"},$f={class:"mb-4"},Nf={key:0,class:"text-truncate"},Ff={key:0,class:"cursor-pointer"},Ef={key:1,class:"cursor-pointer"},Mf={class:"d-flex align-center"},Uf={class:"d-flex align-center"},Pf={key:0,class:"text-subtitle-1"},Bf={key:1,class:"text-subtitle-1"},Lf={class:"text-body-1"},zf={class:"d-flex align-center justify-center fill-height bg-light-primary"},Of={class:"d-flex align-center justify-center fill-height bg-light-primary"},Rf={class:"text-body-1"},qf={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},Yf=["accept"],vs=Oe({__name:"EditDialog",props:{type:{},persistent:{type:Boolean},show:{type:Boolean}},setup(v,{expose:_}){const n=v,{tt:s}=je(),{mode:h,isSupportGeoLocation:d,editId:y,addByTemplateId:f,duplicateFromId:b,clientSessionId:x,loading:u,submitting:m,uploadingPicture:k,geoLocationStatus:N,setGeoLocationByClickMap:V,transaction:p,defaultCurrency:T,defaultAccountId:A,coordinateDisplayType:w,allTimezones:I,allVisibleAccounts:F,allAccountsMap:S,allVisibleCategorizedAccounts:j,allCategories:B,allCategoriesMap:U,allTags:X,allTagsMap:oe,firstVisibleAccountId:W,hasVisibleExpenseCategories:D,hasVisibleIncomeCategories:$,hasVisibleTransferCategories:C,canAddTransactionPicture:M,title:ee,saveButtonTitle:ye,cancelButtonTitle:L,sourceAmountName:Y,sourceAmountTitle:O,sourceAccountTitle:J,transferInAmountTitle:ae,sourceAccountName:Z,destinationAccountName:le,sourceAccountCurrency:z,destinationAccountCurrency:se,transactionDisplayTimezone:ue,transactionTimezoneTimeDifference:Ee,geoLocationStatusInfo:me,inputEmptyProblemMessage:te,inputIsEmpty:Se,createNewTransactionModel:Te,updateTransactionTime:Ye,updateTransactionTimezone:He,swapTransactionData:It,getTransactionPictureUrl:la}=Hu(n.type),Ot=Ya(),ze=ta(),ke=pa(),Ie=va(),Et=rl(),yt=en(),Ne=rs(),kt=xe("map"),Be=xe("confirmDialog"),Ke=xe("snackbar"),Fe=xe("pictureInput"),De=P(!1),Ue=P("basicInfo"),Pe=P(!1),ut=P(!1),we=P(!1),Dt=P(""),bt=P(""),St=P(void 0),_a=P(void 0),Vt=P(void 0),Qt=P(void 0);let Rt=null,Ct=null;const fa=E(()=>{if(p.value.type===pe.Expense)return"expense";if(p.value.type===pe.Income)return"income";if(p.value.type===pe.Transfer)return"primary"}),xa=E(()=>{const G=Dt.value.toLowerCase();let K=0;for(const Re of X.value)if(!G||Re.name.toLowerCase().indexOf(G)>=0){if(!Re.hidden)return!1;K++}return K>0}),ia=E(()=>h.value===tt.Add?yt.isTransactionDraftModified(p.value,St.value,_a.value,Vt.value,Qt.value,W.value):h.value===tt.Edit);function aa(G,K,Re){Wu(p.value,G,B.value,U.value,F.value,S.value,oe.value,A.value,{time:K.time,type:K.type,categoryId:K.categoryId,accountId:K.accountId,destinationAccountId:K.destinationAccountId,amount:K.amount,destinationAmount:K.destinationAmount,tagIds:K.tagIds,comment:K.comment},Re)}function Xa(G){f.value=null,b.value=null,De.value=!0,Ue.value="basicInfo",u.value=!0,m.value=!1,N.value=null,V.value=!1,Pe.value=!1,ut.value=G.noTransactionDraft||!1,St.value=G.amount,_a.value=G.categoryId,Vt.value=G.accountId,Qt.value=G.tagIds;const K=Te(G.type);aa(K,G,!0);const Re=[ke.loadAllAccounts({force:!1}),Ie.loadAllCategories({force:!1}),Et.loadAllTags({force:!1})];if(n.type===Mt.Transaction)G&&G.id?(G.currentTransaction&&aa(G.currentTransaction,G,!0),h.value=tt.View,y.value=G.id,Re.push(yt.getTransaction({transactionId:y.value}))):(h.value=tt.Add,y.value=null,G.template?(aa(G.template,G,!1),f.value=G.template.id):!G.noTransactionDraft&&(Ot.appSettings.autoSaveTransactionDraft==="enabled"||Ot.appSettings.autoSaveTransactionDraft==="confirmation")&&yt.transactionDraft&&aa(qo.ofDraft(yt.transactionDraft),G,!1),Ot.appSettings.autoGetCurrentGeoLocation&&!N.value&&!p.value.geoLocation&&Pa(!1));else if(n.type===Mt.Template){const at=yl.createNewTransactionTemplate(p.value);at.name="",G&&G.templateType&&(at.templateType=G.templateType),at.templateType===Da.Schedule.type&&(at.scheduledFrequencyType=hl.Disabled.type,at.scheduledFrequency=""),p.value=at,G&&G.id?(G.currentTemplate&&(aa(G.currentTemplate,G,!1),p.value.fillFrom(G.currentTemplate)),h.value=tt.Edit,y.value=G.id,p.value.id=G.id,Re.push(Ne.getTemplate({templateId:y.value}))):(h.value=tt.Add,y.value=null,p.value.id="")}return G.type&&G.type>=pe.Income&&G.type<=pe.Transfer&&(p.value.type=G.type),h.value===tt.Add&&(x.value=_l()),Promise.all(Re).then(function(at){if(y.value&&!at[3]){Ct&&(n.type===Mt.Transaction?Ct("Unable to retrieve transaction"):n.type===Mt.Template&&Ct("Unable to retrieve template"));return}if(n.type===Mt.Transaction&&G&&G.id&&at[3]&&at[3]instanceof qo){const gt=at[3];aa(gt,G,!0),Pe.value=gt.editable}else if(n.type===Mt.Template&&G&&G.id&&at[3]&&at[3]instanceof yl){const gt=at[3];aa(gt,G,!1),p.value instanceof yl||(p.value=yl.createNewTransactionTemplate(p.value)),p.value.fillFrom(gt)}else aa(null,G,!0);u.value=!1}).catch(at=>{Xt.error("failed to load essential data for editing transaction",at),u.value=!1,De.value=!1,at.processed||Ct&&Ct(at)}),new Promise((at,gt)=>{Rt=at,Ct=gt})}function ul(){const G=te.value;if(G){Ke.value?.showMessage(G);return}if(n.type===Mt.Transaction&&(h.value===tt.Add||h.value===tt.Edit)){const K=function(){m.value=!0,yt.saveTransaction({transaction:p.value,defaultCurrency:T.value,isEdit:h.value===tt.Edit,clientSessionId:x.value}).then(()=>{m.value=!1,Rt&&(h.value===tt.Add?Rt({message:"You have added a new transaction"}):h.value===tt.Edit&&Rt({message:"You have saved this transaction"})),h.value===tt.Add&&!ut.value&&!f.value&&!b.value&&yt.clearTransactionDraft(),De.value=!1}).catch(Re=>{m.value=!1,Re.error&&(Re.error.errorCode===Tl.TransactionCannotCreateInThisTime||Re.error.errorCode===Tl.TransactionCannotModifyInThisTime)?Be.value?.open("You have set this time range to prevent editing transactions. Would you like to change the editable transaction range to All?").then(()=>{m.value=!0,ze.updateUserTransactionEditScope({transactionEditScope:Gu.All.type}).then(()=>{m.value=!1,Ke.value?.showMessage("Your editable transaction range has been set to All")}).catch(at=>{m.value=!1,at.processed||Ke.value?.showError(at)})}):Re.processed||Ke.value?.showError(Re)})};p.value.sourceAmount===0?Be.value?.open("Are you sure you want to save this transaction with a zero amount?").then(()=>{K()}):K()}else n.type===Mt.Template&&(h.value===tt.Add||h.value===tt.Edit)&&(m.value=!0,Ne.saveTemplateContent({template:p.value,isEdit:h.value===tt.Edit,clientSessionId:x.value}).then(()=>{m.value=!1,Rt&&(h.value===tt.Add?Rt({message:"You have added a new template"}):h.value===tt.Edit&&Rt({message:"You have saved this template"})),De.value=!1}).catch(K=>{m.value=!1,K.processed||Ke.value?.showError(K)}))}function Ua(G,K){n.type!==Mt.Transaction||h.value!==tt.View||(y.value=null,b.value=p.value.id,x.value=_l(),Ue.value="basicInfo",p.value.id="",G||(p.value.time=Bn(),p.value.timeZone=Ot.appSettings.timeZone,p.value.utcOffset=Ln(p.value.time,p.value.timeZone)),K||p.value.removeGeoLocation(),p.value.clearPictures(),h.value=tt.Add)}function ja(){n.type!==Mt.Transaction||h.value!==tt.View||(h.value=tt.Edit)}function ya(){n.type!==Mt.Transaction||h.value!==tt.View||Be.value?.open("Are you sure you want to delete this transaction?").then(()=>{m.value=!0,yt.deleteTransaction({transaction:p.value,defaultCurrency:T.value}).then(()=>{Rt&&Rt(),m.value=!1,De.value=!1}).catch(G=>{m.value=!1,G.processed||Ke.value?.showError(G)})})}function Cl(){const G=function(){Ct&&Ct(),De.value=!1};if(n.type!==Mt.Transaction||h.value!==tt.Add||ut.value||f.value||b.value){G();return}Ot.appSettings.autoSaveTransactionDraft==="confirmation"?yt.isTransactionDraftModified(p.value,St.value,_a.value,Vt.value,Qt.value,W.value)?Be.value?.open("Do you want to save this transaction draft?").then(()=>{yt.saveTransactionDraft(p.value,St.value,_a.value,Vt.value,Qt.value,W.value),G()}).catch(()=>{yt.clearTransactionDraft(),G()}):(yt.clearTransactionDraft(),G()):(Ot.appSettings.autoSaveTransactionDraft==="enabled"&&yt.saveTransactionDraft(p.value,St.value,_a.value,Vt.value,Qt.value,W.value),G())}function Pa(G){if(we.value=!1,!d){Xt.warn("this browser does not support geo location"),G&&Ke.value?.showMessage("Unable to retrieve current position");return}navigator.geolocation.getCurrentPosition(function(K){if(!K||!K.coords){Xt.error("current position is null"),N.value=Xn.Error,G&&Ke.value?.showMessage("Unable to retrieve current position");return}N.value=Xn.Success,p.value.setLatitudeAndLongitude(K.coords.latitude,K.coords.longitude)},function(K){Xt.error("cannot retrieve current position",K),N.value=Xn.Error,G&&Ke.value?.showMessage("Unable to retrieve current position")}),N.value=Xn.Getting}function el(G){Ao()&&V.value&&(p.value.setLatitudeAndLongitude(G.latitude,G.longitude),kt.value?.setMarkerPosition(p.value.geoLocation))}function Ha(){we.value=!1,N.value=null,p.value.removeGeoLocation()}function dl(G){m.value=!0,Et.saveTag({tag:vo.createNewTag(G)}).then(K=>{m.value=!1,K&&K.id&&p.value.tagIds.push(K.id)}).catch(K=>{m.value=!1,K.processed||Ke.value?.showError(K)})}function cl(){!M.value||m.value||Fe.value?.click()}function ml(G){if(!G||!G.target)return;const K=G.target;if(!K.files||!K.files.length||!K.files[0])return;const Re=K.files[0];K.value="",k.value=!0,m.value=!0,yt.uploadTransactionPicture({pictureFile:Re}).then(at=>{p.value.addPicture(at),k.value=!1,m.value=!1}).catch(at=>{k.value=!1,m.value=!1,at.processed||Ke.value?.showError(at)})}function wl(G){if(h.value!==tt.Add&&h.value!==tt.Edit){window.open(la(G),"_blank");return}Be.value?.open("Are you sure you want to remove this transaction picture?").then(()=>{bt.value=G.pictureId,m.value=!0,yt.removeUnusedTransactionPicture({pictureInfo:G}).then(K=>{K&&p.value.removePicture(G),bt.value="",m.value=!1}).catch(K=>{K.error&&K.error.errorCode===Tl.TransactionPictureNotFound?p.value.removePicture(G):K.processed||Ke.value?.showError(K),bt.value="",m.value=!1})})}function Al(G){Ke.value?.showError(G)}return Ft(Ue,G=>{G==="map"&&ha(()=>{kt.value?.initMapView()})}),_({open:Xa}),(G,K)=>{const Re=Ve("amount-input"),at=Ve("two-column-select"),gt=Ve("date-time-select"),Wa=Ve("schedule-frequency-select"),Fa=Ve("date-select");return l(),g(fe,null,[t(xt,{width:"1000",persistent:ia.value,modelValue:De.value,"onUpdate:modelValue":K[32]||(K[32]=We=>De.value=We)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",Sf,[o("div",Vf,[o("h4",If,i(e(s)(e(ee))),1),e(u)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),t(it),e(h)!==e(tt).View&&(Ue.value==="basicInfo"||Ue.value==="map"&&e(Ao)())?(l(),c(H,{key:0,density:"comfortable",color:"default",variant:"text",class:"ms-2",icon:!0,disabled:e(u)||e(m)},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[Ue.value==="basicInfo"?(l(),c(Je,{key:0},{default:a(()=>[e(p).type===e(pe).Transfer?(l(),c(ve,{key:0,"prepend-icon":e(Dn),title:e(s)("Swap Account"),onClick:K[0]||(K[0]=We=>e(It)(!0,!1))},null,8,["prepend-icon","title"])):r("",!0),e(p).type===e(pe).Transfer?(l(),c(ve,{key:1,"prepend-icon":e(Dn),title:e(s)("Swap Amount"),onClick:K[1]||(K[1]=We=>e(It)(!1,!0))},null,8,["prepend-icon","title"])):r("",!0),e(p).type===e(pe).Transfer?(l(),c(ve,{key:2,"prepend-icon":e(Dn),title:e(s)("Swap Account and Amount"),onClick:K[2]||(K[2]=We=>e(It)(!0,!0))},null,8,["prepend-icon","title"])):r("",!0),e(p).type===e(pe).Transfer?(l(),c(nt,{key:3})):r("",!0),e(p).hideAmount?(l(),c(ve,{key:4,"prepend-icon":e(Ma),title:e(s)("Show Amount"),onClick:K[3]||(K[3]=We=>e(p).hideAmount=!1)},null,8,["prepend-icon","title"])):r("",!0),e(p).hideAmount?r("",!0):(l(),c(ve,{key:5,"prepend-icon":e(da),title:e(s)("Hide Amount"),onClick:K[4]||(K[4]=We=>e(p).hideAmount=!0)},null,8,["prepend-icon","title"]))]),_:1})):r("",!0),Ue.value==="map"?(l(),c(Je,{key:1},{default:a(()=>[e(Ao)()?(l(),c(ve,{key:"setGeoLocationByClickMap",value:"setGeoLocationByClickMap","prepend-icon":e(gr),disabled:!e(p).geoLocation},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:K[5]||(K[5]=We=>{V.value=!e(V),we.value=!1})},{default:a(()=>[o("div",Df,[o("span",null,i(e(s)("Click on Map to Set Geographic Location")),1),t(it),e(V)?(l(),c(ie,{key:0,icon:e(Xe)},null,8,["icon"])):r("",!0)])]),_:1})]),_:1},8,["prepend-icon","disabled"])):r("",!0)]),_:1})):r("",!0)]),_:1})]),_:1},8,["disabled"])):r("",!0)])]),default:a(()=>[t(ge,{class:"d-flex flex-column flex-md-row flex-grow-1 overflow-y-auto"},{default:a(()=>[o("div",$f,[t(Ja,{class:be(["v-tabs-pill",{readonly:v.type===e(Mt).Transaction&&e(h)!==e(tt).Add}]),direction:"vertical",disabled:e(u)||e(m),modelValue:e(p).type,"onUpdate:modelValue":K[6]||(K[6]=We=>e(p).type=We)},{default:a(()=>[e(p).type!==e(pe).ModifyBalance?(l(),c(Wt,{key:0,value:e(pe).Expense,disabled:v.type===e(Mt).Transaction&&e(h)!==e(tt).Add&&e(p).type!==e(pe).Expense},{default:a(()=>[o("span",null,i(e(s)("Expense")),1)]),_:1},8,["value","disabled"])):r("",!0),e(p).type!==e(pe).ModifyBalance?(l(),c(Wt,{key:1,value:e(pe).Income,disabled:v.type===e(Mt).Transaction&&e(h)!==e(tt).Add&&e(p).type!==e(pe).Income},{default:a(()=>[o("span",null,i(e(s)("Income")),1)]),_:1},8,["value","disabled"])):r("",!0),e(p).type!==e(pe).ModifyBalance?(l(),c(Wt,{key:2,value:e(pe).Transfer,disabled:v.type===e(Mt).Transaction&&e(h)!==e(tt).Add&&e(p).type!==e(pe).Transfer},{default:a(()=>[o("span",null,i(e(s)("Transfer")),1)]),_:1},8,["value","disabled"])):r("",!0),v.type===e(Mt).Transaction&&e(p).type===e(pe).ModifyBalance?(l(),c(Wt,{key:3,value:e(pe).ModifyBalance},{default:a(()=>[o("span",null,i(e(s)("Modify Balance")),1)]),_:1},8,["value"])):r("",!0)]),_:1},8,["class","disabled","modelValue"]),t(nt,{class:"my-2"}),t(Ja,{direction:"vertical",disabled:e(u)||e(m),modelValue:Ue.value,"onUpdate:modelValue":K[7]||(K[7]=We=>Ue.value=We)},{default:a(()=>[t(Wt,{value:"basicInfo"},{default:a(()=>[o("span",null,i(e(s)("Basic Information")),1)]),_:1}),v.type===e(Mt).Transaction&&e(Ku)()?(l(),c(Wt,{key:0,value:"map",disabled:!e(p).geoLocation},{default:a(()=>[o("span",null,i(e(s)("Location on Map")),1)]),_:1},8,["disabled"])):r("",!0),v.type===e(Mt).Transaction&&e(Qu)()?(l(),c(Wt,{key:1,value:"pictures",disabled:e(h)!==e(tt).Add&&e(h)!==e(tt).Edit&&(!e(p).pictures||!e(p).pictures.length)},{default:a(()=>[o("span",null,i(e(s)("Pictures")),1)]),_:1},8,["disabled"])):r("",!0)]),_:1},8,["disabled","modelValue"])]),t(qa,{class:"d-flex flex-grow-1 disable-tab-transition w-100-window-container ms-md-5",modelValue:Ue.value,"onUpdate:modelValue":K[27]||(K[27]=We=>Ue.value=We)},{default:a(()=>[t(zt,{value:"basicInfo"},{default:a(()=>[t(jt,{class:"mt-2"},{default:a(()=>[t(Ae,null,{default:a(()=>[v.type===e(Mt).Template&&e(p)instanceof e(yl)?(l(),c(R,{key:0,cols:"12"},{default:a(()=>[t(ot,{type:"text","persistent-placeholder":"",disabled:e(u)||e(m),label:e(s)("Template Name"),placeholder:e(s)("Template Name"),modelValue:e(p).name,"onUpdate:modelValue":K[8]||(K[8]=We=>e(p).name=We)},null,8,["disabled","label","placeholder","modelValue"])]),_:1})):r("",!0),t(R,{cols:"12",md:e(p).type===e(pe).Transfer?6:12},{default:a(()=>[t(Re,{class:"transaction-edit-amount font-weight-bold",color:fa.value,currency:e(z),"show-currency":!0,readonly:e(h)===e(tt).View,disabled:e(u)||e(m),"persistent-placeholder":!0,hide:e(p).hideAmount,label:e(O),placeholder:e(s)(e(Y)),"enable-formula":e(h)!==e(tt).View,modelValue:e(p).sourceAmount,"onUpdate:modelValue":K[9]||(K[9]=We=>e(p).sourceAmount=We)},null,8,["color","currency","readonly","disabled","hide","label","placeholder","enable-formula","modelValue"])]),_:1},8,["md"]),e(p).type===e(pe).Transfer?(l(),c(R,{key:1,cols:"12",md:6},{default:a(()=>[t(Re,{class:"transaction-edit-amount font-weight-bold",color:"primary",currency:e(se),"show-currency":!0,readonly:e(h)===e(tt).View,disabled:e(u)||e(m),"persistent-placeholder":!0,hide:e(p).hideAmount,label:e(ae),placeholder:e(s)("Transfer In Amount"),"enable-formula":e(h)!==e(tt).View,modelValue:e(p).destinationAmount,"onUpdate:modelValue":K[10]||(K[10]=We=>e(p).destinationAmount=We)},null,8,["currency","readonly","disabled","hide","label","placeholder","enable-formula","modelValue"])]),_:1})):r("",!0),e(p).type===e(pe).Expense?(l(),c(R,{key:2,cols:"12",md:"12"},{default:a(()=>[t(vt,{disabled:e(D),text:e(D)?"":e(s)("No secondary expense categories are available")},{activator:a(({props:We})=>[o("div",_t(We,{class:"d-block"}),[t(at,{"primary-key-field":"id","primary-value-field":"id","primary-title-field":"name","primary-icon-field":"icon","primary-icon-type":"category","primary-color-field":"color","primary-hidden-field":"hidden","primary-sub-items-field":"subCategories","secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-icon-field":"icon","secondary-icon-type":"category","secondary-color-field":"color","secondary-hidden-field":"hidden",readonly:e(h)===e(tt).View,disabled:e(u)||e(m)||!e(D),"enable-filter":!0,"filter-placeholder":e(s)("Find category"),"filter-no-items-text":e(s)("No available category"),"show-selection-primary-text":!0,"custom-selection-primary-text":e(Qa)(e(p).expenseCategoryId,e(B)[e(st).Expense]),"custom-selection-secondary-text":e($a)(e(p).expenseCategoryId,e(B)[e(st).Expense]),label:e(s)("Category"),placeholder:e(s)("Category"),items:e(B)[e(st).Expense]||[],modelValue:e(p).expenseCategoryId,"onUpdate:modelValue":K[11]||(K[11]=Nt=>e(p).expenseCategoryId=Nt)},null,8,["readonly","disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","custom-selection-secondary-text","label","placeholder","items","modelValue"])],16)]),_:1},8,["disabled","text"])]),_:1})):r("",!0),e(p).type===e(pe).Income?(l(),c(R,{key:3,cols:"12",md:"12"},{default:a(()=>[t(vt,{disabled:e($),text:e($)?"":e(s)("No secondary income categories are available")},{activator:a(({props:We})=>[o("div",_t(We,{class:"d-block"}),[t(at,{"primary-key-field":"id","primary-value-field":"id","primary-title-field":"name","primary-icon-field":"icon","primary-icon-type":"category","primary-color-field":"color","primary-hidden-field":"hidden","primary-sub-items-field":"subCategories","secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-icon-field":"icon","secondary-icon-type":"category","secondary-color-field":"color","secondary-hidden-field":"hidden",readonly:e(h)===e(tt).View,disabled:e(u)||e(m)||!e($),"enable-filter":!0,"filter-placeholder":e(s)("Find category"),"filter-no-items-text":e(s)("No available category"),"show-selection-primary-text":!0,"custom-selection-primary-text":e(Qa)(e(p).incomeCategoryId,e(B)[e(st).Income]),"custom-selection-secondary-text":e($a)(e(p).incomeCategoryId,e(B)[e(st).Income]),label:e(s)("Category"),placeholder:e(s)("Category"),items:e(B)[e(st).Income]||[],modelValue:e(p).incomeCategoryId,"onUpdate:modelValue":K[12]||(K[12]=Nt=>e(p).incomeCategoryId=Nt)},null,8,["readonly","disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","custom-selection-secondary-text","label","placeholder","items","modelValue"])],16)]),_:1},8,["disabled","text"])]),_:1})):r("",!0),e(p).type===e(pe).Transfer?(l(),c(R,{key:4,cols:"12",md:"12"},{default:a(()=>[t(vt,{disabled:e(C),text:e(C)?"":e(s)("No secondary transfer categories are available")},{activator:a(({props:We})=>[o("div",_t(We,{class:"d-block"}),[t(at,{"primary-key-field":"id","primary-value-field":"id","primary-title-field":"name","primary-icon-field":"icon","primary-icon-type":"category","primary-color-field":"color","primary-hidden-field":"hidden","primary-sub-items-field":"subCategories","secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-icon-field":"icon","secondary-icon-type":"category","secondary-color-field":"color","secondary-hidden-field":"hidden",readonly:e(h)===e(tt).View,disabled:e(u)||e(m)||!e(C),"enable-filter":!0,"filter-placeholder":e(s)("Find category"),"filter-no-items-text":e(s)("No available category"),"show-selection-primary-text":!0,"custom-selection-primary-text":e(Qa)(e(p).transferCategoryId,e(B)[e(st).Transfer]),"custom-selection-secondary-text":e($a)(e(p).transferCategoryId,e(B)[e(st).Transfer]),label:e(s)("Category"),placeholder:e(s)("Category"),items:e(B)[e(st).Transfer]||[],modelValue:e(p).transferCategoryId,"onUpdate:modelValue":K[13]||(K[13]=Nt=>e(p).transferCategoryId=Nt)},null,8,["readonly","disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","custom-selection-secondary-text","label","placeholder","items","modelValue"])],16)]),_:1},8,["disabled","text"])]),_:1})):r("",!0),t(R,{cols:"12",md:e(p).type===e(pe).Transfer?6:12},{default:a(()=>[t(vt,{disabled:!!e(F).length,text:e(F).length?"":e(s)("No available account")},{activator:a(({props:We})=>[o("div",_t(We,{class:"d-block"}),[t(at,{"primary-key-field":"id","primary-value-field":"category","primary-title-field":"name","primary-footer-field":"displayBalance","primary-icon-field":"icon","primary-icon-type":"account","primary-sub-items-field":"accounts","primary-title-i18n":!0,"secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-footer-field":"displayBalance","secondary-icon-field":"icon","secondary-icon-type":"account","secondary-color-field":"color",readonly:e(h)===e(tt).View,disabled:e(u)||e(m)||!e(F).length||e(h)===e(tt).Edit&&e(p).type===e(pe).ModifyBalance,"enable-filter":!0,"filter-placeholder":e(s)("Find account"),"filter-no-items-text":e(s)("No available account"),"custom-selection-primary-text":e(Z),label:e(s)(e(J)),placeholder:e(s)(e(J)),items:e(j),modelValue:e(p).sourceAccountId,"onUpdate:modelValue":K[14]||(K[14]=Nt=>e(p).sourceAccountId=Nt)},null,8,["readonly","disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","label","placeholder","items","modelValue"])],16)]),_:1},8,["disabled","text"])]),_:1},8,["md"]),e(p).type===e(pe).Transfer?(l(),c(R,{key:5,cols:"12",md:"6"},{default:a(()=>[t(vt,{disabled:!!e(F).length,text:e(F).length?"":e(s)("No available account")},{activator:a(({props:We})=>[o("div",_t(We,{class:"d-block"}),[t(at,{"primary-key-field":"id","primary-value-field":"category","primary-title-field":"name","primary-footer-field":"displayBalance","primary-icon-field":"icon","primary-icon-type":"account","primary-sub-items-field":"accounts","primary-title-i18n":!0,"secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-footer-field":"displayBalance","secondary-icon-field":"icon","secondary-icon-type":"account","secondary-color-field":"color",readonly:e(h)===e(tt).View,disabled:e(u)||e(m)||!e(F).length,"enable-filter":!0,"filter-placeholder":e(s)("Find account"),"filter-no-items-text":e(s)("No available account"),"custom-selection-primary-text":e(le),label:e(s)("Destination Account"),placeholder:e(s)("Destination Account"),items:e(j),modelValue:e(p).destinationAccountId,"onUpdate:modelValue":K[15]||(K[15]=Nt=>e(p).destinationAccountId=Nt)},null,8,["readonly","disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","label","placeholder","items","modelValue"])],16)]),_:1},8,["disabled","text"])]),_:1})):r("",!0),v.type===e(Mt).Transaction?(l(),c(R,{key:6,cols:"12",md:"6"},{default:a(()=>[t(gt,{readonly:e(h)===e(tt).View,disabled:e(u)||e(m)||e(h)===e(tt).Edit&&e(p).type===e(pe).ModifyBalance,label:e(s)("Transaction Time"),"timezone-utc-offset":e(p).utcOffset,"model-value":e(p).time,"onUpdate:modelValue":e(Ye),onError:Al},null,8,["readonly","disabled","label","timezone-utc-offset","model-value","onUpdate:modelValue"])]),_:1})):r("",!0),v.type===e(Mt).Template&&e(p)instanceof e(yl)&&e(p).templateType===e(Da).Schedule.type?(l(),c(R,{key:7,cols:"12",md:"6"},{default:a(()=>[t(Wa,{readonly:e(h)===e(tt).View,disabled:e(u)||e(m),label:e(s)("Scheduled Transaction Frequency"),type:e(p).scheduledFrequencyType,"onUpdate:type":K[16]||(K[16]=We=>e(p).scheduledFrequencyType=We),modelValue:e(p).scheduledFrequency,"onUpdate:modelValue":K[17]||(K[17]=We=>e(p).scheduledFrequency=We)},null,8,["readonly","disabled","label","type","modelValue"])]),_:1})):r("",!0),v.type===e(Mt).Transaction||v.type===e(Mt).Template&&e(p)instanceof e(yl)&&e(p).templateType===e(Da).Schedule.type?(l(),c(R,{key:8,cols:"12",md:"6"},{default:a(()=>[t(ua,{class:"transaction-edit-timezone","item-title":"displayNameWithUtcOffset","item-value":"name","auto-select-first":"","persistent-placeholder":"",readonly:e(h)===e(tt).View,disabled:e(u)||e(m)||e(h)===e(tt).Edit&&e(p).type===e(pe).ModifyBalance,label:e(s)("Transaction Timezone"),placeholder:!e(p).timeZone&&e(p).timeZone!==""?`(${e(ue)}) ${e(Ee)}`:e(s)("Timezone"),items:e(I),"no-data-text":e(s)("No results"),"model-value":e(p).timeZone,"onUpdate:modelValue":e(He)},{selection:a(({item:We})=>[e(p).timeZone||e(p).timeZone===""?(l(),g("span",Nf,i(We.title),1)):r("",!0)]),_:1},8,["readonly","disabled","label","placeholder","items","no-data-text","model-value","onUpdate:modelValue"])]),_:1})):r("",!0),v.type===e(Mt).Template&&e(p)instanceof e(yl)&&e(p).templateType===e(Da).Schedule.type?(l(),c(R,{key:9,cols:"12",md:"6"},{default:a(()=>[t(Fa,{readonly:e(h)===e(tt).View,disabled:e(u)||e(m),clearable:!0,label:e(s)("Start Date"),"no-data-text":e(s)("No limit"),modelValue:e(p).scheduledStartDate,"onUpdate:modelValue":K[18]||(K[18]=We=>e(p).scheduledStartDate=We)},null,8,["readonly","disabled","label","no-data-text","modelValue"])]),_:1})):r("",!0),v.type===e(Mt).Template&&e(p)instanceof e(yl)&&e(p).templateType===e(Da).Schedule.type?(l(),c(R,{key:10,cols:"12",md:"6"},{default:a(()=>[t(Fa,{readonly:e(h)===e(tt).View,disabled:e(u)||e(m),clearable:!0,label:e(s)("End Date"),"no-data-text":e(s)("No limit"),modelValue:e(p).scheduledEndDate,"onUpdate:modelValue":K[19]||(K[19]=We=>e(p).scheduledEndDate=We)},null,8,["readonly","disabled","label","no-data-text","modelValue"])]),_:1})):r("",!0),v.type===e(Mt).Transaction?(l(),c(R,{key:11,cols:"12",md:"12"},{default:a(()=>[t(Ge,{"persistent-placeholder":"",readonly:e(h)===e(tt).View,disabled:e(u)||e(m),label:e(s)("Geographic Location"),modelValue:e(p),"onUpdate:modelValue":K[21]||(K[21]=We=>ht(p)?p.value=We:null),menu:we.value,"onUpdate:menu":K[22]||(K[22]=We=>we.value=We)},{selection:a(()=>[e(p).geoLocation?(l(),g("span",Ff,i(`(${e(fi)(e(p).geoLocation,e(w))})`),1)):e(p).geoLocation?r("",!0):(l(),g("span",Ef,i(e(me)),1))]),"no-data":a(()=>[t(Je,{class:"py-0"},{default:a(()=>[e(h)!==e(tt).View?(l(),c(ve,{key:0,onClick:K[20]||(K[20]=We=>Pa(!0))},{default:a(()=>[q(i(e(s)("Update Geographic Location")),1)]),_:1})):r("",!0),e(h)!==e(tt).View?(l(),c(ve,{key:1,onClick:Ha},{default:a(()=>[q(i(e(s)("Clear Geographic Location")),1)]),_:1})):r("",!0)]),_:1})]),_:1},8,["readonly","disabled","label","modelValue","menu"])]),_:1})):r("",!0),t(R,{cols:"12",md:"12"},{default:a(()=>[t(ua,{"item-title":"name","item-value":"id","auto-select-first":"","persistent-placeholder":"",multiple:"",chips:"","closable-chips":e(h)!==e(tt).View,readonly:e(h)===e(tt).View,disabled:e(u)||e(m),label:e(s)("Tags"),placeholder:e(s)("None"),items:e(X),modelValue:e(p).tagIds,"onUpdate:modelValue":K[24]||(K[24]=We=>e(p).tagIds=We),search:Dt.value,"onUpdate:search":K[25]||(K[25]=We=>Dt.value=We)},{chip:a(({props:We,item:Nt})=>[t(Jt,_t({"prepend-icon":e(ea),text:Nt.title},We),null,16,["prepend-icon","text"])]),item:a(({props:We,item:Nt})=>[Nt.raw.hidden?r("",!0):(l(),c(ve,_t({key:0,value:Nt.value},We),{title:a(()=>[t(rt,null,{default:a(()=>[o("div",Mf,[t(ie,{size:"20",start:"",icon:e(ea)},null,8,["icon"]),o("span",null,i(Nt.title),1)])]),_:2},1024)]),_:2},1040,["value"])),Nt.raw.hidden&&Nt.raw.name.toLowerCase().indexOf(Dt.value.toLowerCase())>=0&&xa.value?(l(),c(ve,_t({key:1,disabled:!0},We),{title:a(()=>[t(rt,null,{default:a(()=>[o("div",Uf,[t(ie,{size:"20",start:"",icon:e(ea)},null,8,["icon"]),o("span",null,i(Nt.title),1)])]),_:2},1024)]),_:2},1040)):r("",!0)]),"no-data":a(()=>[t(Je,{class:"py-0"},{default:a(()=>[Dt.value?(l(),c(ve,{key:0,onClick:K[23]||(K[23]=We=>dl(Dt.value))},{default:a(()=>[q(i(e(s)("format.misc.addNewTag",{tag:Dt.value})),1)]),_:1})):Dt.value?r("",!0):(l(),c(ve,{key:1},{default:a(()=>[q(i(e(s)("No available tag")),1)]),_:1}))]),_:1})]),_:1},8,["closable-chips","readonly","disabled","label","placeholder","items","modelValue","search"])]),_:1}),t(R,{cols:"12",md:"12"},{default:a(()=>[t(Oa,{type:"text","persistent-placeholder":"",rows:"3",readonly:e(h)===e(tt).View,disabled:e(u)||e(m),label:e(s)("Description"),placeholder:e(s)("Your transaction description (optional)"),modelValue:e(p).comment,"onUpdate:modelValue":K[26]||(K[26]=We=>e(p).comment=We)},null,8,["readonly","disabled","label","placeholder","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(zt,{value:"map"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"12"},{default:a(()=>[t(yi,{ref_key:"map",ref:kt,"map-class":"transaction-edit-map-view","enable-zoom-control":!0,"geo-location":e(p).geoLocation,onClick:el},{"error-title":a(({mapSupported:We,mapDependencyLoaded:Nt})=>[We?Nt?r("",!0):(l(),g("span",Bf,[o("b",null,i(e(s)("Cannot Initialize Map")),1)])):(l(),g("span",Pf,[o("b",null,i(e(s)("Unsupported Map Provider")),1)]))]),"error-content":a(()=>[o("p",Lf,i(e(s)("Please refresh the page and try again. If the error persists, ensure that the server's map settings are correctly configured.")),1)]),_:1},8,["geo-location"])]),_:1})]),_:1})]),_:1}),t(zt,{value:"pictures"},{default:a(()=>[t(Ae,{class:be(["transaction-pictures align-content-start",{readonly:e(m)||e(k)||bt.value}])},{default:a(()=>[(l(!0),g(fe,null,$e(e(p).pictures,(We,Nt)=>(l(),c(R,{key:Nt,cols:"6",md:"3"},{default:a(()=>[t(ol,{rounded:"lg",variant:"tonal",size:"160",class:"cursor-pointer transaction-picture",color:"rgba(0,0,0,0)",onClick:tl=>wl(We)},{default:a(()=>[t(wt,{src:e(la)(We)},{placeholder:a(()=>[o("div",zf,[t(Ze,{color:"grey-500",indeterminate:"",size:"48"})])]),error:a(()=>[o("div",Of,[o("span",Rf,i(e(s)('Failed to load image, please check whether the config "domain" and "root_url" are set correctly.')),1)])]),_:1},8,["src"]),o("div",{class:be(["picture-control-icon",{"show-control-icon":We.pictureId===bt.value}])},[(e(h)===e(tt).Add||e(h)===e(tt).Edit)&&We.pictureId!==bt.value?(l(),c(ie,{key:0,size:"64",icon:e(vr)},null,8,["icon"])):r("",!0),(e(h)===e(tt).Add||e(h)===e(tt).Edit)&&We.pictureId===bt.value?(l(),c(Ze,{key:1,color:"grey-500",indeterminate:"",size:"48"})):r("",!0),e(h)!==e(tt).Add&&e(h)!==e(tt).Edit?(l(),c(ie,{key:2,size:"64",icon:e(fr)},null,8,["icon"])):r("",!0)],2)]),_:2},1032,["onClick"])]),_:2},1024))),128)),e(M)?(l(),c(R,{key:0,cols:"6",md:"3"},{default:a(()=>[t(ol,{rounded:"lg",variant:"tonal",size:"160",class:be(["transaction-picture transaction-picture-add",{enabled:!e(m),"cursor-pointer":!e(m)}]),color:"rgba(0,0,0,0)",onClick:cl},{default:a(()=>[e(m)?r("",!0):(l(),c(vt,{key:0,activator:"parent"},{default:a(()=>[q(i(e(s)("Add Picture")),1)]),_:1})),e(k)?r("",!0):(l(),c(ie,{key:1,class:"transaction-picture-add-icon",size:"56",icon:e(yr)},null,8,["icon"])),e(k)?(l(),c(Ze,{key:2,color:"grey-500",indeterminate:"",size:"48"})):r("",!0)]),_:1},8,["class"])]),_:1})):r("",!0)]),_:1},8,["class"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(ge,null,{default:a(()=>[o("div",qf,[t(vt,{disabled:!e(Se),text:e(te)?e(s)(e(te)):""},{activator:a(({props:We})=>[o("div",_t(We,{class:"d-inline-block"}),[e(h)!==e(tt).View?(l(),c(H,{key:0,disabled:e(Se)||e(u)||e(m),onClick:ul},{default:a(()=>[q(i(e(s)(e(ye)))+" ",1),e(m)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])):r("",!0)],16)]),_:1},8,["disabled","text"]),e(h)===e(tt).View&&e(p).type!==e(pe).ModifyBalance?(l(),c(Gl,{key:0,variant:"tonal",density:"comfortable"},{default:a(()=>[t(H,{disabled:e(u)||e(m),onClick:K[28]||(K[28]=We=>Ua(!1,!1))},{default:a(()=>[q(i(e(s)("Duplicate")),1)]),_:1},8,["disabled"]),t(H,{density:"compact",disabled:e(u)||e(m),icon:!0},{default:a(()=>[t(ie,{icon:e(Fl),size:"24"},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{title:e(s)("Duplicate (With Time)"),onClick:K[29]||(K[29]=We=>Ua(!0,!1))},null,8,["title"]),e(p).geoLocation?(l(),c(ve,{key:0,title:e(s)("Duplicate (With Geographic Location)"),onClick:K[30]||(K[30]=We=>Ua(!1,!0))},null,8,["title"])):r("",!0),e(p).geoLocation?(l(),c(ve,{key:1,title:e(s)("Duplicate (With Time and Geographic Location)"),onClick:K[31]||(K[31]=We=>Ua(!0,!0))},null,8,["title"])):r("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1})):r("",!0),e(h)===e(tt).View&&Pe.value?(l(),c(H,{key:1,color:"warning",variant:"tonal",disabled:e(u)||e(m),onClick:ja},{default:a(()=>[q(i(e(s)("Edit")),1)]),_:1},8,["disabled"])):r("",!0),e(h)===e(tt).View&&Pe.value?(l(),c(H,{key:2,color:"error",variant:"tonal",disabled:e(u)||e(m),onClick:ya},{default:a(()=>[q(i(e(s)("Delete"))+" ",1),e(m)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])):r("",!0),t(H,{color:"secondary",variant:"tonal",disabled:e(u)||e(m),onClick:Cl},{default:a(()=>[q(i(e(s)(e(L))),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["persistent","modelValue"]),t(ka,{ref_key:"confirmDialog",ref:Be},null,512),t(ct,{ref_key:"snackbar",ref:Ke},null,512),o("input",{ref_key:"pictureInput",ref:Fe,type:"file",style:{display:"none"},accept:e(us),onChange:K[33]||(K[33]=We=>ml(We))},null,40,Yf)],64)}}}),jf={class:"text-h4"},Hf={key:0,class:"d-inline-flex flex-column"},Wf={key:2,class:"pa-2"},Gf={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},Kf=["accept"],Qf=Oe({__name:"AIImageRecognitionDialog",setup(v,{expose:_}){const n=Kt(),{tt:s}=je(),h=en(),d=xe("snackbar"),y=xe("imageInput");let f=null,b=null;const x=P(!1),u=P(!1),m=P(!1),k=P(void 0),N=P(null),V=P(void 0),p=P(!1),T=E(()=>n.global.name.value===$t.Dark);function A(D){u.value=!0,N.value=null,V.value=void 0,Ju(D,1280,1280,.8).then($=>{N.value=Bt.JPG.createFileFromBlob($,"image"),V.value=URL.createObjectURL($),u.value=!1}).catch($=>{N.value=null,V.value=void 0,u.value=!1,Xt.error("failed to compress image",$),d.value?.showError("Unable to load image")})}function w(){return x.value=!0,u.value=!1,m.value=!1,k.value=void 0,N.value=null,V.value=void 0,new Promise((D,$)=>{f=D,b=$})}function I(){u.value||m.value||p.value||y.value?.click()}function F(D){if(!D||!D.target)return;const $=D.target;if(!$.files||!$.files.length||!$.files[0])return;const C=$.files[0];$.value="",A(C)}function S(){u.value||m.value||!N.value||(k.value=_l(),m.value=!0,h.recognizeReceiptImage({imageFile:N.value,cancelableUuid:k.value}).then(D=>{f?.(D),x.value=!1,m.value=!1,k.value=void 0}).catch(D=>{D.canceled||(m.value=!1,k.value=void 0,D.processed||d.value?.showError(D))}))}function j(){k.value&&(h.cancelRecognizeReceiptImage(k.value),m.value=!1,k.value=void 0,d.value?.showMessage("User Canceled"))}function B(){b?.(),x.value=!1,u.value=!1,m.value=!1,k.value=void 0,N.value=null,V.value=void 0}function U(){u.value||m.value||(p.value=!0)}function X(){p.value=!1}function oe(D){u.value||m.value||(p.value=!1,D.dataTransfer&&D.dataTransfer.files&&D.dataTransfer.files.length&&D.dataTransfer.files[0]&&A(D.dataTransfer.files[0]))}function W(D){if(!D.clipboardData){D.preventDefault();return}for(let $=0;$<D.clipboardData.items.length;$++){const C=D.clipboardData.items[$];if(C&&C.type.startsWith("image/")){const M=C.getAsFile();if(M){A(M),D.preventDefault();return}}}}return _({open:w}),(D,$)=>(l(),g(fe,null,[t(xt,{width:"800",persistent:u.value||m.value||!!N.value,modelValue:x.value,"onUpdate:modelValue":$[1]||($[1]=C=>x.value=C),onPaste:W},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("h4",jf,i(e(s)("AI Image Recognition")),1)]),default:a(()=>[t(ge,{class:"d-flex flex-column flex-md-row flex-grow-1 overflow-y-auto",style:{height:"480px"}},{default:a(()=>[o("div",{class:"w-100 h-100 border position-relative",onDragenter:Qn(U,["prevent"]),onDragover:$[0]||($[0]=Qn(()=>{},["prevent"])),onDragleave:Qn(X,["prevent"]),onDrop:Qn(oe,["prevent"])},[o("div",{class:be(["d-flex w-100 h-100 justify-center align-center justify-content-center text-center px-4",{dropzone:!0,"dropzone-dragover":p.value}])},[!u.value&&!N.value&&!p.value?(l(),g("div",Hf,[o("h3",{class:be({"pa-2":!0,"bg-grey-200":!T.value,"bg-grey-100":T.value})},i(e(s)("You can drag and drop, paste or click to select a receipt or transaction image")),3),o("span",{class:be({"pa-2":!0,"bg-grey-200":!T.value,"bg-grey-100":T.value})},i(e(s)("Uploaded image and personal data will be sent to the large language model, please be aware of potential privacy risks.")),3)])):!u.value&&p.value?(l(),g("h3",{key:1,class:be({"pa-2":!0,"bg-grey-200":!T.value,"bg-grey-100":T.value})},i(e(s)("Release to load image")),3)):u.value?(l(),g("h3",Wf,i(e(s)("Loading image...")),1)):m.value?(l(),g("h3",{key:3,class:be({"pa-2":!0,"bg-grey-200":!T.value,"bg-grey-100":T.value})},i(e(s)("AI can make mistakes. Check important info.")),3)):r("",!0)],2),t(wt,{class:be({"cursor-pointer":!u.value&&!m.value&&!p.value,"h-100":!0}),src:V.value,onClick:I},{placeholder:a(()=>[o("div",{class:be({"w-100 h-100":!0,"bg-grey-200":!T.value,"bg-grey-100":T.value})},null,2)]),_:1},8,["class","src"])],32)]),_:1}),t(ge,null,{default:a(()=>[o("div",Gf,[t(H,{disabled:u.value||m.value||!N.value,onClick:S},{default:a(()=>[q(i(e(s)("Recognize"))+" ",1),m.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"]),m.value&&k.value?(l(),c(H,{key:0,color:"secondary",variant:"tonal",disabled:u.value,onClick:j},{default:a(()=>[q(i(e(s)("Cancel Recognition")),1)]),_:1},8,["disabled"])):r("",!0),!m.value||!k.value?(l(),c(H,{key:1,color:"secondary",variant:"tonal",disabled:u.value||m.value,onClick:B},{default:a(()=>[q(i(e(s)("Cancel")),1)]),_:1},8,["disabled"])):r("",!0)])]),_:1})]),_:1})]),_:1},8,["persistent","modelValue"]),t(ct,{ref_key:"snackbar",ref:d},null,512),o("input",{ref_key:"imageInput",ref:y,type:"file",style:{display:"none"},accept:e(us),onChange:$[2]||($[2]=C=>F(C))},null,40,Kf)],64))}}),Jf={key:0},Zf={key:1,class:"py-1"},Xf={key:0,class:"title-and-toolbar d-flex align-center text-no-wrap mt-2"},ey={key:0,class:"ms-1"},ty={key:0,class:"ms-1"},ay={key:0,class:"ms-1"},ly={key:0,class:"ms-1"},ny={class:"ms-1"},oy={key:0,class:"ms-1"},sy={class:"ms-1"},iy={key:0,class:"ms-1"},ry={key:0,class:"ms-1"},uy=Oe({__name:"ImportTransactionDefineColumnTab",props:{parsedFileData:{},disabled:{type:Boolean}},setup(v,{expose:_}){const n=v,{tt:s,ti:h,getCurrentNumeralSystemType:d,getAllImportTransactionColumnTypes:y}=je(),f=xe("snackbar"),b=P(1),x=P(10),u=P(Cs.createEmpty()),m=E(()=>d()),k=E(()=>y()),N=E(()=>[{prependIcon:es,title:s("Load Data Mapping File"),onClick:ee},{prependIcon:ts,title:s("Save Data Mapping File"),onClick:ye}]),V=E(()=>[{name:s("Space"),value:" "},{name:s("Comma"),value:","},{name:s("Semicolon"),value:";"},{name:s("Tab"),value:"	"},{name:s("Vertical Bar"),value:"|"}]),p=E(()=>{if(!(x.value<=10||!A.value||A.value.length<=10))return 400}),T=E(()=>{let L=0;if(n.parsedFileData)for(const J of n.parsedFileData)J.length>L&&(L=J.length);const Y=n.parsedFileData&&n.parsedFileData.length>0?n.parsedFileData[0]:[],O=[];O.push({key:"index",value:"index",title:"#",sortable:!0,nowrap:!0});for(let J=0;J<L;J++){let ae=`#${J+1}`;u.value.includeHeader&&Y&&Y[J]&&(ae=Y[J]),O.push({key:J.toString(),value:`column${J+1}`,title:ae,sortable:!0,nowrap:!0})}return O}),A=E(()=>{if(!n.parsedFileData)return;const L=[],Y=u.value.includeHeader?1:0;for(let O=Y,J=1;O<n.parsedFileData.length;O++,J++){const ae={},Z=n.parsedFileData[O];for(const[le,z]of Ra(Z))ae.index=J.toString(),ae[`column${z+1}`]=le;L.push(ae)}return L}),w=E(()=>D(A.value?.length)),I=E(()=>u.value.parseFileAllTransactionTypes(n.parsedFileData)),F=E(()=>u.value.parseFileValidMappedTransactionTypes(n.parsedFileData)),S=E(()=>u.value.parseFileAutoDetectedTimeFormat(n.parsedFileData)),j=E(()=>u.value.parseFileAutoDetectedTimezoneFormat(n.parsedFileData)),B=E(()=>u.value.parseFileAutoDetectedAmountFormat(n.parsedFileData)),U=E(()=>{const L=u.value.timezoneFormat||j.value||"";if(L){const Y=So.valueOf(L);if(Y)return h(Y.name,Y.nameSupportedI18n)}return s("Unknown")}),X=E(()=>{const L=j.value;if(L){const Y=So.valueOf(L);if(Y)return h(Y.name,Y.nameSupportedI18n)}return s("Unknown")}),oe=E(()=>{const L=B.value;if(L){const Y=eo.valueOf(L);if(Y)return Y.format}return s("Unknown")});function W(L){return m.value.formatNumber(L)}function D(L){const Y=[];if(!L||L<1)return Y.push({value:-1,name:s("All")}),Y;for(const O of[5,10,15,20,25,30,50]){if(L<O)break;Y.push({value:O,name:W(O)})}return Y.push({value:-1,name:s("All")}),Y}function $(L){for(const[Y,O]of gi(u.value.dataColumnMapping))if(O===L)return Zu(k.value,parseInt(Y))||s("Unspecified");return s("Unspecified")}function C(){const L=u.value.dataColumnMapping,Y=F.value,O=u.value.includeHeader,J=u.value.geoLocationSeparator,ae=u.value.geoLocationOrder,Z=u.value.tagSeparator;let le=u.value.timeFormat,z=u.value.timezoneFormat,se=u.value.amountFormat,ue,Ee;if(!L||!Zt(L[La.TransactionTime.type])||!Zt(L[La.TransactionType.type])||!Zt(L[La.Amount.type])){f.value?.showError("Missing transaction time, transaction type, or amount column mapping");return}if(!Y||hi(Y)){f.value?.showError("Transaction type mapping is not set");return}if(u.value.timeFormat||(le=S.value),u.value.timezoneFormat||(z=j.value),u.value.amountFormat||(se=B.value),se){const me=eo.valueOf(se);me&&(ue=me.decimalSeparator.symbol,Ee=me.digitGroupingSymbol?.symbol)}if(!le){f.value?.showError("Transaction time format is not set");return}if(!ue){f.value?.showError("Transaction amount format is not set");return}return{includeHeader:O,columnMapping:L,transactionTypeMapping:Y,timeFormat:le,timezoneFormat:z,amountDecimalSeparator:ue,amountDigitGroupingSymbol:Ee,geoLocationSeparator:J,geoLocationOrder:ae,tagSeparator:Z}}function M(){u.value.reset(),b.value=1,x.value=10}function ee(){ds({allowedExtensions:Bt.JSON.contentType}).then(L=>{const Y=Cs.parseFromJson(L);Y?u.value=Y:(Xt.error("Failed to parse data mapping file"),f.value?.showError("Data mapping file is invalid"))}).catch(L=>{Xt.error("Failed to open data mapping file",L),f.value?.showError("Data mapping file is invalid")})}function ye(){const L=Bt.JSON.formatFileName(s("dataExport.defaultImportDataMappingFileName"));tn(L,Bt.JSON.createBlob(u.value.toJson()))}return _({menus:N,generateResult:C,reset:M,loadColumnMappingFile:ee,saveColumnMappingFile:ye}),(L,Y)=>(l(),g(fe,null,[t(Kl,{"fixed-header":"","fixed-footer":"",density:"compact","item-value":"index",class:be({"import-transaction-table":!0,disabled:!!v.disabled}),height:p.value,"disable-sort":!0,headers:T.value,items:A.value,hover:!0,"no-data-text":e(s)("No data to import"),"items-per-page":x.value,"onUpdate:itemsPerPage":Y[7]||(Y[7]=O=>x.value=O),page:b.value,"onUpdate:page":Y[8]||(Y[8]=O=>b.value=O)},{headers:a(({columns:O})=>[o("tr",null,[(l(!0),g(fe,null,$e(O,J=>(l(),g("th",{class:"text-no-wrap",key:J.key??void 0},[!J.key||J.key==="index"?(l(),g("span",Jf,i(J.title),1)):r("",!0),J.key&&J.key!=="index"?(l(),g("div",Zf,[o("span",null,i($(parseInt(J.key))),1),Y[9]||(Y[9]=o("br",null,null,-1)),o("span",null,"("+i(J.title)+")",1),t(mt,{activator:"parent",location:"bottom","max-height":"500"},{default:a(()=>[t(Je,null,{default:a(()=>[(l(!0),g(fe,null,$e(k.value,ae=>(l(),c(ve,{key:ae.type,"append-icon":u.value.dataColumnMapping[ae.type]===parseInt(J.key)?e(Xe):void 0,onClick:Z=>u.value.toggleDataMappingColumn(parseInt(J.key),ae.type)},{default:a(()=>[t(rt,{class:"cursor-pointer"},{default:a(()=>[q(i(ae.displayName),1)]),_:2},1024)]),_:2},1032,["append-icon","onClick"]))),128))]),_:2},1024)]),_:2},1024)])):r("",!0)]))),128))])]),bottom:a(()=>[v.parsedFileData?(l(),g("div",Xf,[t(H,{color:"secondary",density:"compact",variant:"outlined","append-icon":u.value.includeHeader?e(Xe):e(vl),onClick:Y[0]||(Y[0]=O=>u.value.toggleIncludeHeader())},{default:a(()=>[q(i(e(s)("Include Header Line")),1)]),_:1},8,["append-icon"]),t(H,{class:"ms-2",color:"secondary",density:"compact",variant:"outlined",disabled:!u.value||!u.value.isColumnMappingSet(e(La).TransactionType)||!I.value},{default:a(()=>[o("span",null,i(e(s)("Transaction Type Mapping")),1),u.value&&u.value.isColumnMappingSet(e(La).TransactionType)&&I.value?(l(),g("span",ey,"("+i(e(Yo)(F.value)||e(s)("None"))+")",1)):r("",!0),t(mt,{eager:"",activator:"parent",location:"bottom","max-height":"500","close-on-content-click":!1},{default:a(()=>[t(Je,{class:"pa-0"},{default:a(()=>[t(ve,{class:"pa-0"},{default:a(()=>[t(sl,{class:"transaction-types-popup-menu"},{default:a(()=>[o("tbody",null,[(l(!0),g(fe,null,$e(I.value,O=>(l(),g("tr",{key:O},[o("td",null,i(O),1),o("td",null,[t(Ul,{class:"toggle-buttons",density:"compact",variant:"outlined",mandatory:"force",divided:"",modelValue:u.value.transactionTypeMapping[O],"onUpdate:modelValue":J=>u.value.transactionTypeMapping[O]=J},{default:a(()=>[t(H,{value:void 0},{default:a(()=>[q(i(e(s)("None")),1)]),_:1}),t(H,{value:e(pe).ModifyBalance},{default:a(()=>[q(i(e(s)("Modify Balance")),1)]),_:1},8,["value"]),t(H,{value:e(pe).Income},{default:a(()=>[q(i(e(s)("Income")),1)]),_:1},8,["value"]),t(H,{value:e(pe).Expense},{default:a(()=>[q(i(e(s)("Expense")),1)]),_:1},8,["value"]),t(H,{value:e(pe).Transfer},{default:a(()=>[q(i(e(s)("Transfer")),1)]),_:1},8,["value"])]),_:1},8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled"]),t(H,{class:"ms-2",color:"secondary",density:"compact",variant:"outlined",disabled:!u.value||!u.value.isColumnMappingSet(e(La).TransactionTime)},{default:a(()=>[o("span",null,i(e(s)("Time Format")),1),u.value&&u.value.isColumnMappingSet(e(La).TransactionTime)?(l(),g("span",ty,"("+i(u.value.timeFormat||S.value||e(s)("Unknown"))+")",1)):r("",!0),t(mt,{eager:"",activator:"parent",location:"bottom","max-height":"500"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{key:"auto","append-icon":u.value.timeFormat===""?e(Xe):void 0,onClick:Y[1]||(Y[1]=O=>u.value.timeFormat="")},{default:a(()=>[t(rt,{class:"cursor-pointer"},{default:a(()=>[o("span",null,i(e(s)("Auto detect")),1),S.value?(l(),g("span",ay,"("+i(S.value||e(s)("Unknown"))+")",1)):r("",!0)]),_:1})]),_:1},8,["append-icon"]),(l(!0),g(fe,null,$e(e(fo).values(),O=>(l(),c(ve,{key:O.format,"append-icon":u.value.timeFormat===O.format?e(Xe):void 0,onClick:J=>u.value.timeFormat=O.format},{default:a(()=>[t(rt,{class:"cursor-pointer"},{default:a(()=>[q(i(O.format),1)]),_:2},1024)]),_:2},1032,["append-icon","onClick"]))),128))]),_:1})]),_:1})]),_:1},8,["disabled"]),u.value&&u.value.isColumnMappingSet(e(La).TransactionTimezone)?(l(),c(H,{key:0,class:"ms-2",color:"secondary",density:"compact",variant:"outlined"},{default:a(()=>[o("span",null,i(e(s)("Timezone Format")),1),u.value&&u.value.isColumnMappingSet(e(La).TransactionTimezone)?(l(),g("span",ly,"("+i(U.value)+")",1)):r("",!0),t(mt,{eager:"",activator:"parent",location:"bottom","max-height":"500"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{key:"auto","append-icon":u.value.timezoneFormat===""?e(Xe):void 0,onClick:Y[2]||(Y[2]=O=>u.value.timezoneFormat="")},{default:a(()=>[t(rt,{class:"cursor-pointer"},{default:a(()=>[o("span",null,i(e(s)("Auto detect")),1),o("span",ny,"("+i(X.value)+")",1)]),_:1})]),_:1},8,["append-icon"]),(l(!0),g(fe,null,$e(e(So).values(),O=>(l(),c(ve,{key:O.value,"append-icon":u.value.timezoneFormat===O.value?e(Xe):void 0,onClick:J=>u.value.timezoneFormat=O.value},{default:a(()=>[t(rt,{class:"cursor-pointer"},{default:a(()=>[q(i(e(h)(O.name,O.nameSupportedI18n)),1)]),_:2},1024)]),_:2},1032,["append-icon","onClick"]))),128))]),_:1})]),_:1})]),_:1})):r("",!0),t(H,{class:"ms-2",color:"secondary",density:"compact",variant:"outlined",disabled:!u.value||!u.value.isColumnMappingSet(e(La).Amount)},{default:a(()=>[o("span",null,i(e(s)("Amount Format")),1),u.value&&u.value.isColumnMappingSet(e(La).Amount)?(l(),g("span",oy,"("+i(e(eo).valueOf(u.value.amountFormat||B.value||"")?.format||e(s)("Unknown"))+")",1)):r("",!0),t(mt,{eager:"",activator:"parent",location:"bottom","max-height":"500"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{key:"auto","append-icon":u.value.amountFormat===""?e(Xe):void 0,onClick:Y[3]||(Y[3]=O=>u.value.amountFormat="")},{default:a(()=>[t(rt,{class:"cursor-pointer"},{default:a(()=>[o("span",null,i(e(s)("Auto detect")),1),o("span",sy,"("+i(oe.value)+")",1)]),_:1})]),_:1},8,["append-icon"]),(l(!0),g(fe,null,$e(e(eo).values(),O=>(l(),c(ve,{key:O.type,"append-icon":u.value.amountFormat===O.type?e(Xe):void 0,onClick:J=>u.value.amountFormat=O.type},{default:a(()=>[t(rt,{class:"cursor-pointer"},{default:a(()=>[q(i(O.format),1)]),_:2},1024)]),_:2},1032,["append-icon","onClick"]))),128))]),_:1})]),_:1})]),_:1},8,["disabled"]),u.value&&u.value.isColumnMappingSet(e(La).GeographicLocation)?(l(),c(H,{key:1,class:"ms-2",color:"secondary",density:"compact",variant:"outlined"},{default:a(()=>[o("span",null,i(e(s)("Geographic Location Separator")),1),u.value.geoLocationOrder?(l(),g("span",iy,"("+i(u.value.formatGeoLocation(e(s)("Latitude"),e(s)("Longitude")))+")",1)):r("",!0),t(mt,{eager:"",activator:"parent",location:"bottom","max-height":"500","close-on-content-click":!1},{default:a(()=>[t(Je,{class:"pa-0"},{default:a(()=>[t(ve,{class:"pa-0"},{default:a(()=>[t(sl,{class:"transaction-types-popup-menu"},{default:a(()=>[o("tbody",null,[(l(!0),g(fe,null,$e(V.value,O=>(l(),g("tr",{key:O.value},[o("td",null,i(O.name)+" ("+i(O.value)+")",1),o("td",null,[u.value.geoLocationSeparator===O.value?(l(),c(Ul,{key:0,class:"toggle-buttons",density:"compact",variant:"outlined",mandatory:"force",divided:"",modelValue:u.value.geoLocationOrder,"onUpdate:modelValue":Y[4]||(Y[4]=J=>u.value.geoLocationOrder=J)},{default:a(()=>[t(H,{value:"latlon"},{default:a(()=>[q(i(`${e(s)("Latitude")}${O.value}${e(s)("Longitude")}`),1)]),_:2},1024),t(H,{value:"lonlat"},{default:a(()=>[q(i(`${e(s)("Longitude")}${O.value}${e(s)("Latitude")}`),1)]),_:2},1024)]),_:2},1032,["modelValue"])):r("",!0),u.value.geoLocationSeparator!==O.value?(l(),c(Gl,{key:1,class:"toggle-buttons",density:"compact",variant:"outlined",divided:""},{default:a(()=>[t(H,{onClick:J=>u.value.setGeoLocationFormat(O.value,"latlon")},{default:a(()=>[q(i(`${e(s)("Latitude")}${O.value}${e(s)("Longitude")}`),1)]),_:2},1032,["onClick"]),t(H,{onClick:J=>u.value.setGeoLocationFormat(O.value,"lonlat")},{default:a(()=>[q(i(`${e(s)("Longitude")}${O.value}${e(s)("Latitude")}`),1)]),_:2},1032,["onClick"])]),_:2},1024)):r("",!0)])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):r("",!0),u.value&&u.value.isColumnMappingSet(e(La).Tags)?(l(),c(H,{key:2,class:"ms-2",color:"secondary",density:"compact",variant:"outlined"},{default:a(()=>[o("span",null,i(e(s)("Transaction Tags Separator")),1),u.value.tagSeparator?(l(),g("span",ry,"("+i(u.value.tagSeparator)+")",1)):r("",!0),t(mt,{eager:"",activator:"parent",location:"bottom","max-height":"500"},{default:a(()=>[t(Je,null,{default:a(()=>[(l(!0),g(fe,null,$e(V.value,O=>(l(),c(ve,{key:O.value,"append-icon":u.value.tagSeparator===O.value?e(Xe):void 0,onClick:J=>u.value.tagSeparator=O.value},{default:a(()=>[t(rt,{class:"cursor-pointer"},{default:a(()=>[q(i(O.name)+" ("+i(O.value)+") ",1)]),_:2},1024)]),_:2},1032,["append-icon","onClick"]))),128))]),_:1})]),_:1})]),_:1})):r("",!0),t(it),o("span",null,i(e(s)("Lines Per Page")),1),t(Ge,{class:"ms-2",density:"compact","max-width":"100","item-title":"name","item-value":"value",disabled:!!v.disabled,items:w.value,modelValue:x.value,"onUpdate:modelValue":Y[5]||(Y[5]=O=>x.value=O)},null,8,["disabled","items","modelValue"]),t(jn,{density:"compact",disabled:!!v.disabled,totalPageCount:Math.ceil((A.value?A.value.length:0)/x.value),modelValue:b.value,"onUpdate:modelValue":Y[6]||(Y[6]=O=>b.value=O)},null,8,["disabled","totalPageCount","modelValue"])])):r("",!0)]),_:1},8,["class","height","headers","items","no-data-text","items-per-page","page"]),t(ct,{ref_key:"snackbar",ref:f},null,512)],64))}}),dy={class:"d-flex w-100 mb-2"},cy={class:"d-flex w-100 mb-2"},my={class:"w-100 code-container"},py=Oe({__name:"ImportTransactionExecuteCustomScriptTab",props:{parsedFileData:{},disabled:{type:Boolean}},setup(v,{expose:_}){const n=v,{tt:s,getCurrentNumeralSystemType:h,formatDateTimeToGregorianDefaultDateTime:d}=je(),y=Ya(),f=xe("sandbox"),b=xe("snackbar"),x=P(!1),u=P(""),m=P(void 0),k=P(!1),N=P(""),V=P(10),p=E(()=>y.appSettings.timeZone||Xu()),T=E(()=>h()),A=E(()=>j(m.value?.length)),w=E(()=>`// ${s("sample.importTransactionCustomScript.headerComment")}
/**
 * ${s("sample.importTransactionCustomScript.functionDescription")}
 * @param {array} row - ${s("sample.importTransactionCustomScript.functionParamRowDescription")}
 * @param {number} index - ${s("sample.importTransactionCustomScript.functionParamIndexDescription")}
 * @returns {object|null} ${s("sample.importTransactionCustomScript.functionReturnDescription")}
 */
function parse(row, index) {
    if (index < 1) {
        return null;
    }

    return {
        // ${s("sample.importTransactionCustomScript.fieldTimeDescription")}
        time: row[0],
        // ${s("sample.importTransactionCustomScript.fieldUtcOffsetDescription")}
        utcOffset: ${p.value?"parseUtcOffset('"+p.value+"')":"'"+Ln(Bn())+"'"},
        // ${s("sample.importTransactionCustomScript.fieldTypeDescription")}
        type: TransactionType.Expense,
        // ${s("sample.importTransactionCustomScript.fieldCategoryNameDescription")}
        categoryName: row[4],
        // ${s("sample.importTransactionCustomScript.fieldSourceAccountNameDescription")}
        sourceAccountName: row[5],
        // ${s("sample.importTransactionCustomScript.fieldDestinationAccountNameDescription")}
        destinationAccountName: row[8],
        // ${s("sample.importTransactionCustomScript.fieldSourceAmountDescription")}
        sourceAmount: row[7],
        // ${s("sample.importTransactionCustomScript.fieldDestinationAmountDescription")}
        destinationAmount: row[10],
        // ${s("sample.importTransactionCustomScript.fieldGeoLocationDescription")}
        geoLocation: undefined,
        // ${s("sample.importTransactionCustomScript.fieldTagNamesDescription")}
        tagNames: '',
        // ${s("sample.importTransactionCustomScript.fieldCommentDescription")}
        description: row[13]
    };
}`),I=E(()=>{if(k.value)return s("Executing Script...");if(N.value)return N.value;if(m.value)if(V.value>0){const C=m.value.slice(0,V.value);return JSON.stringify(C,null,2)}else return JSON.stringify(m.value,null,2);else return s("No Preview Result")}),F=E(()=>[{prependIcon:es,title:s("Load Script File"),onClick:W},{prependIcon:ts,title:s("Save Script File"),onClick:D}]);function S(C){return T.value.formatNumber(C)}function j(C){const M=[];C||(C=0);for(const ee of[10,50,100]){if(ee>10&&ee>V.value&&C<ee)break;M.push({value:ee,name:S(ee)})}return M.push({value:-1,name:s("All")}),M}function B(){x.value=!1,f.value&&(f.value.src="about:blank",f.value.srcdoc=`
            <script>
                window.TransactionType = {
                    Income: 'Income',
                    Expense: 'Expense',
                    Transfer: 'Transfer'
                };

                window.parseDateTime = function(dateTime, format) {
                    return {
                        dateTime: dateTime,
                        format: format
                    };
                };

                window.parseUtcOffset = function(timezoneName) {
                    return {
                        name: timezoneName
                    };
                };

                window.addEventListener('message', function (event) {
                    try {
                        const data = JSON.parse(event.data);
                        const parsedFileData = data.parsedFileData;
                        eval(data.code);

                        if (window.parse) {
                            const result = [];

                            for (let i = 0; i < parsedFileData.length; i++) {
                                try {
                                    const row = parsedFileData[i];
                                    const transaction = window.parse(row, i);

                                    if (transaction) {
                                        result.push(transaction);
                                    }
                                } catch (error) {
                                    window.parent.postMessage({ error: error.message }, '*');
                                    return;
                                }
                            }

                            window.parent.postMessage({ result: JSON.stringify(result) }, '*');
                        } else {
                            window.parent.postMessage({ knownError: 'No parse function defined' }, '*');
                        }
                    } catch (error) {
                        window.parent.postMessage({ error: error.message }, '*');
                    }
                });
            <\/script>
        `,f.value.onload=()=>{x.value=!0})}function U(){if(!f.value||n.disabled||k.value)return;k.value=!0;const C={parsedFileData:n.parsedFileData||[],code:u.value+`

;if (typeof parse !== 'undefined') { window.parse = parse; }`};f.value?.contentWindow?.postMessage(JSON.stringify(C),"*")}function X(){if(!m.value){b.value?.showError("Please execute the custom script first");return}const C={transactions:m.value};return JSON.stringify(C)}function oe(){u.value=w.value,m.value=void 0,N.value="",k.value=!1,V.value=10}function W(){ds({allowedExtensions:Bt.JS.contentType}).then(C=>{u.value=C}).catch(C=>{Xt.error("Failed to load script file",C),b.value?.showError("Cannot load script file")})}function D(){const C=Bt.JS.formatFileName(s("dataExport.defaultImportHandlingScript"));tn(C,Bt.JS.createBlob(u.value))}function $(C){if(C.source!==f.value?.contentWindow)return;k.value=!1;const M=C.data;if(M.knownError)b.value?.showError(M.knownError),m.value=void 0,N.value=`// ${s(M.knownError)}`;else if(M.error)Xt.error("Failed to execute custom script: "+M.error),b.value?.showError("Failed to execute custom script"),m.value=void 0,N.value=`// ${M.error}`;else if(M.result){const ee=JSON.parse(M.result),ye=[];for(const L of ee){let Y="",O,J="";if(Va(L.time)){Y=String(L.time);const Z=bi(Y,fo.DefaultDateTime);Z&&fo.DefaultDateTime.isValid(Y)&&(O=Z.getUnixTime())}else if(zl(L.time)&&Ht(L.time.dateTime)&&Ht(L.time.format)){const Z=String(L.time.dateTime),le=String(L.time.format),z=ed(Z,le);if(z&&(Y=d(z),O=z.getUnixTime()),!Ht(O)){Xt.error('Failed to parse time "'+Z+'" with custom format "'+le+'"'),b.value?.showError("Failed to parse time"),m.value=void 0,N.value=`// ${s("Failed to parse time")} "${Z}"`;return}}if(!Ht(O)){Xt.error('Failed to parse time "'+L.time+'"'),b.value?.showError("Failed to parse time"),m.value=void 0,N.value=`// ${s("Failed to parse time")} "${L.time}"`;return}if(Va(L.utcOffset))J=String(L.utcOffset);else if(zl(L.utcOffset)&&Ht(L.utcOffset.name)){const Z=String(L.utcOffset.name);J=Ln(O,Z).toString(10)}const ae={time:Y,utcOffset:J,type:Ht(L.type)?String(L.type):"",categoryName:Ht(L.categoryName)&&L.categoryName!==""?String(L.categoryName):void 0,sourceAccountName:Ht(L.sourceAccountName)&&L.sourceAccountName!==""?String(L.sourceAccountName):void 0,destinationAccountName:Ht(L.destinationAccountName)&&L.destinationAccountName!==""?String(L.destinationAccountName):void 0,sourceAmount:Ht(L.sourceAmount)?String(L.sourceAmount):"",destinationAmount:Ht(L.destinationAmount)&&L.destinationAmount!==""?String(L.destinationAmount):void 0,geoLocation:Ht(L.geoLocation)&&L.geoLocation?String(L.geoLocation):void 0,tagNames:Ht(L.tagNames)&&L.tagNames?String(L.tagNames):void 0,comment:Ht(L.description)&&L.description?String(L.description):void 0};ye.push(ae)}m.value=ye,N.value=""}B()}return Go(()=>{u.value=w.value,B(),window.addEventListener("message",$)}),ji(()=>{window.removeEventListener("message",$)}),_({menus:F,generateResult:X,reset:oe}),(C,M)=>(l(),g(fe,null,[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[o("div",dy,[t(H,{density:"compact",variant:"tonal","prepend-icon":e(hr),disabled:v.disabled||!x.value||k.value,loading:k.value,onClick:M[0]||(M[0]=ee=>U())},{loader:a(()=>[t(Ze,{indeterminate:"",size:"18",class:"me-1"}),o("span",null,i(e(s)("Execute Custom Script")),1)]),default:a(()=>[o("span",null,i(e(s)("Execute Custom Script")),1)]),_:1},8,["prepend-icon","disabled","loading"])]),t(Oa,{class:"w-100",style:{height:"360px"},readonly:v.disabled,modelValue:u.value,"onUpdate:modelValue":M[1]||(M[1]=ee=>u.value=ee)},null,8,["readonly","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[o("div",cy,[t(H,{density:"compact",color:"default",variant:"text",disabled:v.disabled||!x.value||k.value||!m.value},{default:a(()=>[o("span",null,i(e(s)("format.misc.previewCount",{count:V.value>0?S(V.value):e(s)("All")})),1),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[(l(!0),g(fe,null,$e(A.value,ee=>(l(),c(ve,{key:ee.value,title:ee.name,onClick:ye=>V.value=ee.value},null,8,["title","onClick"]))),128))]),_:1})]),_:1})]),_:1},8,["disabled"])]),o("div",my,[t(Oa,{class:"w-100 always-cursor-text",style:{height:"360px"},readonly:!0,color:N.value?"error":void 0,value:I.value},null,8,["color","value"])])]),_:1})]),_:1}),o("iframe",{id:"sandbox",ref_key:"sandbox",ref:f,sandbox:"allow-scripts",style:{display:"none"}},null,512),t(ct,{ref_key:"snackbar",ref:b},null,512)],64))}}),vy={class:"d-flex flex-wrap align-center"},fy={key:0,class:"text-h4 text-wrap"},yy={key:1,class:"text-h4 text-wrap"},gy={key:2,class:"text-h4 text-wrap"},hy={key:3,class:"text-h4 text-wrap"},by={key:4,class:"text-h4 text-wrap"},Ty={key:5,class:"text-h4 text-wrap"},ky={key:6,class:"text-h4 text-wrap"},_y={key:7,class:"text-h4 text-wrap"},xy={key:8,class:"text-h4 text-wrap"},Cy={key:9,class:"text-h4 text-wrap"},wy={key:10,class:"text-h4 text-wrap"},Ay={key:11,class:"text-h4 text-wrap"},Sy={class:"d-flex align-center"},Vy={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},Iy=Oe({__name:"BatchReplaceDialog",setup(v,{expose:_}){const{tt:n,getCategorizedAccountsWithDisplayBalance:s}=je(),h=Ya(),d=pa(),y=va(),f=rl(),b=xe("snackbar"),x=P(!1),u=P(!1),m=P(""),k=P(""),N=P([]),V=P([]),p=P(void 0),T=P(void 0),A=P(!1);let w=null,I=null;const F=E(()=>h.appSettings.showAccountBalance),S=E(()=>d.allPlainAccounts),j=E(()=>d.allVisiblePlainAccounts),B=E(()=>s(j.value,F.value)),U=E(()=>y.allTransactionCategories),X=E(()=>f.allTransactionTags),oe=E(()=>y.hasVisibleExpenseCategories),W=E(()=>y.hasVisibleIncomeCategories),D=E(()=>y.hasVisibleTransferCategories);function $(L){return L?Dl.findAccountNameById(S.value,L)||"":n("None")}function C(L){return m.value=L.mode,k.value=L.type,p.value=void 0,m.value==="replaceInvalidItems"?N.value=L.invalidItems:N.value=void 0,k.value==="tag"&&m.value==="batchReplace"?V.value=L.allSourceTagItems:V.value=void 0,T.value=void 0,A.value=!1,x.value=!0,new Promise((Y,O)=>{w=Y,I=O})}function M(){k.value==="expenseCategory"||k.value==="incomeCategory"||k.value==="transferCategory"?(u.value=!0,y.loadAllCategories({force:!0}).then(()=>{u.value=!1}).catch(L=>{u.value=!1,L.processed||b.value?.showError(L)})):k.value==="account"||k.value==="destinationAccount"?(u.value=!0,d.loadAllAccounts({force:!0}).then(()=>{u.value=!1}).catch(L=>{u.value=!1,L.processed||b.value?.showError(L)})):k.value==="tag"&&(u.value=!0,f.loadAllTags({force:!0}).then(()=>{u.value=!1}).catch(L=>{u.value=!1,L.processed||b.value?.showError(L)}))}function ee(){let L=T.value;k.value==="tag"&&A.value&&(L=void 0),m.value==="batchReplace"&&k.value!=="tag"?w?.({targetItem:L}):m.value==="batchReplace"&&k.value==="tag"?w?.({sourceItem:p.value,targetItem:L}):m.value==="batchAdd"?w?.({targetItem:L}):m.value==="replaceInvalidItems"&&w?.({sourceItem:p.value,targetItem:L}),x.value=!1}function ye(){I?.(),x.value=!1}return Ft(A,L=>{L&&(T.value=void 0)}),_({open:C}),(L,Y)=>{const O=Ve("two-column-select");return l(),g(fe,null,[t(xt,{width:"600",persistent:u.value||m.value==="replaceInvalidItems"&&!!p.value||!!T.value,modelValue:x.value,"onUpdate:modelValue":Y[10]||(Y[10]=J=>x.value=J)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",vy,[m.value==="batchReplace"&&k.value==="expenseCategory"?(l(),g("h4",fy,i(e(n)("Batch Replace Selected Expense Categories")),1)):r("",!0),m.value==="batchReplace"&&k.value==="incomeCategory"?(l(),g("h4",yy,i(e(n)("Batch Replace Selected Income Categories")),1)):r("",!0),m.value==="batchReplace"&&k.value==="transferCategory"?(l(),g("h4",gy,i(e(n)("Batch Replace Selected Transfer Categories")),1)):r("",!0),m.value==="batchReplace"&&k.value==="account"?(l(),g("h4",hy,i(e(n)("Batch Replace Selected Accounts")),1)):r("",!0),m.value==="batchReplace"&&k.value==="destinationAccount"?(l(),g("h4",by,i(e(n)("Batch Replace Selected Destination Accounts")),1)):r("",!0),m.value==="batchReplace"&&k.value==="tag"?(l(),g("h4",Ty,i(e(n)("Batch Replace Selected Transaction Tags")),1)):r("",!0),m.value==="batchAdd"&&k.value==="tag"?(l(),g("h4",ky,i(e(n)("Batch Add Transaction Tags")),1)):r("",!0),m.value==="replaceInvalidItems"&&k.value==="expenseCategory"?(l(),g("h4",_y,i(e(n)("Replace Invalid Expense Categories")),1)):r("",!0),m.value==="replaceInvalidItems"&&k.value==="incomeCategory"?(l(),g("h4",xy,i(e(n)("Replace Invalid Income Categories")),1)):r("",!0),m.value==="replaceInvalidItems"&&k.value==="transferCategory"?(l(),g("h4",Cy,i(e(n)("Replace Invalid Transfer Categories")),1)):r("",!0),m.value==="replaceInvalidItems"&&k.value==="account"?(l(),g("h4",wy,i(e(n)("Replace Invalid Accounts")),1)):r("",!0),m.value==="replaceInvalidItems"&&k.value==="tag"?(l(),g("h4",Ay,i(e(n)("Replace Invalid Transaction Tags")),1)):r("",!0),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,disabled:u.value,loading:u.value,onClick:M},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Refresh")),1)]),_:1})]),_:1},8,["disabled","loading"])])]),default:a(()=>[k.value==="expenseCategory"||k.value==="incomeCategory"||k.value==="transferCategory"?(l(),c(ge,{key:0,class:"w-100 d-flex justify-center"},{default:a(()=>[t(Ae,null,{default:a(()=>[m.value==="replaceInvalidItems"?(l(),c(R,{key:0,cols:"12"},{default:a(()=>[t(ua,{"item-title":"name","item-value":"value","persistent-placeholder":"",disabled:u.value,label:e(n)("Invalid Category"),placeholder:e(n)("Invalid Category"),items:N.value,"no-data-text":e(n)("No available category"),modelValue:p.value,"onUpdate:modelValue":Y[0]||(Y[0]=J=>p.value=J)},null,8,["disabled","label","placeholder","items","no-data-text","modelValue"])]),_:1})):r("",!0),t(R,{cols:"12"},{default:a(()=>[k.value==="expenseCategory"?(l(),c(O,{key:0,"primary-key-field":"id","primary-value-field":"id","primary-title-field":"name","primary-icon-field":"icon","primary-icon-type":"category","primary-color-field":"color","primary-hidden-field":"hidden","primary-sub-items-field":"subCategories","secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-icon-field":"icon","secondary-icon-type":"category","secondary-color-field":"color","secondary-hidden-field":"hidden",disabled:u.value||!oe.value,"enable-filter":!0,"filter-placeholder":e(n)("Find category"),"filter-no-items-text":e(n)("No available category"),"show-selection-primary-text":!0,"custom-selection-primary-text":e(Qa)(T.value,U.value[e(st).Expense]),"custom-selection-secondary-text":e($a)(T.value,U.value[e(st).Expense]),label:e(n)("Target Category"),placeholder:e(n)("Target Category"),items:U.value[e(st).Expense],modelValue:T.value,"onUpdate:modelValue":Y[1]||(Y[1]=J=>T.value=J)},null,8,["disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","custom-selection-secondary-text","label","placeholder","items","modelValue"])):r("",!0),k.value==="incomeCategory"?(l(),c(O,{key:1,"primary-key-field":"id","primary-value-field":"id","primary-title-field":"name","primary-icon-field":"icon","primary-icon-type":"category","primary-color-field":"color","primary-hidden-field":"hidden","primary-sub-items-field":"subCategories","secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-icon-field":"icon","secondary-icon-type":"category","secondary-color-field":"color","secondary-hidden-field":"hidden",disabled:u.value||!W.value,"enable-filter":!0,"filter-placeholder":e(n)("Find category"),"filter-no-items-text":e(n)("No available category"),"show-selection-primary-text":!0,"custom-selection-primary-text":e(Qa)(T.value,U.value[e(st).Income]),"custom-selection-secondary-text":e($a)(T.value,U.value[e(st).Income]),label:e(n)("Target Category"),placeholder:e(n)("Target Category"),items:U.value[e(st).Income],modelValue:T.value,"onUpdate:modelValue":Y[2]||(Y[2]=J=>T.value=J)},null,8,["disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","custom-selection-secondary-text","label","placeholder","items","modelValue"])):r("",!0),k.value==="transferCategory"?(l(),c(O,{key:2,"primary-key-field":"id","primary-value-field":"id","primary-title-field":"name","primary-icon-field":"icon","primary-icon-type":"category","primary-color-field":"color","primary-hidden-field":"hidden","primary-sub-items-field":"subCategories","secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-icon-field":"icon","secondary-icon-type":"category","secondary-color-field":"color","secondary-hidden-field":"hidden",disabled:u.value||!D.value,"enable-filter":!0,"filter-placeholder":e(n)("Find category"),"filter-no-items-text":e(n)("No available category"),"show-selection-primary-text":!0,"custom-selection-primary-text":e(Qa)(T.value,U.value[e(st).Transfer]),"custom-selection-secondary-text":e($a)(T.value,U.value[e(st).Transfer]),label:e(n)("Target Category"),placeholder:e(n)("Target Category"),items:U.value[e(st).Transfer],modelValue:T.value,"onUpdate:modelValue":Y[3]||(Y[3]=J=>T.value=J)},null,8,["disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","custom-selection-secondary-text","label","placeholder","items","modelValue"])):r("",!0)]),_:1})]),_:1})]),_:1})):r("",!0),k.value==="account"||k.value==="destinationAccount"?(l(),c(ge,{key:1,class:"w-100 d-flex justify-center"},{default:a(()=>[t(Ae,null,{default:a(()=>[m.value==="replaceInvalidItems"?(l(),c(R,{key:0,cols:"12"},{default:a(()=>[t(ua,{"item-title":"name","item-value":"value","persistent-placeholder":"",disabled:u.value,label:e(n)("Invalid Account"),placeholder:e(n)("Invalid Account"),items:N.value,"no-data-text":e(n)("No available account"),modelValue:p.value,"onUpdate:modelValue":Y[4]||(Y[4]=J=>p.value=J)},null,8,["disabled","label","placeholder","items","no-data-text","modelValue"])]),_:1})):r("",!0),t(R,{cols:"12"},{default:a(()=>[t(O,{"primary-key-field":"id","primary-value-field":"category","primary-title-field":"name","primary-footer-field":"displayBalance","primary-icon-field":"icon","primary-icon-type":"account","primary-sub-items-field":"accounts","primary-title-i18n":!0,"secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-footer-field":"displayBalance","secondary-icon-field":"icon","secondary-icon-type":"account","secondary-color-field":"color",disabled:u.value||!j.value.length,"enable-filter":!0,"filter-placeholder":e(n)("Find account"),"filter-no-items-text":e(n)("No available account"),"custom-selection-primary-text":$(T.value),label:e(n)("Target Account"),placeholder:e(n)("Target Account"),items:B.value,modelValue:T.value,"onUpdate:modelValue":Y[5]||(Y[5]=J=>T.value=J)},null,8,["disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1})):r("",!0),k.value==="tag"?(l(),c(ge,{key:2,class:"w-100 d-flex justify-center"},{default:a(()=>[t(Ae,null,{default:a(()=>[m.value==="batchReplace"?(l(),c(R,{key:0,cols:"12"},{default:a(()=>[t(ua,{"item-title":"name","item-value":"value","persistent-placeholder":"",disabled:u.value,label:e(n)("Source Value"),placeholder:e(n)("Source Value"),items:V.value,"no-data-text":e(n)("No available tag"),modelValue:p.value,"onUpdate:modelValue":Y[6]||(Y[6]=J=>p.value=J)},null,8,["disabled","label","placeholder","items","no-data-text","modelValue"])]),_:1})):r("",!0),m.value==="replaceInvalidItems"?(l(),c(R,{key:1,cols:"12"},{default:a(()=>[t(ua,{"item-title":"name","item-value":"value","persistent-placeholder":"",disabled:u.value,label:e(n)("Invalid Tag"),placeholder:e(n)("Invalid Tag"),items:N.value,"no-data-text":e(n)("No available tag"),modelValue:p.value,"onUpdate:modelValue":Y[7]||(Y[7]=J=>p.value=J)},null,8,["disabled","label","placeholder","items","no-data-text","modelValue"])]),_:1})):r("",!0),t(R,{cols:"12"},{default:a(()=>[t(ua,{"item-title":"name","item-value":"id","persistent-placeholder":"",chips:"",disabled:u.value||A.value,label:e(n)("Target Tag"),placeholder:e(n)("Target Tag"),items:X.value,"no-data-text":e(n)("No available tag"),modelValue:T.value,"onUpdate:modelValue":Y[8]||(Y[8]=J=>T.value=J)},{chip:a(({props:J,item:ae})=>[t(Jt,_t({"prepend-icon":e(ea),text:ae.title},J),null,16,["prepend-icon","text"])]),item:a(({props:J,item:ae})=>[ae.raw.hidden?r("",!0):(l(),c(ve,_t({key:0,value:ae.value},J),{title:a(()=>[t(rt,null,{default:a(()=>[o("div",Sy,[t(ie,{size:"20",start:"",icon:e(ea)},null,8,["icon"]),o("span",null,i(ae.title),1)])]),_:2},1024)]),_:2},1040,["value"]))]),_:1},8,["disabled","label","placeholder","items","no-data-text","modelValue"])]),_:1}),m.value==="batchReplace"||m.value==="replaceInvalidItems"?(l(),c(R,{key:2,cols:"12",class:"pt-0"},{default:a(()=>[t(Ea,{disabled:u.value,label:e(n)("Remove Tag"),modelValue:A.value,"onUpdate:modelValue":Y[9]||(Y[9]=J=>A.value=J)},null,8,["disabled","label","modelValue"])]),_:1})):r("",!0)]),_:1})]),_:1})):r("",!0),t(ge,null,{default:a(()=>[o("div",Vy,[t(H,{disabled:u.value||(m.value==="replaceInvalidItems"||m.value==="batchReplace"&&k.value==="tag")&&!p.value&&p.value!==""||!T.value&&T.value!==""&&!A.value,onClick:ee},{default:a(()=>[q(i(e(n)("OK")),1)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",disabled:u.value,onClick:ye},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["persistent","modelValue"]),t(ct,{ref_key:"snackbar",ref:b},null,512)],64)}}}),Dy={class:"d-flex flex-wrap align-center justify-center"},$y={class:"d-flex flex-wrap align-center"},Ny={class:"text-h4 text-wrap"},Fy={class:"text-left"},Ey={class:"text-left"},My={class:"text-left"},Uy={class:"text-right"},Py={class:"text-left"},By={class:"text-left"},Ly={class:"text-left"},zy={class:"text-right"},Oy={style:{"background-color":"rgb(var(--v-theme-surface))"}},Ry={class:"d-flex align-center"},qy={class:"text-right"},Yy={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},jy=Oe({__name:"BatchReplaceAllTypesDialog",setup(v,{expose:_}){const{tt:n,getCategorizedAccountsWithDisplayBalance:s}=je(),h=Ya(),d=pa(),y=va(),f=rl(),b=xe("snackbar"),x=P(!1),u=P(!1),m=P([]),k=P(Vo.of("expenseCategory","","")),N=P([]),V=P([]),p=P([]),T=P([]),A=P([]);let w=null,I=null;const F=E(()=>h.appSettings.showAccountBalance),S=E(()=>d.allPlainAccounts),j=E(()=>d.allVisiblePlainAccounts),B=E(()=>s(j.value,F.value)),U=E(()=>y.allTransactionCategories),X=E(()=>f.allTransactionTags),oe=E(()=>y.hasVisibleExpenseCategories),W=E(()=>y.hasVisibleIncomeCategories),D=E(()=>y.hasVisibleTransferCategories),$=E(()=>{switch(k.value.dataType){case"expenseCategory":return N.value;case"incomeCategory":return V.value;case"transferCategory":return p.value;case"account":return T.value;case"tag":return A.value;default:return[]}}),C=E(()=>{switch(k.value.dataType){case"expenseCategory":return n("No available category");case"incomeCategory":return n("No available category");case"transferCategory":return n("No available category");case"account":return n("No available account");case"tag":return n("No available tag");default:return""}});function M(se){switch(se.dataType){case"expenseCategory":return n("Expense Category");case"incomeCategory":return n("Income Category");case"transferCategory":return n("Transfer Category");case"account":return n("Account");case"tag":return n("Transaction Tag");default:return""}}function ee(se){switch(se.dataType){case"expenseCategory":return $a(se.targetId,U.value[st.Expense])||"";case"incomeCategory":return $a(se.targetId,U.value[st.Income])||"";case"transferCategory":return $a(se.targetId,U.value[st.Transfer])||"";case"account":return ye(se.targetId);case"tag":for(const ue of X.value)if(ue.id===se.targetId)return ue.name;return"";default:return""}}function ye(se){return se?Dl.findAccountNameById(S.value,se)||"":n("None")}function L(se){return m.value=[],k.value=Vo.of("expenseCategory","",""),N.value=se.expenseCategoryNames,V.value=se.incomeCategoryNames,p.value=se.transferCategoryNames,T.value=se.accountNames,A.value=se.tagNames,x.value=!0,new Promise((ue,Ee)=>{w=ue,I=Ee})}function Y(){u.value=!0,Promise.all([d.loadAllAccounts({force:!0}),y.loadAllCategories({force:!0}),f.loadAllTags({force:!0})]).then(()=>{u.value=!1}).catch(se=>{u.value=!1,se.processed||b.value?.showError(se)})}function O(){ds({allowedExtensions:Bt.JSON.contentType}).then(se=>{const ue=ws.parseFromJson(se);ue?m.value=ue.getRules():(Xt.error("Failed to parse replace rule file"),b.value?.showError("Replace rule file is invalid"))}).catch(se=>{Xt.error("Failed to open replace rule file",se),b.value?.showError("Replace rule file is invalid")})}function J(){const se=Bt.JSON.formatFileName(n("dataExport.defaultImportReplaceRuleFileName"));tn(se,Bt.JSON.createBlob(ws.of(m.value).toJson()))}function ae(se){m.value.splice(se,1)}function Z(){!k.value.dataType||!k.value.targetId||(m.value.push(k.value),k.value=Vo.of("expenseCategory","",""))}function le(){w?.({rules:m.value}),x.value=!1}function z(){I?.(),x.value=!1}return _({open:L}),(se,ue)=>{const Ee=Ve("two-column-select");return l(),g(fe,null,[t(xt,{width:"1000",persistent:u.value||!!m.value.length||!!k.value.targetId,modelValue:x.value,"onUpdate:modelValue":ue[11]||(ue[11]=me=>x.value=me)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",Dy,[o("div",$y,[o("h4",Ny,i(e(n)("Batch Replace Categories / Accounts / Tags")),1),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,disabled:u.value,loading:u.value,onClick:Y},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Refresh")),1)]),_:1})]),_:1},8,["disabled","loading"])]),t(it),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",icon:!0,disabled:u.value},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent","max-height":"500"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{"prepend-icon":e(es),title:e(n)("Load Replace Rule File"),onClick:ue[0]||(ue[0]=me=>O())},null,8,["prepend-icon","title"]),t(ve,{"prepend-icon":e(ts),title:e(n)("Save Replace Rule File"),onClick:ue[1]||(ue[1]=me=>J())},null,8,["prepend-icon","title"])]),_:1})]),_:1})]),_:1},8,["disabled"])])]),default:a(()=>[t(ge,{class:"w-100 d-flex justify-center"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(sl,{density:"comfortable","fixed-header":"","fixed-footer":"",height:"400",striped:"even"},{default:a(()=>[o("thead",null,[o("tr",null,[o("th",Fy,i(e(n)("Type")),1),o("th",Ey,i(e(n)("Source Value")),1),o("th",My,i(e(n)("Target Value")),1),o("th",Uy,i(e(n)("Operation")),1)])]),o("tbody",null,[(l(!0),g(fe,null,$e(m.value,(me,te)=>(l(),g("tr",{key:te},[o("td",Py,i(M(me)),1),o("td",By,i(me.sourceValue||e(n)("(Empty)")),1),o("td",Ly,i(ee(me)),1),o("td",zy,[t(H,{density:"comfortable",variant:"tonal",color:"error",disabled:u.value,onClick:Se=>ae(te)},{default:a(()=>[q(i(e(n)("Delete")),1)]),_:1},8,["disabled","onClick"])])]))),128))]),o("tfoot",null,[o("tr",Oy,[o("td",null,[t(Ge,{class:"w-100",density:"compact",variant:"underlined","item-title":"name","item-value":"value",disabled:u.value,items:[{value:"expenseCategory",name:e(n)("Expense Category")},{value:"incomeCategory",name:e(n)("Income Category")},{value:"transferCategory",name:e(n)("Transfer Category")},{value:"account",name:e(n)("Account")},{value:"tag",name:e(n)("Transaction Tag")}],modelValue:k.value.dataType,"onUpdate:modelValue":[ue[2]||(ue[2]=me=>k.value.dataType=me),ue[3]||(ue[3]=me=>{k.value.sourceValue="",k.value.targetId=""})]},null,8,["disabled","items","modelValue"])]),o("td",null,[t(ua,{class:"w-100",density:"compact",variant:"underlined","item-title":"name","item-value":"value","persistent-placeholder":"",disabled:u.value,items:$.value,"no-data-text":C.value,modelValue:k.value.sourceValue,"onUpdate:modelValue":ue[4]||(ue[4]=me=>k.value.sourceValue=me)},null,8,["disabled","items","no-data-text","modelValue"])]),o("td",null,[k.value.dataType==="expenseCategory"?(l(),c(Ee,{key:0,density:"compact",variant:"underlined","primary-key-field":"id","primary-value-field":"id","primary-title-field":"name","primary-icon-field":"icon","primary-icon-type":"category","primary-color-field":"color","primary-hidden-field":"hidden","primary-sub-items-field":"subCategories","secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-icon-field":"icon","secondary-icon-type":"category","secondary-color-field":"color","secondary-hidden-field":"hidden",disabled:u.value||!oe.value,"enable-filter":!0,"filter-placeholder":e(n)("Find category"),"filter-no-items-text":e(n)("No available category"),"show-selection-primary-text":!0,"custom-selection-primary-text":e(Qa)(k.value.targetId,U.value[e(st).Expense]),"custom-selection-secondary-text":e($a)(k.value.targetId,U.value[e(st).Expense]),items:U.value[e(st).Expense],modelValue:k.value.targetId,"onUpdate:modelValue":ue[5]||(ue[5]=me=>k.value.targetId=me)},null,8,["disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","custom-selection-secondary-text","items","modelValue"])):r("",!0),k.value.dataType==="incomeCategory"?(l(),c(Ee,{key:1,density:"compact",variant:"underlined","primary-key-field":"id","primary-value-field":"id","primary-title-field":"name","primary-icon-field":"icon","primary-icon-type":"category","primary-color-field":"color","primary-hidden-field":"hidden","primary-sub-items-field":"subCategories","secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-icon-field":"icon","secondary-icon-type":"category","secondary-color-field":"color","secondary-hidden-field":"hidden",disabled:u.value||!W.value,"enable-filter":!0,"filter-placeholder":e(n)("Find category"),"filter-no-items-text":e(n)("No available category"),"show-selection-primary-text":!0,"custom-selection-primary-text":e(Qa)(k.value.targetId,U.value[e(st).Income]),"custom-selection-secondary-text":e($a)(k.value.targetId,U.value[e(st).Income]),items:U.value[e(st).Income],modelValue:k.value.targetId,"onUpdate:modelValue":ue[6]||(ue[6]=me=>k.value.targetId=me)},null,8,["disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","custom-selection-secondary-text","items","modelValue"])):r("",!0),k.value.dataType==="transferCategory"?(l(),c(Ee,{key:2,density:"compact",variant:"underlined","primary-key-field":"id","primary-value-field":"id","primary-title-field":"name","primary-icon-field":"icon","primary-icon-type":"category","primary-color-field":"color","primary-hidden-field":"hidden","primary-sub-items-field":"subCategories","secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-icon-field":"icon","secondary-icon-type":"category","secondary-color-field":"color","secondary-hidden-field":"hidden",disabled:u.value||!D.value,"enable-filter":!0,"filter-placeholder":e(n)("Find category"),"filter-no-items-text":e(n)("No available category"),"show-selection-primary-text":!0,"custom-selection-primary-text":e(Qa)(k.value.targetId,U.value[e(st).Transfer]),"custom-selection-secondary-text":e($a)(k.value.targetId,U.value[e(st).Transfer]),items:U.value[e(st).Transfer],modelValue:k.value.targetId,"onUpdate:modelValue":ue[7]||(ue[7]=me=>k.value.targetId=me)},null,8,["disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","custom-selection-secondary-text","items","modelValue"])):r("",!0),k.value.dataType==="account"?(l(),c(Ee,{key:3,density:"compact",variant:"underlined","primary-key-field":"id","primary-value-field":"category","primary-title-field":"name","primary-footer-field":"displayBalance","primary-icon-field":"icon","primary-icon-type":"account","primary-sub-items-field":"accounts","primary-title-i18n":!0,"secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-footer-field":"displayBalance","secondary-icon-field":"icon","secondary-icon-type":"account","secondary-color-field":"color",disabled:u.value||!j.value.length,"enable-filter":!0,"filter-placeholder":e(n)("Find account"),"filter-no-items-text":e(n)("No available account"),"custom-selection-primary-text":ye(k.value.targetId),items:B.value,modelValue:k.value.targetId,"onUpdate:modelValue":ue[8]||(ue[8]=me=>k.value.targetId=me)},null,8,["disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","items","modelValue"])):r("",!0),k.value.dataType=="tag"?(l(),c(ua,{key:4,density:"compact",variant:"underlined","item-title":"name","item-value":"id","persistent-placeholder":"",chips:"",disabled:u.value,items:X.value,"no-data-text":e(n)("No available tag"),modelValue:k.value.targetId,"onUpdate:modelValue":ue[9]||(ue[9]=me=>k.value.targetId=me)},{chip:a(({props:me,item:te})=>[k.value.targetId?(l(),c(Jt,_t({key:0,"prepend-icon":e(ea),text:te.title},me),null,16,["prepend-icon","text"])):r("",!0)]),item:a(({props:me,item:te})=>[te.raw.hidden?r("",!0):(l(),c(ve,_t({key:0,value:te.value},me),{title:a(()=>[t(rt,null,{default:a(()=>[o("div",Ry,[t(ie,{size:"20",start:"",icon:e(ea)},null,8,["icon"]),o("span",null,i(te.title),1)])]),_:2},1024)]),_:2},1040,["value"]))]),_:1},8,["disabled","items","no-data-text","modelValue"])):r("",!0)]),o("td",qy,[t(H,{density:"comfortable",variant:"tonal",color:"primary",disabled:u.value||!k.value.dataType||!k.value.targetId,onClick:ue[10]||(ue[10]=me=>Z())},{default:a(()=>[q(i(e(n)("Add Rule")),1)]),_:1},8,["disabled"])])])])]),_:1})]),_:1})]),_:1})]),_:1}),t(ge,null,{default:a(()=>[o("div",Yy,[t(H,{disabled:u.value,onClick:le},{default:a(()=>[q(i(e(n)("OK")),1)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",disabled:u.value,onClick:z},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["persistent","modelValue"]),t(ct,{ref_key:"snackbar",ref:b},null,512)],64)}}}),Hy={class:"d-flex flex-wrap"},Wy={key:0,class:"text-h4 text-wrap"},Gy={key:1,class:"text-h4 text-wrap"},Ky={key:2,class:"text-h4 text-wrap"},Qy={key:3,class:"text-h4 text-wrap"},Jy={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},Zy=Oe({__name:"BatchCreateDialog",setup(v,{expose:_}){const{tt:n}=je(),s=va(),h=rl(),d=xe("snackbar"),y=P(!1),f=P(!1),b=P(""),x=P([]),u=P([]);let m=null,k=null;function N(j,B){const U=[];for(const X of u.value)(X!==j||B)&&U.push(X);B&&U.push(j),u.value=U}function V(j){const B={},U={};for(const oe of x.value||[])B[oe.name]=oe.value;for(const oe of cs(j))for(const W of oe)if(!(!W.subCategories||W.subCategories.length<1))for(const D of W.subCategories){const $=B[D.name];Ht($)&&(U[$]=D.id)}return{sourceTargetMap:U}}function p(j){const B={},U={};for(const oe of x.value||[])B[oe.name]=oe.value;for(const oe of j){const W=B[oe.name];Ht(W)&&(U[W]=oe.id)}return{sourceTargetMap:U}}function T(j){return b.value=j.type,x.value=j.invalidItems,u.value=[],y.value=!0,new Promise((B,U)=>{m=B,k=U})}function A(){u.value=(x.value||[]).map(j=>j.name)}function w(){u.value=[]}function I(){const j=cn(u.value,!0);u.value=[];for(const B of x.value||[])j[B.name]||u.value.push(B.name)}function F(){if(b.value==="expenseCategory"||b.value==="incomeCategory"||b.value==="transferCategory"){f.value=!0;let j=st.Expense,B="";b.value==="expenseCategory"?(j=st.Expense,B=n("Default Expense Category")):b.value==="incomeCategory"?(j=st.Income,B=n("Default Income Category")):b.value==="transferCategory"&&(j=st.Transfer,B=n("Default Transfer Category"));const U=[];for(const oe of u.value){const W=jo.createNewCategory(j);W.name=oe,W.icon=As,U.push(W.toCreateRequest(""))}const X=[{name:B,type:j,icon:As,color:td,subCategories:U}];s.addCategories({categories:X}).then(oe=>{s.loadAllCategories({force:!1}).then(()=>{f.value=!1,y.value=!1,m?.(V(oe))}).catch(W=>{f.value=!1,W.processed||d.value?.showError(W)})}).catch(oe=>{f.value=!1,oe.processed||d.value?.showError(oe)})}else if(b.value==="tag"){f.value=!0;const j=[];for(const B of u.value){const U=vo.createNewTag(B);j.push(U.toCreateRequest())}h.addTags({tags:j,skipExists:!0}).then(B=>{h.loadAllTags({force:!1}).then(()=>{f.value=!1,y.value=!1,m?.(p(B))}).catch(U=>{f.value=!1,U.processed||d.value?.showError(U)})}).catch(B=>{f.value=!1,B.processed||d.value?.showError(B)})}}function S(){k?.(),y.value=!1}return _({open:T}),(j,B)=>(l(),g(fe,null,[t(xt,{width:"600",persistent:f.value||!!u.value.length,modelValue:y.value,"onUpdate:modelValue":B[1]||(B[1]=U=>y.value=U)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",Hy,[b.value==="expenseCategory"?(l(),g("h4",Wy,i(e(n)("Create Nonexistent Expense Categories")),1)):r("",!0),b.value==="incomeCategory"?(l(),g("h4",Gy,i(e(n)("Create Nonexistent Income Categories")),1)):r("",!0),b.value==="transferCategory"?(l(),g("h4",Ky,i(e(n)("Create Nonexistent Transfer Categories")),1)):r("",!0),b.value==="tag"?(l(),g("h4",Qy,i(e(n)("Create Nonexistent Transaction Tags")),1)):r("",!0),t(it),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",disabled:f.value||!x.value||!x.value.length,icon:!0},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{"prepend-icon":e(nl),title:e(n)("Select All"),disabled:!x.value||!x.value.length,onClick:A},null,8,["prepend-icon","title","disabled"]),t(ve,{"prepend-icon":e(vn),title:e(n)("Select None"),disabled:!x.value||!x.value.length,onClick:w},null,8,["prepend-icon","title","disabled"]),t(ve,{"prepend-icon":e(fn),title:e(n)("Invert Selection"),disabled:!x.value||!x.value.length,onClick:I},null,8,["prepend-icon","title","disabled"])]),_:1})]),_:1})]),_:1},8,["disabled"])])]),default:a(()=>[t(ge,{class:"d-flex flex-column flex-md-row flex-grow-1 overflow-y-auto"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",class:"px-0"},{default:a(()=>[t(Je,{class:"py-0",density:"compact","select-strategy":"classic",disabled:f.value,selected:u.value,"onUpdate:selected":B[0]||(B[0]=U=>u.value=U)},{default:a(()=>[(l(!0),g(fe,null,$e(x.value,U=>(l(),c(ve,{class:"mx-1 px-2 py-0",key:U.value,value:U.name,title:U.name},{prepend:a(({isActive:X})=>[t(Zo,{start:""},{default:a(()=>[t(Xs,{"model-value":X,"onUpdate:modelValue":oe=>N(U.name,oe)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["value","title"]))),128))]),_:1},8,["disabled","selected"])]),_:1})]),_:1})]),_:1}),t(ge,null,{default:a(()=>[o("div",Jy,[t(H,{disabled:f.value||!u.value||!u.value.length,onClick:F},{default:a(()=>[q(i(e(n)("OK"))+" ",1),f.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",disabled:f.value,onClick:S},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["persistent","modelValue"]),t(ct,{ref_key:"snackbar",ref:d},null,512)],64))}}),Xy={key:0,class:"d-flex align-center"},eg={key:0},tg={key:2,class:"ms-2"},ag={key:3,class:"text-error font-italic"},lg={key:1,style:{width:"260px"}},ng={key:2,style:{width:"260px"}},og={key:3,style:{width:"260px"}},sg={key:0,class:"d-flex align-center"},ig={key:1},rg={key:0,class:"d-flex align-center"},ug={key:0},dg={key:1,class:"text-error font-italic"},cg={key:3},mg={key:4,class:"text-error font-italic"},pg={key:0},vg={key:1},fg={key:0},yg={key:1,style:{width:"200px"}},gg={class:"d-flex align-center"},hg={key:0},bg={key:1},Tg={key:0,class:"title-and-toolbar d-flex align-center text-no-wrap mt-2"},kg={key:1},_g={class:"d-flex align-center"},xg={class:"text-h4"},Cg={key:0,class:"me-2 d-flex flex-column justify-center"},wg={key:1,class:"ms-2 me-2 d-flex flex-column justify-center"},Ag={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},Sg={class:"d-flex align-center"},Vg={class:"text-h4"},Ig={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},Dg=Oe({__name:"ImportTransactionCheckDataTab",props:{importTransactions:{},disabled:{type:Boolean}},setup(v,{expose:_}){const n=v,{tt:s,getCurrentNumeralSystemType:h,formatDateTimeToLongDateTime:d,formatAmountToLocalizedNumeralsWithCurrency:y,getCategorizedAccountsWithDisplayBalance:f}=je(),b=Ya(),x=ta(),u=pa(),m=va(),k=rl(),N=xe("snackbar"),V=xe("batchReplaceDialog"),p=xe("batchReplaceAllTypesDialog"),T=xe("batchCreateDialog"),A=P(null),w=P([]),I=P({minDatetime:null,maxDatetime:null,transactionType:null,category:null,amount:null,account:null,tag:null,description:null}),F=P(1),S=P(10),j=P(!1),B=P(!1),U=P(!1),X=P(null),oe=P(0),W=P(0),D=P(null),$=E(()=>h()),C=E(()=>b.appSettings.showAccountBalance),M=E(()=>x.currentUserDefaultCurrency),ee=E(()=>x.currentUserCoordinateDisplayType),ye=E(()=>u.allPlainAccounts),L=E(()=>u.allVisiblePlainAccounts),Y=E(()=>f(L.value,C.value)),O=E(()=>u.allAccountsMap),J=E(()=>ad(u.allAccounts)),ae=E(()=>m.allTransactionCategories),Z=E(()=>m.allTransactionCategoriesMap),le=E(()=>k.allTransactionTags),z=E(()=>k.allTransactionTagsMap),se=E(()=>m.hasVisibleExpenseCategories),ue=E(()=>m.hasVisibleIncomeCategories),Ee=E(()=>m.hasVisibleTransferCategories),me=E(()=>!!A.value),te=E(()=>ze.value>0&&yt.value<1),Se=E(()=>[{title:s("Date Range"),items:[{title:s("All"),appendIcon:I.value.minDatetime===null||I.value.maxDatetime===null?Xe:void 0,onClick:()=>{I.value.minDatetime=null,I.value.maxDatetime=null}},{title:s("Custom"),subTitle:bt.value,appendIcon:I.value.minDatetime!==null&&I.value.maxDatetime!==null?Xe:void 0,onClick:()=>j.value=!0}]},{title:s("Type"),items:[{title:s("All"),appendIcon:I.value.transactionType===null?Xe:void 0,onClick:()=>I.value.transactionType=null},{title:s("Income"),appendIcon:I.value.transactionType===pe.Income?Xe:void 0,onClick:()=>I.value.transactionType=pe.Income},{title:s("Expense"),appendIcon:I.value.transactionType===pe.Expense?Xe:void 0,onClick:()=>I.value.transactionType=pe.Expense},{title:s("Transfer"),appendIcon:I.value.transactionType===pe.Transfer?Xe:void 0,onClick:()=>I.value.transactionType=pe.Transfer}]},{title:s("Category"),items:[{title:s("All"),appendIcon:I.value.category===null?Xe:void 0,onClick:()=>I.value.category=null},{title:s("Invalid Category"),appendIcon:I.value.category===void 0?Xe:void 0,onClick:()=>I.value.category=void 0},{title:s("None"),appendIcon:I.value.category===""?Xe:void 0,onClick:()=>I.value.category=""},...Be.value.map(Q=>({title:Q,appendIcon:I.value.category===Q?Xe:void 0,onClick:()=>I.value.category=Q}))]},{title:s("Amount"),items:[{title:s("All"),appendIcon:I.value.amount?void 0:Xe,onClick:()=>I.value.amount=null},...yo.values().map(Q=>({title:s(Q.name),appendIcon:I.value.amount&&I.value.amount.startsWith(`${Q.type}:`)?Xe:void 0,onClick:()=>{let he=0,_e=0;if(I.value.amount){const qe=I.value.amount.split(":");qe.length>=2&&(he=parseInt(qe[1])),qe.length>=3&&(_e=parseInt(qe[2]))}(Number.isNaN(he)||!Number.isFinite(he))&&(he=0),(Number.isNaN(_e)||!Number.isFinite(_e))&&(_e=0),X.value=Q,oe.value=he,W.value=_e,B.value=!0}}))]},{title:s("Account"),items:[{title:s("All"),appendIcon:I.value.account===null?Xe:void 0,onClick:()=>I.value.account=null},{title:s("Invalid Account"),appendIcon:I.value.account===void 0?Xe:void 0,onClick:()=>I.value.account=void 0},{title:s("None"),appendIcon:I.value.account===""?Xe:void 0,onClick:()=>I.value.account=""},...Ke.value.map(Q=>({title:Q,appendIcon:I.value.account===Q?Xe:void 0,onClick:()=>I.value.account=Q}))]},{title:s("Tags"),items:[{title:s("All"),appendIcon:I.value.tag===null?Xe:void 0,onClick:()=>I.value.tag=null},{title:s("Invalid Tag"),appendIcon:I.value.tag===void 0?Xe:void 0,onClick:()=>I.value.tag=void 0},{title:s("None"),appendIcon:I.value.tag===""?Xe:void 0,onClick:()=>I.value.tag=""},...Fe.value.map(Q=>({title:Q,appendIcon:I.value.tag===Q?Xe:void 0,onClick:()=>I.value.tag=Q}))]},{title:s("Description"),items:[{title:s("All"),appendIcon:I.value.description===null?Xe:void 0,onClick:()=>I.value.description=null},{title:s("None"),appendIcon:I.value.description===""?Xe:void 0,onClick:()=>I.value.description=""},{title:s("Custom"),subTitle:I.value.description!==null?I.value.description:void 0,appendIcon:I.value.description!==null&&I.value.description!==""?Xe:void 0,onClick:()=>{D.value=I.value.description||"",U.value=!0}}]}]),Te=E(()=>[{prependIcon:Ba,title:s("Batch Replace Categories / Accounts / Tags"),disabled:me.value,onClick:We},{prependIcon:Ba,title:s("Batch Replace Selected Expense Categories"),disabled:me.value||ke.value<1,divider:!0,onClick:()=>gt("expenseCategory")},{prependIcon:Ba,title:s("Batch Replace Selected Income Categories"),disabled:me.value||Ie.value<1,onClick:()=>gt("incomeCategory")},{prependIcon:Ba,title:s("Batch Replace Selected Transfer Categories"),disabled:me.value||Et.value<1,onClick:()=>gt("transferCategory")},{prependIcon:Ba,title:s("Batch Replace Selected Accounts"),disabled:me.value||ze.value<1,onClick:()=>gt("account")},{prependIcon:Ba,title:s("Batch Replace Selected Destination Accounts"),disabled:me.value||Et.value<1,onClick:()=>gt("destinationAccount")},{prependIcon:Ba,title:s("Batch Replace Selected Transaction Tags"),disabled:me.value||ze.value<1,onClick:()=>gt("tag",Dt.value)},{prependIcon:Ba,title:s("Batch Add Transaction Tags"),disabled:me.value||ze.value<1,onClick:()=>Wa("tag")},{prependIcon:Ba,title:s("Replace Invalid Expense Categories"),disabled:me.value||!De.value||De.value.length<1,divider:!0,onClick:()=>Fa("expenseCategory",De.value)},{prependIcon:Ba,title:s("Replace Invalid Income Categories"),disabled:me.value||!Ue.value||Ue.value.length<1,onClick:()=>Fa("incomeCategory",Ue.value)},{prependIcon:Ba,title:s("Replace Invalid Transfer Categories"),disabled:me.value||!Pe.value||Pe.value.length<1,onClick:()=>Fa("transferCategory",Pe.value)},{prependIcon:Ba,title:s("Replace Invalid Accounts"),disabled:me.value||!ut.value||ut.value.length<1,onClick:()=>Fa("account",ut.value)},{prependIcon:Ba,title:s("Replace Invalid Transaction Tags"),disabled:me.value||!we.value||we.value.length<1,onClick:()=>Fa("tag",we.value)},{prependIcon:Jn,title:s("Create Nonexistent Expense Categories"),disabled:me.value||!De.value||De.value.length<1,divider:!0,onClick:()=>Nt("expenseCategory",De.value)},{prependIcon:Jn,title:s("Create Nonexistent Income Categories"),disabled:me.value||!Ue.value||Ue.value.length<1,onClick:()=>Nt("incomeCategory",Ue.value)},{prependIcon:Jn,title:s("Create Nonexistent Transfer Categories"),disabled:me.value||!Pe.value||Pe.value.length<1,onClick:()=>Nt("transferCategory",Pe.value)},{prependIcon:Jn,title:s("Create Nonexistent Transaction Tags"),disabled:me.value||!we.value||we.value.length<1,onClick:()=>Nt("tag",we.value)},{prependIcon:an,title:s("Batch Convert Expense Transaction to Income Transaction"),disabled:me.value||ke.value<1,divider:!0,onClick:()=>tl(pe.Expense,pe.Income)},{prependIcon:an,title:s("Batch Convert Expense Transaction to Transfer Transaction"),disabled:me.value||ke.value<1,onClick:()=>tl(pe.Expense,pe.Transfer)},{prependIcon:an,title:s("Batch Convert Income Transaction to Expense Transaction"),disabled:me.value||Ie.value<1,onClick:()=>tl(pe.Income,pe.Expense)},{prependIcon:an,title:s("Batch Convert Income Transaction to Transfer Transaction"),disabled:me.value||Ie.value<1,onClick:()=>tl(pe.Income,pe.Transfer)},{prependIcon:an,title:s("Batch Convert Transfer Transaction to Expense Transaction"),disabled:me.value||Et.value<1,onClick:()=>tl(pe.Transfer,pe.Expense)},{prependIcon:an,title:s("Batch Convert Transfer Transaction to Income Transaction"),disabled:me.value||Et.value<1,onClick:()=>tl(pe.Transfer,pe.Income)},{prependIcon:br,title:s("Batch Convert Selected Amounts to Positive Values"),disabled:me.value||ze.value<1,divider:!0,onClick:()=>Le(1)},{prependIcon:Tr,title:s("Batch Convert Selected Amounts to Negative Values"),disabled:me.value||ze.value<1,onClick:()=>Le(-1)}]),Ye=E(()=>{if(!(S.value<=10||!n.importTransactions||n.importTransactions.length<=10))return 380}),He=E(()=>[{value:"valid",sortable:!0,nowrap:!0,width:35},{value:"time",title:s("Transaction Time"),sortable:!0,nowrap:!0},{value:"type",title:s("Type"),sortable:!0,nowrap:!0},{value:"actualCategoryName",title:s("Category"),sortable:!0,nowrap:!0},{value:"sourceAmount",title:s("Amount"),sortable:!0,nowrap:!0},{value:"actualSourceAccountName",title:s("Account"),sortable:!0,nowrap:!0},{value:"geoLocation",title:s("Geographic Location"),sortable:!0,nowrap:!0},{value:"tagIds",title:s("Tags"),sortable:!0,nowrap:!0},{value:"comment",title:s("Description"),sortable:!0,nowrap:!0}]),It=E(()=>_a(n.importTransactions?.length)),la=E(()=>{if(!n.importTransactions||n.importTransactions.length<1)return 1;let Q=0;for(const he of n.importTransactions)Vt(he)&&Q++;return Math.ceil(Q/S.value)}),Ot=E(()=>{const Q=[];if(!n.importTransactions||n.importTransactions.length<1)return Q;const he=Math.max(0,(F.value-1)*S.value);let _e=0;for(const qe of n.importTransactions){if(Q.length>=S.value)break;Vt(qe)&&(_e>=he&&Q.push(qe),_e++)}return Q}),ze=E(()=>{let Q=0;if(!n.importTransactions||n.importTransactions.length<1)return Q;for(const he of n.importTransactions)he.selected&&Q++;return Q}),ke=E(()=>{let Q=0;if(!n.importTransactions||n.importTransactions.length<1)return Q;for(const he of n.importTransactions)he.selected&&he.type===pe.Expense&&Q++;return Q}),Ie=E(()=>{let Q=0;if(!n.importTransactions||n.importTransactions.length<1)return Q;for(const he of n.importTransactions)he.selected&&he.type===pe.Income&&Q++;return Q}),Et=E(()=>{let Q=0;if(!n.importTransactions||n.importTransactions.length<1)return Q;for(const he of n.importTransactions)he.selected&&he.type===pe.Transfer&&Q++;return Q}),yt=E(()=>{let Q=0;if(!n.importTransactions||n.importTransactions.length<1)return Q;for(const he of n.importTransactions)!he.valid&&he.selected&&Q++;return Q}),Ne=E(()=>!!n.importTransactions&&ze.value>0&&ze.value!==n.importTransactions.length),kt=E(()=>!!n.importTransactions&&ze.value===n.importTransactions.length),Be=E(()=>{if(!n.importTransactions||n.importTransactions.length<1)return[];const Q={};for(const he of n.importTransactions)he.actualCategoryName&&he.actualCategoryName!==""&&(Q[he.actualCategoryName]=!0);return Io(Q)}),Ke=E(()=>{if(!n.importTransactions||n.importTransactions.length<1)return[];const Q={};for(const he of n.importTransactions)he.actualSourceAccountName&&he.actualSourceAccountName!==""&&(Q[he.actualSourceAccountName]=!0),he.actualDestinationAccountName&&he.actualDestinationAccountName!==""&&(Q[he.actualDestinationAccountName]=!0);return Io(Q)}),Fe=E(()=>{if(!n.importTransactions||n.importTransactions.length<1)return[];const Q={};for(const he of n.importTransactions)if(!(!he.tagIds||!he.originalTagNames))for(const[_e,qe]of Ra(he.tagIds)){const Ce=he.originalTagNames[qe];_e&&_e!=="0"&&z.value[_e]&&z.value[_e].name?Q[z.value[_e].name]=!0:Ce&&(Q[Ce]=!0)}return Io(Q)}),De=E(()=>ja(pe.Expense)),Ue=E(()=>ja(pe.Income)),Pe=E(()=>ja(pe.Transfer)),ut=E(()=>ya()),we=E(()=>Cl()),Dt=E(()=>Pa()),bt=E(()=>{if(I.value.minDatetime===null||I.value.maxDatetime===null)return"";const Q=d(Ia(I.value.minDatetime)),he=d(Ia(I.value.maxDatetime));return`${Q} - ${he}`});function St(Q){return $.value.formatNumber(Q)}function _a(Q){const he=[];if(!Q||Q<1)return he.push({value:-1,name:s("All")}),he;for(const _e of[5,10,15,20,25,30,50]){if(Q<_e)break;he.push({value:_e,name:St(_e)})}return he.push({value:-1,name:s("All")}),he}function Vt(Q){if(Zt(I.value.minDatetime)&&Zt(I.value.maxDatetime)&&(Q.time<I.value.minDatetime||Q.time>I.value.maxDatetime)||Zt(I.value.transactionType)&&Q.type!==I.value.transactionType)return!1;if(Va(I.value.category)){if(I.value.category===""&&Q.actualCategoryName!=="")return!1;if(I.value.category!==""&&Q.actualCategoryName!==I.value.category)return!1}else if(I.value.category===void 0&&Q.type!==pe.ModifyBalance&&Q.categoryId&&Q.categoryId!=="0")return!1;if(Va(I.value.amount)&&!yo.match(I.value.amount,Q.sourceAmount))return!1;if(Va(I.value.account)){if(I.value.account===""&&(Q.actualSourceAccountName!==""||Q.actualDestinationAccountName!==""))return!1;if(I.value.account!==""&&Q.actualSourceAccountName!==I.value.account&&Q.actualDestinationAccountName!==I.value.account)return!1}else if(I.value.account===void 0){if(Q.type!==pe.Transfer&&Q.sourceAccountId&&Q.sourceAccountId!=="0")return!1;if(Q.type===pe.Transfer&&Q.sourceAccountId&&Q.sourceAccountId!=="0"&&Q.destinationAccountId&&Q.destinationAccountId!=="0")return!1}if(Va(I.value.tag)){if(I.value.tag===""&&Q.tagIds&&Q.tagIds.length)return!1;if(I.value.tag!==""){let he=!1;if(Q.tagIds&&Q.tagIds.length)for(const[_e,qe]of Ra(Q.tagIds)){let Ce=Q.originalTagNames?Q.originalTagNames[qe]??"":"";if(_e&&_e!=="0"&&z.value[_e]&&z.value[_e].name&&(Ce=z.value[_e].name),Ce===I.value.tag){he=!0;break}}if(!he)return!1}}else if(I.value.tag===void 0)if(Q.tagIds&&Q.tagIds.length){let he=!1;for(const _e of Q.tagIds)if(!_e||_e==="0"){he=!0;break}if(!he)return!1}else return!1;if(Va(I.value.description)){if(I.value.description===""&&Q.comment!=="")return!1;if(I.value.description!==""&&Q.comment.indexOf(I.value.description)<0)return!1}return!0}function Qt(Q,he){if(!Q||!Q[he]||Q[he]==="0")return!1;const _e=Q[he];return!!z.value[_e]}function Rt(Q){const he=go(Q.time,Q.utcOffset);return d(he)}function Ct(Q){return Q.utcOffset===Ln(Q.time)}function fa(Q){return`UTC${Ti(Q.utcOffset)}`}function xa(Q,he){return y(Q,he)}function ia(Q){let he=Q.originalSourceAccountCurrency||M.value;return Q.sourceAccountId&&Q.sourceAccountId!=="0"&&O.value[Q.sourceAccountId]&&(he=O.value[Q.sourceAccountId].currency),xa(Q.sourceAmount,he)}function aa(Q){if(Q.type!==pe.Transfer)return"-";let he=Q.originalDestinationAccountCurrency||M.value;return Q.destinationAccountId&&Q.destinationAccountId!=="0"&&O.value[Q.destinationAccountId]&&(he=O.value[Q.destinationAccountId].currency),xa(Q.destinationAmount,he)}function Xa(Q){return Q.type===pe.Expense||Q.type===pe.Income?s("Account"):Q.type===pe.Transfer?s("Source Account"):s("Account")}function ul(Q){return Q.sourceAccountId?Dl.findAccountNameById(ye.value,Q.sourceAccountId)||"":s("None")}function Ua(Q){return Q.destinationAccountId?Dl.findAccountNameById(ye.value,Q.destinationAccountId)||"":s("None")}function ja(Q){const he={},_e=[];if(!n.importTransactions||n.importTransactions.length<1)return _e;for(const qe of n.importTransactions){const Ce=qe.categoryId;qe.type===Q&&(!Ce||Ce==="0"||!Z.value[Ce])&&(he[qe.originalCategoryName]=!0)}for(const qe of El(he))_e.push({name:qe||s("(Empty)"),value:qe});return _e}function ya(){const Q={},he=[];if(!n.importTransactions||n.importTransactions.length<1)return he;for(const _e of n.importTransactions){const qe=_e.sourceAccountId,Ce=_e.destinationAccountId;(!qe||qe==="0"||!O.value[qe])&&(Q[_e.originalSourceAccountName]=!0),_e.type===pe.Transfer&&Va(_e.originalDestinationAccountName)&&(!Ce||Ce==="0"||!O.value[Ce])&&(Q[_e.originalDestinationAccountName]=!0)}for(const _e of El(Q))he.push({name:_e||s("(Empty)"),value:_e});return he}function Cl(){const Q={},he=[];if(!n.importTransactions||n.importTransactions.length<1)return he;for(const _e of n.importTransactions)if(!(!_e.tagIds||!_e.originalTagNames))for(const[qe,Ce]of Ra(_e.tagIds)){const dt=_e.originalTagNames[Ce];dt&&(!qe||qe==="0"||!z.value[qe])&&(Q[dt]=!0)}for(const _e of El(Q))he.push({name:_e||s("(Empty)"),value:_e});return he}function Pa(){const Q={},he=[];if(!n.importTransactions||n.importTransactions.length<1)return he;for(const _e of n.importTransactions)if(_e.originalTagNames)for(const qe of _e.originalTagNames)Q[qe]=!0;for(const _e of El(Q))he.push({name:_e||s("(Empty)"),value:_e});return he}function el(Q,he,_e){return!_e||!_e.raw?!1:Vt(_e.raw)}function Ha(){if(!(!n.importTransactions||n.importTransactions.length<1))for(const Q of n.importTransactions)Q.valid&&Vt(Q)&&(Q.selected=!0)}function dl(){if(!(!n.importTransactions||n.importTransactions.length<1))for(const Q of n.importTransactions)!Q.valid&&Vt(Q)&&(Q.selected=!0)}function cl(){if(!(!n.importTransactions||n.importTransactions.length<1))for(const Q of n.importTransactions)Vt(Q)&&(Q.selected=!0)}function ml(){if(!(!n.importTransactions||n.importTransactions.length<1))for(const Q of n.importTransactions)Vt(Q)&&(Q.selected=!1)}function wl(){if(!(!n.importTransactions||n.importTransactions.length<1))for(const Q of n.importTransactions)Vt(Q)&&(Q.selected=!Q.selected)}function Al(){for(const Q of Ot.value)Q.selected=!0}function G(){for(const Q of Ot.value)Q.selected=!1}function K(){for(const Q of Ot.value)Q.selected=!Q.selected}function Re(Q){A.value&&(A.value.tagIds=w.value,at(A.value)),A.value===Q?(w.value=[],A.value=null):(A.value=Q,w.value=A.value.tagIds)}function at(Q){Q.valid=Q.isTransactionValid(),Q.categoryId&&Z.value[Q.categoryId]&&(Q.actualCategoryName=Z.value[Q.categoryId].name),Q.sourceAccountId&&O.value[Q.sourceAccountId]&&(Q.actualSourceAccountName=O.value[Q.sourceAccountId].name),Q.destinationAccountId&&O.value[Q.destinationAccountId]&&(Q.actualDestinationAccountName=O.value[Q.destinationAccountId].name)}function gt(Q,he){me.value||V.value?.open({mode:"batchReplace",type:Q,allSourceTagItems:he}).then(_e=>{if(!_e||Q!=="tag"&&!_e.targetItem)return;let qe=0;if(n.importTransactions)for(const Ce of n.importTransactions){if(!Ce.selected)continue;let dt=!1;if(Q==="expenseCategory")Ce.type===pe.Expense&&(Ce.categoryId=_e.targetItem,dt=!0);else if(Q==="incomeCategory")Ce.type===pe.Income&&(Ce.categoryId=_e.targetItem,dt=!0);else if(Q==="transferCategory")Ce.type===pe.Transfer&&(Ce.categoryId=_e.targetItem,dt=!0);else if(Q==="account")Ce.sourceAccountId=_e.targetItem,dt=!0;else if(Q==="destinationAccount")Ce.type===pe.Transfer&&(Ce.destinationAccountId=_e.targetItem,dt=!0);else if(Q==="tag"){const de=[];for(let Qe=0;Qe<Ce.originalTagNames.length;Qe++)(Ce.originalTagNames?Ce.originalTagNames[Qe]??"":"")===_e.sourceItem&&(_e.targetItem?(Ce.tagIds[Qe]=_e.targetItem,Ce.originalTagNames[Qe]=z.value[_e.targetItem]?.name||""):de.push(Qe),dt=!0);for(const Qe of Ss(de))Ce.tagIds.splice(Qe,1),Ce.originalTagNames.splice(Qe,1)}dt&&(qe++,at(Ce))}qe>0&&N.value?.showMessage("format.misc.youHaveUpdatedTransactions",{count:St(qe)})})}function Wa(Q){me.value||V.value?.open({mode:"batchAdd",type:Q}).then(he=>{if(!he||!he.targetItem)return;let _e=0;if(n.importTransactions)for(const qe of n.importTransactions){if(!qe.selected)continue;let Ce=!1;if(Q==="tag"){let dt=!1;for(const de of qe.originalTagNames)if(de===he.targetItem){dt=!0;break}dt||(qe.tagIds||(qe.tagIds=[]),qe.originalTagNames||(qe.originalTagNames=[]),qe.tagIds.push(he.targetItem),qe.originalTagNames.push(z.value[he.targetItem]?.name??""),Ce=!0)}Ce&&(_e++,at(qe))}_e>0&&N.value?.showMessage("format.misc.youHaveUpdatedTransactions",{count:St(_e)})})}function Fa(Q,he){me.value||V.value?.open({mode:"replaceInvalidItems",type:Q,invalidItems:he}).then(_e=>{if(!_e||!_e.sourceItem&&_e.sourceItem!==""||Q!=="tag"&&!_e.targetItem)return;let qe=0;if(n.importTransactions)for(const Ce of n.importTransactions){if(Ce.valid)continue;let dt=!1;if(Q==="expenseCategory"||Q==="incomeCategory"||Q==="transferCategory"){const de=Ce.categoryId,Qe=Ce.originalCategoryName;Ce.type!==pe.ModifyBalance&&Qe===_e.sourceItem&&(!de||de==="0"||!Z.value[de])&&(Q==="expenseCategory"&&Ce.type===pe.Expense||Q==="incomeCategory"&&Ce.type===pe.Income||Q==="transferCategory"&&Ce.type===pe.Transfer)&&(Ce.categoryId=_e.targetItem,dt=!0)}else if(Q==="account"){const de=Ce.sourceAccountId,Qe=Ce.originalSourceAccountName,Ut=Ce.destinationAccountId,al=Ce.originalDestinationAccountName;Qe===_e.sourceItem&&(!de||de==="0"||!O.value[de])&&(Ce.sourceAccountId=_e.targetItem,dt=!0),Ce.type===pe.Transfer&&al===_e.sourceItem&&(!Ut||Ut==="0"||!O.value[Ut])&&(Ce.destinationAccountId=_e.targetItem,dt=!0)}else if(Q==="tag"&&Ce.tagIds){const de=[];for(let Qe=0;Qe<Ce.tagIds.length;Qe++){const Ut=Ce.tagIds[Qe];(Ce.originalTagNames?Ce.originalTagNames[Qe]??"":"")===_e.sourceItem&&(!Ut||Ut==="0"||!z.value[Ut])&&(_e.targetItem?(Ce.tagIds[Qe]=_e.targetItem,Ce.originalTagNames[Qe]=z.value[_e.targetItem]?.name||""):de.push(Qe),dt=!0)}for(const Qe of Ss(de))Ce.tagIds.splice(Qe,1),Ce.originalTagNames.splice(Qe,1)}dt&&(qe++,at(Ce))}qe>0&&N.value?.showMessage("format.misc.youHaveUpdatedTransactions",{count:St(qe)})})}function We(){me.value||p.value?.open({expenseCategoryNames:De.value,incomeCategoryNames:Ue.value,transferCategoryNames:Pe.value,accountNames:ut.value,tagNames:we.value}).then(Q=>{if(!Q||!Q.rules)return;let he=0;if(n.importTransactions)for(const _e of n.importTransactions){let qe=!1;for(const Ce of Q.rules)if(!(!Ce||!Ce.dataType||!Ce.targetId)){if(Ce.dataType==="expenseCategory"||Ce.dataType==="incomeCategory"||Ce.dataType==="transferCategory")_e.type!==pe.ModifyBalance&&_e.originalCategoryName===Ce.sourceValue&&(Ce.dataType==="expenseCategory"&&_e.type===pe.Expense||Ce.dataType==="incomeCategory"&&_e.type===pe.Income||Ce.dataType==="transferCategory"&&_e.type===pe.Transfer)&&(_e.categoryId=Ce.targetId,qe=!0);else if(Ce.dataType==="account")_e.originalSourceAccountName===Ce.sourceValue&&(_e.sourceAccountId=Ce.targetId,qe=!0),_e.type===pe.Transfer&&_e.originalDestinationAccountName===Ce.sourceValue&&(_e.destinationAccountId=Ce.targetId,qe=!0);else if(Ce.dataType==="tag"&&_e.tagIds)for(let dt=0;dt<_e.tagIds.length;dt++)(_e.originalTagNames?_e.originalTagNames[dt]??"":"")===Ce.sourceValue&&(_e.tagIds[dt]=Ce.targetId,qe=!0)}qe&&(he++,at(_e))}he>0&&N.value?.showMessage("format.misc.youHaveUpdatedTransactions",{count:St(he)})})}function Nt(Q,he){me.value||T.value?.open({type:Q,invalidItems:he}).then(_e=>{if(!_e||!_e.sourceTargetMap)return;let qe=0;if(n.importTransactions){const Ce=_e.sourceTargetMap;for(const dt of n.importTransactions){if(dt.valid)continue;let de=!1;if(Q==="expenseCategory"||Q==="incomeCategory"||Q==="transferCategory"){const Qe=dt.categoryId,Ut=dt.originalCategoryName,al=Ce[Ut];dt.type!==pe.ModifyBalance&&al&&(!Qe||Qe==="0"||!Z.value[Qe])&&(Q==="expenseCategory"&&dt.type===pe.Expense||Q==="incomeCategory"&&dt.type===pe.Income||Q==="transferCategory"&&dt.type===pe.Transfer)&&(dt.categoryId=al,de=!0)}else if(Q==="tag"&&dt.tagIds)for(let Qe=0;Qe<dt.tagIds.length;Qe++){const Ut=dt.tagIds[Qe],al=dt.originalTagNames?dt.originalTagNames[Qe]??"":"",_n=Ce[al];_n&&(!Ut||Ut==="0"||!z.value[Ut])&&(dt.tagIds[Qe]=_n,de=!0)}de&&(qe++,at(dt))}}qe>0&&N.value?.showMessage("format.misc.youHaveUpdatedTransactions",{count:St(qe)})})}function tl(Q,he){if(!n.importTransactions||n.importTransactions.length<1)return;const _e=Ho(he);if(!_e)return;const qe=ld(ae.value[_e]);for(const Ce of n.importTransactions)!Ce.selected||Ce.type!==Q||(Ce.type=he,Ce.categoryId=qe[Ce.originalCategoryName]?.id||"0",Ce.type===pe.Transfer?(Ce.destinationAccountId=J.value[Ce.originalDestinationAccountName||""]?.id||"0",Ce.destinationAmount=Ce.sourceAmount):(Q===pe.Transfer&&he===pe.Income&&(Ce.sourceAccountId=Ce.destinationAccountId,Ce.sourceAmount=Ce.destinationAmount),Ce.destinationAccountId="0",Ce.destinationAmount=0),at(Ce))}function Le(Q){if(!(!n.importTransactions||n.importTransactions.length<1))for(const he of n.importTransactions)he.selected&&(Q>0?(he.sourceAmount=Math.abs(he.sourceAmount),he.destinationAmount=Math.abs(he.destinationAmount)):Q<0&&(he.sourceAmount=-Math.abs(he.sourceAmount),he.destinationAmount=-Math.abs(he.destinationAmount)),at(he))}function Ca(Q,he){I.value.minDatetime=Q,I.value.maxDatetime=he,j.value=!1}function ko(Q){N.value?.showError(Q)}function Wn(){A.value=null,w.value=[],I.value.minDatetime=null,I.value.maxDatetime=null,I.value.transactionType=null,I.value.category=null,I.value.account=null,I.value.tag=null,I.value.description=null,F.value=1,S.value=10}function _o(Q){S.value=Q}return _({filterMenus:Se,toolMenus:Te,isEditing:me,canImport:te,reset:Wn,setCountPerPage:_o}),(Q,he)=>{const _e=Ve("ItemIcon"),qe=Ve("two-column-select"),Ce=Ve("amount-input"),dt=Ve("date-range-selection-dialog");return l(),g(fe,null,[t(Kl,{"fixed-header":"","fixed-footer":"","show-select":"","multi-sort":"",density:"compact","item-value":"index",class:be({"import-transaction-table":!0,disabled:!!v.disabled}),height:Ye.value,headers:He.value,items:v.importTransactions,hover:!0,search:JSON.stringify(I.value),"custom-filter":el,"no-data-text":e(s)("No data to import"),"items-per-page":S.value,"onUpdate:itemsPerPage":he[4]||(he[4]=de=>S.value=de),page:F.value,"onUpdate:page":he[5]||(he[5]=de=>F.value=de)},{"header.data-table-select":a(()=>[t(il,{readonly:"",class:"always-cursor-pointer",density:"compact",width:"28",disabled:!!v.disabled,indeterminate:Ne.value,modelValue:kt.value,"onUpdate:modelValue":he[0]||(he[0]=de=>kt.value=de)},{default:a(()=>[t(mt,{activator:"parent",location:"bottom"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{"prepend-icon":e(nl),title:e(s)("Select All Valid Items"),disabled:!!v.disabled,onClick:Ha},null,8,["prepend-icon","title","disabled"]),t(ve,{"prepend-icon":e(nl),title:e(s)("Select All Invalid Items"),disabled:!!v.disabled,onClick:dl},null,8,["prepend-icon","title","disabled"]),t(nt,{class:"my-2"}),t(ve,{"prepend-icon":e(nl),title:e(s)("Select All"),disabled:!!v.disabled,onClick:cl},null,8,["prepend-icon","title","disabled"]),t(ve,{"prepend-icon":e(vn),title:e(s)("Select None"),disabled:!!v.disabled,onClick:ml},null,8,["prepend-icon","title","disabled"]),t(ve,{"prepend-icon":e(fn),title:e(s)("Invert Selection"),disabled:!!v.disabled,onClick:wl},null,8,["prepend-icon","title","disabled"]),t(nt,{class:"my-2"}),t(ve,{"prepend-icon":e(nl),title:e(s)("Select All in This Page"),disabled:!!v.disabled,onClick:Al},null,8,["prepend-icon","title","disabled"]),t(ve,{"prepend-icon":e(vn),title:e(s)("Select None in This Page"),disabled:!!v.disabled,onClick:G},null,8,["prepend-icon","title","disabled"]),t(ve,{"prepend-icon":e(fn),title:e(s)("Invert Selection in This Page"),disabled:!!v.disabled,onClick:K},null,8,["prepend-icon","title","disabled"])]),_:1})]),_:1})]),_:1},8,["disabled","indeterminate","modelValue"])]),"item.data-table-select":a(({item:de})=>[t(il,{density:"compact",color:de.valid?"primary":"error",disabled:!!v.disabled,modelValue:de.selected,"onUpdate:modelValue":Qe=>de.selected=Qe},null,8,["color","disabled","modelValue","onUpdate:modelValue"])]),"item.valid":a(({item:de})=>[t(ie,{size:"small",class:be({"text-error":!de.valid}),disabled:!!v.disabled,icon:A.value===de?e(Xe):e(hn),onClick:Qe=>Re(de)},null,8,["class","disabled","icon","onClick"]),v.disabled?r("",!0):(l(),c(vt,{key:0,activator:"parent"},{default:a(()=>[q(i(e(s)("Edit")),1)]),_:1}))]),"item.time":a(({item:de})=>[o("span",null,i(Rt(de)),1),Ct(de)?r("",!0):(l(),c(Jt,{key:0,class:"ms-1",variant:"flat",color:"grey",size:"x-small"},{default:a(()=>[q(i(fa(de)),1)]),_:2},1024))]),"item.type":a(({value:de})=>[de===e(pe).ModifyBalance?(l(),c(Jt,{key:0,label:"",color:"secondary",variant:"outlined",size:"x-small"},{default:a(()=>[q(i(e(s)("Modify Balance")),1)]),_:1})):de===e(pe).Income?(l(),c(Jt,{key:1,label:"",class:"text-income",variant:"outlined",size:"x-small"},{default:a(()=>[q(i(e(s)("Income")),1)]),_:1})):de===e(pe).Expense?(l(),c(Jt,{key:2,label:"",class:"text-expense",variant:"outlined",size:"x-small"},{default:a(()=>[q(i(e(s)("Expense")),1)]),_:1})):de===e(pe).Transfer?(l(),c(Jt,{key:3,label:"",color:"primary",variant:"outlined",size:"x-small"},{default:a(()=>[q(i(e(s)("Transfer")),1)]),_:1})):(l(),c(Jt,{key:4,label:"",color:"default",variant:"outlined",size:"x-small"},{default:a(()=>[q(i(e(s)("Unknown")),1)]),_:1}))]),"item.actualCategoryName":a(({item:de})=>[A.value!==de||de.type===e(pe).ModifyBalance?(l(),g("div",Xy,[de.type===e(pe).ModifyBalance?(l(),g("span",eg,"-")):r("",!0),de.type!==e(pe).ModifyBalance&&de.categoryId&&de.categoryId!=="0"&&Z.value[de.categoryId]?(l(),c(_e,{key:1,size:"24px","icon-type":"category","icon-id":Z.value[de.categoryId]?.icon??"",color:Z.value[de.categoryId]?.color??""},null,8,["icon-id","color"])):r("",!0),de.type!==e(pe).ModifyBalance&&de.categoryId&&de.categoryId!=="0"&&Z.value[de.categoryId]?(l(),g("span",tg,i(Z.value[de.categoryId]?.name),1)):de.type!==e(pe).ModifyBalance&&(!de.categoryId||de.categoryId==="0"||!Z.value[de.categoryId])?(l(),g("div",ag,[t(ie,{class:"me-1",icon:e(Cn)},null,8,["icon"]),o("span",null,i(de.originalCategoryName),1)])):r("",!0)])):r("",!0),A.value===de&&de.type===e(pe).Expense?(l(),g("div",lg,[t(qe,{density:"compact",variant:"plain","primary-key-field":"id","primary-value-field":"id","primary-title-field":"name","primary-icon-field":"icon","primary-icon-type":"category","primary-color-field":"color","primary-hidden-field":"hidden","primary-sub-items-field":"subCategories","secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-icon-field":"icon","secondary-icon-type":"category","secondary-color-field":"color","secondary-hidden-field":"hidden",disabled:!!v.disabled||!se.value,"enable-filter":!0,"filter-placeholder":e(s)("Find category"),"filter-no-items-text":e(s)("No available category"),"show-selection-primary-text":!0,"custom-selection-primary-text":e(Qa)(de.categoryId,ae.value[e(st).Expense]),"custom-selection-secondary-text":e($a)(de.categoryId,ae.value[e(st).Expense]),placeholder:e(s)("Category"),items:ae.value[e(st).Expense],modelValue:de.categoryId,"onUpdate:modelValue":Qe=>de.categoryId=Qe},null,8,["disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","custom-selection-secondary-text","placeholder","items","modelValue","onUpdate:modelValue"])])):r("",!0),A.value===de&&de.type===e(pe).Income?(l(),g("div",ng,[t(qe,{density:"compact",variant:"plain","primary-key-field":"id","primary-value-field":"id","primary-title-field":"name","primary-icon-field":"icon","primary-icon-type":"category","primary-color-field":"color","primary-hidden-field":"hidden","primary-sub-items-field":"subCategories","secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-icon-field":"icon","secondary-icon-type":"category","secondary-color-field":"color","secondary-hidden-field":"hidden",disabled:!!v.disabled||!ue.value,"enable-filter":!0,"filter-placeholder":e(s)("Find category"),"filter-no-items-text":e(s)("No available category"),"show-selection-primary-text":!0,"custom-selection-primary-text":e(Qa)(de.categoryId,ae.value[e(st).Income]),"custom-selection-secondary-text":e($a)(de.categoryId,ae.value[e(st).Income]),placeholder:e(s)("Category"),items:ae.value[e(st).Income],modelValue:de.categoryId,"onUpdate:modelValue":Qe=>de.categoryId=Qe},null,8,["disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","custom-selection-secondary-text","placeholder","items","modelValue","onUpdate:modelValue"])])):r("",!0),A.value===de&&de.type===e(pe).Transfer?(l(),g("div",og,[t(qe,{density:"compact",variant:"plain","primary-key-field":"id","primary-value-field":"id","primary-title-field":"name","primary-icon-field":"icon","primary-icon-type":"category","primary-color-field":"color","primary-hidden-field":"hidden","primary-sub-items-field":"subCategories","secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-icon-field":"icon","secondary-icon-type":"category","secondary-color-field":"color","secondary-hidden-field":"hidden",disabled:!!v.disabled||!Ee.value,"enable-filter":!0,"filter-placeholder":e(s)("Find category"),"filter-no-items-text":e(s)("No available category"),"show-selection-primary-text":!0,"custom-selection-primary-text":e(Qa)(de.categoryId,ae.value[e(st).Transfer]),"custom-selection-secondary-text":e($a)(de.categoryId,ae.value[e(st).Transfer]),placeholder:e(s)("Category"),items:ae.value[e(st).Transfer],modelValue:de.categoryId,"onUpdate:modelValue":Qe=>de.categoryId=Qe},null,8,["disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","custom-selection-secondary-text","placeholder","items","modelValue","onUpdate:modelValue"])])):r("",!0)]),"item.sourceAmount":a(({item:de})=>[A.value!==de?(l(),g("div",sg,[o("span",null,i(ia(de)),1),de.type===e(pe).Transfer&&de.sourceAccountId!==de.destinationAccountId?(l(),c(ie,{key:0,class:"icon-with-direction mx-1",size:"13",icon:e(ba)},null,8,["icon"])):r("",!0),de.type===e(pe).Transfer&&de.sourceAccountId!==de.destinationAccountId?(l(),g("span",ig,i(aa(de)),1)):r("",!0)])):r("",!0),A.value===de?(l(),g("div",{key:1,class:"d-flex align-center",style:kl(`width: ${de.type===e(pe).Transfer&&de.sourceAccountId!==de.destinationAccountId?250:100}px`)},[t(Ce,{density:"compact",variant:"plain","persistent-placeholder":"",currency:de.originalSourceAccountCurrency||M.value,"show-currency":!0,disabled:!!v.disabled,placeholder:e(s)("Amount"),modelValue:de.sourceAmount,"onUpdate:modelValue":Qe=>de.sourceAmount=Qe},null,8,["currency","disabled","placeholder","modelValue","onUpdate:modelValue"]),de.type===e(pe).Transfer&&de.sourceAccountId!==de.destinationAccountId?(l(),c(ie,{key:0,class:"icon-with-direction mx-1",size:"13",icon:e(ba)},null,8,["icon"])):r("",!0),de.type===e(pe).Transfer&&de.sourceAccountId!==de.destinationAccountId?(l(),c(Ce,{key:1,density:"compact",variant:"plain","persistent-placeholder":"",currency:de.originalDestinationAccountCurrency||M.value,"show-currency":!0,disabled:!!v.disabled,placeholder:e(s)("Transfer In Amount"),modelValue:de.destinationAmount,"onUpdate:modelValue":Qe=>de.destinationAmount=Qe},null,8,["currency","disabled","placeholder","modelValue","onUpdate:modelValue"])):r("",!0)],4)):r("",!0)]),"item.actualSourceAccountName":a(({item:de})=>[A.value!==de?(l(),g("div",rg,[de.sourceAccountId&&de.sourceAccountId!=="0"&&O.value[de.sourceAccountId]?(l(),g("span",ug,i(O.value[de.sourceAccountId]?.name),1)):(l(),g("div",dg,[t(ie,{class:"me-1",icon:e(Cn)},null,8,["icon"]),o("span",null,i(de.originalSourceAccountName),1)])),de.type===e(pe).Transfer?(l(),c(ie,{key:2,class:"icon-with-direction mx-1",size:"13",icon:e(ba)},null,8,["icon"])):r("",!0),de.type===e(pe).Transfer&&de.destinationAccountId&&de.destinationAccountId!=="0"&&O.value[de.destinationAccountId]?(l(),g("span",cg,i(O.value[de.destinationAccountId]?.name),1)):de.type===e(pe).Transfer&&(!de.destinationAccountId||de.destinationAccountId==="0"||!O.value[de.destinationAccountId])?(l(),g("div",mg,[t(ie,{class:"me-1",icon:e(Cn)},null,8,["icon"]),o("span",null,i(de.originalDestinationAccountName),1)])):r("",!0)])):r("",!0),A.value===de?(l(),g("div",{key:1,class:"d-flex align-center",style:kl(`width: ${de.type===e(pe).Transfer?450:200}px`)},[t(qe,{density:"compact",variant:"plain","primary-key-field":"id","primary-value-field":"category","primary-title-field":"name","primary-footer-field":"displayBalance","primary-icon-field":"icon","primary-icon-type":"account","primary-sub-items-field":"accounts","primary-title-i18n":!0,"secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-footer-field":"displayBalance","secondary-icon-field":"icon","secondary-icon-type":"account","secondary-color-field":"color",disabled:!!v.disabled||!L.value.length,"enable-filter":!0,"filter-placeholder":e(s)("Find account"),"filter-no-items-text":e(s)("No available account"),"custom-selection-primary-text":ul(de),placeholder:Xa(de),items:Y.value,modelValue:de.sourceAccountId,"onUpdate:modelValue":Qe=>de.sourceAccountId=Qe},null,8,["disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","placeholder","items","modelValue","onUpdate:modelValue"]),de.type===e(pe).Transfer?(l(),c(ie,{key:0,class:"icon-with-direction mx-1",size:"13",icon:e(ba)},null,8,["icon"])):r("",!0),de.type===e(pe).Transfer?(l(),c(qe,{key:1,density:"compact",variant:"plain","primary-key-field":"id","primary-value-field":"category","primary-title-field":"name","primary-footer-field":"displayBalance","primary-icon-field":"icon","primary-icon-type":"account","primary-sub-items-field":"accounts","primary-title-i18n":!0,"secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-footer-field":"displayBalance","secondary-icon-field":"icon","secondary-icon-type":"account","secondary-color-field":"color",disabled:!!v.disabled||!L.value.length,"enable-filter":!0,"filter-placeholder":e(s)("Find account"),"filter-no-items-text":e(s)("No available account"),"custom-selection-primary-text":Ua(de),placeholder:e(s)("Destination Account"),items:Y.value,modelValue:de.destinationAccountId,"onUpdate:modelValue":Qe=>de.destinationAccountId=Qe},null,8,["disabled","filter-placeholder","filter-no-items-text","custom-selection-primary-text","placeholder","items","modelValue","onUpdate:modelValue"])):r("",!0)],4)):r("",!0)]),"item.geoLocation":a(({item:de})=>[de.geoLocation?(l(),g("span",pg,i(`(${e(fi)(de.geoLocation,ee.value)})`),1)):de.geoLocation?r("",!0):(l(),g("span",vg,i(e(s)("None")),1))]),"item.tagIds":a(({item:de})=>[A.value!==de?(l(),g("div",fg,[(l(!0),g(fe,null,$e(de.tagIds,(Qe,Ut)=>(l(),c(Jt,{class:be(["transaction-tag",{"font-italic":!Qe||Qe==="0"||!z.value[Qe]}]),size:"small","prepend-icon":Qe&&Qe!=="0"&&z.value[Qe]?e(ea):e(Cn),color:Qe&&Qe!=="0"&&z.value[Qe]?"default":"error",text:Qe&&Qe!=="0"&&z.value[Qe]?z.value[Qe].name:de.originalTagNames[Ut],key:Qe},null,8,["class","prepend-icon","color","text"]))),128)),!de.tagIds||!de.tagIds.length?(l(),c(Jt,{key:0,class:"transaction-tag",size:"small",text:e(s)("None")},null,8,["text"])):r("",!0)])):r("",!0),A.value===de?(l(),g("div",yg,[t(ua,{"item-title":"name","item-value":"id","auto-select-first":"","persistent-placeholder":"",multiple:"",chips:"","closable-chips":"",density:"compact",variant:"plain",disabled:!!v.disabled,placeholder:e(s)("None"),items:le.value,"no-data-text":e(s)("No available tag"),modelValue:w.value,"onUpdate:modelValue":he[1]||(he[1]=Qe=>w.value=Qe)},{chip:a(({props:Qe,index:Ut})=>[t(Jt,_t({class:{"font-italic":!Qt(w.value,Ut)},"prepend-icon":Qt(w.value,Ut)?e(ea):e(Cn),color:Qt(w.value,Ut)?"default":"error",text:Qt(w.value,Ut)?z.value[w.value[Ut]]?.name:de.originalTagNames[Ut]},Qe),null,16,["class","prepend-icon","color","text"])]),item:a(({props:Qe,item:Ut})=>[Ut.raw.hidden?r("",!0):(l(),c(ve,_t({key:0,value:Ut.value},Qe),{title:a(()=>[t(rt,null,{default:a(()=>[o("div",gg,[t(ie,{size:"20",start:"",icon:e(ea)},null,8,["icon"]),o("span",null,i(Ut.title),1)])]),_:2},1024)]),_:2},1040,["value"]))]),_:2},1032,["disabled","placeholder","items","no-data-text","modelValue"])])):r("",!0)]),"item.comment":a(({item:de})=>[A.value!==de?(l(),g("span",hg,i(de.comment||""),1)):r("",!0),A.value===de?(l(),g("div",bg,[t(ot,{style:{width:"200px"},type:"text",density:"compact",variant:"plain","persistent-placeholder":"",placeholder:e(s)("Description"),disabled:!!v.disabled,modelValue:de.comment,"onUpdate:modelValue":Qe=>de.comment=Qe},null,8,["placeholder","disabled","modelValue","onUpdate:modelValue"])])):r("",!0)]),bottom:a(()=>[v.importTransactions?(l(),g("div",Tg,[o("span",{class:be({"text-error":yt.value>0})},i(e(s)("format.misc.selectedCount",{count:St(ze.value),totalCount:St(v.importTransactions.length)})),3),v.importTransactions.length>10?(l(),c(it,{key:0})):r("",!0),v.importTransactions.length>10?(l(),g("span",kg,i(e(s)("Transactions Per Page")),1)):r("",!0),v.importTransactions.length>10?(l(),c(Ge,{key:2,class:"ms-2",density:"compact","max-width":"100","item-title":"name","item-value":"value",disabled:!!v.disabled,items:It.value,modelValue:S.value,"onUpdate:modelValue":he[2]||(he[2]=de=>S.value=de)},null,8,["disabled","items","modelValue"])):r("",!0),v.importTransactions.length>10?(l(),c(jn,{key:3,density:"compact",disabled:!!v.disabled,totalPageCount:la.value,modelValue:F.value,"onUpdate:modelValue":he[3]||(he[3]=de=>F.value=de)},null,8,["disabled","totalPageCount","modelValue"])):r("",!0)])):r("",!0)]),_:1},8,["class","height","headers","items","search","no-data-text","items-per-page","page"]),t(xt,{width:"640",modelValue:B.value,"onUpdate:modelValue":he[10]||(he[10]=de=>B.value=de)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",_g,[o("h4",xg,i(e(s)("Filter Amount")),1)])]),default:a(()=>[t(ge,{class:"w-100 d-flex justify-center"},{default:a(()=>[X.value?(l(),g("div",Cg,i(e(s)(X.value.name)),1)):r("",!0),t(Ce,{currency:M.value,modelValue:oe.value,"onUpdate:modelValue":he[6]||(he[6]=de=>oe.value=de)},null,8,["currency","modelValue"]),X.value&&X.value.paramCount===2?(l(),g("div",wg," ~ ")):r("",!0),X.value&&X.value.paramCount===2?(l(),c(Ce,{key:2,currency:M.value,modelValue:W.value,"onUpdate:modelValue":he[7]||(he[7]=de=>W.value=de)},null,8,["currency","modelValue"])):r("",!0)]),_:1}),t(ge,null,{default:a(()=>[o("div",Ag,[t(H,{onClick:he[8]||(he[8]=de=>{B.value=!1,I.value.amount=X.value?.toTextualFilter(oe.value,W.value)??null})},{default:a(()=>[q(i(e(s)("OK")),1)]),_:1}),t(H,{color:"secondary",variant:"tonal",onClick:he[9]||(he[9]=de=>B.value=!1)},{default:a(()=>[q(i(e(s)("Cancel")),1)]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(xt,{width:"640",modelValue:U.value,"onUpdate:modelValue":he[14]||(he[14]=de=>U.value=de)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",Sg,[o("h4",Vg,i(e(s)("Filter Description")),1)])]),default:a(()=>[t(ge,{class:"w-100 d-flex justify-center"},{default:a(()=>[t(ot,{type:"text","persistent-placeholder":"",label:e(s)("Description"),placeholder:e(s)("Description"),modelValue:D.value,"onUpdate:modelValue":he[11]||(he[11]=de=>D.value=de)},null,8,["label","placeholder","modelValue"])]),_:1}),t(ge,null,{default:a(()=>[o("div",Ig,[t(H,{disabled:!D.value,onClick:he[12]||(he[12]=de=>{U.value=!1,I.value.description=D.value})},{default:a(()=>[q(i(e(s)("OK")),1)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",onClick:he[13]||(he[13]=de=>{U.value=!1,D.value=""})},{default:a(()=>[q(i(e(s)("Cancel")),1)]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(dt,{title:e(s)("Custom Date Range"),"min-time":I.value.minDatetime,"max-time":I.value.maxDatetime,show:j.value,"onUpdate:show":he[15]||(he[15]=de=>j.value=de),"onDateRange:change":Ca,onError:ko},null,8,["title","min-time","max-time","show"]),t(Iy,{ref_key:"batchReplaceDialog",ref:V},null,512),t(jy,{ref_key:"batchReplaceAllTypesDialog",ref:p},null,512),t(Zy,{ref_key:"batchCreateDialog",ref:T},null,512),t(ct,{ref_key:"snackbar",ref:N},null,512)],64)}}}),$g={class:"d-flex align-center justify-center"},Ng={class:"d-flex w-100 align-center"},Fg={class:"text-h4"},Eg={class:"cursor-default"},Mg={class:"cursor-pointer"},Ug=["href"],Pg={key:0,class:"ms-1"},Bg={key:1,class:"ms-1"},Lg={key:2,class:"ms-1"},zg={class:"text-h4 mb-1"},Og={class:"my-5"},Rg={class:"d-flex justify-center justify-sm-space-between flex-wrap mt-sm-1 mt-md-2 gap-4"},qg=["accept"];const Yg=Oe({__name:"ImportDialog",props:{persistent:{type:Boolean}},setup(v,{expose:_}){const{tt:n,joinMultiText:s,getCurrentNumeralSystemType:h,getAllSupportedImportFileCagtegoryAndTypes:d,formatNumberToLocalizedNumerals:y,getLocalizedFileEncodingName:f}=je(),b=pa(),x=va(),u=rl(),m=en(),k=vi(),N=ki(),V=xe("confirmDialog"),p=xe("snackbar"),T=xe("importTransactionDefineColumnTab"),A=xe("importTransactionExecuteCustomScriptTab"),w=xe("importTransactionCheckDataTab"),I=xe("fileInput"),F=[{key:"payeeAsTag",name:"Parse Payee as Tag"},{key:"payeeAsDescription",name:"Parse Payee as Description"},{key:"memberAsTag",name:"Parse Member as Tag"},{key:"projectAsTag",name:"Parse Project as Tag"},{key:"merchantAsTag",name:"Parse Merchant as Tag"}],S=P(!1),j=P(!1),B=P(""),U=P("uploadFile"),X=P(0),oe=P("ezbookkeeping"),W=P("ezbookkeeping_csv"),D=P("auto"),$=P(!1),C=P(void 0),M=P(0),ee=P(null),ye=P(""),L=P({}),Y=P(void 0),O=P(void 0),J=P(null),ae=P(!0),Z=P(!1);let le=null,z=null;const se=E(()=>h()),ue=E(()=>d()),Ee=E(()=>Ye.value[oe.value]?.subTypes),me=E(()=>{const Ke=Ye.value[oe.value]?.supportedEncodings;if(!Ke)return;const Fe=[];let De=n("Auto detect");ee.value&&($.value?De+=` [${n("Detecting...")}]`:C.value?De+=` [${f(C.value)}]`:De+=` [${n("Unknown")}]`);const Ue={displayName:De,encoding:"auto"};return Fe.push(Ue),Ke&&Ke.length&&Fe.push(...Ke),Fe}),te=E(()=>Ye.value[oe.value]?.dataFromTextbox??!1),Se=E(()=>Ye.value[oe.value]?.supportedAdditionalOptions),Te=E(()=>{const Ke=[{name:"uploadFile",title:n("Upload File"),subTitle:n("Upload Transaction Data File")}];return(oe.value==="dsv"||oe.value==="dsv_data")&&(M.value===1?Ke.push({name:"executeCustomScript",title:n("Execute Custom Script"),subTitle:n("Execute Custom Script to Parse Data")}):Ke.push({name:"defineColumn",title:n("Define Column"),subTitle:n("Define and Check Column Mapping")})),Ke.push({name:"checkData",title:n("Check & Modify"),subTitle:n("Check and Modify Your Data")},{name:"finalResult",title:n("Complete"),subTitle:n("Data Import Completed")}),Ke}),Ye=E(()=>{const Ke={};for(const Fe of ue.value)for(const De of Fe.fileTypes)Ke[De.type]=De;return Ke}),He=E(()=>{if(Ee.value&&Ee.value.length){const Ke=Vs(Ee.value,W.value);if(Ke)return Ke}return Ye.value[oe.value]?.extensions}),It=E(()=>{if(!Se.value)return n("None");const Ke=[];for(const Fe of F)Ht(Se.value[Fe.key])&&L.value[Fe.key]&&Ke.push(n(Fe.name));return Ke.length<1?n("None"):s(Ke)}),la=E(()=>{const Ke=Ye.value[oe.value]?.document;if(!Ke)return;const Fe=Ke.language?Ke.language+"/":"",De=Ke.anchor?"#"+Ke.anchor:"";return`https://ezbookkeeping.mayswind.net/${Fe}export_and_import${De}`}),Ot=E(()=>Ye.value[oe.value]?.document?.displayLanguageName),ze=E(()=>ee.value?.name||"");function ke(Ke){return se.value.formatNumber(Ke)}function Ie(){oe.value="ezbookkeeping",W.value="ezbookkeeping_csv",D.value="auto",$.value=!1,C.value=void 0,M.value=0,U.value="uploadFile",X.value=0,ee.value=null,ye.value="",L.value=Object.assign({},Se.value??{}),Y.value=void 0,T.value?.reset(),A.value?.reset(),O.value=void 0,w.value?.reset(),S.value=!0,B.value=_l();const Ke=[b.loadAllAccounts({force:!1}),x.loadAllCategories({force:!1}),u.loadAllTags({force:!1})];return Promise.all(Ke).then(()=>{ae.value=!1}).catch(Fe=>{Xt.error("failed to load essential data for importing transaction",Fe),ae.value=!1,S.value=!1,Fe.processed||z&&z(Fe)}),new Promise((Fe,De)=>{le=Fe,z=De})}function Et(){Z.value||I.value?.click()}function yt(Ke){if(!Ke||!Ke.target)return;const Fe=Ke.target;!Fe.files||!Fe.files.length||!Fe.files[0]||(ee.value=Fe.files[0],$.value=!1,C.value=void 0,Fe.value="",me.value&&($.value=!0,nd(ee.value).then(De=>{$.value=!1,C.value=De}).catch(()=>{$.value=!1,C.value=void 0})))}function Ne(){let Ke,Fe=oe.value,De;if(Ee.value&&(Fe=W.value),me.value&&(D.value==="auto"?De=C.value:De=D.value),te.value)if(te.value){if(!ye.value){p.value?.showError("No data to import");return}if(Fe==="custom_csv")Ke=Bt.CSV.createFile(ye.value,"import");else if(Fe==="custom_tsv")Ke=Bt.TSV.createFile(ye.value,"import");else{p.value?.showError("Parameter Invalid");return}De=od}else{p.value?.showMessage("An error occurred");return}else{if(!ee.value){p.value?.showError("Please select a file to import");return}if(me.value&&D.value==="auto"&&!C.value){p.value?.showError("Unable to detect the file encoding automatically. Please select the actual encoding.");return}Ke=ee.value}const Ue=oe.value==="dsv"||oe.value==="dsv_data";if(Ue&&U.value==="uploadFile")Z.value=!0,m.parseImportDsvFile({fileType:Fe,fileEncoding:De,importFile:Ke}).then(Pe=>{Pe&&Pe.length?M.value===1?(A.value?.reset(),Y.value=Pe,U.value="executeCustomScript"):(T.value?.reset(),Y.value=Pe,U.value="defineColumn"):(Y.value=void 0,p.value?.showError("No data to import")),Z.value=!1}).catch(Pe=>{Z.value=!1,Pe.processed||p.value?.showError(Pe)});else{let Pe,ut,we,Dt,bt,St,_a,Vt,Qt,Rt;if(Ue&&M.value===0){const Ct=T.value?.generateResult();if(!Ct)return;Pe=Ct.columnMapping,ut=Ct.transactionTypeMapping,we=Ct.includeHeader,Dt=Ct.timeFormat,bt=Ct.timezoneFormat,St=Ct.amountDecimalSeparator,_a=Ct.amountDigitGroupingSymbol,Vt=Ct.geoLocationSeparator,Qt=Ct.geoLocationOrder,Rt=Ct.tagSeparator}else if(Ue&&M.value===1){const Ct=A.value?.generateResult();if(!Ct)return;Fe="ezbookkeeping_json",De=void 0,Ke=Bt.JSON.createFile(Ct,"import")}Z.value=!0,m.parseImportTransaction({fileType:Fe,additionalOptions:L.value,fileEncoding:De,importFile:Ke,columnMapping:Pe,transactionTypeMapping:ut,hasHeaderLine:we,timeFormat:Dt,timezoneFormat:bt,amountDecimalSeparator:St,amountDigitGroupingSymbol:_a,geoSeparator:Vt,geoOrder:Qt,tagSeparator:Rt}).then(Ct=>{const fa=[];if(Ct.items)for(const[xa,ia]of Ra(Ct.items)){const aa=sd.of(xa,ia);fa.push(aa)}w.value?.reset(),fa&&fa.length>=0&&fa.length<10?w.value?.setCountPerPage(-1):w.value?.setCountPerPage(10),O.value=fa,U.value="checkData",Z.value=!1}).catch(Ct=>{Z.value=!1,Ct.processed||p.value?.showError(Ct)})}}function kt(){if(w.value?.isEditing)return;const Ke=[];if(O.value){for(const Fe of O.value)if(Fe.valid&&Fe.selected)Ke.push(Fe);else if(!Fe.valid&&Fe.selected){p.value?.showError("Cannot import invalid transactions");return}}if(Ke.length<1){p.value?.showError("No data to import");return}V.value?.open("format.misc.confirmImportTransactions",{count:ke(Ke.length)}).then(()=>{Z.value=!0;let Fe;Ke.length>100&&setTimeout(()=>{if(!Z.value){Xt.warn("transaction import is not submitting");return}Fe=setInterval(()=>{Z.value&&m.getImportTransactionsProcess({clientSessionId:B.value}).then(De=>{Zt(De)&&0<=De&&De<100?X.value=De:(X.value=0,clearInterval(Fe),Fe=void 0)}).catch(()=>{X.value=0,clearInterval(Fe),Fe=void 0})},2e3)},2e3),m.importTransactions({transactions:Ke,clientSessionId:B.value}).then(De=>{Fe&&(X.value=0,clearInterval(Fe),Fe=void 0),J.value=De,U.value="finalResult",b.updateAccountListInvalidState(!0),m.updateTransactionListInvalidState(!0),k.updateTransactionOverviewInvalidState(!0),N.updateTransactionStatisticsInvalidState(!0),Z.value=!1}).catch(De=>{Fe&&(X.value=0,clearInterval(Fe),Fe=void 0),Z.value=!1,De.processed||p.value?.showError(De)})})}function Be(Ke){Ke?le&&le():z&&z(),S.value=!1}return Ft(oe,()=>{Ee.value&&Ee.value.length&&(W.value=Ee.value[0].type),ee.value=null,Y.value=void 0,L.value=Object.assign({},Se.value??{}),O.value=void 0}),Ft(W,Ke=>{let Fe=Vs(Ee.value,Ke);Fe||(Fe=Ye.value[oe.value]?.extensions),ee.value&&ee.value.name&&!id(ee.value.name,Fe||"")&&(ee.value=null)}),_({open:Ie}),(Ke,Fe)=>{const De=Ve("steps-bar"),Ue=Ve("two-column-select");return l(),g(fe,null,[t(xt,{persistent:!!v.persistent,modelValue:S.value,"onUpdate:modelValue":Fe[11]||(Fe[11]=Pe=>S.value=Pe)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",$g,[o("div",Ng,[o("h4",Fg,i(e(n)("Import Transactions")),1),ae.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),U.value==="defineColumn"&&T.value?.menus?(l(),c(H,{key:0,density:"comfortable",color:"default",variant:"text",class:"ms-2",icon:!0,disabled:ae.value||Z.value},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent","max-height":"500"},{default:a(()=>[t(Je,null,{default:a(()=>[(l(!0),g(fe,null,$e(T.value.menus,(Pe,ut)=>(l(),c(ve,{key:ut,"prepend-icon":Pe.prependIcon,title:Pe.title,disabled:Pe.disabled,onClick:we=>Pe.onClick()},null,8,["prepend-icon","title","disabled","onClick"]))),128))]),_:1})]),_:1})]),_:1},8,["disabled"])):r("",!0),U.value==="executeCustomScript"&&A.value?.menus?(l(),c(H,{key:1,density:"comfortable",color:"default",variant:"text",class:"ms-2",icon:!0,disabled:ae.value||Z.value},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent","max-height":"500"},{default:a(()=>[t(Je,null,{default:a(()=>[(l(!0),g(fe,null,$e(A.value.menus,(Pe,ut)=>(l(),c(ve,{key:ut,"prepend-icon":Pe.prependIcon,title:Pe.title,disabled:Pe.disabled,onClick:we=>Pe.onClick()},null,8,["prepend-icon","title","disabled","onClick"]))),128))]),_:1})]),_:1})]),_:1},8,["disabled"])):r("",!0),U.value==="checkData"&&w.value?.filterMenus?(l(),c(H,{key:2,density:"comfortable",color:"default",variant:"text",class:"ms-2",icon:!0,disabled:ae.value||Z.value},{default:a(()=>[t(ie,{icon:e(co)},null,8,["icon"]),t(mt,{activator:"parent","max-height":"500"},{default:a(()=>[t(Je,null,{default:a(()=>[(l(!0),g(fe,null,$e(w.value.filterMenus,(Pe,ut)=>(l(),g(fe,{key:ut},[ut>0?(l(),c(nt,{key:0,class:"my-2"})):r("",!0),t(Pn,{title:Pe.title},null,8,["title"]),(l(!0),g(fe,null,$e(Pe.items,(we,Dt)=>(l(),c(ve,{key:`menu_${ut}_${Dt}`,"prepend-icon":we.prependIcon,title:we.title,subtitle:we.subTitle,"append-icon":we.appendIcon,disabled:we.disabled,onClick:bt=>we.onClick()},null,8,["prepend-icon","title","subtitle","append-icon","disabled","onClick"]))),128))],64))),128))]),_:1})]),_:1})]),_:1},8,["disabled"])):r("",!0),U.value==="checkData"&&w.value?.toolMenus?(l(),c(H,{key:3,density:"comfortable",color:"default",variant:"text",class:"ms-2",icon:!0,disabled:ae.value||Z.value},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent","max-height":"500"},{default:a(()=>[t(Je,null,{default:a(()=>[(l(!0),g(fe,null,$e(w.value.toolMenus,(Pe,ut)=>(l(),g(fe,{key:ut},[Pe.divider?(l(),c(nt,{key:0,class:"my-2"})):r("",!0),t(ve,{"prepend-icon":Pe.prependIcon,title:Pe.title,subtitle:Pe.subTitle,"append-icon":Pe.appendIcon,disabled:Pe.disabled,onClick:we=>Pe.onClick()},null,8,["prepend-icon","title","subtitle","append-icon","disabled","onClick"])],64))),128))]),_:1})]),_:1})]),_:1},8,["disabled"])):r("",!0)])]),default:a(()=>[t(ge,null,{default:a(()=>[o("div",Eg,[t(De,{"min-width":"700",clickable:!1,steps:Te.value,"current-step":U.value},null,8,["steps","current-step"])]),t(qa,{class:"disable-tab-transition",modelValue:U.value,"onUpdate:modelValue":Fe[8]||(Fe[8]=Pe=>U.value=Pe)},{default:a(()=>[t(zt,{value:"uploadFile"},{default:a(()=>[t(Ae,{class:"pt-2"},{default:a(()=>[t(R,{cols:"12",md:"12"},{default:a(()=>[t(Ue,{"primary-key-field":"displayCategoryName","primary-value-field":"displayCategoryName","primary-title-field":"displayCategoryName","primary-sub-items-field":"fileTypes","secondary-key-field":"type","secondary-value-field":"type","secondary-title-field":"displayName",disabled:Z.value,"enable-filter":!0,"filter-placeholder":e(n)("Find file type"),"filter-no-items-text":e(n)("No available file type"),label:e(n)("File Type"),placeholder:e(n)("File Type"),items:ue.value,"auto-update-menu-position":!0,modelValue:oe.value,"onUpdate:modelValue":Fe[0]||(Fe[0]=Pe=>oe.value=Pe)},null,8,["disabled","filter-placeholder","filter-no-items-text","label","placeholder","items","modelValue"])]),_:1}),Ee.value?(l(),c(R,{key:0,cols:"12",md:"12"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type",disabled:Z.value,label:e(n)("Format"),placeholder:e(n)("Format"),items:Ee.value,modelValue:W.value,"onUpdate:modelValue":Fe[1]||(Fe[1]=Pe=>W.value=Pe)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1})):r("",!0),!te.value&&me.value?(l(),c(R,{key:1,cols:"12",md:"12"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"encoding",disabled:Z.value,label:e(n)("File Encoding"),placeholder:e(n)("File Encoding"),items:me.value,modelValue:D.value,"onUpdate:modelValue":Fe[2]||(Fe[2]=Pe=>D.value=Pe)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1})):r("",!0),oe.value==="dsv"||oe.value==="dsv_data"?(l(),c(R,{key:2,cols:"12",md:"12"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type",disabled:Z.value,label:e(n)("Handling Method"),placeholder:e(n)("Handling Method"),items:[{displayName:e(n)("Column Mapping"),type:0},{displayName:e(n)("Custom Script"),type:1}],modelValue:M.value,"onUpdate:modelValue":Fe[3]||(Fe[3]=Pe=>M.value=Pe)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1})):r("",!0),Se.value?(l(),c(R,{key:3,cols:"12",md:"12"},{default:a(()=>[t(Ge,{disabled:Z.value,label:e(n)("Additional Options"),placeholder:e(n)("Additional Options"),modelValue:oe.value,"onUpdate:modelValue":Fe[4]||(Fe[4]=Pe=>oe.value=Pe),menu:j.value,"onUpdate:menu":Fe[5]||(Fe[5]=Pe=>j.value=Pe)},{selection:a(()=>[o("span",Mg,i(It.value),1)]),"no-data":a(()=>[t(Je,{class:"py-0"},{default:a(()=>[(l(),g(fe,null,$e(F,Pe=>(l(),g(fe,null,[e(Ht)(Se.value[Pe.key])?(l(),c(ve,{key:Pe.key,"append-icon":L.value[Pe.key]?e(Xe):void 0,onClick:ut=>L.value[Pe.key]=!L.value[Pe.key]},{default:a(()=>[q(i(e(n)(Pe.name)),1)]),_:2},1032,["append-icon","onClick"])):r("",!0)],64))),64))]),_:1})]),_:1},8,["disabled","label","placeholder","modelValue","menu"])]),_:1})):r("",!0),te.value?r("",!0):(l(),c(R,{key:4,cols:"12",md:"12"},{default:a(()=>[t(ot,{readonly:"","persistent-placeholder":"",type:"text",class:"always-cursor-pointer",disabled:Z.value,label:e(n)("Data File"),placeholder:e(n)("format.misc.clickToSelectedFile",{extensions:He.value}),modelValue:ze.value,"onUpdate:modelValue":Fe[6]||(Fe[6]=Pe=>ze.value=Pe),onClick:Et},null,8,["disabled","label","placeholder","modelValue"])]),_:1})),te.value?(l(),c(R,{key:5,cols:"12",md:"12"},{default:a(()=>[t(Oa,{type:"text","persistent-placeholder":"",rows:"5",disabled:Z.value,placeholder:e(n)("Data to import"),modelValue:ye.value,"onUpdate:modelValue":Fe[7]||(Fe[7]=Pe=>ye.value=Pe)},null,8,["disabled","placeholder","modelValue"])]),_:1})):r("",!0),la.value?(l(),c(R,{key:6,cols:"12",md:"12"},{default:a(()=>[o("a",{href:la.value,class:be({disabled:Z.value}),target:"_blank"},[t(ie,{icon:e(Ws),size:"16"},null,8,["icon"]),oe.value==="dsv"||oe.value==="dsv_data"?(l(),g("span",Pg,i(e(n)("How to import this file?")),1)):r("",!0),oe.value!=="dsv"&&oe.value!=="dsv_data"?(l(),g("span",Bg,i(e(n)("How to export this file?")),1)):r("",!0),Ot.value?(l(),g("span",Lg,"["+i(Ot.value)+"]",1)):r("",!0)],10,Ug)]),_:1})):r("",!0)]),_:1})]),_:1}),t(zt,{value:"defineColumn"},{default:a(()=>[t(uy,{ref_key:"importTransactionDefineColumnTab",ref:T,"parsed-file-data":Y.value,disabled:ae.value||Z.value},null,8,["parsed-file-data","disabled"])]),_:1}),t(zt,{value:"executeCustomScript"},{default:a(()=>[t(py,{ref_key:"importTransactionExecuteCustomScriptTab",ref:A,"parsed-file-data":Y.value,disabled:ae.value||Z.value},null,8,["parsed-file-data","disabled"])]),_:1}),t(zt,{value:"checkData"},{default:a(()=>[t(Dg,{ref_key:"importTransactionCheckDataTab",ref:w,"import-transactions":O.value,disabled:ae.value||Z.value},null,8,["import-transactions","disabled"])]),_:1}),t(zt,{value:"finalResult"},{default:a(()=>[o("h4",zg,i(e(n)("Data Import Completed")),1),o("p",Og,i(e(n)("format.misc.importTransactionResult",{count:ke(J.value||0)})),1)]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(ge,null,{default:a(()=>[o("div",Rg,[U.value!=="finalResult"?(l(),c(H,{key:0,color:"secondary",variant:"tonal",disabled:ae.value||Z.value,"prepend-icon":e(vl),onClick:Fe[9]||(Fe[9]=Pe=>Be(!1))},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1},8,["disabled","prepend-icon"])):r("",!0),U.value==="defineColumn"||U.value==="executeCustomScript"||U.value==="uploadFile"?(l(),c(H,{key:1,class:"button-icon-with-direction",color:"primary",disabled:ae.value||Z.value||!te.value&&!ee.value||te.value&&!ye.value||!te.value&&me.value&&D.value==="auto"&&!C.value,"append-icon":Z.value?void 0:e(ba),onClick:Ne},{default:a(()=>[q(i(e(n)("Next"))+" ",1),Z.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled","append-icon"])):r("",!0),U.value==="checkData"?(l(),c(H,{key:2,class:"button-icon-with-direction",color:"teal",disabled:Z.value||w.value?.isEditing||!w.value?.canImport,"append-icon":Z.value?void 0:e(ba),onClick:kt},{default:a(()=>[q(i(Z.value&&X.value>0?e(n)("format.misc.importingTransactions",{process:e(y)(X.value,2)}):e(n)("Import"))+" ",1),Z.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled","append-icon"])):r("",!0),U.value==="finalResult"?(l(),c(H,{key:3,color:"secondary",variant:"tonal","append-icon":e(Xe),onClick:Fe[10]||(Fe[10]=Pe=>Be(!0))},{default:a(()=>[q(i(e(n)("Close")),1)]),_:1},8,["append-icon"])):r("",!0)])]),_:1})]),_:1})]),_:1},8,["persistent","modelValue"]),t(ka,{ref_key:"confirmDialog",ref:V},null,512),t(ct,{ref_key:"snackbar",ref:p},null,512),o("input",{ref_key:"fileInput",ref:I,type:"file",style:{display:"none"},accept:He.value,onChange:Fe[12]||(Fe[12]=Pe=>yt(Pe))},null,40,qg)],64)}}}),jg={key:0},Hg={class:"text-body-1"},Wg={class:"ms-3"},Gg={class:"ms-3"},Kg={class:"ms-3"},Qg={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},$l=Oe({__name:"AccountFilterSettingsCard",props:{type:{},selectedAccountIds:{},dialogMode:{type:Boolean},autoSave:{type:Boolean}},emits:["settings:change"],setup(v,{emit:_}){const n=v,s=_,{tt:h}=je(),{loading:d,showHidden:y,filterContent:f,filterAccountIds:b,title:x,applyText:u,allowHiddenAccount:m,allCategorizedAccounts:k,allVisibleAccountMap:N,hasAnyAvailableAccount:V,hasAnyVisibleAccount:p,isAccountChecked:T,loadFilterAccountIds:A,saveFilterAccountIds:w}=rd(n.type,n.selectedAccountIds),I=pa(),F=xe("snackbar"),S=P(Pl.values().map(C=>C.type));function j(){I.loadAllAccounts({force:!1}).then(()=>{d.value=!1,A()||F.value?.showError("Parameter Invalid")}).catch(C=>{d.value=!1,C.processed||F.value?.showError(C)})}function B(C,M){ud(b.value,C,!M),n.autoSave&&D()}function U(C,M){b.value[C.id]=!M,n.autoSave&&D()}function X(){dd(b.value,N.value),n.autoSave&&D()}function oe(){cd(b.value,N.value),n.autoSave&&D()}function W(){md(b.value,N.value),n.autoSave&&D()}function D(){const[C,M]=w();s("settings:change",C,M)}function $(){s("settings:change",!1)}return j(),(C,M)=>{const ee=Ve("ItemIcon");return l(),g(fe,null,[t(Me,{class:be({"pa-sm-1 pa-md-2":v.dialogMode})},{title:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"6"},{default:a(()=>[o("div",{class:be({"text-h4":v.dialogMode,"text-wrap":!0})},i(e(h)(e(x))),3)]),_:1}),t(R,{cols:"6",class:"d-flex align-center"},{default:a(()=>[v.dialogMode?r("",!0):(l(),c(it,{key:0})),v.dialogMode?(l(),c(ot,{key:1,density:"compact",disabled:e(d)||!e(V),"prepend-inner-icon":e(Ql),placeholder:e(h)("Find account"),modelValue:e(f),"onUpdate:modelValue":M[0]||(M[0]=ye=>ht(f)?f.value=ye:null)},null,8,["disabled","prepend-inner-icon","placeholder","modelValue"])):r("",!0),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",disabled:e(d)||!e(V),icon:!0},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{"prepend-icon":e(nl),title:e(h)("Select All"),disabled:!e(p),onClick:X},null,8,["prepend-icon","title","disabled"]),t(ve,{"prepend-icon":e(vn),title:e(h)("Select None"),disabled:!e(p),onClick:oe},null,8,["prepend-icon","title","disabled"]),t(ve,{"prepend-icon":e(fn),title:e(h)("Invert Selection"),disabled:!e(p),onClick:W},null,8,["prepend-icon","title","disabled"]),e(m)?(l(),c(nt,{key:0,class:"my-2"})):r("",!0),e(m)&&!e(y)?(l(),c(ve,{key:1,"prepend-icon":e(Ma),title:e(h)("Show Hidden Accounts"),onClick:M[1]||(M[1]=ye=>y.value=!0)},null,8,["prepend-icon","title"])):r("",!0),e(m)&&e(y)?(l(),c(ve,{key:2,"prepend-icon":e(da),title:e(h)("Hide Hidden Accounts"),onClick:M[2]||(M[2]=ye=>y.value=!1)},null,8,["prepend-icon","title"])):r("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})]),default:a(()=>[e(d)?(l(),g("div",jg,[(l(),g(fe,null,$e([1,2,3],ye=>t(ft,{type:"paragraph",loading:e(d),key:ye},null,8,["loading"])),64))])):r("",!0),!e(d)&&!e(p)?(l(),c(ge,{key:1},{default:a(()=>[o("span",Hg,i(e(h)("No available account")),1)]),_:1})):!e(d)&&e(p)?(l(),c(ge,{key:2,class:be({"flex-grow-1 overflow-y-auto":v.dialogMode})},{default:a(()=>[t(Yl,{class:"account-categories",multiple:"",modelValue:S.value,"onUpdate:modelValue":M[3]||(M[3]=ye=>S.value=ye)},{default:a(()=>[(l(!0),g(fe,null,$e(e(k),ye=>(l(),c(jl,{key:ye.category,value:ye.category,class:"border"},{default:a(()=>[t(Hl,{class:"expand-panel-title-with-bg py-0"},{default:a(()=>[o("span",Wg,i(e(h)(ye.name)),1)]),_:2},1024),t(Wl,null,{default:a(()=>[t(Je,{rounded:"",density:"comfortable",class:"pa-0"},{default:a(()=>[(l(!0),g(fe,null,$e(ye.accounts,(L,Y)=>(l(),g(fe,{key:L.id},[Y>0?(l(),c(nt,{key:0})):r("",!0),t(ve,null,{prepend:a(()=>[t(il,{"model-value":e(vd)(L,e(b)),indeterminate:e(pd)(L,e(b)),"onUpdate:modelValue":O=>B(L,O)},{label:a(()=>[t(ee,{class:"d-flex","icon-type":"account","icon-id":L.icon,color:L.color,"hidden-status":L.hidden},null,8,["icon-id","color","hidden-status"]),o("span",Gg,i(L.name),1)]),_:2},1032,["model-value","indeterminate","onUpdate:modelValue"])]),_:2},1024),L.type===e(oa).MultiSubAccounts.type&&L.subAccounts&&L.subAccounts.length>0?(l(),c(nt,{key:1})):r("",!0),L.type===e(oa).MultiSubAccounts.type&&L.subAccounts&&L.subAccounts.length>0?(l(),c(Je,{key:2,rounded:"",density:"comfortable",class:"pa-0 ms-4"},{default:a(()=>[(l(!0),g(fe,null,$e(L.subAccounts,(O,J)=>(l(),g(fe,{key:O.id},[J>0?(l(),c(nt,{key:0})):r("",!0),e(y)||!O.hidden?(l(),c(ve,{key:1},{prepend:a(()=>[t(il,{"model-value":e(T)(O,e(b)),"onUpdate:modelValue":ae=>U(O,ae)},{label:a(()=>[t(ee,{class:"d-flex","icon-type":"account","icon-id":O.icon,color:O.color,"hidden-status":O.hidden},null,8,["icon-id","color","hidden-status"]),o("span",Kg,i(O.name),1)]),_:2},1032,["model-value","onUpdate:modelValue"])]),_:2},1024)):r("",!0)],64))),128))]),_:2},1024)):r("",!0)],64))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["class"])):r("",!0),v.dialogMode?(l(),c(ge,{key:3,class:"overflow-y-visible"},{default:a(()=>[o("div",Qg,[t(H,{disabled:!e(V),onClick:D},{default:a(()=>[q(i(e(h)(e(u))),1)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",onClick:$},{default:a(()=>[q(i(e(h)("Cancel")),1)]),_:1})])]),_:1})):r("",!0)]),_:1},8,["class"]),t(ct,{ref_key:"snackbar",ref:F},null,512)],64)}}}),Jg={key:0},Zg={class:"ms-3"},Xg={key:0,class:"ms-5 py-3"},e1={class:"ms-3"},t1={class:"ms-3"},a1={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},Hn=Oe({__name:"CategoryFilterSettingsCard",props:{type:{},selectedCategoryIds:{},dialogMode:{type:Boolean},autoSave:{type:Boolean},categoryTypes:{}},emits:["settings:change"],setup(v,{emit:_}){const n=v,s=_,{tt:h}=je(),{loading:d,showHidden:y,filterContent:f,filterCategoryIds:b,title:x,applyText:u,allVisibleTransactionCategories:m,allVisibleTransactionCategoryMap:k,hasAnyAvailableCategory:N,hasAnyVisibleCategory:V,isCategoryChecked:p,getCategoryTypeName:T,loadFilterCategoryIds:A,saveFilterCategoryIds:w}=fd(n.type,n.categoryTypes,n.selectedCategoryIds),I=va(),F=xe("snackbar"),S=P([st.Income,st.Expense,st.Transfer]);function j(){I.loadAllCategories({force:!1}).then(()=>{d.value=!1,A()||F.value?.showError("Parameter Invalid")}).catch(C=>{d.value=!1,C.processed||F.value?.showError(C)})}function B(C,M){C&&(b.value[C.id]=!M,n.autoSave&&D())}function U(C,M){yd(b.value,!M,C),n.autoSave&&D()}function X(){gd(b.value,k.value),n.autoSave&&D()}function oe(){hd(b.value,k.value),n.autoSave&&D()}function W(){bd(b.value,k.value),n.autoSave&&D()}function D(){const[C,M]=w();s("settings:change",C,M)}function $(){s("settings:change",!1)}return j(),(C,M)=>{const ee=Ve("ItemIcon");return l(),g(fe,null,[t(Me,{class:be({"pa-sm-1 pa-md-2":v.dialogMode})},{title:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"6"},{default:a(()=>[o("div",{class:be({"text-h4":v.dialogMode,"text-wrap":!0})},i(e(h)(e(x))),3)]),_:1}),t(R,{cols:"6",class:"d-flex align-center"},{default:a(()=>[v.dialogMode?r("",!0):(l(),c(it,{key:0})),v.dialogMode?(l(),c(ot,{key:1,density:"compact",disabled:e(d)||!e(N),"prepend-inner-icon":e(Ql),placeholder:e(h)("Find category"),modelValue:e(f),"onUpdate:modelValue":M[0]||(M[0]=ye=>ht(f)?f.value=ye:null)},null,8,["disabled","prepend-inner-icon","placeholder","modelValue"])):r("",!0),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",disabled:e(d)||!e(N),icon:!0},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{"prepend-icon":e(nl),title:e(h)("Select All"),disabled:!e(V),onClick:X},null,8,["prepend-icon","title","disabled"]),t(ve,{"prepend-icon":e(vn),title:e(h)("Select None"),disabled:!e(V),onClick:oe},null,8,["prepend-icon","title","disabled"]),t(ve,{"prepend-icon":e(fn),title:e(h)("Invert Selection"),disabled:!e(V),onClick:W},null,8,["prepend-icon","title","disabled"]),t(nt,{class:"my-2"}),e(y)?r("",!0):(l(),c(ve,{key:0,"prepend-icon":e(Ma),title:e(h)("Show Hidden Transaction Categories"),onClick:M[1]||(M[1]=ye=>y.value=!0)},null,8,["prepend-icon","title"])),e(y)?(l(),c(ve,{key:1,"prepend-icon":e(da),title:e(h)("Hide Hidden Transaction Categories"),onClick:M[2]||(M[2]=ye=>y.value=!1)},null,8,["prepend-icon","title"])):r("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})]),default:a(()=>[e(d)?(l(),g("div",Jg,[(l(),g(fe,null,$e([1,2,3],ye=>t(ft,{type:"paragraph",loading:e(d),key:ye},null,8,["loading"])),64))])):e(d)?r("",!0):(l(),c(ge,{key:1,class:be({"flex-grow-1 overflow-y-auto":v.dialogMode})},{default:a(()=>[t(Yl,{class:"category-types",multiple:"",modelValue:S.value,"onUpdate:modelValue":M[3]||(M[3]=ye=>S.value=ye)},{default:a(()=>[(l(!0),g(fe,null,$e(e(m),(ye,L)=>(l(),c(jl,{key:L,value:parseInt(L),class:"border"},{default:a(()=>[t(Hl,{class:"expand-panel-title-with-bg py-0"},{default:a(()=>[o("span",Zg,i(e(T)(parseInt(L))),1)]),_:2},1024),t(Wl,null,{default:a(()=>[t(Je,{rounded:"",density:"comfortable",class:"pa-0"},{default:a(()=>[!ye||!ye.length?(l(),g("div",Xg,i(e(h)("No available category")),1)):r("",!0),(l(!0),g(fe,null,$e(ye,(Y,O)=>(l(),g(fe,{key:Y.id},[O>0?(l(),c(nt,{key:0})):r("",!0),t(ve,null,{prepend:a(()=>[t(il,{"model-value":e(kd)(Y,e(b)),indeterminate:e(Td)(Y,e(b)),"onUpdate:modelValue":J=>U(Y,J)},{label:a(()=>[t(ee,{class:"d-flex","icon-type":"category","icon-id":Y.icon,color:Y.color,"hidden-status":Y.hidden},null,8,["icon-id","color","hidden-status"]),o("span",e1,i(Y.name),1)]),_:2},1032,["model-value","indeterminate","onUpdate:modelValue"])]),_:2},1024),Y.subCategories&&Y.subCategories.length?(l(),c(nt,{key:1})):r("",!0),Y.subCategories&&Y.subCategories.length?(l(),c(Je,{key:2,rounded:"",density:"comfortable",class:"pa-0 ms-4"},{default:a(()=>[(l(!0),g(fe,null,$e(Y.subCategories,(J,ae)=>(l(),g(fe,{key:J.id},[ae>0?(l(),c(nt,{key:0})):r("",!0),t(ve,null,{prepend:a(()=>[t(il,{"model-value":e(p)(J,e(b)),"onUpdate:modelValue":Z=>B(J,Z)},{label:a(()=>[t(ee,{class:"d-flex","icon-type":"category","icon-id":J.icon,color:J.color,"hidden-status":J.hidden},null,8,["icon-id","color","hidden-status"]),o("span",t1,i(J.name),1)]),_:2},1032,["model-value","onUpdate:modelValue"])]),_:2},1024)],64))),128))]),_:2},1024)):r("",!0)],64))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["class"])),v.dialogMode?(l(),c(ge,{key:2,class:"overflow-y-visible"},{default:a(()=>[o("div",a1,[t(H,{disabled:!e(N),onClick:D},{default:a(()=>[q(i(e(h)(e(u))),1)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",onClick:$},{default:a(()=>[q(i(e(h)("Cancel")),1)]),_:1})])]),_:1})):r("",!0)]),_:1},8,["class"]),t(ct,{ref_key:"snackbar",ref:F},null,512)],64)}}}),l1={key:0},n1={class:"text-body-1"},o1={key:0,class:"mb-4"},s1={key:1,class:"mb-4"},i1={class:"ms-3"},r1={class:"ms-3"},u1={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},Si=Oe({__name:"TransactionTagFilterSettingsCard",props:{type:{},dialogMode:{type:Boolean},autoSave:{type:Boolean}},emits:["settings:change"],setup(v,{emit:_}){const n=v,s=_,{tt:h}=je(),{loading:d,showHidden:y,filterContent:f,filterTagIds:b,includeTagFilterType:x,excludeTagFilterType:u,includeTagsCount:m,excludeTagsCount:k,title:N,applyText:V,allVisibleTags:p,hasAnyAvailableTag:T,hasAnyVisibleTag:A,loadFilterTagIds:w,saveFilterTagIds:I}=_d(n.type),F=rl(),S=xe("snackbar"),j=P(["default"]);function B(){F.loadAllTags({force:!1}).then(()=>{d.value=!1,w()||S.value?.showError("Parameter Invalid")}).catch(C=>{d.value=!1,C.processed||S.value?.showError(C)})}function U(C,M){b.value[C.id]=M,n.autoSave&&D()}function X(C){x.value=C,n.autoSave&&D()}function oe(C){u.value=C,n.autoSave&&D()}function W(C){for(const M of p.value)b.value[M.id]=C;n.autoSave&&D()}function D(){const C=I();s("settings:change",C)}function $(){s("settings:change",!1)}return B(),(C,M)=>(l(),g(fe,null,[t(Me,{class:be({"pa-sm-1 pa-md-2":v.dialogMode})},{title:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"6"},{default:a(()=>[o("div",{class:be({"text-h4":v.dialogMode,"text-wrap":!0})},i(e(h)(e(N))),3)]),_:1}),t(R,{cols:"6",class:"d-flex align-center"},{default:a(()=>[v.dialogMode?r("",!0):(l(),c(it,{key:0})),v.dialogMode?(l(),c(ot,{key:1,density:"compact",disabled:e(d)||!e(T),"prepend-inner-icon":e(Ql),placeholder:e(h)("Find tag"),modelValue:e(f),"onUpdate:modelValue":M[0]||(M[0]=ee=>ht(f)?f.value=ee:null)},null,8,["disabled","prepend-inner-icon","placeholder","modelValue"])):r("",!0),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",disabled:e(d)||!e(T),icon:!0},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{"prepend-icon":e(nl),title:e(h)("Set All to Included"),disabled:!e(A),onClick:M[1]||(M[1]=ee=>W(e(nn).Include))},null,8,["prepend-icon","title","disabled"]),t(ve,{"prepend-icon":e(nl),title:e(h)("Set All to Default"),disabled:!e(A),onClick:M[2]||(M[2]=ee=>W(e(nn).Default))},null,8,["prepend-icon","title","disabled"]),t(ve,{"prepend-icon":e(nl),title:e(h)("Set All to Excluded"),disabled:!e(A),onClick:M[3]||(M[3]=ee=>W(e(nn).Exclude))},null,8,["prepend-icon","title","disabled"]),t(nt,{class:"my-2"}),e(y)?r("",!0):(l(),c(ve,{key:0,"prepend-icon":e(Ma),title:e(h)("Show Hidden Transaction Tags"),onClick:M[4]||(M[4]=ee=>y.value=!0)},null,8,["prepend-icon","title"])),e(y)?(l(),c(ve,{key:1,"prepend-icon":e(da),title:e(h)("Hide Hidden Transaction Tags"),onClick:M[5]||(M[5]=ee=>y.value=!1)},null,8,["prepend-icon","title"])):r("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})]),default:a(()=>[e(d)?(l(),g("div",l1,[(l(),g(fe,null,$e([1,2,3],ee=>t(ft,{type:"paragraph",loading:e(d),key:ee},null,8,["loading"])),64))])):r("",!0),!e(d)&&!e(A)?(l(),c(ge,{key:1},{default:a(()=>[o("span",n1,i(e(h)("No available tag")),1)]),_:1})):!e(d)&&e(A)?(l(),c(ge,{key:2,class:be({"flex-grow-1 overflow-y-auto":v.dialogMode})},{default:a(()=>[e(m)>1?(l(),g("div",o1,[t(Ul,{class:"toggle-buttons",density:"compact",variant:"outlined",mandatory:"force",divided:"","model-value":e(x),"onUpdate:modelValue":M[6]||(M[6]=ee=>X(ee))},{default:a(()=>[t(H,{value:e(Sl).HasAny.type},{default:a(()=>[q(i(e(h)(e(Sl).HasAny.name)),1)]),_:1},8,["value"]),t(H,{value:e(Sl).HasAll.type},{default:a(()=>[q(i(e(h)(e(Sl).HasAll.name)),1)]),_:1},8,["value"])]),_:1},8,["model-value"])])):r("",!0),e(k)>1?(l(),g("div",s1,[t(Ul,{class:"toggle-buttons",density:"compact",variant:"outlined",mandatory:"force",divided:"","model-value":e(u),"onUpdate:modelValue":M[7]||(M[7]=ee=>oe(ee))},{default:a(()=>[t(H,{value:e(Sl).NotHasAny.type},{default:a(()=>[q(i(e(h)(e(Sl).NotHasAny.name)),1)]),_:1},8,["value"]),t(H,{value:e(Sl).NotHasAll.type},{default:a(()=>[q(i(e(h)(e(Sl).NotHasAll.name)),1)]),_:1},8,["value"])]),_:1},8,["model-value"])])):r("",!0),t(Yl,{class:"tag-categories",multiple:"",modelValue:j.value,"onUpdate:modelValue":M[8]||(M[8]=ee=>j.value=ee)},{default:a(()=>[t(jl,{class:"border",key:"default",value:"default"},{default:a(()=>[t(Hl,{class:"expand-panel-title-with-bg py-0"},{default:a(()=>[o("span",i1,i(e(h)("Tags")),1)]),_:1}),t(Wl,null,{default:a(()=>[t(Je,{rounded:"",density:"comfortable",class:"pa-0"},{default:a(()=>[(l(!0),g(fe,null,$e(e(p),ee=>(l(),c(ve,{key:ee.id},{prepend:a(()=>[ee.hidden?(l(),c(Il,{key:0,class:"right-bottom-icon",color:"secondary",location:"bottom right","offset-x":"2","offset-y":"2",icon:e(da)},{default:a(()=>[t(ie,{size:"24",icon:e(ea)},null,8,["icon"])]),_:1},8,["icon"])):ee.hidden?r("",!0):(l(),c(ie,{key:1,size:"24",icon:e(ea)},null,8,["icon"])),o("span",r1,i(ee.name),1)]),append:a(()=>[t(Ul,{class:"toggle-buttons",density:"compact",variant:"outlined",mandatory:"force",divided:"","model-value":e(b)[ee.id],"onUpdate:modelValue":ye=>U(ee,ye)},{default:a(()=>[t(H,{value:e(nn).Include},{default:a(()=>[q(i(e(h)("Included")),1)]),_:1},8,["value"]),t(H,{value:e(nn).Default},{default:a(()=>[q(i(e(h)("Default")),1)]),_:1},8,["value"]),t(H,{value:e(nn).Exclude},{default:a(()=>[q(i(e(h)("Excluded")),1)]),_:1},8,["value"])]),_:1},8,["model-value","onUpdate:modelValue"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["class"])):r("",!0),v.dialogMode?(l(),c(ge,{key:3,class:"overflow-y-visible"},{default:a(()=>[o("div",u1,[t(H,{disabled:!e(T),onClick:D},{default:a(()=>[q(i(e(h)(e(V))),1)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",onClick:$},{default:a(()=>[q(i(e(h)("Cancel")),1)]),_:1})])]),_:1})):r("",!0)]),_:1},8,["class"]),t(ct,{ref_key:"snackbar",ref:S},null,512)],64))}}),d1={class:"mx-6 my-4"},c1={class:"mx-6 mt-4"},m1={class:"text-subtitle-2"},p1={key:0,class:"mx-6 mt-4"},v1={class:"text-subtitle-2"},f1={class:"text-truncate"},y1={class:"title-and-toolbar d-flex align-center text-no-wrap"},g1={class:"transaction-keyword-filter ms-2"},h1={class:"transaction-list-datetime-range d-flex align-center"},b1={class:"text-body-1"},T1={key:0,class:"text-body-1 transaction-list-datetime-range-text ms-2"},k1={class:"text-sm"},_1={key:1,class:"text-body-1 transaction-list-datetime-range-text ms-2"},x1={class:"text-sm"},C1={key:2,class:"skeleton-no-margin d-flex align-center"},w1={class:"ms-2 text-subtitle-1"},A1={key:0,class:"text-income ms-2"},S1={key:1,class:"text-income ms-2"},V1={class:"text-subtitle-1 ms-3"},I1={key:2,class:"text-expense ms-2"},D1={key:3,class:"text-expense ms-2"},$1={class:"transaction-table-column-time text-no-wrap"},N1={class:"d-flex align-center"},F1={class:"text-sm ms-3"},E1={key:0,class:"transaction-list-custom-datetime-range ms-3 smaller"},M1={class:"transaction-table-column-category text-no-wrap"},U1={class:"d-flex align-center"},P1={class:"text-sm ms-3"},B1={class:"d-flex align-center"},L1={class:"text-sm ms-3"},z1={class:"text-sm"},O1={class:"d-flex align-center"},R1={class:"text-sm ms-3"},q1={class:"d-flex align-center"},Y1={class:"text-sm ms-3"},j1={class:"d-flex align-center"},H1={class:"text-sm ms-3"},W1={class:"transaction-table-column-amount text-no-wrap"},G1={class:"d-flex align-center"},K1={class:"text-sm ms-3"},Q1={class:"d-flex align-center"},J1={class:"text-sm ms-3"},Z1={key:0,class:"text-sm ms-4"},X1={key:2,class:"ms-2 me-2"},eh={class:"transaction-table-column-account text-no-wrap"},th={class:"d-flex align-center"},ah={class:"text-sm ms-3"},lh={class:"d-flex align-center"},nh={class:"text-sm ms-3"},oh={class:"d-flex align-center"},sh={class:"text-sm ms-3"},ih={key:0,class:"transaction-table-column-tags text-no-wrap"},rh={class:"d-flex align-center"},uh={class:"text-sm ms-3"},dh={class:"d-flex align-center"},ch={class:"text-sm ms-3"},mh={class:"d-flex align-center"},ph={class:"text-sm ms-3"},vh={class:"d-flex align-center"},fh={class:"text-sm ms-3"},yh={class:"transaction-table-column-description text-no-wrap"},gh={key:0},hh=["colspan"],bh={key:1},Th=["colspan"],kh={key:0,class:"transaction-list-row-date no-hover text-sm"},_h=["colspan"],xh={class:"d-flex align-center"},Ch=["onClick"],wh={class:"transaction-table-column-time"},Ah={class:"d-flex flex-column"},Sh={key:0,class:"text-caption"},Vh={class:"transaction-table-column-category"},Ih={class:"d-flex align-center"},Dh={key:2,class:"ms-2"},$h={key:3,class:"ms-2"},Nh={key:4,class:"ms-2"},Fh={key:0},Eh={class:"transaction-table-column-account"},Mh={class:"d-flex align-center"},Uh={key:0},Ph={key:2},Bh={key:0,class:"transaction-table-column-tags"},Lh={class:"transaction-table-column-description text-truncate"},zh={key:1,class:"mt-2 mb-4"},Oh=Oe({__name:"ListPage",props:{initPageType:{},initDateType:{},initMaxTime:{},initMinTime:{},initType:{},initCategoryIds:{},initAccountIds:{},initTagFilter:{},initAmountFilter:{},initKeyword:{}},setup(v){const _=v,n=Na(),s=Rl(),h=Kt(),{tt:d,getAllRecentMonthDateRanges:y,getWeekdayLongName:f,getCurrentNumeralSystemType:b}=je(),{pageType:x,loading:u,customMinDatetime:m,customMaxDatetime:k,currentCalendarDate:N,firstDayOfWeek:V,fiscalYearStart:p,defaultCurrency:T,showTotalAmountInTransactionListPage:A,showTagInTransactionListPage:w,allDateRanges:I,allAccounts:F,allAccountsMap:S,allAvailableAccountsCount:j,allCategories:B,allPrimaryCategories:U,allAvailableCategoriesCount:X,allTransactionTags:oe,allAvailableTagsCount:W,query:D,queryMinTime:$,queryMaxTime:C,queryMonthlyData:M,queryMonth:ee,queryAllFilterCategoryIds:ye,queryAllFilterAccountIds:L,queryAllFilterTagIds:Y,queryAllFilterCategoryIdsCount:O,queryAllFilterAccountIdsCount:J,queryAllFilterTagIdsCount:ae,queryAccountName:Z,queryCategoryName:le,queryTagName:z,queryAmount:se,transactionCalendarMinDate:ue,transactionCalendarMaxDate:Ee,currentMonthTransactionData:me,hasSubCategoryInQuery:te,isSameAsDefaultTimezoneOffsetMinutes:Se,canAddTransaction:Te,getDisplayTime:Ye,getDisplayLongDate:He,getDisplayTimezone:It,getDisplayTimeInDefaultTimezone:la,getDisplayAmount:Ot,getDisplayMonthTotalAmount:ze,getTransactionTypeName:ke}=xd(),Ie=Ya(),Et=ta(),yt=pa(),Ne=va(),kt=rl(),Be=en(),Ke=rs(),Fe=ci(),De=xe("timeFilterMenu"),Ue=xe("categoryFilterMenu"),Pe=xe("amountFilterMenu"),ut=xe("accountFilterMenu"),we=xe("tagFilterMenu"),Dt=xe("confirmDialog"),bt=xe("snackbar"),St=xe("editDialog"),_a=xe("aiImageRecognitionDialog"),Vt=xe("importDialog"),Qt=P("transactionPage"),Rt=P(1),Ct=P(null),fa=P(1),xa=P(""),ia=P(""),aa=P(0),Xa=P(0),ul=P([]),Ua=P(!1),ja=P(!1),ya=P(!1),Cl=P(s.mdAndUp.value),Pa=P(s.mdAndUp.value),el=P(!1),Ha=P(!1),dl=P(!1),cl=P(!1),ml=P(!1),wl=E(()=>h.global.name.value===$t.Dark),Al=E(()=>b()),G=E(()=>{const ne=[],ce=[5,10,15,20,25,30,50];for(const pt of ce)ne.push({value:pt,name:Al.value.replaceWesternArabicDigitsToLocalizedDigits(pt.toString())});return ne}),K=E(()=>y(x.value===ca.List.type,!0)),Re=E(()=>Ke.allVisibleTemplates[Da.Normal.type]||[]),at=E(()=>pe.Income<=D.value.type&&D.value.type<=pe.Transfer?Ho(D.value.type)?.toString()??"":""),gt=E(()=>{if(x.value===ca.List.type)if(M.value){const ne=me.value;if(!ne||!ne.items)return[];const ce=(Rt.value-1)*Ca.value,pt=Rt.value*Ca.value;return ne.items.slice(ce,pt)}else return ul.value;else if(x.value===ca.Calendar.type)if(M.value){const ne=me.value;if(!ne||!ne.items)return[];const ce=[];for(const pt of ne.items)pt.gregorianCalendarYearDashMonthDashDay===N.value&&ce.push(pt);return ce}else return[];else return[]}),Wa=E({get:()=>Cd(K.value,D.value.dateType,D.value.minTime,D.value.maxTime,V.value,p.value),set:ne=>{(ne<0||ne>=K.value.length)&&(ne=0),Qe(K.value[ne])}}),Fa=E({get:()=>x.value,set:ne=>de(ne)}),We=E({get:()=>D.value.type,set:ne=>$i(ne)}),Nt=E(()=>O.value===0?"":O.value===1?D.value.categoryIds:"multiple"),tl=E(()=>J.value===0?"":J.value===1?D.value.accountIds:"multiple"),Le=E(()=>{if(D.value.tagFilter===gl.TransactionNoTagFilterValue)return gl.TransactionNoTagFilterValue;if(ae.value===0)return"";if(ae.value===1){for(const ne of El(Y.value))return ne;return""}else return"multiple"}),Ca=E({get:()=>Ct.value?Ct.value:Ie.appSettings.itemsCountInTransactionListPage,set:ne=>{const ce=Math.ceil(fa.value/ne);Rt.value>ce&&(Rt.value=ce),Ct.value=ne,M.value||dt(!1,!1)}}),ko=E(()=>Math.ceil(fa.value/Ca.value)),Wn=E({get:()=>Rt.value,set:ne=>{Rt.value=ne,M.value||dt(!1,!1)}}),_o=E(()=>{const ne=[],ce=x.value===ca.List.type?Ca.value:3;for(let pt=0;pt<ce;pt++)ne.push(pt);return ne}),Q=E(()=>{if(M.value){const ne=me.value;return ne?{income:ze(ne.totalAmount.income,T.value,"",ne.totalAmount.incompleteIncome),expense:ze(ne.totalAmount.expense,T.value,"",ne.totalAmount.incompleteExpense)}:null}else return null});function he(ne,ce){if(ce&&ce[ne.id])return{"list-item-selected":!0,"has-children-item-selected":!0};if(ne.subCategories){for(const pt of ne.subCategories)if(ce&&ce[pt.id])return{"list-item-selected":!0,"has-children-item-selected":!0}}return{}}function _e(ne){const ce=yo.valueOf(ne);return ce?ce.paramCount:0}function qe(ne){ne&&(u.value=!0,ul.value=[],Be.clearTransactions(),n.push(`/transaction/list?${Be.getTransactionListPageParams(x.value)}`))}function Ce(ne){let ce=zn(ne.initDateType?parseInt(ne.initDateType):void 0,V.value,p.value);if(!ce&&ne.initDateType&&ne.initMaxTime&&ne.initMinTime&&(Lt.isBillingCycle(parseInt(ne.initDateType))||ne.initDateType===Lt.Custom.type.toString())&&parseInt(ne.initMaxTime)>0&&parseInt(ne.initMinTime)>0&&(ce={dateType:parseInt(ne.initDateType),maxTime:parseInt(ne.initMaxTime),minTime:parseInt(ne.initMinTime)}),Be.initTransactionListFilter({dateType:ce?ce.dateType:void 0,maxTime:ce?ce.maxTime:void 0,minTime:ce?ce.minTime:void 0,type:ne.initType&&parseInt(ne.initType)>0?parseInt(ne.initType):void 0,categoryIds:ne.initCategoryIds,accountIds:ne.initAccountIds,tagFilter:ne.initTagFilter,amountFilter:ne.initAmountFilter||"",keyword:ne.initKeyword||""}),ne.initPageType){const pt=ca.valueOf(parseInt(ne.initPageType));if(pt&&(x.value=pt.type,N.value=ll(D.value.minTime,N.value),x.value===ca.Calendar.type)){const lt=wn(D.value.minTime,D.value.maxTime,V.value,p.value);if(lt){const Pt=Be.updateTransactionListFilter({dateType:lt.dateType,maxTime:lt.maxTime,minTime:lt.minTime});if(Pt){N.value=ll(D.value.minTime,N.value),qe(Pt);return}}}}xa.value=ne.initKeyword||"",ia.value="",Rt.value=1,dt(!1,!0),Ke.loadAllTemplates({templateType:Da.Normal.type,force:!1})}function dt(ne,ce){u.value=!0;const pt=Rt.value;Promise.all([yt.loadAllAccounts({force:!1}),Ne.loadAllCategories({force:!1}),kt.loadAllTags({force:!1})]).then(()=>{if(ce&&Fe.showAddTransactionDialogInTransactionList&&(Fe.resetShowAddTransactionDialogInTransactionList(),Gn()),M.value){const lt=Ia(D.value.minTime),Pt=lt.getGregorianCalendarYear(),Nl=lt.getGregorianCalendarMonth();return Be.loadMonthlyAllTransactions({year:Pt,month:Nl,autoExpand:!0,defaultCurrency:T.value})}else return Be.loadTransactions({reload:!0,count:Ca.value,page:pt,withCount:pt<=1,autoExpand:!0,defaultCurrency:T.value})}).then(lt=>{u.value=!1,ul.value=lt&&lt.items&&lt.items.length?lt.items:[],pt<=1&&(fa.value=lt&&lt.totalCount?lt.totalCount:1),ne&&bt.value?.showMessage("Data has been updated")}).catch(lt=>{u.value=!1,ul.value=[],fa.value=1,lt.processed||bt.value?.showError(lt)})}function de(ne){if(x.value=ne,N.value=ll(D.value.minTime,N.value),x.value===ca.Calendar.type){const ce=wn(D.value.minTime,D.value.maxTime,V.value,p.value);ce&&(Be.updateTransactionListFilter({dateType:ce.dateType,maxTime:ce.maxTime,minTime:ce.minTime}),N.value=ll(D.value.minTime,N.value))}qe(!0)}function Qe(ne){if(ne===Lt.Custom.type||zl(ne)&&ne.dateType===Lt.Custom.type&&!ne.minTime&&!ne.maxTime){!D.value.minTime||!D.value.maxTime?(k.value=Bn(),m.value=wd(k.value)):(k.value=D.value.maxTime,m.value=D.value.minTime),x.value===ca.Calendar.type?Ha.value=!0:el.value=!0;return}if(Zt(ne)&&(Lt.isBillingCycle(ne)?ne=_i(ne,V.value,p.value,yt.getAccountStatementDate(D.value.accountIds)):ne=zn(ne,V.value,p.value)),!ne)return;if(x.value===ca.Calendar.type){N.value=ll(ne.minTime,N.value);const pt=wn(ne.minTime,ne.maxTime,V.value,p.value);pt&&(ne=pt,N.value=ll(ne.minTime,N.value))}if(D.value.dateType===ne.dateType&&D.value.maxTime===ne.maxTime&&D.value.minTime===ne.minTime)return;const ce=Be.updateTransactionListFilter({dateType:ne.dateType,maxTime:ne.maxTime,minTime:ne.minTime});qe(ce)}function Ut(ne,ce){if(!ne||!ce)return;let pt=Ad(ne,ce,V.value,p.value,ma.Normal,yt.getAccountStatementDate(D.value.accountIds));if(pt||(pt=Bl(ne,ce,V.value,p.value,ma.Normal)),x.value===ca.Calendar.type){N.value=ll(ne,N.value);const Pt=wn(ne,ce,V.value,p.value);Pt&&(ne=Pt.minTime,ce=Pt.maxTime,pt=Pt.dateType,N.value=ll(ne,N.value))}if(D.value.dateType===pt&&D.value.maxTime===ce&&D.value.minTime===ne){el.value=!1;return}const lt=Be.updateTransactionListFilter({dateType:pt,maxTime:ce,minTime:ne});el.value=!1,qe(lt)}function al(ne){if(!ne)return;const ce=mn(ne),pt=ho(ne),lt=Bl(ce,pt,V.value,p.value,ma.Normal);if(x.value===ca.Calendar.type&&(N.value=ll(ce,N.value)),D.value.dateType===lt&&D.value.maxTime===pt&&D.value.minTime===ce){Ha.value=!1;return}const Pt=Be.updateTransactionListFilter({dateType:lt,maxTime:pt,minTime:ce});Ha.value=!1,qe(Pt)}function _n(ne,ce,pt){if(K.value[Wa.value]?.dateType===Lt.All.type)return;let lt=null;if((Lt.isBillingCycle(D.value.dateType)||D.value.dateType===Lt.Custom.type)&&(lt=Sd(ne,ce,pt,V.value,p.value,ma.Normal,yt.getAccountStatementDate(D.value.accountIds))),lt||(lt=Nn(ne,ce,pt,V.value,p.value,ma.Normal)),x.value===ca.Calendar.type){N.value=ll(lt.minTime,N.value);const Nl=wn(lt.minTime,lt.maxTime,V.value,p.value);Nl&&(lt=Nl,N.value=ll(lt.minTime,N.value))}const Pt=Be.updateTransactionListFilter({dateType:lt.dateType,maxTime:lt.maxTime,minTime:lt.minTime});qe(Pt)}function $i(ne){let ce;if(ne&&D.value.categoryIds){ce="";for(const lt of El(ye.value)){const Pt=B.value[lt];Pt&&Pt.type===Ho(ne)&&(ce.length>0&&(ce+=","),ce+=lt)}}const pt=Be.updateTransactionListFilter({type:ne,categoryIds:ce});qe(pt)}function xo(ne){if(Ua.value=!1,D.value.categoryIds===ne)return;const ce=Be.updateTransactionListFilter({categoryIds:ne});qe(ce)}function Ni(ne){Ua.value=!1,cl.value=!1,qe(ne)}function fs(ne){if(D.value.accountIds===ne)return;const ce=Be.updateTransactionListFilter({accountIds:ne});qe(ce)}function Fi(ne){dl.value=!1,qe(ne)}function Co(ne){if(D.value.tagFilter===ne)return;const ce=Be.updateTransactionListFilter({tagFilter:ne});qe(ce)}function Ei(ne){ml.value=!1,qe(ne)}function ys(ne){if(D.value.keyword===ne)return;const ce=Be.updateTransactionListFilter({keyword:ne});qe(ce)}function gs(ne){if(ia.value="",ja.value=!1,D.value.amountFilter===ne)return;let ce=ne;if(ne){const lt=_e(ne);if(!lt)return;if(lt===1)ce+=":"+aa.value;else if(lt===2){if(Xa.value<aa.value){bt.value?.showMessage("Incorrect amount range");return}ce+=":"+aa.value+":"+Xa.value}else return}if(D.value.amountFilter===ce)return;const pt=Be.updateTransactionListFilter({amountFilter:ce});qe(pt)}function Gn(ne){const ce=Bn();let pt;D.value.maxTime&&D.value.minTime&&(D.value.maxTime<ce?pt=D.value.maxTime:ce<D.value.minTime&&(pt=D.value.minTime)),St.value?.open({time:pt,type:D.value.type,categoryId:O.value===1?D.value.categoryIds:"",accountId:J.value===1?D.value.accountIds:"",tagIds:Vd(Y.value,!0).join(",")||"",template:ne}).then(lt=>{lt&&lt.message&&bt.value?.showMessage(lt.message),dt(!1,!1)}).catch(lt=>{lt&&bt.value?.showError(lt)})}function Mi(){_a.value?.open().then(ne=>{St.value?.open({time:ne.time,type:ne.type,categoryId:ne.categoryId,accountId:ne.sourceAccountId,destinationAccountId:ne.destinationAccountId,amount:ne.sourceAmount,destinationAmount:ne.destinationAmount,tagIds:ne.tagIds?ne.tagIds.join(","):void 0,comment:ne.comment,noTransactionDraft:!0}).then(ce=>{ce&&ce.message&&bt.value?.showMessage(ce.message),dt(!1,!1)}).catch(ce=>{ce&&bt.value?.showError(ce)})})}function Ui(){Vt.value?.open().then(()=>{dt(!1,!1)}).catch(ne=>{ne&&bt.value?.showError(ne)})}function Kn(ne){if(ya.value)return;const ce=Et.currentUserNickname;let pt="";ce?pt=d("dataExport.exportFilename",{nickname:ce})+"."+ne:pt=d("dataExport.defaultExportFilename")+"."+ne;const lt=Be.getExportTransactionDataRequestByTransactionFilter();ya.value=!0,Et.getExportedUserData(ne,lt).then(Pt=>{tn(pt,Pt),ya.value=!1}).catch(Pt=>{ya.value=!1,Pt.processed||bt.value?.showError(Pt)})}function Pi(ne){St.value?.open({id:ne.id,currentTransaction:ne}).then(ce=>{ce&&ce.message&&bt.value?.showMessage(ce.message),dt(!1,!1)}).catch(ce=>{ce&&bt.value?.showError(ce)})}function Bi(ne){ne&&xn(De.value)}function Li(ne){ne&&xn(Ue.value)}function zi(ne){if(ne){ia.value="";let ce=0,pt=0;if(Va(D.value.amountFilter))try{const lt=D.value.amountFilter.split(":"),Pt=_e(lt[0]);lt.length===2&&Pt===1?ce=parseInt(lt[1]):lt.length===3&&Pt===2&&(ce=parseInt(lt[1]),pt=parseInt(lt[2]))}catch(lt){Xt.warn("cannot parse amount from filter value, original value is "+D.value.amountFilter,lt)}aa.value=ce,Xa.value=pt,xn(Pe.value)}}function Oi(ne){ne&&xn(ut.value)}function Ri(ne){ne&&xn(we.value)}function xn(ne){ha(()=>{Ol(ne?.contentEl,"div.v-list","div.v-list","div.v-list-item.list-item-selected")})}function hs(ne){bt.value?.showError(ne)}return Rn(ne=>{ne.query?Ce({initDateType:ne.query.dateType||void 0,initMinTime:ne.query.minTime||void 0,initMaxTime:ne.query.maxTime||void 0,initType:ne.query.type||void 0,initCategoryIds:ne.query.categoryIds||void 0,initAccountIds:ne.query.accountIds||void 0,initTagFilter:ne.query.tagFilter||void 0,initAmountFilter:ne.query.amountFilter||void 0,initKeyword:ne.query.keyword||void 0}):Ce({})}),Ft(()=>s.mdAndUp.value,ne=>{Cl.value=ne,Pa.value||(Pa.value=ne)}),Ft(()=>Fe.showAddTransactionDialogInTransactionList,ne=>{ne&&(Fe.resetShowAddTransactionDialogInTransactionList(),Gn())}),Ce(_),(ne,ce)=>{const pt=Ve("btn-vertical-group"),lt=Ve("transaction-calendar"),Pt=Ve("ItemIcon"),Nl=Ve("amount-input"),qi=Ve("date-range-selection-dialog"),Yi=Ve("month-selection-dialog");return l(),g(fe,null,[t(Ae,{class:"match-height"},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,null,{default:a(()=>[t(Jl,null,{default:a(()=>[t(Zl,{permanent:Cl.value,modelValue:Pa.value,"onUpdate:modelValue":ce[4]||(ce[4]=re=>Pa.value=re)},{default:a(()=>[o("div",d1,[t(pt,{disabled:e(u),buttons:e(ca).values().map(re=>({name:e(d)(re.name),value:re.type})),modelValue:Fa.value,"onUpdate:modelValue":ce[0]||(ce[0]=re=>Fa.value=re)},null,8,["disabled","buttons","modelValue"])]),t(nt),o("div",c1,[o("span",m1,i(e(d)("Transaction Type")),1),t(Ge,{"item-title":"displayName","item-value":"type",class:"mt-2",density:"compact",disabled:e(u),items:[{displayName:e(d)("All Types"),type:0},{displayName:e(d)("Modify Balance"),type:1},{displayName:e(d)("Income"),type:2},{displayName:e(d)("Expense"),type:3},{displayName:e(d)("Transfer"),type:4}],modelValue:We.value,"onUpdate:modelValue":ce[1]||(ce[1]=re=>We.value=re)},null,8,["disabled","items","modelValue"])]),e(x)===e(ca).List.type?(l(),g("div",p1,[o("span",v1,i(e(d)("Transactions Per Page")),1),t(Ge,{class:"mt-2",density:"compact","item-title":"name","item-value":"value",disabled:e(u),items:G.value,modelValue:Ca.value,"onUpdate:modelValue":ce[2]||(ce[2]=re=>Ca.value=re)},null,8,["disabled","items","modelValue"])])):r("",!0),t(Ja,{"show-arrows":"",class:"my-4",direction:"vertical",disabled:e(u),modelValue:Wa.value,"onUpdate:modelValue":ce[3]||(ce[3]=re=>Wa.value=re)},{default:a(()=>[(l(!0),g(fe,null,$e(K.value,(re,na)=>(l(),c(Wt,{class:"tab-text-truncate",key:na,value:na,onClick:ra=>Qe(re)},{default:a(()=>[o("span",f1,i(re.displayName),1)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["disabled","modelValue"])]),_:1},8,["permanent","modelValue"]),t(Xl,null,{default:a(()=>[t(qa,{class:"d-flex flex-grow-1 disable-tab-transition w-100-window-container",modelValue:Qt.value,"onUpdate:modelValue":ce[31]||(ce[31]=re=>Qt.value=re)},{default:a(()=>[t(zt,{value:"transactionPage"},{default:a(()=>[t(Me,{variant:"flat","min-height":"920"},{title:a(()=>[o("div",y1,[t(H,{class:"me-3 d-md-none",density:"compact",color:"default",variant:"plain",ripple:!1,icon:!0,onClick:ce[5]||(ce[5]=re=>Pa.value=!Pa.value)},{default:a(()=>[t(ie,{icon:e(ql),size:"24"},null,8,["icon"])]),_:1}),o("span",null,i(e(d)("Transaction List")),1),t(H,{class:"ms-3",color:"default",variant:"outlined",disabled:e(u)||!e(Te),onClick:ce[6]||(ce[6]=re=>Gn())},{default:a(()=>[q(i(e(d)("Add"))+" ",1),e(Is)()||Re.value&&Re.value.length?(l(),c(e(mt),{key:0,activator:"parent","open-on-hover":!0},{default:a(()=>[t(Je,null,{default:a(()=>[e(Is)()?(l(),c(ve,{key:"AIImageRecognition",title:e(d)("AI Image Recognition"),"prepend-icon":e(_r),onClick:Mi},null,8,["title","prepend-icon"])):r("",!0),(l(!0),g(fe,null,$e(Re.value,re=>(l(),c(ve,{key:re.id,title:re.name,"prepend-icon":e(Po),onClick:na=>Gn(re)},null,8,["title","prepend-icon","onClick"]))),128))]),_:1})]),_:1})):r("",!0)]),_:1},8,["disabled"]),e(Ds)()?(l(),c(H,{key:0,class:"ms-3",color:"default",variant:"outlined",disabled:e(u),onClick:Ui},{default:a(()=>[q(i(e(d)("Import"))+" ",1),e(Wo)()?(l(),c(e(mt),{key:0,activator:"parent","open-on-hover":!0},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{disabled:e(u)||ya.value||!gt.value||!gt.value.length||gt.value.length<1,onClick:ce[7]||(ce[7]=re=>Kn("csv"))},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(d)("Export to CSV (Comma-separated values) File")),1)]),_:1})]),_:1},8,["disabled"]),t(ve,{disabled:e(u)||ya.value||!gt.value||!gt.value.length||gt.value.length<1,onClick:ce[8]||(ce[8]=re=>Kn("tsv"))},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(d)("Export to TSV (Tab-separated values) File")),1)]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})):r("",!0)]),_:1},8,["disabled"])):r("",!0),!e(Ds)()&&e(Wo)()?(l(),c(H,{key:1,class:"ms-3",color:"default",variant:"outlined",disabled:e(u)||ya.value||!gt.value||!gt.value.length||gt.value.length<1},{default:a(()=>[q(i(e(d)("Export"))+" ",1),t(e(mt),{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{disabled:e(u)||ya.value||!gt.value||!gt.value.length||gt.value.length<1,onClick:ce[9]||(ce[9]=re=>Kn("csv"))},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(d)("Export to CSV (Comma-separated values) File")),1)]),_:1})]),_:1},8,["disabled"]),t(ve,{disabled:e(u)||ya.value||!gt.value||!gt.value.length||gt.value.length<1,onClick:ce[10]||(ce[10]=re=>Kn("tsv"))},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(d)("Export to TSV (Tab-separated values) File")),1)]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["disabled"])):r("",!0),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,loading:e(u),onClick:ce[11]||(ce[11]=re=>dt(!0,!1))},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(d)("Refresh")),1)]),_:1})]),_:1},8,["loading"]),t(it),o("div",g1,[t(ot,{density:"compact",disabled:e(u),"prepend-inner-icon":e(Ql),"append-inner-icon":xa.value!==e(D).keyword?e(Xe):void 0,placeholder:e(d)("Search transaction description"),modelValue:xa.value,"onUpdate:modelValue":ce[12]||(ce[12]=re=>xa.value=re),"onClick:appendInner":ce[13]||(ce[13]=re=>ys(xa.value)),onKeyup:ce[14]||(ce[14]=Gt(re=>ys(xa.value),["enter"]))},null,8,["disabled","prepend-inner-icon","append-inner-icon","placeholder","modelValue"])])])]),default:a(()=>[t(ge,{class:"pt-0"},{default:a(()=>[o("div",h1,[o("span",b1,i(e(d)("Date Range")),1),!e(D).minTime&&!e(D).maxTime?(l(),g("span",T1,[o("span",k1,i(e(d)("All")),1)])):e(D).minTime||e(D).maxTime?(l(),g("span",_1,[t(H,{class:"button-icon-with-direction me-1",size:"x-small",density:"compact",color:"default",variant:"outlined",icon:e(On),disabled:e(u),onClick:ce[15]||(ce[15]=re=>_n(e(D).minTime,e(D).maxTime,-1))},null,8,["icon","disabled"]),o("span",x1,i(`${e($)} - ${e(C)}`),1),t(H,{class:"button-icon-with-direction ms-1",size:"x-small",density:"compact",color:"default",variant:"outlined",icon:e(ba),disabled:e(u),onClick:ce[16]||(ce[16]=re=>_n(e(D).minTime,e(D).maxTime,1))},null,8,["icon","disabled"])])):r("",!0),t(it),e(A)&&Q.value?(l(),g("div",C1,[o("span",w1,i(e(J)?e(d)("Total Inflows"):e(d)("Total Income")),1),e(u)?(l(),g("span",A1,[t(ft,{type:"text",style:{width:"60px"},loading:!0})])):e(u)?r("",!0):(l(),g("span",S1,i(Q.value.income),1)),o("span",V1,i(e(J)?e(d)("Total Outflows"):e(d)("Total Expense")),1),e(u)?(l(),g("span",I1,[t(ft,{type:"text",style:{width:"60px"},loading:!0})])):e(u)?r("",!0):(l(),g("span",D1,i(Q.value.expense),1))])):r("",!0)])]),_:1}),e(x)===e(ca).Calendar.type?(l(),c(ge,{key:0,class:"transaction-calendar-container pt-0"},{default:a(()=>[t(lt,{"day-has-transaction-class":"font-weight-bold",readonly:e(u),"is-dark-mode":wl.value,"default-currency":e(T),"min-date":e(ue),"max-date":e(Ee),dailyTotalAmounts:e(me)?.dailyTotalAmounts,modelValue:e(N),"onUpdate:modelValue":ce[17]||(ce[17]=re=>ht(N)?N.value=re:null)},null,8,["readonly","is-dark-mode","default-currency","min-date","max-date","dailyTotalAmounts","modelValue"])]),_:1})):r("",!0),t(sl,{class:"transaction-table",hover:!e(u)},{default:a(()=>[o("thead",null,[o("tr",null,[o("th",$1,[t(e(mt),{ref_key:"timeFilterMenu",ref:De,class:"transaction-time-menu",eager:"",location:"bottom","max-height":"500","onUpdate:modelValue":Bi},{activator:a(({props:re})=>[o("div",_t({class:["d-flex align-center cursor-pointer",{readonly:e(u),"text-primary":e(D).dateType!==e(Lt).ThisMonth.type}]},re),[o("span",null,i(e(d)("Time")),1),t(ie,{icon:e(Fl)},null,8,["icon"])],16)]),default:a(()=>[t(Je,{selected:[e(D).dateType]},{default:a(()=>[(l(!0),g(fe,null,$e(e(I),re=>(l(),c(ve,{class:be(["text-sm",{"list-item-selected":e(D).dateType===re.type}]),density:"compact",key:re.type,value:re.type,"append-icon":e(D).dateType===re.type?e(Xe):void 0},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:na=>Qe(re.type)},{default:a(()=>[o("div",N1,[o("span",F1,i(re.displayName),1)]),re.isUserCustomRange&&e(D).dateType===re.type&&e(D).minTime&&e(D).maxTime?(l(),g("div",E1,[o("span",null,i(e($)),1),ce[37]||(ce[37]=o("span",null," - ",-1)),ce[38]||(ce[38]=o("br",null,null,-1)),o("span",null,i(e(C)),1)])):r("",!0)]),_:2},1032,["onClick"])]),_:2},1032,["value","class","append-icon"]))),128))]),_:1},8,["selected"])]),_:1},512)]),o("th",M1,[t(e(mt),{ref_key:"categoryFilterMenu",ref:Ue,class:"transaction-category-menu",eager:"",location:"bottom","max-height":"500",disabled:e(D).type===1,"close-on-content-click":!1,modelValue:Ua.value,"onUpdate:modelValue":[ce[20]||(ce[20]=re=>Ua.value=re),Li]},{activator:a(({props:re})=>[o("div",_t({class:["d-flex align-center",{readonly:e(u),"cursor-pointer":e(D).type!==1,"text-primary":e(D).categoryIds}]},re),[o("span",null,i(e(le)),1),za(t(ie,{icon:e(Fl)},null,8,["icon"]),[[Ka,e(D).type!==1]])],16)]),default:a(()=>[t(Je,{selected:[Nt.value]},{default:a(()=>[t(ve,{key:"",value:"",class:be(["text-sm",{"list-item-selected":!e(D).categoryIds}]),density:"compact","append-icon":e(D).categoryIds?void 0:e(Xe)},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:ce[18]||(ce[18]=re=>xo(""))},{default:a(()=>[o("div",U1,[t(ie,{icon:e(Zn)},null,8,["icon"]),o("span",P1,i(e(d)("All")),1)])]),_:1})]),_:1},8,["class","append-icon"]),e(X)>0?(l(),c(ve,{key:"multiple",value:"multiple",class:be(["text-sm",{"list-item-selected":e(D).categoryIds&&e(O)>1}]),density:"compact","append-icon":e(D).categoryIds&&e(O)>1?e(Xe):void 0},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:ce[19]||(ce[19]=re=>cl.value=!0)},{default:a(()=>[o("div",B1,[t(ie,{icon:e(wo)},null,8,["icon"]),o("span",L1,i(e(d)("Multiple Categories")),1)])]),_:1})]),_:1},8,["class","append-icon"])):r("",!0),(l(!0),g(fe,null,$e(e(U),(re,na)=>(l(),g(fe,{key:na},[za(t(ve,{density:"compact"},{default:a(()=>[t(rt,null,{default:a(()=>[o("span",z1,i(e(ke)(e(Id)(parseInt(na)),"Type")),1)]),_:2},1024)]),_:2},1536),[[Ka,re&&re.length]]),(l(!0),g(fe,null,$e(re,ra=>(l(),c(ei,{key:ra.id},ro({default:a(()=>[t(nt),t(ve,{class:be(["text-sm",{"item-in-multiple-selection":e(O)>1&&e(ye)[ra.id]}]),density:"compact",value:ra.id,"append-icon":e(D).categoryIds===ra.id?e(Xe):void 0},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:ga=>xo(ra.id)},{default:a(()=>[o("div",q1,[t(ie,{icon:e(Zn)},null,8,["icon"]),o("span",Y1,i(e(d)("All")),1)])]),_:1},8,["onClick"])]),_:2},1032,["class","value","append-icon"]),(l(!0),g(fe,null,$e(ra.subCategories,ga=>(l(),g(fe,{key:ga.id},[!ga.hidden||e(ye)[ga.id]?(l(),c(nt,{key:0})):r("",!0),!ga.hidden||e(ye)[ga.id]?(l(),c(ve,{key:1,class:be(["text-sm",{"list-item-selected":e(D).categoryIds===ga.id,"item-in-multiple-selection":e(O)>1&&e(ye)[ga.id]}]),density:"compact",value:ga.id,"append-icon":e(D).categoryIds===ga.id?e(Xe):void 0},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:xw=>xo(ga.id)},{default:a(()=>[o("div",j1,[t(Pt,{"icon-type":"category",size:"24px","icon-id":ga.icon,color:ga.color},null,8,["icon-id","color"]),o("span",H1,i(ga.name),1)])]),_:2},1032,["onClick"])]),_:2},1032,["value","class","append-icon"])):r("",!0)],64))),128))]),_:2},[!ra.hidden||e(ye)[ra.id]||e(B)[e(D).categoryIds]?.parentId===ra.id||e(te)(ra)?{name:"activator",fn:a(({props:ga})=>[t(nt),t(ve,_t({class:["text-sm",he(ra,e(ye))],density:"compact"},{ref_for:!0},ga),{default:a(()=>[t(rt,null,{default:a(()=>[o("div",O1,[t(Pt,{"icon-type":"category",size:"24px","icon-id":ra.icon,color:ra.color},null,8,["icon-id","color"]),o("span",R1,i(ra.name),1)])]),_:2},1024)]),_:2},1040,["class"])]),key:"0"}:void 0]),1024))),128))],64))),128))]),_:1},8,["selected"])]),_:1},8,["disabled","modelValue"])]),o("th",W1,[t(e(mt),{ref_key:"amountFilterMenu",ref:Pe,class:"transaction-amount-menu",eager:"",location:"bottom","max-height":"500","close-on-content-click":!1,modelValue:ja.value,"onUpdate:modelValue":[ce[24]||(ce[24]=re=>ja.value=re),zi]},{activator:a(({props:re})=>[o("div",_t({class:["d-flex align-center cursor-pointer",{readonly:e(u),"text-primary":e(D).amountFilter}]},re),[o("span",null,i(e(d)("Amount")),1),t(ie,{icon:e(Fl)},null,8,["icon"])],16)]),default:a(()=>[t(Je,{selected:[e(D).amountFilter.split(":")[0]]},{default:a(()=>[t(ve,{key:"",value:"",class:be(["text-sm",{"list-item-selected":!e(D).amountFilter}]),density:"compact","append-icon":!e(D).amountFilter&&!ia.value?e(Xe):void 0},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:ce[21]||(ce[21]=re=>gs(""))},{default:a(()=>[o("div",G1,[o("span",K1,i(e(d)("All")),1)])]),_:1})]),_:1},8,["class","append-icon"]),(l(!0),g(fe,null,$e(e(yo).values(),re=>(l(),c(ve,{key:re.type,class:be(["text-sm",{"list-item-selected":e(D).amountFilter&&e(D).amountFilter.startsWith(`${re.type}:`)}]),density:"compact",value:re.type,"append-icon":e(D).amountFilter&&e(D).amountFilter.startsWith(`${re.type}:`)&&ia.value!==re.type?e(Xe):void 0},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:na=>ia.value=re.type},{default:a(()=>[o("div",Q1,[o("span",J1,i(e(d)(re.name)),1),e(D).amountFilter&&e(D).amountFilter.startsWith(`${re.type}:`)&&ia.value!==re.type?(l(),g("span",Z1,i(e(se)),1)):r("",!0),ia.value===re.type?(l(),c(Nl,{key:1,class:"transaction-amount-filter-value ms-4",density:"compact",currency:e(T),modelValue:aa.value,"onUpdate:modelValue":ce[22]||(ce[22]=na=>aa.value=na)},null,8,["currency","modelValue"])):r("",!0),ia.value===re.type&&re.paramCount===2?(l(),g("span",X1,"~")):r("",!0),ia.value===re.type&&re.paramCount===2?(l(),c(Nl,{key:3,class:"transaction-amount-filter-value",density:"compact",currency:e(T),modelValue:Xa.value,"onUpdate:modelValue":ce[23]||(ce[23]=na=>Xa.value=na)},null,8,["currency","modelValue"])):r("",!0),ia.value===re.type?(l(),c(H,{key:4,class:"ms-2",density:"compact",color:"primary",variant:"tonal",onClick:na=>gs(re.type)},{default:a(()=>[q(i(e(d)("Apply")),1)]),_:1},8,["onClick"])):r("",!0)])]),_:2},1032,["onClick"])]),_:2},1032,["value","class","append-icon"]))),128))]),_:1},8,["selected"])]),_:1},8,["modelValue"])]),o("th",eh,[t(e(mt),{ref_key:"accountFilterMenu",ref:ut,class:"transaction-account-menu",eager:"",location:"bottom","max-height":"500","onUpdate:modelValue":Oi},{activator:a(({props:re})=>[o("div",_t({class:["d-flex align-center cursor-pointer",{readonly:e(u),"text-primary":e(D).accountIds}]},re),[o("span",null,i(e(Z)),1),t(ie,{icon:e(Fl)},null,8,["icon"])],16)]),default:a(()=>[t(Je,{selected:[tl.value]},{default:a(()=>[t(ve,{key:"",value:"",class:be(["text-sm",{"list-item-selected":!e(D).accountIds}]),density:"compact","append-icon":e(D).accountIds?void 0:e(Xe)},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:ce[25]||(ce[25]=re=>fs(""))},{default:a(()=>[o("div",th,[t(ie,{icon:e(Zn)},null,8,["icon"]),o("span",ah,i(e(d)("All")),1)])]),_:1})]),_:1},8,["class","append-icon"]),e(j)>0?(l(),c(ve,{key:"multiple",value:"multiple",class:be(["text-sm",{"list-item-selected":e(D).accountIds&&e(J)>1}]),density:"compact","append-icon":e(D).accountIds&&e(J)>1?e(Xe):void 0},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:ce[26]||(ce[26]=re=>dl.value=!0)},{default:a(()=>[o("div",lh,[t(ie,{icon:e(wo)},null,8,["icon"]),o("span",nh,i(e(d)("Multiple Accounts")),1)])]),_:1})]),_:1},8,["class","append-icon"])):r("",!0),(l(!0),g(fe,null,$e(e(F),re=>(l(),g(fe,{key:re.id},[!re.hidden&&(!e(S)[re.parentId]||!e(S)[re.parentId].hidden)||e(L)[re.id]?(l(),c(nt,{key:0})):r("",!0),!re.hidden&&(!e(S)[re.parentId]||!e(S)[re.parentId].hidden)||e(L)[re.id]?(l(),c(ve,{key:1,class:be(["text-sm",{"list-item-selected":e(D).accountIds===re.id,"item-in-multiple-selection":e(J)>1&&e(L)[re.id]}]),density:"compact",value:re.id,"append-icon":e(D).accountIds===re.id?e(Xe):void 0},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:na=>fs(re.id)},{default:a(()=>[o("div",oh,[t(Pt,{"icon-type":"account",size:"24px","icon-id":re.icon,color:re.color},null,8,["icon-id","color"]),o("span",sh,i(re.name),1)])]),_:2},1032,["onClick"])]),_:2},1032,["value","class","append-icon"])):r("",!0)],64))),128))]),_:1},8,["selected"])]),_:1},512)]),e(w)?(l(),g("th",ih,[t(e(mt),{ref_key:"tagFilterMenu",ref:we,class:"transaction-tag-menu",eager:"",location:"bottom","max-height":"500","onUpdate:modelValue":Ri},{activator:a(({props:re})=>[o("div",_t({class:["d-flex align-center cursor-pointer",{readonly:e(u),"text-primary":e(D).tagFilter}]},re),[o("span",null,i(e(z)),1),t(ie,{icon:e(Fl)},null,8,["icon"])],16)]),default:a(()=>[t(Je,{selected:[Le.value]},{default:a(()=>[t(ve,{key:"",value:"",class:be(["text-sm",{"list-item-selected":!e(D).tagFilter}]),density:"compact","append-icon":e(D).tagFilter?void 0:e(Xe)},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:ce[27]||(ce[27]=re=>Co(""))},{default:a(()=>[o("div",rh,[t(ie,{icon:e(Zn)},null,8,["icon"]),o("span",uh,i(e(d)("All")),1)])]),_:1})]),_:1},8,["class","append-icon"]),(l(),c(ve,{class:be(["text-sm",{"list-item-selected":e(D).tagFilter===e(gl).TransactionNoTagFilterValue}]),density:"compact",key:e(gl).TransactionNoTagFilterValue,value:e(gl).TransactionNoTagFilterValue,"append-icon":e(D).tagFilter===e(gl).TransactionNoTagFilterValue?e(Xe):void 0},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:ce[28]||(ce[28]=re=>Co(e(gl).TransactionNoTagFilterValue))},{default:a(()=>[o("div",dh,[t(ie,{icon:e(kr)},null,8,["icon"]),o("span",ch,i(e(d)("Without Tags")),1)])]),_:1})]),_:1},8,["value","class","append-icon"])),e(W)>0?(l(),c(ve,{key:"multiple",value:"multiple",class:be(["text-sm",{"list-item-selected":e(D).tagFilter&&e(ae)>1}]),density:"compact","append-icon":e(D).tagFilter&&e(ae)>1?e(Xe):void 0},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:ce[29]||(ce[29]=re=>ml.value=!0)},{default:a(()=>[o("div",mh,[t(ie,{icon:e(wo)},null,8,["icon"]),o("span",ph,i(e(d)("Multiple Tags")),1)])]),_:1})]),_:1},8,["class","append-icon"])):r("",!0),e(D).tagFilter&&e(D).tagFilter!==e(gl).TransactionNoTagFilterValue?(l(),c(nt,{key:1})):r("",!0),(l(!0),g(fe,null,$e(e(oe),re=>(l(),g(fe,{key:re.id},[!re.hidden||e(Ht)(e(Y)[re.id])?(l(),c(nt,{key:0})):r("",!0),!re.hidden||e(Ht)(e(Y)[re.id])?(l(),c(ve,{key:1,class:be(["text-sm",{"list-item-selected":e(ae)===1&&e(Ht)(e(Y)[re.id]),"item-in-multiple-selection":e(ae)>1&&e(Ht)(e(Y)[re.id])}]),density:"compact",value:re.id,"append-icon":e(Y)[re.id]===!0?e(Xe):e(Y)[re.id]===!1?e(vl):void 0},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:na=>Co(e(gl).of(re.id).toTextualTagFilter())},{default:a(()=>[o("div",vh,[t(ie,{size:"24",icon:e(ea)},null,8,["icon"]),o("span",fh,i(re.name),1)])]),_:2},1032,["onClick"])]),_:2},1032,["value","class","append-icon"])):r("",!0)],64))),128))]),_:1},8,["selected"])]),_:1},512)])):r("",!0),o("th",yh,i(e(d)("Description")),1)])]),e(u)&&(!gt.value||!gt.value.length||gt.value.length<1)?(l(),g("tbody",gh,[(l(!0),g(fe,null,$e(_o.value,re=>(l(),g("tr",{key:re},[o("td",{class:"px-0",colspan:e(w)?6:5},[t(ft,{type:"text",loading:!0})],8,hh)]))),128))])):r("",!0),!e(u)&&(!gt.value||!gt.value.length||gt.value.length<1)?(l(),g("tbody",bh,[o("tr",null,[o("td",{colspan:e(w)?6:5},i(e(d)("No transaction data")),9,Th)])])):r("",!0),(l(!0),g(fe,null,$e(gt.value,(re,na)=>(l(),g("tbody",{key:re.id,class:be({disabled:e(u),"has-bottom-border":na<gt.value.length-1})},[e(x)===e(ca).List.type&&(na===0||na>0&&re.gregorianCalendarYearDashMonthDashDay!==gt.value[na-1].gregorianCalendarYearDashMonthDashDay)?(l(),g("tr",kh,[o("td",{colspan:e(w)?6:5,class:"font-weight-bold"},[o("div",xh,[o("span",null,i(e(He)(re)),1),re.displayDayOfWeek?(l(),c(Jt,{key:0,class:"ms-1",color:"default",size:"x-small"},{default:a(()=>[q(i(e(f)(re.displayDayOfWeek)),1)]),_:2},1024)):r("",!0)])],8,_h)])):r("",!0),o("tr",{class:"transaction-table-row-data text-sm cursor-pointer",onClick:ra=>Pi(re)},[o("td",wh,[o("div",Ah,[o("span",null,i(e(Ye)(re)),1),e(Se)(re)?r("",!0):(l(),g("span",Sh,i(e(It)(re)),1)),e(Se)(re)?r("",!0):(l(),c(vt,{key:1,activator:"parent"},{default:a(()=>[q(i(e(la)(re)),1)]),_:2},1024))])]),o("td",Vh,[o("div",Ih,[re.category&&re.category.color?(l(),c(Pt,{key:0,size:"24px","icon-type":"category","icon-id":re.category.icon,color:re.category.color},null,8,["icon-id","color"])):!re.category||!re.category.color?(l(),c(ie,{key:1,size:"24",icon:e(as)},null,8,["icon"])):r("",!0),re.type===e(pe).ModifyBalance?(l(),g("span",Dh,i(e(d)("Modify Balance")),1)):re.type!==e(pe).ModifyBalance&&re.category?(l(),g("span",$h,i(re.category.name),1)):re.type!==e(pe).ModifyBalance&&!re.category?(l(),g("span",Nh,i(e(ke)(re.type,"Transaction")),1)):r("",!0)])]),o("td",{class:be(["transaction-table-column-amount",{"text-expense":re.type===e(pe).Expense,"text-income":re.type===e(pe).Income}])},[re.sourceAccount?(l(),g("div",Fh,[o("span",null,i(e(Ot)(re)),1)])):r("",!0)],2),o("td",Eh,[o("div",Mh,[re.sourceAccount?(l(),g("span",Uh,i(re.sourceAccount.name),1)):r("",!0),re.sourceAccount&&re.type===e(pe).Transfer&&re.destinationAccount&&re.sourceAccount.id!==re.destinationAccount.id?(l(),c(ie,{key:1,class:"icon-with-direction mx-1",size:"13",icon:e(ba)},null,8,["icon"])):r("",!0),re.sourceAccount&&re.type===e(pe).Transfer&&re.destinationAccount&&re.sourceAccount.id!==re.destinationAccount.id?(l(),g("span",Ph,i(re.destinationAccount.name),1)):r("",!0)])]),e(w)?(l(),g("td",Bh,[(l(!0),g(fe,null,$e(re.tagIds,ra=>(l(),c(Jt,{class:"transaction-tag",size:"small","prepend-icon":e(ea),text:e(oe)[ra]?.name,key:ra},null,8,["prepend-icon","text"]))),128)),!re.tagIds||!re.tagIds.length?(l(),c(Jt,{key:0,class:"transaction-tag",size:"small",text:e(d)("None")},null,8,["text"])):r("",!0)])):r("",!0),o("td",Lh,i(re.comment),1)],8,Ch)],2))),128))]),_:1},8,["hover"]),e(x)===e(ca).List.type?(l(),g("div",zh,[t(jn,{totalPageCount:ko.value,modelValue:Wn.value,"onUpdate:modelValue":ce[30]||(ce[30]=re=>Wn.value=re)},null,8,["totalPageCount","modelValue"])])):r("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(qi,{title:e(d)("Custom Date Range"),"min-time":e(m),"max-time":e(k),show:el.value,"onUpdate:show":ce[32]||(ce[32]=re=>el.value=re),"onDateRange:change":Ut,onError:hs},null,8,["title","min-time","max-time","show"]),t(Yi,{title:e(d)("Select Month"),"model-value":e(ee),show:Ha.value,"onUpdate:show":ce[33]||(ce[33]=re=>Ha.value=re),"onUpdate:modelValue":al,onError:hs},null,8,["title","model-value","show"]),t(vs,{ref_key:"editDialog",ref:St,type:e(Mt).Transaction},null,8,["type"]),t(Qf,{ref_key:"aiImageRecognitionDialog",ref:_a},null,512),t(Yg,{ref_key:"importDialog",ref:Vt,persistent:!0},null,512),t(xt,{width:"800",modelValue:dl.value,"onUpdate:modelValue":ce[34]||(ce[34]=re=>dl.value=re)},{default:a(()=>[t($l,{type:"transactionListCurrent","dialog-mode":!0,"onSettings:change":Fi})]),_:1},8,["modelValue"]),t(xt,{width:"800",modelValue:cl.value,"onUpdate:modelValue":ce[35]||(ce[35]=re=>cl.value=re)},{default:a(()=>[t(Hn,{type:"transactionListCurrent","dialog-mode":!0,"category-types":at.value,"onSettings:change":Ni},null,8,["category-types"])]),_:1},8,["modelValue"]),t(xt,{width:"800",modelValue:ml.value,"onUpdate:modelValue":ce[36]||(ce[36]=re=>ml.value=re)},{default:a(()=>[t(Si,{type:"transactionListCurrent","dialog-mode":!0,"onSettings:change":Ei})]),_:1},8,["modelValue"]),t(ka,{ref_key:"confirmDialog",ref:Dt},null,512),t(ct,{ref_key:"snackbar",ref:bt},null,512)],64)}}}),Rh=Oe({__name:"TrendsChart",props:{skeleton:{type:Boolean},type:{},showValue:{type:Boolean},showTotalAmountInTooltip:{type:Boolean},chartMode:{},items:{},stacked:{type:Boolean},startTime:{},endTime:{},startYearMonth:{},endYearMonth:{},fiscalYearStart:{},sortingType:{},dataAggregationType:{},dateAggregationType:{},idField:{},nameField:{},valueField:{},colorField:{},hiddenField:{},displayOrdersField:{},translateName:{type:Boolean},defaultCurrency:{},enableClickItem:{type:Boolean}},emits:["click"],setup(v,{expose:_,emit:n}){const s=v,h=n,d=Kt(),{tt:y,getCurrentLanguageTextDirection:f,formatDateTimeToShortDate:b,formatDateTimeToGregorianLikeShortYear:x,formatDateTimeToGregorianLikeShortYearMonth:u,formatYearQuarterToGregorianLikeYearQuarter:m,formatDateTimeToGregorianLikeFiscalYear:k,formatAmountToWesternArabicNumeralsWithoutDigitGrouping:N,formatAmountToLocalizedNumeralsWithCurrency:V}=je(),{allDateRanges:p,getItemName:T}=Dd(s),A=ta(),w=P({}),I=E(()=>f()),F=E(()=>d.global.name.value===$t.Dark),S=E(()=>{const $={};for(const C of s.items){let M="";s.idField&&C[s.idField]?M=C[s.idField]:M=T(C[s.nameField]);const ee={[s.nameField]:C[s.nameField]};s.idField&&(ee[s.idField]=C[s.idField]),s.hiddenField&&(ee[s.hiddenField]=C[s.hiddenField]),s.displayOrdersField&&(ee[s.displayOrdersField]=C[s.displayOrdersField]),$[M]=ee}return $}),j=E(()=>{const $=[];for(const C of p.value){const M=Ia(C.minUnixTime);s.dateAggregationType===Yt.Year.type?$.push(x(M)):s.dateAggregationType===Yt.FiscalYear.type&&"year"in C?$.push(k(M)):s.dateAggregationType===Yt.Quarter.type&&"quarter"in C?$.push(m(C.year,C.quarter)):s.dateAggregationType===Yt.Month.type?$.push(u(M)):s.dateAggregationType===Yt.Day.type&&s.chartMode==="daily"&&$.push(b(M))}return $}),B=E(()=>{const $=[];let C=0;for(const[M,ee]of Ra(s.items)){if(s.hiddenField&&M[s.hiddenField])continue;const ye=[],L={};for(const O of M.items){let J="";s.chartMode==="daily"&&"month"in O?s.dateAggregationType===Yt.Year.type?J=O.year.toString():s.dateAggregationType===Yt.FiscalYear.type?J=$s(mn({year:O.year,month1base:O.month}),s.fiscalYearStart).toString():s.dateAggregationType===Yt.Quarter.type?J=`${O.year}-${Math.floor((O.month-1)/3)+1}`:s.dateAggregationType===Yt.Month.type?J=`${O.year}-${O.month}`:J=`${O.year}-${O.month}-${O.day}`:s.chartMode==="monthly"&&"month1base"in O&&(s.dateAggregationType===Yt.Year.type?J=O.year.toString():s.dateAggregationType===Yt.FiscalYear.type?J=$s(mn({year:O.year,month1base:O.month1base}),s.fiscalYearStart).toString():s.dateAggregationType===Yt.Quarter.type?J=`${O.year}-${Math.floor((O.month1base-1)/3)+1}`:J=`${O.year}-${O.month1base}`);const ae=L[J]||[];ae.push(O),L[J]=ae}for(const O of p.value){let J="";s.dateAggregationType===Yt.Year.type||s.dateAggregationType===Yt.FiscalYear.type&&"year"in O?J=O.year.toString():s.dateAggregationType===Yt.Quarter.type&&"quarter"in O?J=`${O.year}-${O.quarter}`:s.dateAggregationType===Yt.Month.type&&"month0base"in O?J=`${O.year}-${O.month0base+1}`:s.dateAggregationType===Yt.Day.type&&"day"in O&&s.chartMode==="daily"&&(J=`${O.year}-${O.month}-${O.day}`);let ae=0;const Z=L[J];if(Fn(Z))for(const le of Z){const z=le[s.valueField];Zt(z)&&(s.dataAggregationType===dn.Sum?ae+=z:s.dataAggregationType===dn.Last&&(ae=z))}ae>C&&(C=ae),ye.push(ae)}const Y={id:s.idField&&M[s.idField]?M[s.idField]:T(M[s.nameField]),name:s.idField&&M[s.idField]?M[s.idField]:T(M[s.nameField]),itemStyle:{color:En(s.colorField&&M[s.colorField]?M[s.colorField]:Ll[ee%Ll.length])},selected:!0,type:"line",animation:!s.skeleton,data:ye};s.stacked?Y.stack="a":s.idField&&M[s.idField]&&(Y.stack=M[s.idField]),s.type===Do.Area.type?Y.areaStyle={}:s.type===Do.Column.type?Y.type="bar":s.type===Do.Bubble.type&&(Y.type="scatter",Y.symbolSize=O=>Math.sqrt(O)/Math.sqrt(C)*80+5),$.push(Y)}return $}),U=E(()=>{let $=Number.MIN_SAFE_INTEGER,C=Number.MAX_SAFE_INTEGER,M=90;if(!B.value||!B.value.length)return M;for(const J of B.value)for(const ae of J.data)ae>$&&($=ae),ae<C&&(C=ae);const ee=V($,s.defaultCurrency),ye=V(C,s.defaultCurrency),L=ee.length>ye.length?ee:ye,O=document.createElement("canvas").getContext("2d");if(O){O.font="12px Arial";const J=O.measureText(L),ae=Math.round(J.width)+20;ae>=200&&(M=200),ae>90&&(M=ae)}return M}),X=E(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:F.value?"#333":"#fff",color:F.value?"#eee":"#333"}},backgroundColor:F.value?"#333":"#fff",borderColor:F.value?"#333":"#fff",textStyle:{color:F.value?"#eee":"#333"},formatter:$=>{let C="",M=0,ee=0;const ye=[];for(const L of $){const Y=L.seriesId,O=S.value[Y]&&s.nameField&&S.value[Y][s.nameField]?T(S.value[Y][s.nameField]):Y,J=L.color,ae=S.value[Y]&&s.displayOrdersField&&S.value[Y][s.displayOrdersField]?S.value[Y][s.displayOrdersField]:[0],Z=L.data;ye.push({name:O,color:J,displayOrders:ae,totalAmount:Z}),M+=Z}$d(ye,s.sortingType);for(const L of ye)if(ye.length===1||L.totalAmount!==0){const Y=V(L.totalAmount,s.defaultCurrency);C+='<div><span class="chart-pointer" style="background-color: '+L.color+'"></span>',C+=`<span>${L.name}</span><span class="ms-5" style="float: inline-end">${Y}</span><br/>`,C+="</div>",ee++}if(s.showTotalAmountInTooltip){const L=V(M,s.defaultCurrency);C=(ee>0?'<div style="border-bottom: '+(F.value?"#eee":"#333")+' dashed 1px">':"<div></div>")+'<span class="chart-pointer" style="background-color: '+(F.value?"#eee":"#333")+`"></span><span>${y("Total Amount")}</span><span class="ms-5" style="float: inline-end">${L}</span><br/></div>`+C}return $.length&&$[0]&&$[0].name&&(C=`${$[0].name}<br/>`+C),C}},legend:{orient:"horizontal",type:"scroll",top:0,data:B.value.map($=>$.name),selected:w.value,textStyle:{color:F.value?"#eee":"#333"},formatter:$=>S.value[$]&&s.nameField&&S.value[$][s.nameField]?T(S.value[$][s.nameField]):$},grid:{left:U.value,right:20,bottom:40},xAxis:[{type:"category",data:j.value,inverse:I.value===Tn.RTL,axisLabel:{color:F.value?"#888":"#666"}}],yAxis:[{type:"value",axisLabel:{color:F.value?"#888":"#666",formatter:$=>V(parseInt($),s.defaultCurrency)},axisPointer:{label:{formatter:$=>V(Math.trunc($.value),s.defaultCurrency)}},splitLine:{lineStyle:{color:F.value?"#4f4f4f":"#e1e6f2"}}}],series:B.value}));function oe($){if(!s.enableClickItem||$.componentType!=="series")return;const C=$.seriesId,M=S.value[C],ee=s.idField?M[s.idField]:"",ye=p.value[$.dataIndex];if(!ye)return;let L=ye.minUnixTime,Y=ye.maxUnixTime;if(s.chartMode==="daily")s.startTime&&s.startTime>L&&(L=s.startTime),s.endTime&&s.endTime<Y&&(Y=s.endTime);else if(s.chartMode==="monthly"){if(s.startYearMonth){const J=mn(s.startYearMonth);J>L&&(L=J)}if(s.endYearMonth){const J=ho(s.endYearMonth);J<Y&&(Y=J)}}const O=Bl(L,Y,A.currentUserFirstDayOfWeek,A.currentUserFiscalYearStart,ma.Normal);h("click",{itemId:ee,dateRange:{minTime:L,maxTime:Y,dateType:O}})}function W(){const $=[],C=[];$.push(y("Date"));for(const M of B.value){const ee=M.id,ye=S.value[ee]&&s.nameField&&S.value[ee][s.nameField]?T(S.value[ee][s.nameField]):ee;$.push(ye)}for(const[M,ee]of Ra(j.value)){const ye=[];ye.push(M),ye.push(...B.value.map(L=>N(L.data[ee]??0))),C.push(ye)}return{headers:$,data:C}}function D($){w.value=$.selected}return _({exportData:W}),($,C)=>{const M=Ve("v-chart");return l(),c(M,{autoresize:"",class:be(["trends-chart-container",{"transition-in":v.skeleton}]),option:X.value,onClick:oe,onLegendselectchanged:D},null,8,["class","option"])}}}),In=kn(Rh,[["__scopeId","data-v-57dc3e0e"]]),qh={class:"d-flex flex-wrap align-center justify-center"},Yh={class:"text-h4"},jh={key:1,class:"w-100 h-100 code-container"},Vi=Oe({__name:"ExportDialog",setup(v,{expose:_}){const{tt:n}=je(),s=ta(),h=xe("buttonContainer"),d=xe("snackbar"),y=P(!1),f=P([]),b=P([]),x=P(Bt.CSV.extension),u=P(!1),m=E(()=>{const I=s.currentUserNickname;return I?n("dataExport.exportStatisticsFileName",{nickname:I}):n("dataExport.defaultExportStatisticsFileName")}),k=E(()=>f.value.map((I,F)=>({key:F.toString(),value:`column${F}`,title:I,sortable:F>0,nowrap:!0}))),N=E(()=>b.value.map(I=>{const F={};return I.forEach((S,j)=>{F[`column${j}`]=S}),F})),V=E(()=>{let I="";if(x.value===Bt.CSV.extension||x.value===Bt.TSV.extension){let F=",";x.value===Bt.TSV.extension&&(F="	"),f.value.length>0&&(I+=f.value.map(S=>Vn(S,F," ")).join(F));for(const S of b.value)I+=`
`,I+=S.map(j=>Vn(j,F," ")).join(F)}else if(x.value===Bt.MARKDOWN.extension){I+="| "+f.value.map(F=>Vn(F,"|"," ")).join(" | ")+" |",I+=`
`,I+="| "+f.value.map(()=>"---").join(" | ")+" |";for(const F of b.value)I+=`
`,I+="| "+F.map(S=>Vn(S,"|"," ")).join(" | ")+" |"}return I});function p(I){f.value=I.headers||[],b.value=I.data||[],x.value=Bt.CSV.extension,u.value=!1,y.value=!0}function T(){Mn(V.value,h.value),d.value?.showMessage("Data copied")}function A(){let I=Bt.parse(x.value);I||(I=Bt.CSV),tn(I.formatFileName(m.value),I.createBlob(V.value))}function w(){y.value=!1}return _({open:p}),(I,F)=>(l(),g(fe,null,[t(xt,{width:"1000",modelValue:y.value,"onUpdate:modelValue":F[6]||(F[6]=S=>y.value=S)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",qh,[o("h4",Yh,i(e(n)("Export Results")),1),t(it),t(Ea,{class:"bidirectional-switch ms-2 pt-1",color:"secondary",label:e(n)("Raw Data"),modelValue:u.value,"onUpdate:modelValue":F[0]||(F[0]=S=>u.value=S),onClick:F[1]||(F[1]=S=>u.value=!u.value)},{prepend:a(()=>[o("span",null,i(e(n)("Table")),1)]),_:1},8,["label","modelValue"]),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",icon:!0},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(Pn,{title:e(n)("File Format")},null,8,["title"]),t(ve,{"prepend-icon":e(ti),"append-icon":x.value===e(Bt).CSV.extension?e(Xe):void 0,title:e(n)("CSV (Comma-separated values) File"),onClick:F[2]||(F[2]=S=>x.value=e(Bt).CSV.extension)},null,8,["prepend-icon","append-icon","title"]),t(ve,{"prepend-icon":e(ai),"append-icon":x.value===e(Bt).TSV.extension?e(Xe):void 0,title:e(n)("TSV (Tab-separated values) File"),onClick:F[3]||(F[3]=S=>x.value=e(Bt).TSV.extension)},null,8,["prepend-icon","append-icon","title"]),t(ve,{"prepend-icon":e(xr),"append-icon":x.value===e(Bt).MARKDOWN.extension?e(Xe):void 0,title:e(n)("Markdown File"),onClick:F[4]||(F[4]=S=>x.value=e(Bt).MARKDOWN.extension)},null,8,["prepend-icon","append-icon","title"])]),_:1})]),_:1})]),_:1})])]),default:a(()=>[t(ge,{class:"d-flex flex-column flex-md-row flex-grow-1 overflow-y-auto",style:{height:"485px"}},{default:a(()=>[u.value?r("",!0):(l(),c(Kl,{key:0,"fixed-header":"","fixed-footer":"","multi-sort":"",density:"compact",headers:k.value,items:N.value,hover:!0,"hide-default-footer":!0,"items-per-page":N.value.length,"no-data-text":e(n)("No data")},null,8,["headers","items","items-per-page","no-data-text"])),u.value?(l(),g("div",jh,[t(Oa,{class:"w-100 h-100 always-cursor-text",readonly:!0,value:V.value},null,8,["value"])])):r("",!0)]),_:1}),t(ge,null,{default:a(()=>[o("div",{ref_key:"buttonContainer",ref:h,class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},[t(Gl,{variant:"tonal",density:"comfortable"},{default:a(()=>[t(H,{color:"primary",disabled:!V.value,onClick:T},{default:a(()=>[q(i(e(n)("Copy")),1)]),_:1},8,["disabled"]),t(H,{density:"compact",color:"primary",disabled:!V.value,icon:!0},{default:a(()=>[t(ie,{icon:e(Fl),size:"24"},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{title:e(n)("Save"),onClick:F[5]||(F[5]=S=>A())},null,8,["title"])]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),t(H,{color:"secondary",variant:"tonal",onClick:w},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1})],512)]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ct,{ref_key:"snackbar",ref:d},null,512)],64))}}),Hh={class:"mx-6 my-4"},Wh={class:"mx-6 mt-4"},Gh={class:"text-subtitle-2"},Kh={class:"mx-6 mt-4"},Qh={class:"text-subtitle-2"},Jh={class:"text-truncate"},Zh={class:"title-and-toolbar d-flex align-center"},Xh={class:"d-flex align-center"},eb={key:0,class:"statistics-custom-datetime-range smaller"},tb={class:"transaction-keyword-filter ms-2"},ab={class:"statistics-subtitle"},lb={key:0,class:"statistics-overview-amount ms-3 text-income"},nb={class:"statistics-subtitle ms-3"},ob={key:2,class:"statistics-overview-amount ms-3 text-expense"},sb={class:"statistics-subtitle"},ib={class:"statistics-subtitle statistics-overview-empty-tip"},rb={class:"d-flex flex-column ms-2"},ub={class:"d-flex"},db={class:"d-flex flex-column ms-2"},cb={class:"d-flex"},mb={key:0,class:"statistics-percent"},pb={class:"statistics-amount"},vb=Oe({__name:"TransactionPage",props:{initAnalysisType:{},initChartDataType:{},initChartType:{},initChartDateType:{},initStartTime:{},initEndTime:{},initFilterAccountIds:{},initFilterCategoryIds:{},initTagFilter:{},initKeyword:{},initSortingType:{},initTrendDateAggregationType:{},initAssetTrendsDateAggregationType:{}},setup(v){const _=v,n=Na(),s=Rl(),h=Kt(),{tt:d,getAllCategoricalChartTypes:y,getAllTrendChartTypes:f,formatAmountToWesternArabicNumeralsWithoutDigitGrouping:b,formatPercentToLocalizedNumerals:x}=je(),{loading:u,analysisType:m,trendDateAggregationType:k,assetTrendsDateAggregationType:N,defaultCurrency:V,firstDayOfWeek:p,fiscalYearStart:T,allDateRanges:A,allSortingTypes:w,allTrendAnalysisDateAggregationTypes:I,allAssetTrendsDateAggregationTypes:F,query:S,queryChartDataCategory:j,queryDateType:B,queryStartTime:U,queryEndTime:X,queryDateRangeName:oe,queryTrendDateAggregationTypeName:W,queryAssetTrendsDateAggregationTypeName:D,canChangeDateRange:$,canShiftDateRange:C,canUseCategoryFilter:M,canUseTagFilter:ee,canUseKeywordFilter:ye,showAmountInChart:L,totalAmountName:Y,showPercentInCategoricalChart:O,showTotalAmountInTrendsChart:J,showStackedInTrendsChart:ae,translateNameInTrendsChart:Z,categoricalOverviewAnalysisData:le,categoricalAnalysisData:z,trendsAnalysisData:se,assetTrendsData:ue,canShowCustomDateRange:Ee,getTransactionCategoricalAnalysisDataItemDisplayColor:me,getDisplayAmount:te}=Nd(),Se=pa(),Te=va(),Ye=ki(),He=xe("snackbar"),It=xe("monthlyTrendsChart"),la=xe("dailyTrendsChart"),Ot=xe("exportDialog"),ze=P("statisticsPage"),ke=P(!0),Ie=P(""),Et=P(s.mdAndUp.value),yt=P(s.mdAndUp.value),Ne=P(!1),kt=P(!1),Be=P(!1),Ke=P(!1),Fe=P(!1),De=E(()=>h.global.name.value===$t.Dark),Ue=E(()=>m.value===et.CategoricalAnalysis?!!z.value&&!!z.value.items&&z.value.items.length>0:m.value===et.TrendAnalysis?!!se.value&&!!se.value.items&&se.value.items.length>0&&!!It.value:m.value===et.AssetTrends?!!ue.value&&!!ue.value.items&&ue.value.items.length>0&&!!la.value:!1),Pe=E(()=>m.value===et.CategoricalAnalysis?y(!0):m.value===et.TrendAnalysis||m.value===et.AssetTrends?f():[]),ut=E({get:()=>m.value,set:G=>{fa(G)}}),we=E({get:()=>m.value===et.CategoricalAnalysis?S.value.categoricalChartType:m.value===et.TrendAnalysis?S.value.trendChartType:m.value===et.AssetTrends?S.value.assetTrendsChartType:void 0,set:G=>{xa(G)}}),Dt=E({get:()=>S.value.chartDataType,set:G=>{ia(G)}}),bt=E({get:()=>S.value.sortingType,set:G=>{aa(G)}}),St=E(()=>At.valueOf(Dt.value)?.specialChart??!1),_a=E(()=>S.value.chartDataType===At.OutflowsByAccount.type||S.value.chartDataType===At.ExpenseByAccount.type||S.value.chartDataType===At.ExpenseByPrimaryCategory.type||S.value.chartDataType===At.ExpenseBySecondaryCategory.type?"text-expense":S.value.chartDataType===At.InflowsByAccount.type||S.value.chartDataType===At.IncomeByAccount.type||S.value.chartDataType===At.IncomeByPrimaryCategory.type||S.value.chartDataType===At.IncomeBySecondaryCategory.type?"text-income":"text-default");function Vt(){return`/statistics/transaction?${Ye.getTransactionStatisticsPageParams(m.value,k.value,N.value)}`}function Qt(G,K){return`/transaction/list?${Ye.getTransactionListPageParams(m.value,G,K)}`}function Rt(G){let K=!Ht(G.initAnalysisType);const Re={chartDataType:G.initChartDataType?parseInt(G.initChartDataType):void 0,filterAccountIds:G.initFilterAccountIds?cn(G.initFilterAccountIds.split(","),!0):{},filterCategoryIds:G.initFilterCategoryIds?cn(G.initFilterCategoryIds.split(","),!0):{},tagFilter:G.initTagFilter,keyword:G.initKeyword,sortingType:G.initSortingType?parseInt(G.initSortingType):void 0};if(Ie.value=Re.keyword||"",G.initAnalysisType===et.CategoricalAnalysis.toString()?(Re.categoricalChartType=G.initChartType?parseInt(G.initChartType):void 0,Re.categoricalChartDateType=G.initChartDateType?parseInt(G.initChartDateType):void 0,Re.categoricalChartStartTime=G.initStartTime?parseInt(G.initStartTime):void 0,Re.categoricalChartEndTime=G.initEndTime?parseInt(G.initEndTime):void 0,(Re.categoricalChartDateType!==S.value.categoricalChartDateType||Re.categoricalChartDateType===Lt.Custom.type&&(Re.categoricalChartStartTime!==S.value.categoricalChartStartTime||Re.categoricalChartEndTime!==S.value.categoricalChartEndTime))&&(K=!0),G.initAnalysisType!==m.value.toString()&&(m.value=et.CategoricalAnalysis,K=!0)):G.initAnalysisType===et.TrendAnalysis.toString()?(Re.trendChartType=G.initChartType?parseInt(G.initChartType):void 0,Re.trendChartDateType=G.initChartDateType?parseInt(G.initChartDateType):void 0,Re.trendChartStartYearMonth=G.initStartTime,Re.trendChartEndYearMonth=G.initEndTime,(Re.trendChartDateType!==S.value.trendChartDateType||Re.trendChartDateType===Lt.Custom.type&&(Re.trendChartStartYearMonth!==S.value.trendChartStartYearMonth||Re.trendChartEndYearMonth!==S.value.trendChartEndYearMonth))&&(K=!0),G.initAnalysisType!==m.value.toString()&&(m.value=et.TrendAnalysis,K=!0),G.initTrendDateAggregationType&&(k.value=parseInt(G.initTrendDateAggregationType))):G.initAnalysisType===et.AssetTrends.toString()&&(Re.assetTrendsChartType=G.initChartType?parseInt(G.initChartType):void 0,Re.assetTrendsChartDateType=G.initChartDateType?parseInt(G.initChartDateType):void 0,Re.assetTrendsChartStartTime=G.initStartTime?parseInt(G.initStartTime):void 0,Re.assetTrendsChartEndTime=G.initEndTime?parseInt(G.initEndTime):void 0,(Re.assetTrendsChartDateType!==S.value.assetTrendsChartDateType||Re.assetTrendsChartDateType===Lt.Custom.type&&(Re.assetTrendsChartStartTime!==S.value.assetTrendsChartStartTime||Re.assetTrendsChartEndTime!==S.value.assetTrendsChartEndTime))&&(K=!0),G.initAnalysisType!==m.value.toString()&&(m.value=et.AssetTrends,K=!0),G.initAssetTrendsDateAggregationType&&(N.value=parseInt(G.initAssetTrendsDateAggregationType))),Ht(G.initAnalysisType)?Ye.initTransactionStatisticsFilter(m.value,Re):(m.value=et.CategoricalAnalysis,Ye.initTransactionStatisticsFilter(m.value)),!K&&!Ye.transactionStatisticsStateInvalid){u.value=!1,ke.value=!1;return}Promise.all([Se.loadAllAccounts({force:!1}),Te.loadAllCategories({force:!1})]).then(()=>m.value===et.CategoricalAnalysis?Ye.loadCategoricalAnalysis({force:!1}):m.value===et.TrendAnalysis?Ye.loadTrendAnalysis({force:!1}):m.value===et.AssetTrends?Ye.loadAssetTrends({force:!1}):Promise.reject("An error occurred")).then(()=>{u.value=!1,ke.value=!1}).catch(at=>{u.value=!1,ke.value=!1,at.processed||He.value?.showError(at)})}function Ct(G){let K=null;return u.value=!0,S.value.chartDataType===At.Overview.type||S.value.chartDataType===At.OutflowsByAccount.type||S.value.chartDataType===At.ExpenseByAccount.type||S.value.chartDataType===At.ExpenseByPrimaryCategory.type||S.value.chartDataType===At.ExpenseBySecondaryCategory.type||S.value.chartDataType===At.InflowsByAccount.type||S.value.chartDataType===At.IncomeByAccount.type||S.value.chartDataType===At.IncomeByPrimaryCategory.type||S.value.chartDataType===At.IncomeBySecondaryCategory.type||S.value.chartDataType===At.TotalOutflows.type||S.value.chartDataType===At.TotalExpense.type||S.value.chartDataType===At.TotalInflows.type||S.value.chartDataType===At.TotalIncome.type||S.value.chartDataType===At.NetCashFlow.type||S.value.chartDataType===At.NetIncome.type||S.value.chartDataType===At.NetWorth.type?m.value===et.CategoricalAnalysis?K=Ye.loadCategoricalAnalysis({force:G}):m.value===et.TrendAnalysis?K=Ye.loadTrendAnalysis({force:G}):m.value===et.AssetTrends&&(K=Ye.loadAssetTrends({force:G})):(S.value.chartDataType===At.AccountTotalAssets.type||S.value.chartDataType===At.AccountTotalLiabilities.type)&&(m.value===et.CategoricalAnalysis?K=Se.loadAllAccounts({force:G}):m.value===et.AssetTrends&&(K=Ye.loadAssetTrends({force:G}))),K&&K.then(()=>{u.value=!1,G&&He.value?.showMessage("Data has been updated")}).catch(Re=>{u.value=!1,Re.processed||He.value?.showError(Re)}),K}function fa(G){if(m.value!==G){if(!At.isAvailableForAnalysisType(S.value.chartDataType,G)){let K=At.Default;G===et.AssetTrends&&(K=At.DefaultForAssetTrends),Ye.updateTransactionStatisticsFilter({chartDataType:K.type})}m.value!==et.TrendAnalysis&&G===et.TrendAnalysis?k.value=Yt.Default.type:m.value!==et.AssetTrends&&G===et.AssetTrends&&(N.value=Yt.Default.type),m.value=G,u.value=!0,Ye.updateTransactionStatisticsInvalidState(!0),n.push(Vt())}}function xa(G){let K=!1;m.value===et.CategoricalAnalysis?K=Ye.updateTransactionStatisticsFilter({categoricalChartType:G}):m.value===et.TrendAnalysis?K=Ye.updateTransactionStatisticsFilter({trendChartType:G}):m.value===et.AssetTrends&&(K=Ye.updateTransactionStatisticsFilter({assetTrendsChartType:G})),K&&n.push(Vt())}function ia(G){Ye.updateTransactionStatisticsFilter({chartDataType:G})&&n.push(Vt())}function aa(G){if(G<Ns.Amount.type||G>Ns.Name.type)return;Ye.updateTransactionStatisticsFilter({sortingType:G})&&n.push(Vt())}function Xa(G){const K=k.value!==G;k.value=G,K&&n.push(Vt())}function ul(G){const K=N.value!==G;N.value=G,K&&n.push(Vt())}function Ua(G){if(m.value===et.CategoricalAnalysis){if(G===Lt.Custom.type){Ne.value=!0;return}else if(S.value.categoricalChartDateType===G)return}else if(m.value===et.TrendAnalysis){if(G===Lt.Custom.type){kt.value=!0;return}else if(S.value.trendChartDateType===G)return}else if(m.value===et.AssetTrends){if(G===Lt.Custom.type){Ne.value=!0;return}else if(S.value.assetTrendsChartDateType===G)return}const K=zn(G,p.value,T.value);if(!K)return;let Re=!1;m.value===et.CategoricalAnalysis?Re=Ye.updateTransactionStatisticsFilter({categoricalChartDateType:K.dateType,categoricalChartStartTime:K.minTime,categoricalChartEndTime:K.maxTime}):m.value===et.TrendAnalysis?Re=Ye.updateTransactionStatisticsFilter({trendChartDateType:K.dateType,trendChartStartYearMonth:to(K.minTime),trendChartEndYearMonth:to(K.maxTime)}):m.value===et.AssetTrends&&(Re=Ye.updateTransactionStatisticsFilter({assetTrendsChartDateType:K.dateType,assetTrendsChartStartTime:K.minTime,assetTrendsChartEndTime:K.maxTime})),Re&&(u.value=!0,Ye.updateTransactionStatisticsInvalidState(!0),n.push(Vt()))}function ja(G,K){if(!G||!K)return;let Re=!1;if(m.value===et.CategoricalAnalysis&&Zt(G)&&Zt(K)){const at=Bl(G,K,p.value,T.value,ma.Normal);Re=Ye.updateTransactionStatisticsFilter({categoricalChartDateType:at,categoricalChartStartTime:G,categoricalChartEndTime:K}),Ne.value=!1}else if(m.value===et.TrendAnalysis&&Va(G)&&Va(K)){const at=Bl(mn(G),ho(K),p.value,T.value,ma.TrendAnalysis);Re=Ye.updateTransactionStatisticsFilter({trendChartDateType:at,trendChartStartYearMonth:G,trendChartEndYearMonth:K}),kt.value=!1}else if(m.value===et.AssetTrends&&Zt(G)&&Zt(K)){const at=Bl(G,K,p.value,T.value,ma.AssetTrends);Re=Ye.updateTransactionStatisticsFilter({assetTrendsChartDateType:at,assetTrendsChartStartTime:G,assetTrendsChartEndTime:K}),Ne.value=!1}Re&&(u.value=!0,Ye.updateTransactionStatisticsInvalidState(!0),n.push(Vt()))}function ya(G){let K=!1;if(m.value===et.CategoricalAnalysis){if(S.value.categoricalChartDateType===Lt.All.type)return;const Re=Nn(S.value.categoricalChartStartTime,S.value.categoricalChartEndTime,G,p.value,T.value,ma.Normal);K=Ye.updateTransactionStatisticsFilter({categoricalChartDateType:Re.dateType,categoricalChartStartTime:Re.minTime,categoricalChartEndTime:Re.maxTime})}else if(m.value===et.TrendAnalysis){const Re=Nn(mn(S.value.trendChartStartYearMonth),ho(S.value.trendChartEndYearMonth),G,p.value,T.value,ma.TrendAnalysis);K=Ye.updateTransactionStatisticsFilter({trendChartDateType:Re.dateType,trendChartStartYearMonth:to(Re.minTime),trendChartEndYearMonth:to(Re.maxTime)})}else if(m.value===et.AssetTrends){if(S.value.assetTrendsChartDateType===Lt.All.type)return;const Re=Nn(S.value.assetTrendsChartStartTime,S.value.assetTrendsChartEndTime,G,p.value,T.value,ma.AssetTrends);K=Ye.updateTransactionStatisticsFilter({assetTrendsChartDateType:Re.dateType,assetTrendsChartStartTime:Re.minTime,assetTrendsChartEndTime:Re.maxTime})}K&&(u.value=!0,Ye.updateTransactionStatisticsInvalidState(!0),n.push(Vt()))}function Cl(G){Be.value=!1,G&&(u.value=!0,Ye.updateTransactionStatisticsInvalidState(!0),n.push(Vt()))}function Pa(G){Ke.value=!1,G&&(u.value=!0,Ye.updateTransactionStatisticsInvalidState(!0),n.push(Vt()))}function el(G){Fe.value=!1,G&&(u.value=!0,Ye.updateTransactionStatisticsInvalidState(!0),n.push(Vt()))}function Ha(G){if(m.value===et.AssetTrends||S.value.keyword===G)return;let K=!1;m.value===et.CategoricalAnalysis?K=Ye.updateTransactionStatisticsFilter({keyword:G}):m.value===et.TrendAnalysis&&(K=Ye.updateTransactionStatisticsFilter({keyword:G})),K&&(u.value=!0,Ye.updateTransactionStatisticsInvalidState(!0),n.push(Vt()))}function dl(){if(m.value===et.CategoricalAnalysis&&z.value&&z.value.items)Ot.value?.open({headers:[d("Name"),d("Amount")+` (${V.value})`,d("Proportion (%)")],data:z.value.items.filter(G=>!G.hidden).map(G=>[G.name,b(G.totalAmount),G.percent.toFixed(4)])});else if(m.value===et.TrendAnalysis&&se.value&&se.value.items&&It.value){const G=It.value.exportData();Ot.value?.open({headers:G.headers||[],data:G.data||[]})}else if(m.value===et.AssetTrends&&ue.value&&ue.value.items&&la.value){const G=la.value.exportData();Ot.value?.open({headers:G.headers||[],data:G.data||[]})}}function cl(G,K,Re,at){if(G==="category"&&Re==="category"&&K&&at){const gt=Te.allTransactionCategoriesMap[K],Wa=Te.allTransactionCategoriesMap[at];if(gt?.parentId===Wa?.id){n.push(Qt(`${G}:${K}`));return}else if(Wa?.parentId===gt?.id){n.push(Qt(`${Re}:${at}`));return}}n.push(Qt(`${G}:${K}`+(Re&&at?`-${Re}:${at}`:"")))}function ml(G){n.push(Qt(G.id))}function wl(G){n.push(Qt(G.itemId,G.dateRange))}function Al(G){He.value?.showError(G)}return Rn(G=>{G.query?Rt({initAnalysisType:G.query.analysisType||void 0,initChartDataType:G.query.chartDataType||void 0,initChartType:G.query.chartType||void 0,initChartDateType:G.query.chartDateType||void 0,initStartTime:G.query.startTime||void 0,initEndTime:G.query.endTime||void 0,initFilterAccountIds:G.query.filterAccountIds||void 0,initFilterCategoryIds:G.query.filterCategoryIds||void 0,initTagFilter:G.query.tagFilter||void 0,initKeyword:G.query.keyword||void 0,initSortingType:G.query.sortingType||void 0,initTrendDateAggregationType:G.query.trendDateAggregationType||void 0,initAssetTrendsDateAggregationType:G.query.assetTrendsDateAggregationType||void 0}):Rt({})}),Ft(()=>s.mdAndUp.value,G=>{Et.value=G,yt.value||(yt.value=G)}),Rt(_),(G,K)=>{const Re=Ve("btn-vertical-group"),at=Ve("account-and-category-sankey-chart"),gt=Ve("pie-chart"),Wa=Ve("ItemIcon"),Fa=Ve("router-link"),We=Ve("radar-chart"),Nt=Ve("date-range-selection-dialog"),tl=Ve("month-range-selection-dialog");return l(),g(fe,null,[t(Ae,{class:"match-height"},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,null,{default:a(()=>[t(Jl,null,{default:a(()=>[t(Zl,{permanent:Et.value,modelValue:yt.value,"onUpdate:modelValue":K[4]||(K[4]=Le=>yt.value=Le)},{default:a(()=>[o("div",Hh,[t(Re,{disabled:e(u),buttons:[{name:e(d)("Categorical Analysis"),value:e(et).CategoricalAnalysis},{name:e(d)("Trend Analysis"),value:e(et).TrendAnalysis},{name:e(d)("Asset Trends"),value:e(et).AssetTrends}],modelValue:ut.value,"onUpdate:modelValue":K[0]||(K[0]=Le=>ut.value=Le)},null,8,["disabled","buttons","modelValue"])]),t(nt),o("div",Wh,[o("span",Gh,i(e(d)("Chart Type")),1),za(t(Ge,{"item-title":"displayName","item-value":"type",class:"mt-2",density:"compact",disabled:e(u),items:Pe.value,modelValue:we.value,"onUpdate:modelValue":K[1]||(K[1]=Le=>we.value=Le)},null,8,["disabled","items","modelValue"]),[[Ka,!St.value]]),za(t(Ge,{"item-title":"displayName","item-value":"type",class:"mt-2",density:"compact",disabled:!0,items:[{displayName:e(d)("Sankey Chart"),type:0}],"model-value":0},null,8,["items"]),[[Ka,St.value&&Dt.value===e(At).Overview.type]])]),o("div",Kh,[o("span",Qh,i(e(d)("Sort Order")),1),t(Ge,{"item-title":"displayName","item-value":"type",class:"mt-2",density:"compact",disabled:e(u),items:e(w),modelValue:bt.value,"onUpdate:modelValue":K[2]||(K[2]=Le=>bt.value=Le)},null,8,["disabled","items","modelValue"])]),t(Ja,{"show-arrows":"",class:"my-4",direction:"vertical",disabled:e(u),modelValue:Dt.value,"onUpdate:modelValue":K[3]||(K[3]=Le=>Dt.value=Le)},{default:a(()=>[(l(!0),g(fe,null,$e(e(At).values(void 0,!0),Le=>za((l(),c(Wt,{class:"tab-text-truncate",key:Le.type,value:Le.type},{default:a(()=>[o("span",Jh,i(e(d)(Le.name)),1),t(vt,{activator:"parent",location:"right"},{default:a(()=>[q(i(e(d)(Le.name)),1)]),_:2},1024)]),_:2},1032,["value"])),[[Ka,Le.isAvailableAnalysisType(ut.value)]])),128))]),_:1},8,["disabled","modelValue"])]),_:1},8,["permanent","modelValue"]),t(Xl,null,{default:a(()=>[t(qa,{class:"d-flex flex-grow-1 disable-tab-transition w-100-window-container",modelValue:ze.value,"onUpdate:modelValue":K[15]||(K[15]=Le=>ze.value=Le)},{default:a(()=>[t(zt,{value:"statisticsPage"},{default:a(()=>[t(Me,{variant:"flat","min-height":ut.value===e(et).TrendAnalysis||ut.value===e(et).AssetTrends?"900":"800"},{title:a(()=>[o("div",Zh,[t(H,{class:"me-3 d-md-none",density:"compact",color:"default",variant:"plain",ripple:!1,icon:!0,onClick:K[5]||(K[5]=Le=>yt.value=!yt.value)},{default:a(()=>[t(ie,{icon:e(ql),size:"24"},null,8,["icon"])]),_:1}),o("span",null,i(e(d)("Statistics & Analysis")),1),t(Gl,{class:"ms-4",color:"default",density:"comfortable",variant:"outlined",divided:""},{default:a(()=>[t(H,{class:"button-icon-with-direction",icon:e(On),disabled:e(u)||!e(C),onClick:K[6]||(K[6]=Le=>ya(-1))},null,8,["icon","disabled"]),t(mt,{location:"bottom","max-height":"500"},{activator:a(({props:Le})=>[t(H,_t({disabled:e(u)||!e($)},Le),{default:a(()=>[q(i(e(oe)),1)]),_:1},16,["disabled"])]),default:a(()=>[t(Je,{selected:[e(B)]},{default:a(()=>[(l(!0),g(fe,null,$e(e(A),Le=>(l(),c(ve,{key:Le.type,value:Le.type,"append-icon":e(B)===Le.type?e(Xe):void 0},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:Ca=>Ua(Le.type)},{default:a(()=>[o("div",Xh,[o("span",null,i(Le.displayName),1)]),Le.isUserCustomRange&&e(Ee)(Le.type)?(l(),g("div",eb,[o("span",null,i(e(U)),1),K[21]||(K[21]=o("span",null," - ",-1)),K[22]||(K[22]=o("br",null,null,-1)),o("span",null,i(e(X)),1)])):r("",!0)]),_:2},1032,["onClick"])]),_:2},1032,["value","append-icon"]))),128))]),_:1},8,["selected"])]),_:1}),t(H,{class:"button-icon-with-direction",icon:e(ba),disabled:e(u)||!e(C),onClick:K[7]||(K[7]=Le=>ya(1))},null,8,["icon","disabled"])]),_:1}),ut.value===e(et).TrendAnalysis?(l(),c(mt,{key:0,location:"bottom","max-height":"500"},{activator:a(({props:Le})=>[t(H,_t({class:"ms-3",color:"default",variant:"outlined","prepend-icon":e(bs),disabled:e(u)},Le),{default:a(()=>[q(i(e(W)),1)]),_:1},16,["prepend-icon","disabled"])]),default:a(()=>[t(Je,null,{default:a(()=>[(l(!0),g(fe,null,$e(e(I),Le=>(l(),c(ve,{class:"cursor-pointer",key:Le.type,value:Le.type,"append-icon":e(k)===Le.type?e(Xe):void 0,title:Le.displayName,onClick:Ca=>Xa(Le.type)},null,8,["value","append-icon","title","onClick"]))),128))]),_:1})]),_:1})):r("",!0),ut.value===e(et).AssetTrends?(l(),c(mt,{key:1,location:"bottom","max-height":"500"},{activator:a(({props:Le})=>[t(H,_t({class:"ms-3",color:"default",variant:"outlined","prepend-icon":e(bs),disabled:e(u)},Le),{default:a(()=>[q(i(e(D)),1)]),_:1},16,["prepend-icon","disabled"])]),default:a(()=>[t(Je,null,{default:a(()=>[(l(!0),g(fe,null,$e(e(F),Le=>(l(),c(ve,{class:"cursor-pointer",key:Le.type,value:Le.type,"append-icon":e(N)===Le.type?e(Xe):void 0,title:Le.displayName,onClick:Ca=>ul(Le.type)},null,8,["value","append-icon","title","onClick"]))),128))]),_:1})]),_:1})):r("",!0),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,loading:e(u),onClick:K[8]||(K[8]=Le=>Ct(!0))},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(d)("Refresh")),1)]),_:1})]),_:1},8,["loading"]),t(it),o("div",tb,[e(ye)?(l(),c(ot,{key:0,density:"compact",disabled:e(u),"prepend-inner-icon":e(Ql),"append-inner-icon":Ie.value!==e(S).keyword?e(Xe):void 0,placeholder:e(d)("Filter transaction description"),modelValue:Ie.value,"onUpdate:modelValue":K[9]||(K[9]=Le=>Ie.value=Le),"onClick:appendInner":K[10]||(K[10]=Le=>Ha(Ie.value)),onKeyup:K[11]||(K[11]=Gt(Le=>Ha(Ie.value),["enter"]))},null,8,["disabled","prepend-inner-icon","append-inner-icon","placeholder","modelValue"])):r("",!0)]),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",disabled:e(u),icon:!0},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{disabled:e(u),"prepend-icon":e(co),title:e(d)("Filter Accounts"),onClick:K[12]||(K[12]=Le=>Be.value=!0)},null,8,["disabled","prepend-icon","title"]),e(M)?(l(),c(ve,{key:0,disabled:e(u),"prepend-icon":e(co),title:e(d)("Filter Transaction Categories"),onClick:K[13]||(K[13]=Le=>Ke.value=!0)},null,8,["disabled","prepend-icon","title"])):r("",!0),e(ee)?(l(),c(ve,{key:1,disabled:e(u),"prepend-icon":e(co),title:e(d)("Filter Transaction Tags"),onClick:K[14]||(K[14]=Le=>Fe.value=!0)},null,8,["disabled","prepend-icon","title"])):r("",!0),St.value?r("",!0):(l(),c(nt,{key:2,class:"my-2"})),St.value?r("",!0):(l(),c(ve,{key:3,"prepend-icon":e(li),title:e(d)("Export Results"),disabled:!Ue.value,onClick:dl},null,8,["prepend-icon","title","disabled"])),t(nt,{class:"my-2"}),t(ve,{to:"/app/settings?tab=statisticsSetting","prepend-icon":e(Cr),title:e(d)("Settings")},null,8,["prepend-icon","title"])]),_:1})]),_:1})]),_:1},8,["disabled"])])]),default:a(()=>[ut.value===e(et).CategoricalAnalysis&&St.value&&Dt.value===e(At).Overview.type&&(ke.value||e(le)&&e(le).items&&e(le).items.length)?(l(),c(ge,{key:0,class:be(["statistics-overview-title pt-0",{disabled:e(u)}])},{default:a(()=>[o("span",ab,i(e(d)("Total Income")),1),!ke.value&&e(le)&&e(le).items&&e(le).items.length?(l(),g("span",lb,i(e(te)(e(le).totalIncome,e(V))),1)):ke.value?(l(),c(ft,{key:1,class:"skeleton-no-margin ms-3 mb-2",width:"120px",type:"text",loading:!0})):r("",!0),o("span",nb,i(e(d)("Total Expense")),1),!ke.value&&e(le)&&e(le).items&&e(le).items.length?(l(),g("span",ob,i(e(te)(e(le).totalExpense,e(V))),1)):ke.value?(l(),c(ft,{key:3,class:"skeleton-no-margin ms-3 mb-2",width:"120px",type:"text",loading:!0})):r("",!0)]),_:1},8,["class"])):ut.value===e(et).CategoricalAnalysis&&!St.value&&(ke.value||e(z)&&e(z).items&&e(z).items.length)?(l(),c(ge,{key:1,class:be(["statistics-overview-title pt-0",{disabled:e(u)}])},{default:a(()=>[o("span",sb,i(e(Y)),1),!ke.value&&e(z)&&e(z).items&&e(z).items.length?(l(),g("span",{key:0,class:be(["statistics-overview-amount ms-3",_a.value])},i(e(te)(e(z).totalAmount,e(V))),3)):ke.value?(l(),c(ft,{key:1,class:"skeleton-no-margin ms-3 mb-2",width:"120px",type:"text",loading:!0})):r("",!0)]),_:1},8,["class"])):!e(u)&&(ut.value===e(et).CategoricalAnalysis&&St.value&&Dt.value===e(At).Overview.type&&(!e(le)||!e(le).items||!e(le).items.length)||ut.value===e(et).CategoricalAnalysis&&!St.value&&(!e(z)||!e(z).items||!e(z).items.length)||ut.value===e(et).TrendAnalysis&&(!e(se)||!e(se).items||!e(se).items.length)||ut.value===e(et).AssetTrends&&(!e(ue)||!e(ue).items||!e(ue).items.length))?(l(),c(ge,{key:2,class:"statistics-overview-title pt-0"},{default:a(()=>[o("span",ib,i(e(d)("No transaction data")),1)]),_:1})):r("",!0),ut.value===e(et).CategoricalAnalysis&&Dt.value===e(At).Overview.type?(l(),c(ge,{key:3,class:be({readonly:e(u)})},{default:a(()=>[ke.value?(l(),c(at,{key:0,items:[],"sorting-type":bt.value,skeleton:!0},null,8,["sorting-type"])):ke.value?r("",!0):(l(),c(at,{key:1,items:e(le)&&e(le).items&&e(le).items.length?e(le).items:[],"enable-click-item":!0,"default-currency":e(V),onClick:cl},null,8,["items","default-currency"]))]),_:1},8,["class"])):r("",!0),ut.value===e(et).CategoricalAnalysis&&!St.value&&e(S).categoricalChartType===e($o).Pie.type?(l(),c(ge,{key:4,class:be({readonly:e(u)})},{default:a(()=>[ke.value?(l(),c(gt,{key:0,items:[{id:"1",name:"---",value:60,color:"7c7c7f"},{id:"2",name:"---",value:20,color:"a5a5aa"},{id:"3",name:"---",value:20,color:"c5c5c9"}],skeleton:!0,"id-field":"id","name-field":"name","value-field":"value","color-field":"color"})):ke.value?r("",!0):(l(),c(gt,{key:1,items:e(z)&&e(z).items&&e(z).items.length?e(z).items:[],"min-valid-percent":1e-4,"show-value":e(L),"show-percent":e(O),"enable-click-item":!0,"amount-value":!0,"default-currency":e(V),"id-field":"id","name-field":"name","value-field":"totalAmount","percent-field":"percent","hidden-field":"hidden",onClick:ml},null,8,["items","show-value","show-percent","default-currency"]))]),_:1},8,["class"])):r("",!0),ut.value===e(et).CategoricalAnalysis&&!St.value&&e(S).categoricalChartType===e($o).Bar.type?(l(),c(ge,{key:5,class:be({readonly:e(u)})},{default:a(()=>[ke.value?(l(),c(Je,{key:0,rounded:"",lines:"two"},{default:a(()=>[(l(),g(fe,null,$e([1,2,3],Le=>(l(),g(fe,{key:Le},[t(ve,{class:"ps-0"},{prepend:a(()=>[o("div",null,[t(ie,{class:"disabled me-0",size:"34",icon:e($n)},null,8,["icon"])])]),default:a(()=>[o("div",rb,[o("div",ub,[t(ft,{class:"skeleton-no-margin my-2",width:"120px",type:"text",loading:!0})]),o("div",null,[t(Bo,{"model-value":0,height:4})])])]),_:1}),Le<3?(l(),c(nt,{key:0})):r("",!0)],64))),64))]),_:1})):!ke.value&&e(z)&&e(z).items&&e(z).items.length?(l(),c(Je,{key:1,class:"py-0",rounded:"",lines:"two"},{default:a(()=>[(l(!0),g(fe,null,$e(e(z).items,(Le,Ca)=>(l(),g(fe,{key:Ca},[Le.hidden?r("",!0):(l(),c(ve,{key:0,class:"ps-0"},{prepend:a(()=>[t(Fa,{class:"statistics-list-item",to:Qt(Le.id)},{default:a(()=>[t(Wa,{"icon-type":e(j),size:"34px","icon-id":Le.icon,color:Le.color},null,8,["icon-type","icon-id","color"])]),_:2},1032,["to"])]),default:a(()=>[t(Fa,{class:"statistics-list-item",to:Qt(Le.id)},{default:a(()=>[o("div",db,[o("div",cb,[o("span",null,i(Le.name),1),e(O)&&Le.percent>=0?(l(),g("small",mb,i(e(x)(Le.percent,2,"<0.01")),1)):r("",!0),t(it),o("span",pb,i(e(te)(Le.totalAmount,e(V))),1)]),o("div",null,[t(Bo,{color:Le.color?e(me)(Le):"primary","bg-color":De.value?"#444444":"#f8f8f8","bg-opacity":1,"model-value":Le.percent>=0?Le.percent:0,height:4},null,8,["color","bg-color","model-value"])])])]),_:2},1032,["to"])]),_:2},1024)),!Le.hidden&&Ca!==e(z).items.length-1?(l(),c(nt,{key:1})):r("",!0)],64))),128))]),_:1})):r("",!0)]),_:1},8,["class"])):r("",!0),ut.value===e(et).CategoricalAnalysis&&!St.value&&e(S).categoricalChartType===e($o).Radar.type?(l(),c(ge,{key:6,class:be({readonly:e(u)})},{default:a(()=>[ke.value?(l(),c(We,{key:0,items:[{name:"---",value:10},{name:"---",value:10},{name:"---",value:10},{name:"---",value:10},{name:"---",value:10},{name:"---",value:10}],skeleton:!0,"name-field":"name","value-field":"value"})):ke.value?r("",!0):(l(),c(We,{key:1,items:e(z)&&e(z).items&&e(z).items.length?e(z).items:[],"min-valid-percent":1e-4,"show-value":e(L),"show-percent":e(O),"amount-value":!0,"default-currency":e(V),"name-field":"name","value-field":"totalAmount","percent-field":"percent","hidden-field":"hidden"},null,8,["items","show-value","show-percent","default-currency"]))]),_:1},8,["class"])):r("",!0),ut.value===e(et).TrendAnalysis?(l(),c(ge,{key:7,class:be({readonly:e(u)})},{default:a(()=>[ke.value?(l(),c(In,{key:0,"chart-mode":"monthly",type:we.value,"start-time":void 0,"end-time":void 0,"start-year-month":e(S).trendChartStartYearMonth,"end-year-month":e(S).trendChartEndYearMonth,"sorting-type":bt.value,"data-aggregation-type":e(dn).Sum,"date-aggregation-type":e(k),"fiscal-year-start":e(T),items:[],skeleton:!0,"id-field":"id","name-field":"name","value-field":"value","color-field":"color"},null,8,["type","start-year-month","end-year-month","sorting-type","data-aggregation-type","date-aggregation-type","fiscal-year-start"])):!ke.value&&e(se)&&e(se).items&&e(se).items.length?(l(),c(In,{key:1,"chart-mode":"monthly",type:we.value,"start-time":void 0,"end-time":void 0,"start-year-month":e(S).trendChartStartYearMonth,"end-year-month":e(S).trendChartEndYearMonth,"sorting-type":bt.value,"data-aggregation-type":e(dn).Sum,"date-aggregation-type":e(k),"fiscal-year-start":e(T),items:e(se)&&e(se).items&&e(se).items.length?e(se).items:[],"translate-name":e(Z),"show-value":e(L),"enable-click-item":!0,"default-currency":e(V),stacked:e(ae),"show-total-amount-in-tooltip":e(J),ref_key:"monthlyTrendsChart",ref:It,"id-field":"id","name-field":"name","value-field":"totalAmount","hidden-field":"hidden","display-orders-field":"displayOrders",onClick:wl},null,8,["type","start-year-month","end-year-month","sorting-type","data-aggregation-type","date-aggregation-type","fiscal-year-start","items","translate-name","show-value","default-currency","stacked","show-total-amount-in-tooltip"])):r("",!0)]),_:1},8,["class"])):r("",!0),ut.value===e(et).AssetTrends?(l(),c(ge,{key:8,class:be({readonly:e(u)})},{default:a(()=>[ke.value?(l(),c(In,{key:0,"chart-mode":"daily",type:we.value,"start-time":e(S).assetTrendsChartStartTime,"end-time":e(S).assetTrendsChartEndTime,"start-year-month":void 0,"end-year-month":void 0,"sorting-type":bt.value,"data-aggregation-type":e(dn).Last,"date-aggregation-type":e(N),"fiscal-year-start":e(T),items:[],skeleton:!0,"id-field":"id","name-field":"name","value-field":"value","color-field":"color"},null,8,["type","start-time","end-time","sorting-type","data-aggregation-type","date-aggregation-type","fiscal-year-start"])):!ke.value&&e(ue)&&e(ue).items&&e(ue).items.length?(l(),c(In,{key:1,"chart-mode":"daily",type:we.value,"start-time":e(S).assetTrendsChartStartTime,"end-time":e(S).assetTrendsChartEndTime,"start-year-month":void 0,"end-year-month":void 0,"sorting-type":bt.value,"data-aggregation-type":e(dn).Last,"date-aggregation-type":e(N),"fiscal-year-start":e(T),items:e(ue)&&e(ue).items&&e(ue).items.length?e(ue).items:[],"translate-name":e(Z),"show-value":e(L),"enable-click-item":!0,"default-currency":e(V),stacked:e(ae),"show-total-amount-in-tooltip":e(J),ref_key:"dailyTrendsChart",ref:la,"id-field":"id","name-field":"name","value-field":"totalAmount","hidden-field":"hidden","display-orders-field":"displayOrders",onClick:wl},null,8,["type","start-time","end-time","sorting-type","data-aggregation-type","date-aggregation-type","fiscal-year-start","items","translate-name","show-value","default-currency","stacked","show-total-amount-in-tooltip"])):r("",!0)]),_:1},8,["class"])):r("",!0)]),_:1},8,["min-height"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(Nt,{title:e(d)("Custom Date Range"),"min-time":e(S).categoricalChartStartTime,"max-time":e(S).categoricalChartEndTime,show:Ne.value,"onUpdate:show":K[16]||(K[16]=Le=>Ne.value=Le),"onDateRange:change":ja,onError:Al},null,8,["title","min-time","max-time","show"]),t(tl,{title:e(d)("Custom Date Range"),"min-time":e(S).trendChartStartYearMonth,"max-time":e(S).trendChartEndYearMonth,show:kt.value,"onUpdate:show":K[17]||(K[17]=Le=>kt.value=Le),"onDateRange:change":ja,onError:Al},null,8,["title","min-time","max-time","show"]),t(xt,{width:"800",modelValue:Be.value,"onUpdate:modelValue":K[18]||(K[18]=Le=>Be.value=Le)},{default:a(()=>[t($l,{type:"statisticsCurrent","dialog-mode":!0,"onSettings:change":Cl})]),_:1},8,["modelValue"]),t(xt,{width:"800",modelValue:Ke.value,"onUpdate:modelValue":K[19]||(K[19]=Le=>Ke.value=Le)},{default:a(()=>[t(Hn,{type:"statisticsCurrent","dialog-mode":!0,"onSettings:change":Pa})]),_:1},8,["modelValue"]),t(xt,{width:"800",modelValue:Fe.value,"onUpdate:modelValue":K[20]||(K[20]=Le=>Fe.value=Le)},{default:a(()=>[t(Si,{type:"statisticsCurrent","dialog-mode":!0,"onSettings:change":el})]),_:1},8,["modelValue"]),t(Vi,{ref_key:"exportDialog",ref:Ot},null,512),t(ct,{ref_key:"snackbar",ref:He},null,512)],64)}}}),fb={class:"title-and-toolbar d-flex"},yb={key:0,class:"query-name text-subtitle-1 ms-2"},gb={key:1,class:"query-name-edit ms-2"},hb=["id"],bb={key:0,class:"text-center py-4"},Tb={key:1},kb={class:"d-flex overflow-x-auto align-center gap-2 mb-4"},_b={class:"d-flex w-100 flex-1-1",style:{"min-width":"280px"}},xb={class:"d-flex align-center"},Cb={key:4,class:"d-flex w-100 align-center gap-2"},wb={key:0,class:"ms-2 me-2"},Ab={key:5,class:"d-flex w-100"},Sb={class:"d-flex align-center"},Vb={class:"d-flex align-center"},Ib={key:2},Db={class:"w-100 code-container"},$b={key:0,class:"query-group-separator d-flex align-center justify-center my-4"},Nb=Oe({__name:"ExploreQueryTab",props:{loading:{type:Boolean}},setup(v){const _=v,{tt:n,joinMultiText:s,getAllTransactionExploreConditionFields:h,getAllTransactionExploreConditionOperators:d}=je(),y=ta(),f=pa(),b=va(),x=rl(),u=Yn(),m=xe("snackbar"),k=P(void 0),N=P({}),V=P(!1),p=P(!1),T=P(!1),A=P(""),w=P(void 0),I=P(""),F=E(()=>u.transactionExploreFilter.query),S=E(()=>y.currentUserDefaultCurrency),j=E(()=>f.allPlainAccounts.length>0),B=E(()=>!hi(b.allTransactionCategoriesMap)),U=E(()=>x.allTransactionTags),X=E(()=>h()),oe=E(()=>{const se=A.value.toLowerCase();let ue=0;for(const Ee of U.value)if(!se||Ee.name.toLowerCase().indexOf(se)>=0){if(!Ee.hidden)return!1;ue++}return ue>0});function W(se){if(_.loading&&!j.value||!f.allVisiblePlainAccounts||!f.allVisiblePlainAccounts.length)return"";if(!se)return n("All");let ue=!0;const Ee=[];for(const me of f.allPlainAccounts)me.type!==oa.MultiSubAccounts.type&&(se[me.id]?Ee.push(me.name):ue=!1);return ue?n("All"):Ee.length<1?"":s(Ee)}function D(se){if(_.loading&&!B.value||!b.allTransactionCategoriesMap)return"";if(!se)return n("All");let ue=!0;const Ee=[];for(const me of cs(b.allTransactionCategoriesMap))!me.parentId||me.parentId==="0"||(se[me.id]?Ee.push(me.name):ue=!1);return ue?n("All"):Ee.length<1?"":s(Ee)}function $(){F.value.push(ao.create())}function C(se){se.name=I.value,w.value=void 0,I.value=""}function M(){w.value=void 0,I.value=""}function ee(se){F.value.push(se.clone())}function ye(se){F.value.length>0&&F.value.splice(se,1);const ue={};for(const[Ee,me]of gi(N.value)){const te=parseInt(Ee);se>te?ue[te]=me:se<te&&(ue[te-1]=me)}N.value=ue,F.value.length<1&&F.value.push(ao.create())}function L(){F.value.length=0,F.value.push(ao.create())}function Y(se){const ue=F.value[se];if(!ue)return;const Ee=ue.addNewCondition(wa.TransactionType,ue.conditions.length<1);ue.conditions.push(Ee)}function O(se,ue){const Ee=F.value[se];if(Ee&&(Ee.conditions.splice(ue,1),ue===0&&Ee.conditions.length>0)){const me=Ee.conditions[0];me&&(me.relation=An.First)}}function J(se,ue,Ee){if(!Ee)return;const me=F.value[se];if(!me)return;const te=me.conditions[ue];if(!te)return;const Se=me.addNewCondition(Ee,ue<1);te.condition=Se.condition}function ae(se,ue){if(!se||!k.value||k.value.field!==wa.SourceAccount.value){V.value=!1;return}k.value.value=ue||[],k.value=void 0,V.value=!1}function Z(se,ue){if(!se||!k.value||k.value.field!==wa.DestinationAccount.value){p.value=!1;return}k.value.value=ue||[],k.value=void 0,p.value=!1}function le(se,ue){if(!se||!k.value||k.value.field!==wa.TransactionCategory.value){T.value=!1;return}k.value.value=ue||[],k.value=void 0,T.value=!1}function z(se){const ue=F.value[se];if(!ue||!ue.conditions||ue.conditions.length<1)return"";try{return ue.toExpression(b.allTransactionCategoriesMap,f.allAccountsMap,x.allTransactionTagsMap)}catch(Ee){return Xt.error("failed to generate expression for explore query#"+se,Ee),m.value?.showError(n("Failed to generate expression")),n("Failed to generate expression")}}return F.value.length===0&&F.value.push(ao.create()),(se,ue)=>{const Ee=Ve("amount-input"),me=Hi("text-field-auto-width");return l(),g(fe,null,[t(ni,{class:"px-5"},{default:a(()=>[o("div",fb,[t(H,{color:"default",variant:"outlined",disabled:v.loading||!!w.value,onClick:$},{default:a(()=>[q(i(e(n)("Add Query")),1)]),_:1},8,["disabled"]),t(it),t(H,{color:"secondary",variant:"tonal",disabled:v.loading||!!w.value||F.value.length<1,onClick:L},{default:a(()=>[q(i(e(n)("Clear All")),1)]),_:1},8,["disabled"])])]),_:1}),t(ge,{class:"pt-0"},{default:a(()=>[(l(!0),g(fe,null,$e(F.value,(te,Se)=>(l(),g("div",{key:Se},[t(Me,{border:"",class:"card-title-with-bg mt-4"},{default:a(()=>[t(oi,{class:"d-flex align-center py-2 px-5"},{default:a(()=>[t(ie,{icon:e(wr),size:"20"},null,8,["icon"]),w.value!==te?(l(),g("span",yb,i(te.name||e(n)("format.misc.queryIndex",{index:Se+1})),1)):r("",!0),w.value===te?(l(),g("div",gb,[za(t(ot,{autofocus:"",type:"text",density:"compact",variant:"underlined",disabled:v.loading,placeholder:e(n)("format.misc.queryIndex",{index:Se+1}),modelValue:I.value,"onUpdate:modelValue":ue[0]||(ue[0]=Te=>I.value=Te),onKeyup:[Gt(M,["esc"]),Gt(Te=>C(te),["enter"])]},null,8,["disabled","placeholder","modelValue","onKeyup"]),[[me,{minWidth:20,maxWidth:300,auxSpanId:`query-name-aux-span-${Se+1}`}]]),o("span",{id:`query-name-aux-span-${Se+1}`},null,8,hb)])):r("",!0),w.value===te?(l(),c(H,{key:2,class:"ms-2",density:"compact",color:"primary",variant:"text",size:"small",icon:!0,disabled:v.loading,onClick:Te=>C(te)},{default:a(()=>[t(ie,{icon:e(Xe),size:"18"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Update")),1)]),_:1})]),_:1},8,["disabled","onClick"])):r("",!0),w.value===te?(l(),c(H,{key:3,class:"ms-2",density:"compact",color:"default",variant:"text",size:"small",icon:!0,disabled:v.loading,onClick:M},{default:a(()=>[t(ie,{icon:e(vl),size:"18"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1})]),_:1},8,["disabled"])):r("",!0),!w.value||w.value!==te?(l(),c(H,{key:4,class:"ms-2",density:"compact",color:"default",variant:"text",size:"small",icon:!0,disabled:v.loading||!!w.value,onClick:Te=>{I.value=te.name,w.value=te}},{default:a(()=>[t(ie,{icon:e(hn),size:"18"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Modify Query Name")),1)]),_:1})]),_:1},8,["disabled","onClick"])):r("",!0),!w.value||w.value!==te?(l(),c(H,{key:5,class:"ms-2",density:"compact",color:"default",variant:"text",size:"small",icon:!0,disabled:v.loading||!!w.value,onClick:Te=>ee(te)},{default:a(()=>[t(ie,{icon:e(si),size:"18"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Duplicate")),1)]),_:1})]),_:1},8,["disabled","onClick"])):r("",!0),t(it),t(Ea,{class:"bidirectional-switch ms-2",color:"secondary",disabled:v.loading||!!w.value||!te.conditions||te.conditions.length<1,label:e(n)("Expression"),modelValue:N.value[Se],"onUpdate:modelValue":Te=>N.value[Se]=Te,onClick:Te=>N.value[Se]=!N.value[Se]},{prepend:a(()=>[o("span",null,i(e(n)("Editor")),1)]),_:1},8,["disabled","label","modelValue","onUpdate:modelValue","onClick"]),t(H,{class:"ms-2",density:"compact",color:"default",variant:"text",size:"small",icon:!0,disabled:v.loading||!!w.value||F.value.length<1,onClick:Te=>ye(Se)},{default:a(()=>[t(ie,{icon:e(vl),size:"18"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Remove Query")),1)]),_:1})]),_:1},8,["disabled","onClick"])]),_:2},1024),t(nt),t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[!te.conditions||te.conditions.length<1?(l(),g("div",bb,i(e(n)("No conditions defined. All transactions will match.")),1)):te.conditions&&te.conditions.length>0&&!N.value[Se]?(l(),g("div",Tb,[(l(!0),g(fe,null,$e(te.conditions,(Te,Ye)=>(l(),g("div",{key:Ye},[o("div",kb,[Ye<1?(l(),c(Ge,{key:0,disabled:"",class:"flex-0-0",width:"120px",density:"compact","item-title":"displayName","item-value":"value",items:[{value:e(An).First,displayName:e(n)("WHERE")}],"model-value":e(An).First},null,8,["items","model-value"])):Ye>=1?(l(),c(Ge,{key:1,class:"flex-0-0",width:"120px",density:"compact","item-title":"displayName","item-value":"value",disabled:v.loading||!!w.value,items:[{value:e(An).And,displayName:e(n)("AND")},{value:e(An).Or,displayName:e(n)("OR")}],modelValue:Te.relation,"onUpdate:modelValue":He=>Te.relation=He},null,8,["disabled","items","modelValue","onUpdate:modelValue"])):r("",!0),t(Ge,{class:"flex-0-0",density:"compact","item-title":"name","item-value":"value",disabled:v.loading||!!w.value,items:X.value,"onUpdate:modelValue":[He=>J(Se,Ye,e(wa).valueOf(He)),He=>Te.condition.field=He],modelValue:Te.condition.field},null,8,["disabled","items","onUpdate:modelValue","modelValue"]),t(Ge,{class:"flex-0-0",density:"compact","item-title":"name","item-value":"value",disabled:v.loading||!!w.value,items:e(d)(Te.getSupportedOperators()),modelValue:Te.condition.operator,"onUpdate:modelValue":He=>Te.condition.operator=He},null,8,["disabled","items","modelValue","onUpdate:modelValue"]),o("div",_b,[Te.condition.field===e(wa).TransactionType.value?(l(),c(Ge,{key:0,multiple:"",chips:"","closable-chips":"",density:"compact","item-title":"displayName","item-value":"type",disabled:v.loading||!!w.value,placeholder:e(n)("None"),items:[{type:e(pe).Expense,displayName:e(n)("Expense")},{type:e(pe).Income,displayName:e(n)("Income")},{type:e(pe).Transfer,displayName:e(n)("Transfer")}],modelValue:Te.condition.value,"onUpdate:modelValue":He=>Te.condition.value=He},{item:a(({props:He,item:It})=>[t(ve,_t({value:It.value},{ref_for:!0},He),{title:a(()=>[t(rt,null,{default:a(()=>[o("div",xb,i(It.title),1)]),_:2},1024)]),_:2},1040,["value"])]),_:1},8,["disabled","placeholder","items","modelValue","onUpdate:modelValue"])):Te.condition.field===e(wa).TransactionCategory.value?(l(),c(ot,{key:1,class:"always-cursor-pointer text-field-truncate",density:"compact","item-title":"displayName","item-value":"type","persistent-placeholder":"",readonly:!0,disabled:v.loading||!!w.value||!B.value,placeholder:e(n)("None"),"model-value":D(e(cn)(Te.condition.value,!0)),onClick:He=>{k.value=Te.condition,T.value=!0}},null,8,["disabled","placeholder","model-value","onClick"])):Te.condition.field===e(wa).SourceAccount.value?(l(),c(ot,{key:2,class:"always-cursor-pointer text-field-truncate",density:"compact","item-title":"displayName","item-value":"type","persistent-placeholder":"",readonly:!0,disabled:v.loading||!!w.value||!j.value,placeholder:e(n)("None"),"model-value":W(e(cn)(Te.condition.value,!0)),onClick:He=>{k.value=Te.condition,V.value=!0}},null,8,["disabled","placeholder","model-value","onClick"])):Te.condition.field===e(wa).DestinationAccount.value?(l(),c(ot,{key:3,class:"always-cursor-pointer text-field-truncate",density:"compact","item-title":"displayName","item-value":"type","persistent-placeholder":"",readonly:!0,disabled:v.loading||!!w.value||!j.value,placeholder:e(n)("None"),"model-value":W(e(cn)(Te.condition.value,!0)),onClick:He=>{k.value=Te.condition,p.value=!0}},null,8,["disabled","placeholder","model-value","onClick"])):Te.condition.field===e(wa).SourceAmount.value||Te.condition.field===e(wa).DestinationAmount.value?(l(),g("div",Cb,[t(Ee,{density:"compact",currency:S.value,disabled:v.loading||!!w.value,modelValue:Te.condition.value[0],"onUpdate:modelValue":He=>Te.condition.value[0]=He},null,8,["currency","disabled","modelValue","onUpdate:modelValue"]),Te.condition.operator===e(Ga).Between.value||Te.condition.operator===e(Ga).NotBetween.value?(l(),g("span",wb,"~")):r("",!0),Te.condition.operator===e(Ga).Between.value||Te.condition.operator===e(Ga).NotBetween.value?(l(),c(Ee,{key:1,density:"compact",currency:S.value,disabled:v.loading||!!w.value,modelValue:Te.condition.value[1],"onUpdate:modelValue":He=>Te.condition.value[1]=He},null,8,["currency","disabled","modelValue","onUpdate:modelValue"])):r("",!0)])):Te.condition.field===e(wa).TransactionTag.value?(l(),g("div",Ab,[Te.condition.field===e(wa).TransactionTag.value&&(Te.condition.operator===e(Ga).IsEmpty.value||Te.condition.operator===e(Ga).IsNotEmpty.value)?(l(),c(ot,{key:0,disabled:"","persistent-placeholder":"",density:"compact",placeholder:e(n)("None")},null,8,["placeholder"])):Te.condition.operator!==e(Ga).IsEmpty.value&&Te.condition.operator!==e(Ga).IsNotEmpty.value?(l(),c(ua,{key:1,density:"compact","item-title":"name","item-value":"id","auto-select-first":"","persistent-placeholder":"",multiple:"",chips:"","closable-chips":"",disabled:v.loading||!!w.value,placeholder:e(n)("None"),items:U.value,modelValue:Te.condition.value,"onUpdate:modelValue":He=>Te.condition.value=He,search:A.value,"onUpdate:search":ue[1]||(ue[1]=He=>A.value=He)},{chip:a(({props:He,item:It})=>[t(Jt,_t({"prepend-icon":e(ea),text:It.title},{ref_for:!0},He),null,16,["prepend-icon","text"])]),item:a(({props:He,item:It})=>[It.raw.hidden?r("",!0):(l(),c(ve,_t({key:0,value:It.value},{ref_for:!0},He),{title:a(()=>[t(rt,null,{default:a(()=>[o("div",Sb,[t(ie,{size:"20",start:"",icon:e(ea)},null,8,["icon"]),o("span",null,i(It.title),1)])]),_:2},1024)]),_:2},1040,["value"])),It.raw.hidden&&It.raw.name.toLowerCase().indexOf(A.value.toLowerCase())>=0&&oe.value?(l(),c(ve,_t({key:1,disabled:!0},{ref_for:!0},He),{title:a(()=>[t(rt,null,{default:a(()=>[o("div",Vb,[t(ie,{size:"20",start:"",icon:e(ea)},null,8,["icon"]),o("span",null,i(It.title),1)])]),_:2},1024)]),_:2},1040)):r("",!0)]),"no-data":a(()=>[t(Je,{class:"py-0"},{default:a(()=>[t(ve,null,{default:a(()=>[q(i(e(n)("No available tag")),1)]),_:1})]),_:1})]),_:1},8,["disabled","placeholder","items","modelValue","onUpdate:modelValue","search"])):r("",!0)])):Te.condition.field===e(wa).Description.value&&Te.condition.operator===e(Ga).IsEmpty.value||Te.condition.operator===e(Ga).IsNotEmpty.value?(l(),c(ot,{key:6,disabled:"",density:"compact",placeholder:e(n)("None")},null,8,["placeholder"])):Te.condition.field===e(wa).Description.value&&Te.condition.operator!==e(Ga).IsEmpty.value&&Te.condition.operator!==e(Ga).IsNotEmpty.value?(l(),c(ot,{key:7,density:"compact",disabled:v.loading||!!w.value,placeholder:e(n)("None"),modelValue:Te.condition.value,"onUpdate:modelValue":He=>Te.condition.value=He},null,8,["disabled","placeholder","modelValue","onUpdate:modelValue"])):r("",!0)]),t(H,{color:"default",density:"compact",variant:"text",size:"small",icon:!0,disabled:v.loading||!!w.value,onClick:He=>O(Se,Ye)},{default:a(()=>[t(ie,{icon:e(vl),size:"18"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Remove Condition")),1)]),_:1})]),_:1},8,["disabled","onClick"])])]))),128))])):te.conditions&&te.conditions.length>0&&N.value[Se]?(l(),g("div",Ib,[o("div",Db,[t(Oa,{class:"w-100 always-cursor-text mb-4",readonly:!0,value:z(Se)},null,8,["value"])])])):r("",!0),t(H,{class:"px-2",density:"comfortable",color:"primary",variant:"text",size:"small","prepend-icon":e(ii),disabled:v.loading||!!w.value||N.value[Se],onClick:Te=>Y(Se)},{default:a(()=>[q(i(e(n)("Add Condition")),1)]),_:1},8,["prepend-icon","disabled","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),F.value.length>1&&Se<F.value.length-1?(l(),g("div",$b,[t(Jt,{color:"primary",variant:"outlined",size:"small"},{default:a(()=>[q(i(e(n)("or")),1)]),_:1})])):r("",!0)]))),128))]),_:1}),t(xt,{width:"800",modelValue:V.value,"onUpdate:modelValue":ue[2]||(ue[2]=te=>V.value=te)},{default:a(()=>[t($l,{type:"custom","dialog-mode":!0,"selected-account-ids":e(Fn)(k.value?.value)?k.value?.value:[],"onSettings:change":ae},null,8,["selected-account-ids"])]),_:1},8,["modelValue"]),t(xt,{width:"800",modelValue:p.value,"onUpdate:modelValue":ue[3]||(ue[3]=te=>p.value=te)},{default:a(()=>[t($l,{type:"custom","dialog-mode":!0,"selected-account-ids":e(Fn)(k.value?.value)?k.value?.value:[],"onSettings:change":Z},null,8,["selected-account-ids"])]),_:1},8,["modelValue"]),t(xt,{width:"800",modelValue:T.value,"onUpdate:modelValue":ue[4]||(ue[4]=te=>T.value=te)},{default:a(()=>[t(Hn,{type:"custom","dialog-mode":!0,"selected-category-ids":e(Fn)(k.value?.value)?k.value?.value:[],"onSettings:change":le},null,8,["selected-category-ids"])]),_:1},8,["modelValue"]),t(ct,{ref_key:"snackbar",ref:m},null,512)],64)}}}),Fb={class:"d-flex align-center"},Eb={key:2,class:"ms-2"},Mb={key:3,class:"ms-2"},Ub={key:1},Pb={class:"d-flex align-center"},Bb={key:0},Lb={key:2},zb={key:0},Ob={key:1},Rb={class:"title-and-toolbar d-flex align-center justify-center text-no-wrap mt-2 mb-4"},qb=Oe({__name:"ExploreDataTableTab",props:{loading:{type:Boolean},countPerPage:{}},emits:["update:countPerPage"],setup(v,{expose:_,emit:n}){const s=v,h=n,{tt:d,formatDateTimeToLongDateTime:y,formatDateTimeToGregorianDefaultDateTime:f,formatAmountToWesternArabicNumeralsWithoutDigitGrouping:b,formatAmountToLocalizedNumeralsWithCurrency:x}=je(),u=ta(),m=Yn(),k=P(1),N=E(()=>u.currentUserDefaultCurrency),V=E(()=>m.filteredTransactions),p=E({get:()=>s.countPerPage,set:W=>h("update:countPerPage",W)}),T=E(()=>{const W=[];for(let D=0;D<p.value;D++)W.push(D);return W}),A=E(()=>{if(!V.value||V.value.length<1)return 1;const W=V.value.length;return Math.ceil(W/p.value)}),w=E(()=>{const W=[];return W.push({key:"time",value:"time",title:d("Transaction Time"),sortable:!0,nowrap:!0}),W.push({key:"type",value:"type",title:d("Type"),sortable:!0,nowrap:!0}),W.push({key:"secondaryCategoryName",value:"secondaryCategoryName",title:d("Category"),sortable:!0,nowrap:!0}),W.push({key:"sourceAmount",value:"sourceAmount",title:d("Amount"),sortable:!0,nowrap:!0}),W.push({key:"sourceAccountName",value:"sourceAccountName",title:d("Account"),sortable:!0,nowrap:!0}),W.push({key:"comment",value:"comment",title:d("Description"),sortable:!0,nowrap:!0}),W});function I(W){const D=go(W.time,W.utcOffset);return y(D)}function F(W){return W.utcOffset===Ln(W.time)}function S(W){return`UTC${Ti(W.utcOffset)}`}function j(W){return W.type===pe.ModifyBalance?d("Modify Balance"):W.type===pe.Income?d("Income"):W.type===pe.Expense?d("Expense"):W.type===pe.Transfer?d("Transfer"):d("Unknown")}function B(W){return W.type===pe.ModifyBalance?"secondary":W.type===pe.Income||W.type===pe.Expense?void 0:W.type===pe.Transfer?"primary":"default"}function U(W){let D=N.value;return W.sourceAccount&&(D=W.sourceAccount.currency),x(W.sourceAmount,D)}function X(W){let D=N.value;return W.destinationAccount&&(D=W.destinationAccount.currency),x(W.destinationAmount,D)}function oe(){if(V.value)return{headers:[d("Transaction Time"),d("Type"),d("Category"),d("Amount"),d("Account"),d("Description")],data:V.value.map(W=>{const D=go(W.time,W.utcOffset),$=j(W);let C=W.secondaryCategoryName,M=b(W.sourceAmount),ee=W.sourceAccountName;W.type===pe.ModifyBalance?C=d("Modify Balance"):W.type===pe.Transfer&&W.sourceAccount?.id!==W.destinationAccount?.id&&U(W)!==X(W)&&(M=M+" → "+b(W.destinationAmount)),W.type===pe.Transfer&&W.destinationAccount&&(ee=ee+" → "+(W.destinationAccount?.name||""));const ye=W.comment||"";return[f(D),$,C,M,ee,ye]})}}return _({buildExportResults:oe}),(W,D)=>{const $=Ve("ItemIcon");return l(),c(Kl,{"fixed-header":"","fixed-footer":"","multi-sort":"","item-value":"index",class:be({"insights-explore-table":!0,"text-sm":!0,disabled:v.loading,"loading-skeleton":v.loading}),headers:w.value,items:V.value,hover:!0,"items-per-page":p.value,"onUpdate:itemsPerPage":D[1]||(D[1]=C=>p.value=C),page:k.value,"onUpdate:page":D[2]||(D[2]=C=>k.value=C)},{"item.time":a(({item:C})=>[o("span",null,i(I(C)),1),F(C)?r("",!0):(l(),c(Jt,{key:0,class:"ms-1",variant:"flat",color:"secondary",size:"x-small"},{default:a(()=>[q(i(S(C)),1)]),_:2},1024))]),"item.type":a(({item:C})=>[t(Jt,{label:"",variant:"outlined",size:"x-small",class:be({"text-income":C.type===e(pe).Income,"text-expense":C.type===e(pe).Expense}),color:B(C)},{default:a(()=>[q(i(j(C)),1)]),_:2},1032,["class","color"])]),"item.secondaryCategoryName":a(({item:C})=>[o("div",Fb,[C.secondaryCategory?.color?(l(),c($,{key:0,size:"24px","icon-type":"category","icon-id":C.secondaryCategory?.icon??"",color:C.secondaryCategory?.color??""},null,8,["icon-id","color"])):!C.secondaryCategory||!C.secondaryCategory?.color?(l(),c(ie,{key:1,size:"24",icon:e(as)},null,8,["icon"])):r("",!0),C.type===e(pe).ModifyBalance?(l(),g("span",Eb,i(e(d)("Modify Balance")),1)):C.type!==e(pe).ModifyBalance&&C.secondaryCategory?(l(),g("span",Mb,i(C.secondaryCategory?.name),1)):r("",!0)])]),"item.sourceAmount":a(({item:C})=>[o("span",{class:be({"text-expense":C.type===e(pe).Expense,"text-income":C.type===e(pe).Income})},i(U(C)),3),C.type===e(pe).Transfer&&C.sourceAccount?.id!==C.destinationAccount?.id&&U(C)!==X(C)?(l(),c(ie,{key:0,class:"icon-with-direction mx-1",size:"13",icon:e(ba)},null,8,["icon"])):r("",!0),C.type===e(pe).Transfer&&C.sourceAccount?.id!==C.destinationAccount?.id&&U(C)!==X(C)?(l(),g("span",Ub,i(X(C)),1)):r("",!0)]),"item.sourceAccountName":a(({item:C})=>[o("div",Pb,[C.sourceAccount?(l(),g("span",Bb,i(C.sourceAccount?.name),1)):r("",!0),C.type===e(pe).Transfer?(l(),c(ie,{key:1,class:"icon-with-direction mx-1",size:"13",icon:e(ba)},null,8,["icon"])):r("",!0),C.type===e(pe).Transfer&&C.destinationAccount?(l(),g("span",Lb,i(C.destinationAccount?.name),1)):r("",!0)])]),"no-data":a(()=>[v.loading&&(!V.value||V.value.length<1)?(l(),g("div",zb,[(l(!0),g(fe,null,$e(T.value,C=>(l(),g("div",{class:"ms-1",style:{"padding-top":"3px","padding-bottom":"3px"},key:C},[t(ft,{type:"text",loading:!0})]))),128))])):(l(),g("div",Ob,i(e(d)("No transaction data")),1))]),bottom:a(()=>[o("div",Rb,[t(jn,{disabled:v.loading,totalPageCount:A.value,modelValue:k.value,"onUpdate:modelValue":D[0]||(D[0]=C=>k.value=C)},null,8,["disabled","totalPageCount","modelValue"])])]),_:1},8,["class","headers","items","items-per-page","page"])}}}),Yb={class:"d-flex overflow-x-auto align-center gap-2 pt-2"},jb={class:"text-truncate"},Hb=Oe({__name:"ExploreChartTab",props:{loading:{type:Boolean}},setup(v,{expose:_}){const n=Na(),{tt:s,getAllTransactionExploreDataDimensions:h,getAllTransactionExploreValueMetrics:d,getAllTransactionExploreChartTypes:y,getMonthLongName:f,getMonthdayShortName:b,getWeekdayLongName:x,getQuarterName:u,formatDateTimeToShortDateTime:m,formatDateTimeToShortDate:k,formatDateTimeToGregorianLikeShortYear:N,formatDateTimeToGregorianLikeShortYearMonth:V,formatDateTimeToGregorianLikeYearQuarter:p,formatDateTimeToGregorianLikeFiscalYear:T,formatAmountToLocalizedNumerals:A,formatAmountToWesternArabicNumeralsWithoutDigitGrouping:w}=je(),I=ta(),F=Yn(),S=E(()=>I.currentUserDefaultCurrency),j=E(()=>h()),B=E(()=>d()),U=E(()=>y()),X=E(()=>F.transactionExploreFilter.categoryDimension),oe=E(()=>F.transactionExploreFilter.seriesDimension),W=E(()=>F.transactionExploreFilter.valueMetric),D=E(()=>F.transactionExploreFilter.chartType),$=E(()=>{if(D.value!==Vl.Pie.value&&D.value!==Vl.Radar.value)return[];if(!F.categoriedTransactionExploreData||!F.categoriedTransactionExploreData.length)return[];const J=[];for(const ae of F.categoriedTransactionExploreData){const Z=ae.data[0];if(!Ht(Z))continue;const le=C(ae);J.push({categoryDisplayName:le,categoryId:ae.categoryId,categoryIdType:ae.categoryIdType,value:Z.value})}return J});function C(J){let ae="",Z=!1,le,z=Aa.None.value;"categoryName"in J?(ae=J.categoryName,Z=J.categoryNameNeedI18n,le=J.categoryNameI18nParameters,z=F.transactionExploreFilter.categoryDimension):"seriesName"in J&&(ae=J.seriesName,Z=J.seriesNameNeedI18n,le=J.seriesNameI18nParameters,z=F.transactionExploreFilter.seriesDimension);let se=ae;if(Z&&le?se=s(ae,le):Z&&!le&&(se=s(ae)),z===Aa.DateTime.value)se=m(Ia(parseInt(ae)));else if(z===Aa.DateTimeByYearMonthDay.value)se=k(Ia(parseInt(ae)));else if(z===Aa.DateTimeByYearMonth.value)se=V(Ia(parseInt(ae)));else if(z===Aa.DateTimeByYearQuarter.value)se=p(Ia(parseInt(ae)));else if(z===Aa.DateTimeByYear.value)se=N(Ia(parseInt(ae)));else if(z===Aa.DateTimeByFiscalYear.value)se=T(Ia(parseInt(ae)));else if(z===Aa.DateTimeByDayOfWeek.value){const ue=Fd.parse(ae);se=ue?x(ue):s("Unknown")}else if(z===Aa.DateTimeByDayOfMonth.value)se=b(parseInt(ae));else if(z===Aa.DateTimeByMonthOfYear.value){const ue=Ed.valueOf(parseInt(ae));se=ue?f(ue.name):s("Unknown")}else z===Aa.DateTimeByQuarterOfYear.value&&(se=u(parseInt(ae)));return(z===Aa.SourceAmount.value||z===Aa.DestinationAmount.value)&&ae!==""&&ae!=="none"&&Number.isFinite(parseInt(ae))&&(se=A(parseInt(ae))),se}function M(J){F.updateTransactionExploreFilter({categoryDimension:J})}function ee(J){F.updateTransactionExploreFilter({seriesDimension:J})}function ye(J){F.updateTransactionExploreFilter({valueMetric:J})}function L(J){F.updateTransactionExploreFilter({chartType:J})}function Y(J){if(!J||!("categoryId"in J)||!("categoryIdType"in J))return;const ae=J,Z=F.getTransactionListPageParams(ae.categoryIdType,ae.categoryId);Z&&n.push(`/transaction/list?${Z}`)}function O(){if(D.value===Vl.Pie.value||D.value===Vl.Radar.value){const J=No.valueOf(F.transactionExploreFilter.valueMetric);return{headers:[s("Name"),s(J?.name??"Unknown")],data:$.value.map(ae=>[ae.categoryDisplayName,J?.isAmount?w(ae.value):ae.value.toString(10)])}}else return}return _({buildExportResults:O}),(J,ae)=>{const Z=Ve("pie-chart"),le=Ve("radar-chart");return l(),g(fe,null,[t(ge,{class:"px-5 py-0 mb-4"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[o("div",Yb,[t(Ge,{class:"flex-0-0","min-width":"150","item-title":"name","item-value":"value",density:"compact",disabled:v.loading,label:e(s)("Chart Type"),items:U.value,"model-value":D.value,"onUpdate:modelValue":ae[0]||(ae[0]=z=>L(z))},null,8,["disabled","label","items","model-value"]),t(Ge,{class:"flex-0-0","min-width":"150","item-title":"name","item-value":"value",density:"compact",disabled:v.loading,label:e(s)("Axis / Category"),items:j.value,"model-value":X.value,"onUpdate:modelValue":ae[1]||(ae[1]=z=>M(z))},null,8,["disabled","label","items","model-value"]),t(Ge,{class:"flex-0-0","min-width":"150","item-title":"name","item-value":"value",density:"compact",disabled:v.loading||!e(Vl).valueOf(D.value)?.seriesDimensionRequired,label:e(s)("Series"),items:j.value,"model-value":e(Vl).valueOf(D.value)?.seriesDimensionRequired?oe.value:e(Aa).None.value,"onUpdate:modelValue":ae[2]||(ae[2]=z=>ee(z))},{item:a(({props:z,item:se})=>[t(ve,_t({disabled:se.value===X.value&&se.value!==e(Aa).SeriesDimensionDefault.value},z),{title:a(()=>[o("div",jb,i(se.raw.name),1)]),_:2},1040,["disabled"])]),_:1},8,["disabled","label","items","model-value"]),t(Ge,{class:"flex-0-0","min-width":"150","item-title":"name","item-value":"value",density:"compact",disabled:v.loading,label:e(s)("Value Metric"),items:B.value,"model-value":W.value,"onUpdate:modelValue":ae[3]||(ae[3]=z=>ye(z))},null,8,["disabled","label","items","model-value"]),t(it,{class:"flex-1-1"})])]),_:1})]),_:1})]),_:1}),D.value===e(Vl).Pie.value?(l(),c(ge,{key:0,class:be({readonly:v.loading})},{default:a(()=>[v.loading?(l(),c(Z,{key:0,items:[{id:"1",name:"---",value:60,color:"7c7c7f"},{id:"2",name:"---",value:20,color:"a5a5aa"},{id:"3",name:"---",value:20,color:"c5c5c9"}],skeleton:!0,"id-field":"id","name-field":"name","value-field":"value","color-field":"color"})):v.loading?r("",!0):(l(),c(Z,{key:1,items:$.value&&$.value.length?$.value:[],"min-valid-percent":1e-4,"show-value":!0,"show-percent":!0,"enable-click-item":!0,"amount-value":e(F).transactionExploreFilter.valueMetric!==e(No).TransactionCount.value,"default-currency":S.value,"id-field":"categoryId","name-field":"categoryDisplayName","value-field":"value",onClick:Y},null,8,["items","amount-value","default-currency"]))]),_:1},8,["class"])):r("",!0),D.value===e(Vl).Radar.value?(l(),c(ge,{key:1,class:be({readonly:v.loading})},{default:a(()=>[v.loading?(l(),c(le,{key:0,items:[{name:"---",value:10},{name:"---",value:10},{name:"---",value:10},{name:"---",value:10},{name:"---",value:10},{name:"---",value:10}],skeleton:!0,"name-field":"name","value-field":"value"})):v.loading?r("",!0):(l(),c(le,{key:1,items:$.value&&$.value.length?$.value:[],"min-valid-percent":1e-4,"show-value":!0,"show-percent":!0,"amount-value":e(F).transactionExploreFilter.valueMetric!==e(No).TransactionCount.value,"default-currency":S.value,"name-field":"categoryDisplayName","value-field":"value"},null,8,["items","amount-value","default-currency"]))]),_:1},8,["class"])):r("",!0)],64)}}}),Wb={class:"mx-6 my-4"},Gb={key:0,class:"mx-6 mt-4"},Kb={class:"text-subtitle-2"},Qb={class:"text-truncate"},Jb={class:"title-and-toolbar d-flex align-center"},Zb={class:"d-flex align-center"},Xb={key:0,class:"statistics-custom-datetime-range smaller"},eT=Oe({__name:"ExplorePage",props:{initId:{},initActiveTab:{},initDateRangeType:{},initStartTime:{},initEndTime:{}},setup(v){const _=v,n=Na(),s=Rl(),{tt:h,getAllDateRanges:d,getCurrentNumeralSystemType:y,formatDateTimeToLongDateTime:f,formatDateRange:b}=je(),x=ta(),u=pa(),m=va(),k=rl(),N=Yn(),V=xe("snackbar"),p=xe("exploreDataTableTab"),T=xe("exploreChartTab"),A=xe("exportDialog"),w=P(!0),I=P(!0),F=P(s.mdAndUp.value),S=P(s.mdAndUp.value),j=P("query"),B=P(""),U=P(15),X=P(!1),oe=E(()=>x.currentUserFirstDayOfWeek),W=E(()=>x.currentUserFiscalYearStart),D=E(()=>y()),$=E(()=>N.transactionExploreFilter),C=E(()=>N.filteredTransactions),M=E(()=>d(ma.InsightsExplore,!0)),ee=E(()=>$.value.dateRangeType!==Lt.All.type),ye=E(()=>b($.value.dateRangeType,$.value.startTime,$.value.endTime)),L=E(()=>f(Ia($.value.startTime))),Y=E(()=>f(Ia($.value.endTime))),O=E(()=>[{name:h("Query"),value:"query"},{name:h("Data Table"),value:"table"},{name:h("Chart"),value:"chart"}]),J=E(()=>{const te=[],Se=[5,10,15,20,25,30,50];for(const Te of Se)te.push({value:Te,name:D.value.formatNumber(Te)});return te.push({value:-1,name:h("All")}),te});function ae(){return`/insights/explore?${N.getTransactionExplorePageParams(B.value,j.value)}`}function Z(te){const Se={dateRangeType:te.initDateRangeType?parseInt(te.initDateRangeType):void 0,startTime:te.initStartTime?parseInt(te.initStartTime):void 0,endTime:te.initEndTime?parseInt(te.initEndTime):void 0};let Te=!1;if((Se.dateRangeType!==$.value.dateRangeType||Se.dateRangeType===Lt.Custom.type&&(Se.startTime!==$.value.startTime||Se.endTime!==$.value.endTime))&&(Te=!0),te.initActiveTab==="query"||te.initActiveTab==="table"||te.initActiveTab==="chart"?te.initActiveTab!==j.value&&(j.value=te.initActiveTab,Te=!0):j.value="query",N.initTransactionExploreFilter(Se),!Te&&!N.transactionExploreStateInvalid){w.value=!1,I.value=!1;return}Promise.all([u.loadAllAccounts({force:!1}),m.loadAllCategories({force:!1}),k.loadAllTags({force:!1})]).then(()=>N.loadAllTransactions({force:!1})).then(()=>{w.value=!1,I.value=!1}).catch(Ye=>{w.value=!1,I.value=!1,Ye.processed||V.value?.showError(Ye)})}function le(te){return w.value=!0,N.loadAllTransactions({force:te}).then(()=>{w.value=!1,te&&V.value?.showMessage("Data has been updated")}).catch(Se=>{w.value=!1,Se.processed||V.value?.showError(Se)})}function z(){if(j.value==="table"&&C.value){const te=p.value?.buildExportResults();te&&A.value?.open(te)}else if(j.value==="chart"){const te=T.value?.buildExportResults();te&&A.value?.open(te)}}function se(te){if(te===Lt.Custom.type){X.value=!0;return}else if($.value.dateRangeType===te)return;const Se=zn(te,oe.value,W.value);if(!Se)return;N.updateTransactionExploreFilter({dateRangeType:Se.dateType,startTime:Se.minTime,endTime:Se.maxTime})&&(w.value=!0,N.updateTransactionExploreInvalidState(!0),n.push(ae()))}function ue(te,Se){if(!te||!Se)return;const Te=Bl(te,Se,oe.value,W.value,ma.InsightsExplore),Ye=N.updateTransactionExploreFilter({dateRangeType:Te,startTime:te,endTime:Se});X.value=!1,Ye&&(w.value=!0,N.updateTransactionExploreInvalidState(!0),n.push(ae()))}function Ee(te){if($.value.dateRangeType===Lt.All.type)return;const Se=Nn($.value.startTime,$.value.endTime,te,oe.value,W.value,ma.Normal);N.updateTransactionExploreFilter({dateRangeType:Se.dateType,startTime:Se.minTime,endTime:Se.maxTime})&&(w.value=!0,N.updateTransactionExploreInvalidState(!0),n.push(ae()))}function me(te){V.value?.showError(te)}return Rn(te=>{te.query?Z({initId:te.query.id||void 0,initActiveTab:te.query.activeTab||void 0,initDateRangeType:te.query.dateRangeType||void 0,initStartTime:te.query.startTime||void 0,initEndTime:te.query.endTime||void 0}):Z({})}),Ft(()=>s.mdAndUp.value,te=>{F.value=te,S.value||(S.value=te)}),Ft(j,()=>{n.push(ae())}),Z(_),(te,Se)=>{const Te=Ve("btn-vertical-group"),Ye=Ve("date-range-selection-dialog");return l(),g(fe,null,[t(Ae,{class:"match-height"},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,null,{default:a(()=>[t(Jl,null,{default:a(()=>[t(Zl,{permanent:F.value,modelValue:S.value,"onUpdate:modelValue":Se[3]||(Se[3]=He=>S.value=He)},{default:a(()=>[o("div",Wb,[t(Te,{disabled:w.value,buttons:O.value,modelValue:j.value,"onUpdate:modelValue":Se[0]||(Se[0]=He=>j.value=He)},null,8,["disabled","buttons","modelValue"])]),t(nt),j.value==="table"?(l(),g("div",Gb,[o("span",Kb,i(e(h)("Transactions Per Page")),1),t(Ge,{class:"mt-2",density:"compact","item-title":"name","item-value":"value",disabled:w.value,items:J.value,modelValue:U.value,"onUpdate:modelValue":Se[1]||(Se[1]=He=>U.value=He)},null,8,["disabled","items","modelValue"])])):r("",!0),t(Ja,{"show-arrows":"",class:"my-4",direction:"vertical",disabled:w.value,modelValue:B.value,"onUpdate:modelValue":Se[2]||(Se[2]=He=>B.value=He)},{default:a(()=>[t(Wt,{class:"tab-text-truncate",key:"new",value:""},{default:a(()=>[o("span",Qb,i(e(h)("New Explore")),1)]),_:1})]),_:1},8,["disabled","modelValue"])]),_:1},8,["permanent","modelValue"]),t(Xl,null,{default:a(()=>[t(Me,{variant:"flat","min-height":"800"},{title:a(()=>[o("div",Jb,[t(H,{class:"me-3 d-md-none",density:"compact",color:"default",variant:"plain",ripple:!1,icon:!0,onClick:Se[4]||(Se[4]=He=>S.value=!S.value)},{default:a(()=>[t(ie,{icon:e(ql),size:"24"},null,8,["icon"])]),_:1}),o("span",null,i(e(h)("Insights & Explore")),1),t(Gl,{class:"ms-4",color:"default",density:"comfortable",variant:"outlined",divided:""},{default:a(()=>[t(H,{class:"button-icon-with-direction",icon:e(On),disabled:w.value||!ee.value,onClick:Se[5]||(Se[5]=He=>Ee(-1))},null,8,["icon","disabled"]),t(mt,{location:"bottom","max-height":"500"},{activator:a(({props:He})=>[t(H,_t({disabled:w.value},He),{default:a(()=>[q(i(ye.value),1)]),_:1},16,["disabled"])]),default:a(()=>[t(Je,{selected:[$.value.dateRangeType]},{default:a(()=>[(l(!0),g(fe,null,$e(M.value,He=>(l(),c(ve,{key:He.type,value:He.type,"append-icon":$.value.dateRangeType===He.type?e(Xe):void 0},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:It=>se(He.type)},{default:a(()=>[o("div",Zb,[o("span",null,i(He.displayName),1)]),He.isUserCustomRange&&$.value.dateRangeType===He.type&&$.value.startTime&&$.value.endTime?(l(),g("div",Xb,[o("span",null,i(L.value),1),Se[11]||(Se[11]=o("span",null," - ",-1)),Se[12]||(Se[12]=o("br",null,null,-1)),o("span",null,i(Y.value),1)])):r("",!0)]),_:2},1032,["onClick"])]),_:2},1032,["value","append-icon"]))),128))]),_:1},8,["selected"])]),_:1}),t(H,{class:"button-icon-with-direction",icon:e(ba),disabled:w.value||!ee.value,onClick:Se[6]||(Se[6]=He=>Ee(1))},null,8,["icon","disabled"])]),_:1}),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,loading:w.value,onClick:Se[7]||(Se[7]=He=>le(!0))},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(h)("Refresh")),1)]),_:1})]),_:1},8,["loading"]),t(it),j.value==="table"||j.value==="chart"?(l(),c(H,{key:0,density:"comfortable",color:"default",variant:"text",class:"ms-2",disabled:w.value,icon:!0},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{"prepend-icon":e(li),title:e(h)("Export Results"),disabled:w.value||!C.value||C.value.length<1,onClick:z},null,8,["prepend-icon","title","disabled"])]),_:1})]),_:1})]),_:1},8,["disabled"])):r("",!0)])]),default:a(()=>[t(qa,{class:"d-flex flex-grow-1 disable-tab-transition w-100-window-container",modelValue:j.value,"onUpdate:modelValue":Se[9]||(Se[9]=He=>j.value=He)},{default:a(()=>[t(zt,{value:"query"},{default:a(()=>[t(Nb,{loading:w.value},null,8,["loading"])]),_:1}),t(zt,{value:"table"},{default:a(()=>[t(qb,{ref_key:"exploreDataTableTab",ref:p,loading:w.value,"count-per-page":U.value,"onUpdate:countPerPage":Se[8]||(Se[8]=He=>U.value=He)},null,8,["loading","count-per-page"])]),_:1}),t(zt,{value:"chart"},{default:a(()=>[t(Hb,{ref_key:"exploreChartTab",ref:T,loading:w.value},null,8,["loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(Ye,{title:e(h)("Custom Date Range"),"min-time":$.value.startTime,"max-time":$.value.endTime,show:X.value,"onUpdate:show":Se[10]||(Se[10]=He=>X.value=He),"onDateRange:change":ue,onError:me},null,8,["title","min-time","max-time","show"]),t(Vi,{ref_key:"exportDialog",ref:A},null,512),t(ct,{ref_key:"snackbar",ref:V},null,512)],64)}}}),tT={class:"d-flex align-center justify-center"},aT={class:"d-flex align-center"},lT={class:"text-h4"},nT={key:0,class:"mb-4"},oT={class:"d-flex align-center"},sT={class:"ms-2"},iT={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},rT=Oe({__name:"EditDialog",setup(v,{expose:_}){const{tt:n}=je(),{editAccountId:s,clientSessionId:h,loading:d,submitting:y,account:f,subAccounts:b,title:x,saveButtonTitle:u,inputEmptyProblemMessage:m,inputIsEmpty:k,allAccountCategories:N,allAccountTypes:V,allAvailableMonthDays:p,isAccountSupportCreditCardStatementDate:T,getCurrentUnixTimeForNewAccount:A,getDefaultTimezoneOffsetMinutes:w,updateAccountBalanceTime:I,isNewAccount:F,addSubAccount:S,setAccount:j}=Md(),B=ta(),U=pa(),X=xe("confirmDialog"),oe=xe("snackbar"),W=P(!1),D=P("account"),$=P(-1),C=E(()=>$.value<0?f.value:b.value[$.value]),M=E(()=>$.value<0?f.value.isLiability?n("Account Outstanding Balance"):n("Account Balance"):f.value.isLiability?n("Sub-account Outstanding Balance"):n("Sub-account Balance")),ee=E(()=>s.value?!0:!f.value.equals(Dl.createNewAccount(B.currentUserDefaultCurrency,f.value.balanceTime??A())));let ye=null,L=null;function Y(le){W.value=!0,d.value=!0,y.value=!1;const z=Dl.createNewAccount(B.currentUserDefaultCurrency,A());return f.value.fillFrom(z),b.value=[],$.value=-1,h.value=_l(),le&&le.id?(le.currentAccount&&j(le.currentAccount),s.value=le.id,U.getAccount({accountId:s.value}).then(se=>{j(se),d.value=!1}).catch(se=>{d.value=!1,W.value=!1,se.processed||L&&L(se)})):(le&&Zt(le.category)&&(f.value.category=le.category,f.value.setSuitableIcon(1,le.category)),s.value=null,d.value=!1),new Promise((se,ue)=>{ye=se,L=ue})}function O(){const le=m.value;if(le){oe.value?.showMessage(le);return}y.value=!0,U.saveAccount({account:f.value,subAccounts:b.value,isEdit:!!s.value,clientSessionId:h.value}).then(()=>{y.value=!1;let z="You have saved this account";s.value||(z="You have added a new account"),ye?.({message:z}),W.value=!1}).catch(z=>{y.value=!1,z.processed||oe.value?.showError(z)})}function J(le){X.value?.open("Are you sure you want to remove this sub-account?").then(()=>{for(const[z,se]of Ra(b.value))z===le&&(b.value.splice(se,1),$.value>=b.value.length&&($.value=b.value.length-1))})}function ae(){L?.(),W.value=!1}function Z(le){oe.value?.showError(le)}return Ft(()=>f.value.type,()=>{b.value.length<1&&S()}),_({open:Y}),(le,z)=>{const se=Ve("ItemIcon"),ue=Ve("icon-select"),Ee=Ve("color-select"),me=Ve("currency-select"),te=Ve("amount-input"),Se=Ve("date-time-select");return l(),g(fe,null,[t(xt,{width:e(f).type===e(oa).MultiSubAccounts.type?1e3:800,persistent:ee.value,modelValue:W.value,"onUpdate:modelValue":z[13]||(z[13]=Te=>W.value=Te)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",tT,[o("div",aT,[o("h4",lT,i(e(n)(e(x))),1),e(d)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),t(it),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",icon:!0,disabled:e(d)||e(y)||e(f).type!==e(oa).MultiSubAccounts.type},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{"prepend-icon":e(Ar),title:e(n)("Add Sub-account"),onClick:e(S)},null,8,["prepend-icon","title","onClick"])]),_:1})]),_:1})]),_:1},8,["disabled"])])]),default:a(()=>[t(ge,{class:"d-flex flex-column flex-md-row flex-grow-1 overflow-y-auto"},{default:a(()=>[e(f).type===e(oa).MultiSubAccounts.type?(l(),g("div",nT,[t(Ja,{direction:"vertical",disabled:e(d)||e(y),modelValue:$.value,"onUpdate:modelValue":z[0]||(z[0]=Te=>$.value=Te)},{default:a(()=>[t(Wt,{value:-1},{default:a(()=>[o("span",null,i(e(n)("Main Account")),1)]),_:1}),e(f).type===e(oa).MultiSubAccounts.type?(l(!0),g(fe,{key:0},$e(e(b),(Te,Ye)=>(l(),c(Wt,{key:Ye,value:Ye},{default:a(()=>[o("span",null,i(e(n)("Sub Account")+" #"+(Ye+1)),1),t(H,{class:"ms-2",color:"error",size:"24",variant:"text",icon:e(bn),onClick:He=>J(Te)},null,8,["icon","onClick"])]),_:2},1032,["value"]))),128)):r("",!0)]),_:1},8,["disabled","modelValue"])])):r("",!0),t(qa,{class:be(["d-flex flex-grow-1 disable-tab-transition w-100-window-container",{"ms-md-5":e(f).type===e(oa).MultiSubAccounts.type}]),modelValue:D.value,"onUpdate:modelValue":z[12]||(z[12]=Te=>D.value=Te)},{default:a(()=>[t(zt,{value:"account"},{default:a(()=>[t(jt,{class:"mt-2"},{default:a(()=>[t(Ae,null,{default:a(()=>[e(f).type===e(oa).SingleAccount.type||$.value<0?(l(),c(R,{key:0,cols:"12",md:"12"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(y),label:e(n)("Account Category"),placeholder:e(n)("Account Category"),items:e(N),"no-data-text":e(n)("No results"),modelValue:C.value.category,"onUpdate:modelValue":z[1]||(z[1]=Te=>C.value.category=Te)},{item:a(({props:Te,item:Ye})=>[t(ve,_t({value:Ye.value},Te),{title:a(()=>[t(rt,null,{default:a(()=>[o("div",oT,[Ye.raw?(l(),c(se,{key:0,"icon-type":"account","icon-id":Ye.raw.defaultAccountIconId},null,8,["icon-id"])):r("",!0),o("span",sT,i(Ye.title),1)])]),_:2},1024)]),_:2},1040,["value"])]),_:1},8,["disabled","label","placeholder","items","no-data-text","modelValue"])]),_:1})):r("",!0),e(f).type===e(oa).SingleAccount.type||$.value<0?(l(),c(R,{key:1,cols:"12",md:"12"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(y)||!!e(s),label:e(n)("Account Type"),placeholder:e(n)("Account Type"),items:e(V),"no-data-text":e(n)("No results"),modelValue:C.value.type,"onUpdate:modelValue":z[2]||(z[2]=Te=>C.value.type=Te)},null,8,["disabled","label","placeholder","items","no-data-text","modelValue"])]),_:1})):r("",!0),t(R,{cols:"12",md:"12"},{default:a(()=>[t(ot,{type:"text","persistent-placeholder":"",disabled:e(d)||e(y),label:$.value<0?e(n)("Account Name"):e(n)("Sub-account Name"),placeholder:$.value<0?e(n)("Your account name"):e(n)("Your sub-account name"),modelValue:C.value.name,"onUpdate:modelValue":z[3]||(z[3]=Te=>C.value.name=Te)},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(ue,{"icon-type":"account","all-icon-infos":e(Ud),label:$.value<0?e(n)("Account Icon"):e(n)("Sub-account Icon"),color:C.value.color,disabled:e(d)||e(y),modelValue:C.value.icon,"onUpdate:modelValue":z[4]||(z[4]=Te=>C.value.icon=Te)},null,8,["all-icon-infos","label","color","disabled","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ee,{"all-color-infos":e(Pd),label:$.value<0?e(n)("Account Color"):e(n)("Sub-account Color"),disabled:e(d)||e(y),modelValue:C.value.color,"onUpdate:modelValue":z[5]||(z[5]=Te=>C.value.color=Te)},null,8,["all-color-infos","label","disabled","modelValue"])]),_:1}),e(f).type===e(oa).SingleAccount.type||$.value>=0?(l(),c(R,{key:2,cols:"12",md:$.value<0&&e(T)?6:12},{default:a(()=>[t(me,{disabled:e(d)||e(y)||!!e(s)&&!e(F)(C.value),label:e(n)("Currency"),placeholder:e(n)("Currency"),modelValue:C.value.currency,"onUpdate:modelValue":z[6]||(z[6]=Te=>C.value.currency=Te)},null,8,["disabled","label","placeholder","modelValue"])]),_:1},8,["md"])):r("",!0),$.value<0&&e(T)?(l(),c(R,{key:3,cols:"12",md:e(f).type===e(oa).SingleAccount.type||$.value>=0?6:12},{default:a(()=>[t(ua,{"item-title":"displayName","item-value":"day","auto-select-first":"","persistent-placeholder":"",disabled:e(d)||e(y),label:e(n)("Statement Date"),placeholder:e(n)("Statement Date"),items:e(p),"no-data-text":e(n)("No results"),modelValue:e(f).creditCardStatementDate,"onUpdate:modelValue":z[7]||(z[7]=Te=>e(f).creditCardStatementDate=Te)},null,8,["disabled","label","placeholder","items","no-data-text","modelValue"])]),_:1},8,["md"])):r("",!0),e(f).type===e(oa).SingleAccount.type||$.value>=0?(l(),c(R,{key:4,cols:"12",md:(!e(s)||e(F)(C.value))&&C.value.balance?6:12},{default:a(()=>[t(te,{disabled:e(d)||e(y)||!!e(s)&&!e(F)(C.value),"persistent-placeholder":!0,currency:C.value.currency,"show-currency":!0,"flip-negative":e(f).isLiability,label:M.value,placeholder:M.value,modelValue:C.value.balance,"onUpdate:modelValue":z[8]||(z[8]=Te=>C.value.balance=Te)},null,8,["disabled","currency","flip-negative","label","placeholder","modelValue"])]),_:1},8,["md"])):r("",!0),(!e(s)||e(F)(C.value))&&(e(f).type===e(oa).SingleAccount.type||$.value>=0)?za((l(),c(R,{key:5,cols:"12",md:"6"},{default:a(()=>[t(Se,{disabled:e(d)||e(y),label:e(n)("Balance Time"),"timezone-utc-offset":e(w)(C.value),"model-value":C.value.balanceTime,"onUpdate:modelValue":z[9]||(z[9]=Te=>e(I)(C.value,Te)),onError:Z},null,8,["disabled","label","timezone-utc-offset","model-value"])]),_:1},512)),[[Ka,C.value.balance]]):r("",!0),t(R,{cols:"12",md:"12"},{default:a(()=>[t(Oa,{type:"text","persistent-placeholder":"",rows:"3",disabled:e(d)||e(y),label:e(n)("Description"),placeholder:$.value<0?e(n)("Your account description (optional)"):e(n)("Your sub-account description (optional)"),modelValue:C.value.comment,"onUpdate:modelValue":z[10]||(z[10]=Te=>C.value.comment=Te)},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),e(s)&&!e(F)(C.value)?(l(),c(R,{key:6,class:"py-0",cols:"12",md:"12"},{default:a(()=>[t(Ea,{disabled:e(d)||e(y),label:e(n)("Visible"),modelValue:C.value.visible,"onUpdate:modelValue":z[11]||(z[11]=Te=>C.value.visible=Te)},null,8,["disabled","label","modelValue"])]),_:1})):r("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["class","modelValue"])]),_:1}),t(ge,null,{default:a(()=>[o("div",iT,[t(vt,{disabled:!e(k),text:e(m)?e(n)(e(m)):""},{activator:a(({props:Te})=>[o("div",_t(Te,{class:"d-inline-block"}),[t(H,{disabled:e(k)||e(d)||e(y),onClick:O},{default:a(()=>[q(i(e(n)(e(u)))+" ",1),e(y)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])],16)]),_:1},8,["disabled","text"]),t(H,{color:"secondary",variant:"tonal",disabled:e(d)||e(y),onClick:ae},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["width","persistent","modelValue"]),t(ka,{ref_key:"confirmDialog",ref:X},null,512),t(ct,{ref_key:"snackbar",ref:oe},null,512)],64)}}}),Ii=Oe({__name:"AmountInputDialog",emits:["update:show"],setup(v,{expose:_,emit:n}){const s=n,{tt:h}=je(),d=P(!1),y=P(void 0),f=P(0);let b=null,x=null;const u=E(()=>y.value?.title?h(y.value.title):h("global.app.title")),m=E(()=>y.value?.text?h(y.value.text,y.value.textI18nOptions??{}):""),k=E(()=>y.value?.inputLabel?h(y.value.inputLabel):void 0),N=E(()=>y.value?.inputPlaceholder?h(y.value.inputPlaceholder):void 0),V=E(()=>y.value?.color||"primary");function p(w){return d.value=!0,y.value=w,f.value=w.initAmount??0,new Promise((I,F)=>{b=I,x=F})}function T(){b&&b(f.value),d.value=!1,s("update:show",!1)}function A(){x&&x(),d.value=!1,s("update:show",!1)}return Ft(d,w=>{s("update:show",w)}),_({open:p}),(w,I)=>{const F=Ve("amount-input");return l(),c(xt,{persistent:"","min-width":"320",width:"auto",modelValue:d.value,"onUpdate:modelValue":I[1]||(I[1]=S=>d.value=S)},{default:a(()=>[t(Me,null,{default:a(()=>[t(Xo,{color:V.value},{default:a(()=>[t(Ks,null,{default:a(()=>[q(i(u.value),1)]),_:1})]),_:1},8,["color"]),m.value?(l(),c(ge,{key:0,class:"pa-4 pb-6"},{default:a(()=>[q(i(m.value),1)]),_:1})):r("",!0),t(ge,null,{default:a(()=>[t(jt,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(F,{"persistent-placeholder":!0,currency:y.value?.currency,"show-currency":!!y.value?.currency,label:k.value,placeholder:N.value,modelValue:f.value,"onUpdate:modelValue":I[0]||(I[0]=S=>f.value=S)},null,8,["currency","show-currency","label","placeholder","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(Un,{class:"px-4 pb-4"},{default:a(()=>[t(it),t(H,{color:"gray",onClick:A},{default:a(()=>[q(i(e(h)("Cancel")),1)]),_:1}),t(H,{color:V.value,onClick:T},{default:a(()=>[q(i(e(h)("OK")),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),uT={class:"d-flex align-center justify-center"},dT={class:"d-flex flex-wrap w-100 align-center"},cT={class:"text-h4"},mT={key:0,class:"text-body-1 text-wrap mt-2"},pT={key:1,class:"text-body-1 text-wrap mt-2"},vT={class:"d-flex align-center mb-4"},fT={class:"d-flex align-center text-body-1"},yT={key:0,class:"text-primary"},gT={key:1,class:"text-primary ms-2"},hT={class:"ms-3"},bT={key:2,class:"text-primary"},TT={key:3,class:"text-primary ms-2"},kT={class:"d-flex align-center text-body-1"},_T={class:"ms-2"},xT={key:0,class:"text-income"},CT={key:1,class:"text-income ms-2"},wT={class:"ms-3"},AT={key:2,class:"text-expense"},ST={key:3,class:"text-expense ms-2"},VT={class:"ms-3"},IT={key:4,class:"text-primary"},DT={key:5,class:"text-primary ms-2"},$T={class:"d-flex align-center"},NT={key:2,class:"ms-2"},FT={key:3,class:"ms-2"},ET={key:1},MT={class:"d-flex align-center"},UT={key:0},PT={key:2},BT={key:0,class:"title-and-toolbar d-flex align-center text-no-wrap mt-2"},LT={class:"ms-2"},zT={key:0},OT={key:1,class:"ms-2"},RT={key:2},qT={class:"d-flex"},YT={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},jT=Oe({__name:"ReconciliationStatementDialog",emits:["error"],setup(v,{expose:_,emit:n}){const s=n,{tt:h,getCurrentNumeralSystemType:d,formatNumberToLocalizedNumerals:y}=je(),{accountId:f,startTime:b,endTime:x,reconciliationStatements:u,fiscalYearStart:m,allChartTypes:k,allDateAggregationTypes:N,currentAccount:V,currentAccountCurrency:p,isCurrentLiabilityAccount:T,exportFileName:A,displayStartDateTime:w,displayEndDateTime:I,displayTotalInflows:F,displayTotalOutflows:S,displayTotalBalance:j,displayOpeningBalance:B,displayClosingBalance:U,setReconciliationStatements:X,getDisplayTransactionType:oe,getDisplayDateTime:W,isSameAsDefaultTimezoneOffsetMinutes:D,getDisplayTimezone:$,getDisplaySourceAmount:C,getDisplayDestinationAmount:M,getDisplayAccountBalance:ee,getExportedData:ye}=Bd(),L=pa(),Y=va(),O=en(),J={[pl.Column.type]:Ir,[pl.Area.type]:Vr,[pl.Candlestick.type]:Sr},ae={[Yt.Day.type]:Qs,[Yt.Month.type]:Js,[Yt.Quarter.type]:uo,[Yt.Year.type]:uo,[Yt.FiscalYear.type]:uo},Z=xe("amountInputDialog"),le=xe("snackbar"),z=xe("editDialog"),se=P(!1),ue=P(!1),Ee=P(1),me=P(10),te=P(!1),Se=P(pl.Default.type),Te=P(Yt.Day.type);let Ye=null;const He=E(()=>d()),It=E(()=>ke(u.value?.transactions.length)),la=E(()=>{if(!u.value||!u.value.transactions||u.value.transactions.length<1)return 1;const De=u.value.transactions.length;return Math.ceil(De/me.value)}),Ot=E(()=>{if(!(me.value<=10||!u.value?.transactions||u.value?.transactions?.length<=10))return 380}),ze=E(()=>{const De=[],Ue=T.value?"Account Outstanding Balance":"Account Balance";return De.push({key:"time",value:"time",title:h("Transaction Time"),sortable:!0,nowrap:!0}),De.push({key:"type",value:"type",title:h("Type"),sortable:!0,nowrap:!0}),De.push({key:"categoryName",value:"categoryName",title:h("Category"),sortable:!0,nowrap:!0}),De.push({key:"sourceAmount",value:"sourceAmount",title:h("Amount"),sortable:!0,nowrap:!0}),De.push({key:"sourceAccountName",value:"sourceAccountName",title:h("Account"),sortable:!0,nowrap:!0}),De.push({key:"accountBalance",value:"accountBalance",title:h(Ue),sortable:!0,nowrap:!0}),De.push({key:"comment",value:"comment",title:h("Description"),sortable:!0,nowrap:!0}),De.push({key:"operation",title:h("Operation"),sortable:!1,nowrap:!0,align:"center"}),De});function ke(De){const Ue=[];if(!De||De<1)return Ue.push({value:-1,name:h("All")}),Ue;const Pe=[5,10,15,20,25,30,50];for(const ut of Pe){if(De<ut)break;Ue.push({value:ut,name:He.value.formatNumber(ut)})}return Ue.push({value:-1,name:h("All")}),Ue}function Ie(De){return De.type===pe.ModifyBalance?"secondary":De.type===pe.Income||De.type===pe.Expense?void 0:De.type===pe.Transfer?"primary":"default"}function Et(De){return f.value=De.accountId,b.value=De.startTime,x.value=De.endTime,u.value=void 0,Ee.value=1,me.value=10,te.value=!1,Se.value=pl.Default.type,Te.value=Yt.Day.type,se.value=!0,ue.value=!0,Promise.all([L.loadAllAccounts({force:!1}),Y.loadAllCategories({force:!1})]).then(()=>O.getReconciliationStatements({accountId:De.accountId,startTime:De.startTime,endTime:De.endTime})).then(Ue=>{X(Ue),ue.value=!1}).catch(Ue=>{ue.value=!1,Ue.processed||(s("error",Ue),se.value=!1)}),new Promise((Ue,Pe)=>{Ye=Pe})}function yt(De){ue.value=!0,O.getReconciliationStatements({accountId:f.value,startTime:b.value,endTime:x.value}).then(Ue=>{De&&(bo(u.value,Ue)?le.value?.showMessage("Data is up to date"):le.value?.showMessage("Data has been updated")),X(Ue),ue.value=!1}).catch(Ue=>{ue.value=!1,Ue.processed||le.value?.showError(Ue)})}function Ne(){z.value?.open({accountId:f.value}).then(De=>{De&&De.message&&le.value?.showMessage(De.message),yt(!1)}).catch(De=>{De&&le.value?.showError(De)})}function kt(){let De=u.value?.closingBalance??0;T.value&&(De=-De),Z.value?.open({text:"Please enter the new closing balance for the account",inputLabel:"Closing Balance",inputPlaceholder:"Closing Balance",currency:p.value,initAmount:De}).then(Ue=>{if(!Ue)return;const Pe=Bn();let ut;x.value>0&&x.value<Pe?ut=x.value:Pe<b.value&&(ut=b.value);let we=T.value?pe.Expense:pe.Income,Dt=Ue-De;Dt<0&&(we=T.value?pe.Income:pe.Expense,Dt=-Dt),z.value?.open({time:ut,type:we,amount:Dt,accountId:f.value,noTransactionDraft:!0}).then(bt=>{bt&&bt.message&&le.value?.showMessage(bt.message),yt(!1)}).catch(bt=>{bt&&le.value?.showError(bt)})})}function Be(De){if(!u.value||!u.value.transactions||u.value.transactions.length<1)return;const Ue=ye(De);tn(De.formatFileName(A.value),De.createBlob(Ue))}function Ke(De){De.type!==pe.ModifyBalance&&z.value?.open({id:De.id,currentTransaction:qo.of(De)}).then(Ue=>{Ue&&Ue.message&&le.value?.showMessage(Ue.message),yt(!1)}).catch(Ue=>{Ue&&le.value?.showError(Ue)})}function Fe(){Ye?.(),se.value=!1}return _({open:Et}),(De,Ue)=>{const Pe=Ve("ItemIcon"),ut=Ve("account-balance-trends-chart");return l(),g(fe,null,[t(xt,{persistent:ue.value,modelValue:se.value,"onUpdate:modelValue":Ue[11]||(Ue[11]=we=>se.value=we)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",uT,[o("div",dT,[o("h4",cT,i(e(h)("Reconciliation Statement")),1),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,loading:ue.value,onClick:Ue[0]||(Ue[0]=we=>yt(!0))},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(h)("Refresh")),1)]),_:1})]),_:1},8,["loading"]),t(Ea,{class:"bidirectional-switch ms-2 pt-1",color:"secondary",disabled:ue.value,label:e(h)("Account Balance Trends"),modelValue:te.value,"onUpdate:modelValue":Ue[1]||(Ue[1]=we=>te.value=we),onClick:Ue[2]||(Ue[2]=we=>te.value=!te.value)},{prepend:a(()=>[o("span",null,i(e(h)("Transaction List")),1)]),_:1},8,["disabled","label","modelValue"])]),te.value?(l(),c(H,{key:0,density:"comfortable",color:"default",variant:"text",class:"ms-2",icon:!0,disabled:ue.value},{default:a(()=>[t(ie,{icon:e(Dr)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(Pn,{title:e(h)("Chart Type")},null,8,["title"]),(l(!0),g(fe,null,$e(e(k),we=>(l(),c(ve,{key:we.type,"prepend-icon":J[we.type],"append-icon":Se.value===we.type?e(Xe):void 0,title:we.displayName,onClick:Dt=>Se.value=we.type},null,8,["prepend-icon","append-icon","title","onClick"]))),128)),t(nt,{class:"my-2"}),t(Pn,{title:e(h)("Time Granularity")},null,8,["title"]),(l(!0),g(fe,null,$e(e(N),we=>(l(),c(ve,{key:we.type,"prepend-icon":ae[we.type],"append-icon":Te.value===we.type?e(Xe):void 0,title:we.displayName,onClick:Dt=>Te.value=we.type},null,8,["prepend-icon","append-icon","title","onClick"]))),128))]),_:1})]),_:1})]),_:1},8,["disabled"])):r("",!0),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",icon:!0,disabled:ue.value},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{"prepend-icon":e($r),title:e(h)("Add Transaction"),onClick:Ue[3]||(Ue[3]=we=>Ne())},null,8,["prepend-icon","title"]),t(ve,{"prepend-icon":e(Nr),title:e(h)("Update Closing Balance"),onClick:Ue[4]||(Ue[4]=we=>kt())},null,8,["prepend-icon","title"]),t(nt,{class:"my-2"}),t(ve,{"prepend-icon":e(ti),disabled:!e(u)||!e(u).transactions||e(u).transactions.length<1,onClick:Ue[5]||(Ue[5]=we=>Be(e(Bt).CSV))},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(h)("Export to CSV (Comma-separated values) File")),1)]),_:1})]),_:1},8,["prepend-icon","disabled"]),t(ve,{"prepend-icon":e(ai),disabled:!e(u)||!e(u).transactions||e(u).transactions.length<1,onClick:Ue[6]||(Ue[6]=we=>Be(e(Bt).TSV))},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(h)("Export to TSV (Tab-separated values) File")),1)]),_:1})]),_:1},8,["prepend-icon","disabled"])]),_:1})]),_:1})]),_:1},8,["disabled"])])]),subtitle:a(()=>[!e(b)&&!e(x)?(l(),g("div",mT,[o("span",null,i(e(h)("All")),1)])):r("",!0),e(b)||e(x)?(l(),g("div",pT,[o("span",null,i(e(w)),1),Ue[12]||(Ue[12]=o("span",null," - ",-1)),o("span",null,i(e(I)),1)])):r("",!0)]),default:a(()=>[t(ge,null,{default:a(()=>[o("div",vT,[o("div",fT,[o("span",null,i(e(h)("Opening Balance")),1),ue.value?(l(),g("span",yT,[t(ft,{class:"skeleton-no-margin ms-3",type:"text",style:{width:"80px"},loading:!0})])):ue.value?r("",!0):(l(),g("span",gT,i(e(B)),1)),o("span",hT,i(e(h)("Closing Balance")),1),ue.value?(l(),g("span",bT,[t(ft,{class:"skeleton-no-margin ms-3",type:"text",style:{width:"80px"},loading:!0})])):ue.value?r("",!0):(l(),g("span",TT,i(e(U)),1))]),t(it),o("div",kT,[o("span",_T,i(e(h)("Total Inflows")),1),ue.value?(l(),g("span",xT,[t(ft,{class:"skeleton-no-margin ms-3",type:"text",style:{width:"80px"},loading:!0})])):ue.value?r("",!0):(l(),g("span",CT,i(e(F)),1)),o("span",wT,i(e(h)("Total Outflows")),1),ue.value?(l(),g("span",AT,[t(ft,{class:"skeleton-no-margin ms-3",type:"text",style:{width:"80px"},loading:!0})])):ue.value?r("",!0):(l(),g("span",ST,i(e(S)),1)),o("span",VT,i(e(h)("Net Cash Flow")),1),ue.value?(l(),g("span",IT,[t(ft,{class:"skeleton-no-margin ms-3",type:"text",style:{width:"80px"},loading:!0})])):ue.value?r("",!0):(l(),g("span",DT,i(e(j)),1))])]),te.value?r("",!0):(l(),c(Kl,{key:0,"fixed-header":"","fixed-footer":"","multi-sort":"",density:"compact","item-value":"index",class:be({"reconciliation-statement-table":!0,disabled:ue.value}),height:Ot.value,headers:ze.value,items:e(u)?.transactions??[],hover:!0,"no-data-text":ue.value?"":e(h)("No transaction data"),"items-per-page":me.value,"onUpdate:itemsPerPage":Ue[9]||(Ue[9]=we=>me.value=we),page:Ee.value,"onUpdate:page":Ue[10]||(Ue[10]=we=>Ee.value=we)},{"item.time":a(({item:we})=>[o("span",null,i(e(W)(we)),1),e(D)(we)?r("",!0):(l(),c(Jt,{key:0,class:"ms-1",variant:"flat",color:"secondary",size:"x-small"},{default:a(()=>[q(i(e($)(we)),1)]),_:2},1024))]),"item.type":a(({item:we})=>[t(Jt,{label:"",variant:"outlined",size:"x-small",class:be({"text-income":we.type===e(pe).Income,"text-expense":we.type===e(pe).Expense}),color:Ie(we)},{default:a(()=>[q(i(e(oe)(we)),1)]),_:2},1032,["class","color"])]),"item.categoryName":a(({item:we})=>[o("div",$T,[we.category&&we.category?.color?(l(),c(Pe,{key:0,size:"24px","icon-type":"category","icon-id":we.category?.icon??"",color:we.category?.color??""},null,8,["icon-id","color"])):!we.category||!we.category?.color?(l(),c(ie,{key:1,size:"24",icon:e(as)},null,8,["icon"])):r("",!0),we.type===e(pe).ModifyBalance?(l(),g("span",NT,i(e(h)("Modify Balance")),1)):we.type!==e(pe).ModifyBalance&&we.category?(l(),g("span",FT,i(we.category?.name),1)):r("",!0)])]),"item.sourceAmount":a(({item:we})=>[o("span",{class:be({"text-expense":we.type===e(pe).Expense,"text-income":we.type===e(pe).Income})},i(e(C)(we)),3),we.type===e(pe).Transfer&&we.sourceAccountId!==we.destinationAccountId&&e(C)(we)!==e(M)(we)?(l(),c(ie,{key:0,class:"icon-with-direction mx-1",size:"13",icon:e(ba)},null,8,["icon"])):r("",!0),we.type===e(pe).Transfer&&we.sourceAccountId!==we.destinationAccountId&&e(C)(we)!==e(M)(we)?(l(),g("span",ET,i(e(M)(we)),1)):r("",!0)]),"item.sourceAccountName":a(({item:we})=>[o("div",MT,[we.sourceAccount?(l(),g("span",UT,i(we.sourceAccount?.name),1)):r("",!0),we.type===e(pe).Transfer?(l(),c(ie,{key:1,class:"icon-with-direction mx-1",size:"13",icon:e(ba)},null,8,["icon"])):r("",!0),we.type===e(pe).Transfer&&we.destinationAccount?(l(),g("span",PT,i(we.destinationAccount?.name),1)):r("",!0)])]),"item.accountBalance":a(({item:we})=>[o("span",null,i(e(ee)(we)),1)]),"item.operation":a(({item:we})=>[t(H,{density:"compact",variant:"text",color:"default",disabled:ue.value||we.type===e(pe).ModifyBalance,onClick:Dt=>Ke(we)},{default:a(()=>[q(i(e(h)("View")),1)]),_:1},8,["disabled","onClick"])]),bottom:a(()=>[ue.value||e(u)&&e(u).transactions&&e(u).transactions.length?(l(),g("div",BT,[o("span",LT,i(e(h)("Total Transactions")),1),ue.value?(l(),g("span",zT,[t(ft,{class:"skeleton-no-margin ms-3",type:"text",style:{width:"80px"},loading:!0})])):ue.value?r("",!0):(l(),g("span",OT,i(e(y)(e(u)?.transactions.length??0)),1)),t(it),e(u)&&e(u).transactions&&e(u).transactions.length>10?(l(),g("span",RT,i(e(h)("Transactions Per Page")),1)):r("",!0),e(u)&&e(u).transactions&&e(u).transactions.length>10?(l(),c(Ge,{key:3,class:"ms-2",density:"compact","max-width":"100","item-title":"name","item-value":"value",disabled:ue.value,items:It.value,modelValue:me.value,"onUpdate:modelValue":Ue[7]||(Ue[7]=we=>me.value=we)},null,8,["disabled","items","modelValue"])):r("",!0),e(u)&&e(u).transactions&&e(u).transactions.length>10?(l(),c(jn,{key:4,density:"compact",disabled:ue.value,totalPageCount:la.value,modelValue:Ee.value,"onUpdate:modelValue":Ue[8]||(Ue[8]=we=>Ee.value=we)},null,8,["disabled","totalPageCount","modelValue"])):r("",!0)])):r("",!0)]),_:1},8,["class","height","headers","items","no-data-text","items-per-page","page"])),o("div",qT,[te.value&&ue.value?(l(),c(ut,{key:0,type:Se.value,"date-aggregation-type":Te.value,"fiscal-year-start":e(m),items:[],"legend-name":e(T)?e(h)("Account Outstanding Balance"):e(h)("Account Balance"),account:e(V),skeleton:!0},null,8,["type","date-aggregation-type","fiscal-year-start","legend-name","account"])):r("",!0),te.value&&!ue.value?(l(),c(ut,{key:1,type:Se.value,"date-aggregation-type":Te.value,"fiscal-year-start":e(m),items:e(u)?.transactions,"legend-name":e(T)?e(h)("Account Outstanding Balance"):e(h)("Account Balance"),account:e(V)},null,8,["type","date-aggregation-type","fiscal-year-start","items","legend-name","account"])):r("",!0)])]),_:1}),t(ge,null,{default:a(()=>[o("div",YT,[t(H,{color:"secondary",variant:"tonal",disabled:ue.value,onClick:Fe},{default:a(()=>[q(i(e(h)("Close")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["persistent","modelValue"]),t(Ii,{ref_key:"amountInputDialog",ref:Z},null,512),t(vs,{ref_key:"editDialog",ref:z,type:e(Mt).Transaction},null,8,["type"]),t(ct,{ref_key:"snackbar",ref:le},null,512)],64)}}}),HT={class:"text-h4 text-wrap"},WT={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},GT=Oe({__name:"MoveAllTransactionsDialog",setup(v,{expose:_}){const{tt:n}=je(),{moving:s,fromAccount:h,toAccountId:d,toAccountName:y,allAccounts:f,allVisibleAccounts:b,allVisibleCategorizedAccounts:x,displayToAccountName:u,isToAccountNameValid:m}=Ld(),k=pa(),N=en();let V=null,p=null;const T=xe("snackbar"),A=P(!1),w=P(!1);function I(){k.loadAllAccounts({force:!1}).then(()=>{w.value=!1}).catch(B=>{w.value=!1,B.processed||T.value?.showError(B)})}function F(B){return A.value=!0,s.value=!1,h.value=B,d.value="",y.value="",new Promise((U,X)=>{V=U,p=X})}function S(){!h.value||!d.value||h.value?.id===d.value||!y.value||!m.value||(s.value=!0,N.moveAllTransactionsBetweenAccounts({fromAccountId:h.value.id,toAccountId:d.value}).then(()=>{s.value=!1,V?.(),A.value=!1}).catch(B=>{s.value=!1,B.processed||T.value?.showError(B)}))}function j(){p?.(),A.value=!1}return _({open:F}),I(),(B,U)=>{const X=Ve("two-column-select");return l(),g(fe,null,[t(xt,{width:"640",persistent:!0,modelValue:A.value,"onUpdate:modelValue":U[2]||(U[2]=oe=>A.value=oe)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("h4",HT,i(e(n)("Are you sure you want to move all transactions?")),1)]),default:a(()=>[t(ge,null,{default:a(()=>[q(i(e(n)("format.misc.moveTransactionsInAccountTip",{fromAccount:e(h)?.name,toAccount:e(u)})),1)]),_:1}),t(ge,{class:"w-100 d-flex justify-center"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"12"},{default:a(()=>[t(X,{"primary-key-field":"id","primary-value-field":"category","primary-title-field":"name","primary-footer-field":"displayBalance","primary-icon-field":"icon","primary-icon-type":"account","primary-sub-items-field":"accounts","primary-title-i18n":!0,"secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-footer-field":"displayBalance","secondary-icon-field":"icon","secondary-icon-type":"account","secondary-color-field":"color",disabled:w.value||e(s)||!e(b).length,"enable-filter":!0,"filter-placeholder":e(n)("Find account"),"filter-no-items-text":e(n)("No available account"),label:e(n)("Target Account"),placeholder:e(n)("Target Account"),items:e(x),"no-item-text":e(Dl).findAccountNameById(e(f),e(d),e(n)("Unspecified")),modelValue:e(d),"onUpdate:modelValue":U[0]||(U[0]=oe=>ht(d)?d.value=oe:null)},null,8,["disabled","filter-placeholder","filter-no-items-text","label","placeholder","items","no-item-text","modelValue"])]),_:1}),t(R,{cols:"12",md:"12"},{default:a(()=>[t(ot,{type:"text","persistent-placeholder":"",disabled:e(s),label:e(n)("Confirm Target Account Name"),placeholder:e(n)("Please re-enter the target account name to confirm"),modelValue:e(y),"onUpdate:modelValue":U[1]||(U[1]=oe=>ht(y)?y.value=oe:null)},null,8,["disabled","label","placeholder","modelValue"])]),_:1})]),_:1})]),_:1}),t(ge,null,{default:a(()=>[o("div",WT,[t(H,{disabled:!e(h)||!e(d)||e(h)?.id===e(d)||!e(y)||!e(m)||e(s),onClick:S},{default:a(()=>[q(i(e(n)("Confirm"))+" ",1),e(s)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",disabled:e(s),onClick:j},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ct,{ref_key:"snackbar",ref:T},null,512)],64)}}}),KT={class:"text-h4 text-error text-wrap"},QT={class:"w-100"},JT={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},ZT=Oe({__name:"ClearAllTransactionsDialog",setup(v,{expose:_}){const{tt:n}=je(),s=Za();let h=null,d=null;const y=xe("snackbar"),f=P(!1),b=P(!1),x=P(""),u=P(void 0);function m(V){return f.value=!0,b.value=!1,x.value="",u.value=V,new Promise((p,T)=>{h=p,d=T})}function k(){!u.value||!x.value||(b.value=!0,s.clearAllUserTransactionsOfAccount({accountId:u.value.id,password:x.value}).then(()=>{b.value=!1,h?.(),f.value=!1}).catch(V=>{b.value=!1,V.processed||y.value?.showError(V)}))}function N(){d?.(),f.value=!1}return _({open:m}),(V,p)=>(l(),g(fe,null,[t(xt,{width:"640",persistent:!0,modelValue:f.value,"onUpdate:modelValue":p[1]||(p[1]=T=>f.value=T)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("h4",KT,i(e(n)("Are you sure you want to clear all transactions?")),1)]),default:a(()=>[t(ge,{class:"pb-2 text-error"},{default:a(()=>[q(i(e(n)("format.misc.clearTransactionsInAccountTip",{account:u.value?.name})),1)]),_:1}),t(ge,{class:"w-100 d-flex justify-center"},{default:a(()=>[o("div",QT,[t(ot,{autocomplete:"current-password",type:"password",variant:"underlined",color:"error",disabled:b.value,placeholder:e(n)("Current Password"),modelValue:x.value,"onUpdate:modelValue":p[0]||(p[0]=T=>x.value=T)},null,8,["disabled","placeholder","modelValue"])])]),_:1}),t(ge,null,{default:a(()=>[o("div",JT,[t(H,{color:"error",disabled:!x.value||b.value,onClick:k},{default:a(()=>[q(i(e(n)("Confirm"))+" ",1),b.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",disabled:b.value,onClick:N},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ct,{ref_key:"snackbar",ref:y},null,512)],64))}}),XT={class:"mx-6 my-4"},ek={class:"text-subtitle-2"},tk={class:"account-statistic-item-value text-income text-truncate mt-1 mb-3"},ak={key:0},lk={key:1},nk={class:"text-subtitle-2"},ok={class:"account-statistic-item-value text-expense text-truncate mt-1 mb-3"},sk={key:0},ik={key:1},rk={class:"text-subtitle-2"},uk={class:"account-statistic-item-value mt-1"},dk={key:0},ck={key:1},mk={class:"d-flex flex-column text-truncate ms-2"},pk={key:0,class:"text-truncate text-start smaller"},vk={key:1,class:"text-truncate text-start smaller my-1"},fk={class:"text-truncate text-start"},yk={class:"title-and-toolbar d-flex align-center"},gk={class:"accounts-overview-subtitle"},hk={key:1,class:"accounts-overview-amount ms-3"},bk={class:"account-title d-flex align-center"},Tk={class:"account-name text-truncate ms-2"},kk={class:"align-self-center"},_k={class:"d-flex account-toolbar align-center"},xk={class:"account-balance ms-2"},Ck={class:"list-group-item"},wk={class:"account-title d-flex align-baseline"},Ak={class:"account-name text-truncate ms-2"},Sk={class:"account-currency text-truncate ms-2"},Vk={class:"align-self-center"},Ik={key:0,class:"mt-4"},Dk={class:"ms-2"},$k={class:"d-flex account-toolbar align-center"},Nk={class:"d-flex align-center"},Fk={class:"text-sm ms-3"},Ek={class:"account-balance ms-2"},Mk=Oe({__name:"ListPage",setup(v){const _=Rl(),{tt:n,getAllDateRanges:s,getCurrencyName:h,joinMultiText:d}=je(),{loading:y,showHidden:f,displayOrderModified:b,showAccountBalance:x,firstDayOfWeek:u,fiscalYearStart:m,allAccounts:k,allCategorizedAccountsMap:N,allAccountCount:V,netAssets:p,totalAssets:T,totalLiabilities:A,accountCategoryTotalBalance:w,accountBalance:I}=zd(),F=pa(),S=xe("confirmDialog"),j=xe("snackbar"),B=xe("editDialog"),U=xe("reconciliationStatementDialog"),X=xe("moveAllTransactionsDialog"),oe=xe("clearAllTransactionsDialog"),W=P(Pl.Default.type),D=P("accountPage"),$=P({}),C=P(null),M=P(_.mdAndUp.value),ee=P(_.mdAndUp.value),ye=P(!1),L=P(!1),Y=E(()=>F.allVisibleAccountsCount>0),O=E(()=>Pl.valueOf(W.value)),J=E(()=>w(O.value)),ae=E(()=>{if(!O.value)return 0;const ze=N.value[O.value.type];if(!ze||!ze.accounts||!ze.accounts.length)return 0;if(f.value)return ze.accounts.length;let ke=0;for(const Ie of ze.accounts)Ie.hidden||ke++;return ke});function Z(ze){y.value=!0,F.loadAllAccounts({force:ze}).then(()=>{if(y.value=!1,b.value=!1,k.value)for(const ke of k.value)ke.type===oa.MultiSubAccounts.type&&!$.value[ke.id]&&($.value[ke.id]="");ze&&j.value?.showMessage("Account list has been updated")}).catch(ke=>{y.value=!1,ke&&ke.isUpToDate&&(b.value=!1),ke.processed||j.value?.showError(ke)})}function le(ze){return F.hasAccount(ze,!f.value)}function z(ze){if(ze.type===oa.SingleAccount.type)return h(ze.currency);if(ze.type===oa.MultiSubAccounts.type){const ke=ze.getSubAccountCurrencies(f.value,$.value[ze.id]).map(Ie=>h(Ie));return d(ke)}else return null}function se(ze){return s(ma.Normal,!0,!!F.getAccountStatementDate(ze.id))}function ue(){B.value?.open({category:W.value}).then(ze=>{ze&&ze.message&&j.value?.showMessage(ze.message)}).catch(ze=>{ze&&j.value?.showError(ze)})}function Ee(ze){B.value?.open({id:ze.id,currentAccount:ze}).then(ke=>{ke&&ke.message&&j.value?.showMessage(ke.message),F.accountListStateInvalid&&!y.value&&Z(!1)}).catch(ke=>{ke&&j.value?.showError(ke)})}function me(ze,ke){if(!Zt(ke)||ke===Lt.Custom.type){C.value=ze,L.value=!0;return}let Ie=null;Lt.isBillingCycle(ke)?Ie=_i(ke,u.value,m.value,F.getAccountStatementDate(ze.id)):Ie=zn(ke,u.value,m.value),Ie&&U.value?.open({accountId:ze.id,startTime:Ie.minTime,endTime:Ie.maxTime})}function te(ze){X.value?.open(ze).then(()=>{j.value?.showMessage("All transactions in this account has been moved."),F.accountListStateInvalid&&!y.value&&Z(!1)})}function Se(ze){oe.value?.open(ze).then(()=>{j.value?.showMessage("All transactions in this account has been cleared"),F.accountListStateInvalid&&!y.value&&Z(!1)})}function Te(ze,ke,Ie){y.value=!0,F.hideAccount({account:ke,hidden:Ie}).then(()=>{Ie&&!f.value&&$.value[ze.id]&&($.value[ze.id]=""),y.value=!1}).catch(Et=>{y.value=!1,Et.processed||j.value?.showError(Et)})}function Ye(ze){if($.value[ze.id]){const ke=ze.getSubAccount($.value[ze.id]);if(!ke){j.value?.showMessage("Unable to delete this sub-account");return}S.value?.open("Are you sure you want to delete this sub-account?").then(()=>{y.value=!0,F.deleteSubAccount({subAccount:ke}).then(()=>{$.value[ze.id]="",y.value=!1}).catch(Ie=>{y.value=!1,Ie.processed||j.value?.showError(Ie)})})}else S.value?.open("Are you sure you want to delete this account?").then(()=>{y.value=!0,F.deleteAccount({account:ze}).then(()=>{y.value=!1}).catch(ke=>{y.value=!1,ke.processed||j.value?.showError(ke)})})}function He(){b.value&&(y.value=!0,F.updateAccountDisplayOrders().then(()=>{y.value=!1,b.value=!1}).catch(ze=>{y.value=!1,ze.processed||j.value?.showError(ze)}))}function It(ze){if(!ze||!ze.moved)return;const ke=ze.moved;if(!ke.element||!ke.element.id){j.value?.showMessage("Unable to move account");return}F.changeAccountDisplayOrder({accountId:ke.element.id,from:ke.oldIndex,to:ke.newIndex,updateListOrder:!1,updateGlobalListOrder:!0}).then(()=>{b.value=!0}).catch(Ie=>{j.value?.showError(Ie)})}function la(ze,ke){if(!C.value){j.value?.showMessage("An error occurred");return}L.value=!1,U.value?.open({accountId:C.value.id,startTime:ze,endTime:ke}),C.value=null}function Ot(ze){j.value?.showError(ze)}return Ft(()=>_.mdAndUp.value,ze=>{M.value=ze,ee.value||(ee.value=ze)}),Z(!1),(ze,ke)=>{const Ie=Ve("ItemIcon"),Et=Ve("draggable-list"),yt=Ve("date-range-selection-dialog");return l(),g(fe,null,[t(Ae,{class:"match-height"},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,null,{default:a(()=>[t(Jl,null,{default:a(()=>[t(Zl,{permanent:M.value,modelValue:ee.value,"onUpdate:modelValue":ke[1]||(ke[1]=Ne=>ee.value=Ne)},{default:a(()=>[o("div",XT,[o("span",ek,i(e(n)("Net assets")),1),o("p",tk,[!e(y)||e(V)>0?(l(),g("span",ak,i(e(p)),1)):e(y)&&e(V)<=0?(l(),g("span",lk,[t(ft,{class:"skeleton-no-margin pt-2 pb-1",type:"text",loading:!0})])):r("",!0)]),o("span",nk,i(e(n)("Total liabilities")),1),o("p",ok,[!e(y)||e(V)>0?(l(),g("span",sk,i(e(A)),1)):e(y)&&e(V)<=0?(l(),g("span",ik,[t(ft,{class:"skeleton-no-margin pt-2 pb-1",type:"text",loading:!0})])):r("",!0)]),o("span",rk,i(e(n)("Total assets")),1),o("p",uk,[!e(y)||e(V)>0?(l(),g("span",dk,i(e(T)),1)):e(y)&&e(V)<=0?(l(),g("span",ck,[t(ft,{class:"skeleton-no-margin pt-2 pb-1",type:"text",loading:!0})])):r("",!0)])]),t(nt),t(Ja,{"show-arrows":"",class:"account-category-tabs my-4",direction:"vertical",disabled:e(y),modelValue:W.value,"onUpdate:modelValue":ke[0]||(ke[0]=Ne=>W.value=Ne)},{default:a(()=>[(l(!0),g(fe,null,$e(e(Pl).values(),Ne=>(l(),c(Wt,{class:"tab-text-truncate",key:Ne.type,value:Ne.type},{default:a(()=>[t(Ie,{"icon-type":"account","icon-id":Ne.defaultAccountIconId},null,8,["icon-id"]),o("div",mk,[!e(y)||e(V)>0?(l(),g("small",pk,i(e(w)(Ne)),1)):e(y)&&e(V)<=0?(l(),g("small",vk,[t(ft,{class:"skeleton-no-margin",width:"100px",height:"16",type:"text",loading:!0})])):r("",!0),o("span",fk,i(e(n)(Ne.name)),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["disabled","modelValue"])]),_:1},8,["permanent","modelValue"]),t(Xl,null,{default:a(()=>[t(qa,{class:"d-flex flex-grow-1 disable-tab-transition w-100-window-container",modelValue:D.value,"onUpdate:modelValue":ke[8]||(ke[8]=Ne=>D.value=Ne)},{default:a(()=>[t(zt,{value:"accountPage"},{default:a(()=>[t(Me,{variant:"flat","min-height":"780"},{title:a(()=>[o("div",yk,[t(H,{class:"me-3 d-md-none",density:"compact",color:"default",variant:"plain",ripple:!1,icon:!0,onClick:ke[2]||(ke[2]=Ne=>ee.value=!ee.value)},{default:a(()=>[t(ie,{icon:e(ql),size:"24"},null,8,["icon"])]),_:1}),o("span",null,i(e(n)("Account List")),1),t(H,{class:"ms-3",color:"default",variant:"outlined",disabled:e(y),onClick:ue},{default:a(()=>[q(i(e(n)("Add")),1)]),_:1},8,["disabled"]),t(H,{class:"ms-3",color:"warning",variant:"tonal",disabled:e(y),to:"/account/quick_balance_modify"},{default:a(()=>[q(i(e(n)("Quick Balance Modify")),1)]),_:1},8,["disabled"]),e(b)?(l(),c(H,{key:0,class:"ms-3",color:"primary",variant:"tonal",disabled:e(y),onClick:He},{default:a(()=>[q(i(e(n)("Save Display Order")),1)]),_:1},8,["disabled"])):r("",!0),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,loading:e(y),onClick:ke[3]||(ke[3]=Ne=>Z(!0))},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Refresh")),1)]),_:1})]),_:1},8,["loading"]),t(it),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",disabled:e(y),icon:!0},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[e(f)?r("",!0):(l(),c(ve,{key:0,"prepend-icon":e(Ma),title:e(n)("Show Hidden Accounts"),onClick:ke[4]||(ke[4]=Ne=>f.value=!0)},null,8,["prepend-icon","title"])),e(f)?(l(),c(ve,{key:1,"prepend-icon":e(da),title:e(n)("Hide Hidden Accounts"),onClick:ke[5]||(ke[5]=Ne=>f.value=!1)},null,8,["prepend-icon","title"])):r("",!0),Y.value?(l(),c(nt,{key:2,class:"my-2"})):r("",!0),Y.value?(l(),c(ve,{key:3,"prepend-icon":e(ri),title:e(n)("Set Accounts Included in Total"),onClick:ke[6]||(ke[6]=Ne=>ye.value=!0)},null,8,["prepend-icon","title"])):r("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])])]),default:a(()=>[t(ge,{class:"accounts-overview-title text-truncate pt-0"},{default:a(()=>[o("span",gk,i(O.value?.isLiability?e(n)("Outstanding Balance"):e(n)("Balance")),1),e(y)&&O.value&&!le(O.value)?(l(),c(ft,{key:0,class:"skeleton-no-margin ms-3 mb-2",width:"120px",type:"text",loading:!0})):!e(y)||!O.value||le(O.value)?(l(),g("span",hk,i(J.value),1)):r("",!0),t(H,{class:"ms-2",density:"compact",color:"default",variant:"text",icon:!0,disabled:e(y),onClick:ke[7]||(ke[7]=Ne=>x.value=!e(x))},{default:a(()=>[t(ie,{icon:e(x)?e(da):e(Ma),size:"20"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(x)?e(n)("Hide Account Balance"):e(n)("Show Account Balance")),1)]),_:1})]),_:1},8,["disabled"])]),_:1}),e(y)&&O.value&&!le(O.value)?(l(),c(Ae,{key:0,class:"ps-6 pe-6 pe-md-8"},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,{border:"",class:"card-title-with-bg account-card mb-8 h-auto"},{title:a(()=>[o("div",bk,[t(ie,{class:"disabled me-0",size:"28px",icon:e($n)},null,8,["icon"]),o("span",Tk,[t(ft,{class:"skeleton-no-margin my-1",width:"120px",type:"text",loading:!0})]),t(it),o("span",kk,[t(ie,{class:"disabled",icon:e(yn)},null,8,["icon"])])])]),default:a(()=>[t(nt),t(ge,null,{default:a(()=>[o("div",_k,[t(H,{class:"px-2",density:"comfortable",color:"default",variant:"text",disabled:!0,"prepend-icon":e(bl)},{default:a(()=>[q(i(e(n)("Transaction List")),1)]),_:1},8,["prepend-icon"]),t(it),o("span",xk,[t(ft,{class:"skeleton-no-margin",width:"100px",type:"text",loading:!0})])])]),_:1})]),_:1})]),_:1})]),_:1})):r("",!0),!e(y)&&O.value&&!le(O.value)?(l(),c(Ae,{key:1,class:"ps-5 pe-2 pe-md-4"},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[q(i(e(n)("No available account")),1)]),_:1})]),_:1})):r("",!0),t(Ae,{class:"ps-6 pe-6 pe-md-8"},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[O.value&&e(N)[O.value.type]&&e(N)[O.value.type].accounts&&e(N)[O.value.type].accounts.length?(l(),c(Et,{key:0,class:"list-group","item-key":"id",handle:".drag-handle","ghost-class":"dragging-item",disabled:ae.value<=1,list:e(N)[O.value.type].accounts,onChange:It},{item:a(({element:Ne})=>[o("div",Ck,[e(f)||!Ne.hidden?(l(),c(Me,{key:0,border:"",class:"card-title-with-bg account-card mb-8 h-auto"},{title:a(()=>[o("div",wk,[t(Ie,{size:"1.5rem","icon-type":"account","icon-id":Ne.icon,color:Ne.color,"hidden-status":Ne.hidden},null,8,["icon-id","color","hidden-status"]),o("span",Ak,i(Ne.name),1),o("small",Sk,i(z(Ne)),1),t(it),o("span",Vk,[t(ie,{class:be(!e(y)&&ae.value>1?"drag-handle":"disabled"),icon:e(yn)},null,8,["class","icon"]),!e(y)&&ae.value>1?(l(),c(vt,{key:0,activator:"parent"},{default:a(()=>[q(i(e(n)("Drag to Reorder")),1)]),_:1})):r("",!0)])]),Ne.type===e(oa).MultiSubAccounts.type?(l(),g("div",Ik,[t(Ul,{class:"account-subaccounts",variant:"outlined",color:"primary",density:"compact",mandatory:"force",divided:"",rounded:"xl",disabled:e(y),modelValue:$.value[Ne.id],"onUpdate:modelValue":kt=>$.value[Ne.id]=kt},{default:a(()=>[t(H,{value:""},{default:a(()=>[o("span",null,i(e(n)("All")),1)]),_:1}),(l(!0),g(fe,null,$e(Ne.subAccounts,kt=>za((l(),c(H,{key:kt.id,value:kt.id},{default:a(()=>[t(Ie,{size:"1.5rem","icon-type":"account","icon-id":kt.icon,color:kt.color,"hidden-status":kt.hidden},null,8,["icon-id","color","hidden-status"]),o("span",Dk,i(kt.name),1)]),_:2},1032,["value"])),[[Ka,e(f)||!kt.hidden]])),128))]),_:2},1032,["disabled","modelValue","onUpdate:modelValue"])])):r("",!0)]),default:a(()=>[t(nt),Ne.getAccountOrSubAccountComment($.value[Ne.id])?(l(),c(ge,{key:0},{default:a(()=>[q(i(Ne.getAccountOrSubAccountComment($.value[Ne.id])),1)]),_:2},1024)):r("",!0),t(ge,null,{default:a(()=>[o("div",$k,[t(H,{class:"px-2",density:"comfortable",color:"default",variant:"text",disabled:e(y),"prepend-icon":e(bl),to:`/transaction/list?accountIds=${Ne.getAccountOrSubAccountId($.value[Ne.id])}`},{default:a(()=>[q(i(e(n)("Transaction List")),1)]),_:1},8,["disabled","prepend-icon","to"]),Ne.type===e(oa).SingleAccount.type||Ne.getSubAccount($.value[Ne.id])?(l(),c(H,{key:0,class:"px-2 ms-1",density:"comfortable",color:"default",variant:"text",disabled:e(y),"prepend-icon":e(Fr),onClick:kt=>me(Ne.getAccountOrSubAccount($.value[Ne.id]))},{default:a(()=>[q(i(e(n)("Reconciliation Statement"))+" ",1),t(mt,{activator:"parent","open-on-hover":!0},{default:a(()=>[t(Je,null,{default:a(()=>[(l(!0),g(fe,null,$e(se(Ne.getAccountOrSubAccount($.value[Ne.id])),kt=>(l(),c(ve,{key:kt.type,class:"text-sm",density:"compact",value:kt.type},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:Be=>me(Ne.getAccountOrSubAccount($.value[Ne.id]),kt.type)},{default:a(()=>[o("div",Nk,[o("span",Fk,i(kt.displayName),1)])]),_:2},1032,["onClick"])]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["disabled","prepend-icon","onClick"])):r("",!0),!$.value[Ne.id]||Ne.getSubAccount($.value[Ne.id])?(l(),c(H,{key:1,class:be(["px-2 ms-1",{"d-none":e(y),"hover-display":!e(y)}]),density:"comfortable",color:"default",variant:"text",disabled:e(y),"prepend-icon":Ne.isAccountOrSubAccountHidden($.value[Ne.id])?e(Ma):e(da),onClick:kt=>Te(Ne,Ne.getAccountOrSubAccount($.value[Ne.id]),!Ne.isAccountOrSubAccountHidden($.value[Ne.id]))},{default:a(()=>[q(i(Ne.isAccountOrSubAccountHidden($.value[Ne.id])?e(n)("Show"):e(n)("Hide")),1)]),_:2},1032,["class","disabled","prepend-icon","onClick"])):r("",!0),!$.value[Ne.id]||Ne.getSubAccount($.value[Ne.id])?(l(),c(H,{key:2,class:be(["px-2 ms-1",{"d-none":e(y),"hover-display":!e(y)}]),density:"comfortable",color:"default",variant:"text",disabled:e(y),"prepend-icon":e(hn),onClick:kt=>Ee(Ne)},{default:a(()=>[q(i(e(n)("Edit")),1)]),_:1},8,["class","disabled","prepend-icon","onClick"])):r("",!0),Ne.type===e(oa).SingleAccount.type||Ne.getSubAccount($.value[Ne.id])?(l(),c(H,{key:3,class:be(["px-2 ms-1",{"d-none":e(y),"hover-display":!e(y)}]),density:"comfortable",color:"default",variant:"text",disabled:e(y),"prepend-icon":e(Er)},{default:a(()=>[q(i(e(n)("More"))+" ",1),t(mt,{activator:"parent","open-on-hover":!0},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{class:"text-sm",density:"compact",title:e(n)("Move All Transactions"),"prepend-icon":e(Dn),onClick:kt=>te(Ne.getAccountOrSubAccount($.value[Ne.id]))},null,8,["title","prepend-icon","onClick"]),t(ve,{class:"text-sm",density:"compact",title:e(n)("Clear All Transactions"),"prepend-icon":e(Mr),onClick:kt=>Se(Ne.getAccountOrSubAccount($.value[Ne.id]))},null,8,["title","prepend-icon","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["class","disabled","prepend-icon"])):r("",!0),!$.value[Ne.id]||Ne.getSubAccount($.value[Ne.id])?(l(),c(H,{key:4,class:be(["px-2 ms-1",{"d-none":e(y),"hover-display":!e(y)}]),density:"comfortable",color:"default",variant:"text",disabled:e(y),"prepend-icon":e(bn),onClick:kt=>Ye(Ne)},{default:a(()=>[q(i(e(n)("Delete")),1)]),_:1},8,["class","disabled","prepend-icon","onClick"])):r("",!0),t(it),o("span",Ek,i(e(I)(Ne,$.value[Ne.id])),1)])]),_:2},1024)]),_:2},1024)):r("",!0)])]),_:1},8,["disabled","list"])):r("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(xt,{width:"800",modelValue:ye.value,"onUpdate:modelValue":ke[10]||(ke[10]=Ne=>ye.value=Ne)},{default:a(()=>[t($l,{type:"accountListTotalAmount","dialog-mode":!0,"onSettings:change":ke[9]||(ke[9]=Ne=>ye.value=!1)})]),_:1},8,["modelValue"]),t(rT,{ref_key:"editDialog",ref:B},null,512),t(jT,{ref_key:"reconciliationStatementDialog",ref:U,onError:Ot},null,512),t(GT,{ref_key:"moveAllTransactionsDialog",ref:X},null,512),t(ZT,{ref_key:"clearAllTransactionsDialog",ref:oe},null,512),t(yt,{title:e(n)("Custom Date Range"),show:L.value,"onUpdate:show":ke[11]||(ke[11]=Ne=>L.value=Ne),"onDateRange:change":la,onError:Ot},null,8,["title","show"]),t(ka,{ref_key:"confirmDialog",ref:S},null,512),t(ct,{ref_key:"snackbar",ref:j},null,512)],64)}}}),Uk={class:"title-and-toolbar d-flex align-center"},Pk={class:"d-flex align-center flex-wrap ga-2"},Bk={class:"text-subtitle-2"},Lk={class:"d-flex align-center"},zk={class:"ms-2"},Ok={class:"d-flex align-center"},Rk={class:"ms-1"},qk={class:"d-flex ga-1"},Yk={class:"text-center py-6"},jk={class:"mb-4"},Hk={class:"d-flex align-center mb-2"},Wk={class:"ms-2 font-weight-bold"},Gk={class:"text-body-2"},Kk={class:"mb-4"},Qk=Oe({__name:"QuickBalanceModifyPage",setup(v){const _=Na(),{tt:n,formatAmountToLocalizedNumeralsWithCurrency:s}=je(),h=P(!1),d=P(!1),y=P(!1),f=P(!1),b=P(!1),x=P([]),u=P([]),m=P([]),k=P(""),N=P(null),V=P(!1),p=P(null),T=P(0),A=P(0),w=P("add"),I=E(()=>[{title:n("Account Name"),key:"name",sortable:!0},{title:n("Category"),key:"category",sortable:!0},{title:n("Currency"),key:"currency",sortable:!0},{title:n("Balance"),key:"balance",sortable:!0},{title:n("Actions"),key:"actions",sortable:!1}]),F=E(()=>Pl.values().map(L=>({text:n(L.name),value:L.type}))),S=E(()=>x.value.filter(L=>m.value.includes(L.id)));function j(L,Y){return s(L,Y)}function B(L){return{USD:"$",EUR:"€",GBP:"£",JPY:"¥",CNY:"¥",CAD:"CA$",AUD:"AU$"}[L]||L}const U=L=>!!L||n("This field is required");function X(){_.back()}async function oe(){h.value=!0;try{const L=await Fo.getAllAccounts({visibleOnly:!1});x.value=L.data.result.map(Y=>({id:BigInt(Y.id),name:Y.name,category:Y.category,icon:parseInt(Y.icon),color:Y.color,currency:Y.currency,balance:Y.balance,hidden:Y.hidden,isAsset:Y.isAsset,isLiability:Y.isLiability})),W()}catch(L){ct.showNetworkError(L)}finally{h.value=!1}}function W(){let L=[...x.value];if(k.value){const Y=k.value.toLowerCase();L=L.filter(O=>O.name.toLowerCase().includes(Y))}N.value!==null&&(L=L.filter(Y=>Y.category===N.value)),V.value||(L=L.filter(Y=>!Y.hidden)),u.value=L}function D(L){return Pl.valueOf(L)||Pl.Cash}function $(L){p.value=L,T.value=L.balance/100,f.value=!0}function C(L){if(m.value.length===0){ct.showError(n("Please select at least one account"));return}w.value=L,A.value=0,b.value=!0}function M(){m.value=[]}async function ee(){if(console.log("currentAccount",p),!(!p.value||T.value===null||T.value===void 0)){d.value=!0,console.log("Sending modify request:",{id:p.value.id,idString:p.value.id.toString(),idNumber:Number(p.value.id),balance:Math.round(T.value*100),idType:typeof p.value.id,balanceType:typeof Math.round(T.value*100),isSafeInteger:Number.isSafeInteger(p.value.id),maxSafeInteger:Number.MAX_SAFE_INTEGER});try{const L=await Fo.modifyAccountBalance({id:p.value.id,balance:Math.round(T.value*100)}),Y=x.value.findIndex(O=>O.id===p.value.id);if(Y!==-1&&L.data&&L.data.result){const O=x.value[Y];O&&(O.balance=L.data.result.balance)}W(),f.value=!1,ct.showSuccess(n("Account balance updated successfully"))}catch(L){ct.showNetworkError(L)}finally{d.value=!1}}}async function ye(){if(!(m.value.length===0||A.value<=0)){y.value=!0;try{const L=await Fo.modifyBatchAccountBalances({accountIds:m.value,operation:w.value,amount:Math.round(A.value*100)});L.data&&L.data.result&&L.data.result.forEach(Y=>{const O=x.value.findIndex(J=>J.id.toString()===Y.id);if(O!==-1){const J=x.value[O];J&&(J.balance=Y.balance)}}),W(),m.value=[],b.value=!1,ct.showSuccess(n("Batch account balances updated successfully"))}catch(L){ct.showNetworkError(L)}finally{y.value=!1}}}return Go(()=>{oe()}),(L,Y)=>{const O=Ve("ItemIcon");return l(),g(fe,null,[t(Ae,{class:"match-height"},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,null,{title:a(()=>[o("div",Uk,[t(H,{class:"me-3",density:"compact",color:"default",variant:"plain",ripple:!1,icon:!0,onClick:X},{default:a(()=>[t(ie,{icon:e(On),size:"24"},null,8,["icon"])]),_:1}),o("span",null,i(e(n)("Quick Balance Modification")),1),t(it),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,loading:h.value,onClick:oe},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Refresh")),1)]),_:1})]),_:1},8,["loading"])])]),default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,{class:"mb-6"},{default:a(()=>[t(R,{cols:"12",md:"4"},{default:a(()=>[t(ot,{modelValue:k.value,"onUpdate:modelValue":[Y[0]||(Y[0]=J=>k.value=J),W],label:e(n)("Search Accounts"),"prepend-inner-icon":e(Ql),clearable:"","hide-details":""},null,8,["modelValue","label","prepend-inner-icon"])]),_:1}),t(R,{cols:"12",md:"4"},{default:a(()=>[t(Ge,{modelValue:N.value,"onUpdate:modelValue":[Y[1]||(Y[1]=J=>N.value=J),W],label:e(n)("Account Category"),items:F.value,"item-title":"text","item-value":"value",clearable:"","hide-details":""},null,8,["modelValue","label","items"])]),_:1}),t(R,{cols:"12",md:"4"},{default:a(()=>[t(Ea,{modelValue:V.value,"onUpdate:modelValue":[Y[2]||(Y[2]=J=>V.value=J),W],label:e(n)("Show Hidden Accounts"),"hide-details":""},null,8,["modelValue","label"])]),_:1})]),_:1}),t(Me,{class:"mb-6",variant:"outlined"},{default:a(()=>[t(ge,null,{default:a(()=>[o("div",Pk,[o("span",Bk,i(e(n)("Selected"))+": "+i(m.value.length)+" "+i(e(n)("accounts")),1),m.value.length>0?(l(),c(nt,{key:0,vertical:"",class:"mx-2"})):r("",!0),t(H,{color:"success",variant:"tonal",disabled:m.value.length===0,onClick:Y[3]||(Y[3]=J=>C("add"))},{default:a(()=>[t(ie,{icon:e(ii),start:""},null,8,["icon"]),q(" "+i(e(n)("Batch Add Amount")),1)]),_:1},8,["disabled"]),t(H,{color:"warning",variant:"tonal",disabled:m.value.length===0,onClick:Y[4]||(Y[4]=J=>C("subtract"))},{default:a(()=>[t(ie,{icon:e(Ur),start:""},null,8,["icon"]),q(" "+i(e(n)("Batch Subtract Amount")),1)]),_:1},8,["disabled"]),t(H,{color:"info",variant:"tonal",disabled:m.value.length===0,onClick:M},{default:a(()=>[t(ie,{icon:e(vl),start:""},null,8,["icon"]),q(" "+i(e(n)("Clear Selection")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1}),t(Kl,{modelValue:m.value,"onUpdate:modelValue":Y[5]||(Y[5]=J=>m.value=J),headers:I.value,items:u.value,loading:h.value,"show-select":"","item-value":"id",class:"elevation-1","items-per-page":20,"items-per-page-options":[10,20,50,100]},{"item.name":a(({item:J})=>[o("div",Lk,[t(O,{size:"1.5rem","icon-type":"account","icon-id":J.icon,color:J.color,"hidden-status":J.hidden},null,8,["icon-id","color","hidden-status"]),o("span",zk,i(J.name),1),J.hidden?(l(),c(Jt,{key:0,size:"small",class:"ms-2",color:"grey"},{default:a(()=>[q(i(e(n)("Hidden")),1)]),_:1})):r("",!0)])]),"item.category":a(({item:J})=>[o("div",Ok,[t(O,{size:"1rem","icon-type":"account","icon-id":D(J.category)?.defaultAccountIconId},null,8,["icon-id"]),o("span",Rk,i(e(n)(D(J.category)?.name||"")),1)])]),"item.balance":a(({item:J})=>[o("span",{class:be(J.isAsset?"text-income":"text-expense")},i(j(J.balance,J.currency)),3)]),"item.actions":a(({item:J})=>[o("div",qk,[t(H,{density:"comfortable",color:"primary",variant:"text",icon:!0,onClick:ae=>$(J)},{default:a(()=>[t(ie,{icon:e(Br),size:"18"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Modify Balance")),1)]),_:1})]),_:1},8,["onClick"]),t(H,{density:"comfortable",color:"info",variant:"text",icon:!0,to:`/transaction/list?accountIds=${J.id.toString()}`},{default:a(()=>[t(ie,{icon:e(bl),size:"18"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Transaction List")),1)]),_:1})]),_:1},8,["to"])])]),"no-data":a(()=>[o("div",Yk,[t(ie,{icon:e(Pr),size:"48",class:"mb-2"},null,8,["icon"]),o("p",null,i(e(n)("No accounts found")),1)])]),_:1},8,["modelValue","headers","items","loading"])]),_:1})]),_:1})]),_:1})]),_:1}),t(xt,{modelValue:f.value,"onUpdate:modelValue":Y[8]||(Y[8]=J=>f.value=J),"max-width":"500px"},{default:a(()=>[t(Me,null,{title:a(()=>[o("span",null,i(e(n)("Modify Account Balance")),1)]),default:a(()=>[t(ge,null,{default:a(()=>[o("div",jk,[o("div",Hk,[t(O,{size:"1.5rem","icon-type":"account","icon-id":p.value?.icon,color:p.value?.color},null,8,["icon-id","color"]),o("span",Wk,i(p.value?.name),1)]),o("div",Gk,[q(i(e(n)("Current Balance"))+": ",1),o("span",{class:be(p.value?.isAsset?"text-income":"text-expense")},i(j(p.value?.balance||0,p.value?.currency||"USD")),3)])]),t(ot,{modelValue:T.value,"onUpdate:modelValue":Y[6]||(Y[6]=J=>T.value=J),modelModifiers:{number:!0},label:e(n)("New Balance"),type:"number",step:"0.01",prefix:B(p.value?.currency||"USD"),rules:[U],"hide-details":"auto"},null,8,["modelValue","label","prefix","rules"])]),_:1}),t(Un,null,{default:a(()=>[t(it),t(H,{onClick:Y[7]||(Y[7]=J=>f.value=!1)},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1}),t(H,{color:"primary",loading:d.value,onClick:ee},{default:a(()=>[q(i(e(n)("Save")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(xt,{modelValue:b.value,"onUpdate:modelValue":Y[11]||(Y[11]=J=>b.value=J),"max-width":"500px"},{default:a(()=>[t(Me,null,{title:a(()=>[o("span",null,i(w.value==="add"?e(n)("Batch Add Amount"):e(n)("Batch Subtract Amount")),1)]),default:a(()=>[t(ge,null,{default:a(()=>[o("div",Kk,[o("p",null,i(e(n)("Selected accounts"))+": "+i(m.value.length),1),t(Lr,null,{default:a(()=>[(l(!0),g(fe,null,$e(S.value,J=>(l(),c(Jt,{key:J.id.toString(),size:"small",variant:"outlined"},{default:a(()=>[q(i(J.name),1)]),_:2},1024))),128))]),_:1})]),t(ot,{modelValue:A.value,"onUpdate:modelValue":Y[9]||(Y[9]=J=>A.value=J),modelModifiers:{number:!0},label:e(n)("Amount"),type:"number",step:"0.01",prefix:m.value.length>0?B(S.value[0]?.currency||"USD"):"",rules:[U],"hide-details":"auto"},null,8,["modelValue","label","prefix","rules"]),m.value.length>0?(l(),c(ls,{key:0,type:"info",class:"mt-4"},{default:a(()=>[q(i(e(n)("All selected accounts will"))+" "+i(w.value==="add"?e(n)("increase"):e(n)("decrease"))+" "+i(e(n)("by"))+" "+i(j(A.value*100,S.value[0]?.currency||"USD")),1)]),_:1})):r("",!0)]),_:1}),t(Un,null,{default:a(()=>[t(it),t(H,{onClick:Y[10]||(Y[10]=J=>b.value=!1)},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1}),t(H,{color:"primary",loading:y.value,onClick:ye},{default:a(()=>[q(i(e(n)("Confirm")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),Jk=kn(Qk,[["__scopeId","data-v-62c4fa82"]]),Zk={class:"d-flex align-center"},Xk={class:"text-h4"},e_={class:"text-truncate"},t_={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},a_=Oe({__name:"EditDialog",setup(v,{expose:_}){const{tt:n}=je(),{editCategoryId:s,clientSessionId:h,loading:d,submitting:y,category:f,allAvailableCategories:b,title:x,saveButtonTitle:u,inputEmptyProblemMessage:m,inputIsEmpty:k}=Od(),N=va(),V=xe("snackbar"),p=P(!1);let T=null,A=null;const w=E(()=>s.value?!0:!f.value.equals(jo.createNewCategory(f.value.type,f.value.parentId)));function I(j){p.value=!0,d.value=!0,y.value=!1;const B=jo.createNewCategory();if(f.value.fillFrom(B),j.id)j.currentCategory&&f.value.fillFrom(j.currentCategory),s.value=j.id,N.getCategory({categoryId:s.value}).then(U=>{f.value.fillFrom(U),d.value=!1}).catch(U=>{d.value=!1,p.value=!1,U.processed||A&&A(U)});else if(j.parentId){s.value=null;const U=j.type;if(U!==st.Income&&U!==st.Expense&&U!==st.Transfer)return d.value=!1,p.value=!1,Promise.reject("Parameter Invalid");f.value.type=U,f.value.parentId=j.parentId,j.color&&(f.value.color=j.color),j.icon&&(f.value.icon=j.icon),h.value=_l(),d.value=!1}return new Promise((U,X)=>{T=U,A=X})}function F(){const j=m.value;if(j){V.value?.showMessage(j);return}y.value=!0,N.saveCategory({category:f.value,isEdit:!!s.value,clientSessionId:h.value}).then(()=>{y.value=!1;let B="You have saved this category";s.value||(B="You have added a new category"),T?.({message:B}),p.value=!1}).catch(B=>{y.value=!1,B.processed||V.value?.showError(B)})}function S(){A?.(),p.value=!1}return _({open:I}),(j,B)=>{const U=Ve("ItemIcon"),X=Ve("icon-select"),oe=Ve("color-select");return l(),g(fe,null,[t(xt,{width:"800",persistent:w.value,modelValue:p.value,"onUpdate:modelValue":B[6]||(B[6]=W=>p.value=W)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",Zk,[o("h4",Xk,i(e(n)(e(x))),1),e(d)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)])]),default:a(()=>[t(ge,{class:"d-flex flex-column flex-md-row flex-grow-1 overflow-y-auto"},{default:a(()=>[t(jt,{class:"w-100 mt-2"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"12"},{default:a(()=>[t(ot,{type:"text","persistent-placeholder":"",disabled:e(d)||e(y),label:e(n)("Category Name"),placeholder:e(n)("Category Name"),modelValue:e(f).name,"onUpdate:modelValue":B[0]||(B[0]=W=>e(f).name=W)},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),e(s)&&e(f).parentId&&e(f).parentId!=="0"?(l(),c(R,{key:0,cols:"12",md:"12"},{default:a(()=>[t(Ge,{"item-title":"name","item-value":"id","persistent-placeholder":"",disabled:e(d)||e(y),label:e(n)("Primary Category"),placeholder:e(n)("Primary Category"),items:e(b),"no-data-text":e(n)("No available primary category"),modelValue:e(f).parentId,"onUpdate:modelValue":B[1]||(B[1]=W=>e(f).parentId=W)},{item:a(({props:W,item:D})=>[t(ve,Wi(Gi(W)),{prepend:a(()=>[t(U,{class:"me-2","icon-type":"category","icon-id":D.raw.icon,color:D.raw.color},null,8,["icon-id","color"])]),title:a(()=>[o("div",e_,i(D.raw.name),1)]),_:2},1040)]),_:1},8,["disabled","label","placeholder","items","no-data-text","modelValue"])]),_:1})):r("",!0),t(R,{cols:"12",md:"6"},{default:a(()=>[t(X,{"icon-type":"category","all-icon-infos":e(Rd),label:e(n)("Category Icon"),color:e(f).color,disabled:e(d)||e(y),modelValue:e(f).icon,"onUpdate:modelValue":B[2]||(B[2]=W=>e(f).icon=W)},null,8,["all-icon-infos","label","color","disabled","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(oe,{"all-color-infos":e(qd),label:e(n)("Category Color"),disabled:e(d)||e(y),modelValue:e(f).color,"onUpdate:modelValue":B[3]||(B[3]=W=>e(f).color=W)},null,8,["all-color-infos","label","disabled","modelValue"])]),_:1}),t(R,{cols:"12",md:"12"},{default:a(()=>[t(Oa,{type:"text","persistent-placeholder":"",rows:"3",disabled:e(d)||e(y),label:e(n)("Description"),placeholder:e(n)("Your category description (optional)"),modelValue:e(f).comment,"onUpdate:modelValue":B[4]||(B[4]=W=>e(f).comment=W)},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),e(s)?(l(),c(R,{key:1,class:"py-0",cols:"12",md:"12"},{default:a(()=>[t(Ea,{disabled:e(d)||e(y),label:e(n)("Visible"),modelValue:e(f).visible,"onUpdate:modelValue":B[5]||(B[5]=W=>e(f).visible=W)},null,8,["disabled","label","modelValue"])]),_:1})):r("",!0)]),_:1})]),_:1})]),_:1}),t(ge,null,{default:a(()=>[o("div",t_,[t(vt,{disabled:!e(k),text:e(m)?e(n)(e(m)):""},{activator:a(({props:W})=>[o("div",_t(W,{class:"d-inline-block"}),[t(H,{disabled:e(k)||e(d)||e(y),onClick:F},{default:a(()=>[q(i(e(n)(e(u)))+" ",1),e(y)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])],16)]),_:1},8,["disabled","text"]),t(H,{color:"secondary",variant:"tonal",disabled:e(d)||e(y),onClick:S},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["persistent","modelValue"]),t(ct,{ref_key:"snackbar",ref:V},null,512)],64)}}}),l_={class:"d-flex align-center"},n_={class:"text-h4"},o_={class:"d-flex align-center mb-1"},s_={class:"ms-3"},i_={class:"ms-3"},r_={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},u_=Oe({__name:"PresetDialog",props:{categoryType:{},show:{type:Boolean}},emits:["update:show","category:saved"],setup(v,{emit:_}){const n=v,s=_,{tt:h,getCurrentLanguageTag:d,getAllTransactionDefaultCategories:y}=je(),f=va(),b=xe("snackbar"),x=P(d()),u=P(!1),m=E(()=>y(n.categoryType,x.value)),k=E({get:()=>n.show,set:p=>s("update:show",p)});function N(p){switch(p){case st.Income:return h("Income Categories");case st.Expense:return h("Expense Categories");case st.Transfer:return h("Transfer Categories");default:return h("Transaction Categories")}}function V(){u.value=!0;const p=pi(m.value),T=Yd(p);f.addPresetCategories({categories:T}).then(()=>{u.value=!1,k.value=!1,s("category:saved",{message:"You have added preset categories"})}).catch(A=>{u.value=!1,A.processed||b.value?.showError(A)})}return(p,T)=>{const A=Ve("language-select-button"),w=Ve("ItemIcon");return l(),g(fe,null,[t(xt,{width:"800",persistent:u.value,modelValue:k.value,"onUpdate:modelValue":T[2]||(T[2]=I=>k.value=I)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",l_,[o("h4",n_,i(e(h)("Default Categories")),1)])]),default:a(()=>[t(ge,{class:"preset-transaction-categories flex-grow-1 overflow-y-auto"},{default:a(()=>[(l(!0),g(fe,null,$e(m.value,(I,F)=>(l(),g(fe,{key:F},[o("div",o_,[o("h4",null,i(N(parseInt(F))),1),t(it),t(A,{disabled:u.value,"use-model-value":!0,modelValue:x.value,"onUpdate:modelValue":T[0]||(T[0]=S=>x.value=S)},null,8,["disabled","modelValue"])]),t(Yl,{class:"border rounded mb-2",variant:"accordion",multiple:"",disabled:u.value},{default:a(()=>[(l(!0),g(fe,null,$e(I,(S,j)=>(l(),c(jl,{key:j},{default:a(()=>[t(Hl,{class:"py-0"},{default:a(()=>[t(w,{"icon-type":"category","icon-id":S.icon,color:S.color},null,8,["icon-id","color"]),o("span",s_,i(S.name),1)]),_:2},1024),S.subCategories.length?(l(),c(Wl,{key:0},{default:a(()=>[t(Je,{rounded:"",density:"comfortable",class:"pa-0"},{default:a(()=>[(l(!0),g(fe,null,$e(S.subCategories,(B,U)=>(l(),g(fe,{key:U},[t(ve,null,{prepend:a(()=>[t(w,{"icon-type":"category","icon-id":B.icon,color:B.color},null,8,["icon-id","color"])]),default:a(()=>[o("span",i_,i(B.name),1)]),_:2},1024),U!==S.subCategories.length-1?(l(),c(nt,{key:0})):r("",!0)],64))),128))]),_:2},1024)]),_:2},1024)):r("",!0)]),_:2},1024))),128))]),_:2},1032,["disabled"])],64))),128))]),_:1}),t(ge,null,{default:a(()=>[o("div",r_,[t(H,{disabled:u.value,onClick:V},{default:a(()=>[q(i(e(h)("Save"))+" ",1),u.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"]),t(H,{color:"secondary",density:"default",variant:"tonal",disabled:u.value,onClick:T[1]||(T[1]=I=>k.value=!1)},{default:a(()=>[q(i(e(h)("Cancel")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["persistent","modelValue"]),t(ct,{ref_key:"snackbar",ref:b},null,512)],64)}}});function d_(v){if(!v)return 0;const _=window.getComputedStyle(v);return["height","padding-top","padding-bottom","margin-top","margin-bottom"].map(n=>parseInt(_.getPropertyValue(n),10)).reduce((n,s)=>n+s)}function c_(v){if(!v)return 0;const _=v.querySelectorAll(".v-navigation-drawer__content");if(!_||!_[0])return 0;const n=_[0].children;if(!n||n.length<1)return 0;let s=0;for(let h=0;h<n.length;h++)s+=d_(n[h]);return s}function sn(v,_){if(!v)return;const n=v.querySelector(_);if(!n||!n)return;const s=n;s.focus(),s.select()}const m_={class:"mx-6 my-4"},p_={class:"text-truncate"},v_={class:"text-truncate"},f_={class:"title-and-toolbar d-flex align-center"},y_={class:"d-flex align-center"},g_={key:0},h_={class:"px-0"},b_={key:1},T_={class:"d-flex align-center"},k_={key:0,class:"transaction-category-table-row text-sm"},__={class:"d-flex align-center"},x_=["onClick"],C_={class:"d-flex flex-column py-2"},w_={class:"ms-2"},A_={class:"transaction-category-comment ms-2"},S_={class:"ms-2"},V_=Oe({__name:"ListPage",setup(v){const _=Rl(),{tt:n}=je(),{loading:s,primaryCategoryId:h,currentPrimaryCategory:d}=jd(),y=va(),f=xe("navbar"),b=xe("confirmDialog"),x=xe("snackbar"),u=xe("editDialog"),m=P(st.Expense),k=P("categoryPage"),N=P(!1),V=P({}),p=P({}),T=P(!1),A=P(680),w=P(_.mdAndUp.value),I=P(_.mdAndUp.value),F=P(!1),S=P(!1),j=E(()=>!y.allTransactionCategories||!y.allTransactionCategories[m.value]?[]:y.allTransactionCategories[m.value]??[]),B=E(()=>!y.allTransactionCategoriesMap||!y.allTransactionCategoriesMap[h.value]?[]:y.allTransactionCategoriesMap[h.value]?.subCategories??[]),U=E(()=>!h.value||h.value===""||h.value==="0"),X=E(()=>U.value?j.value:B.value),oe=E(()=>Hd(X.value,F.value)),W=E(()=>X.value.length<1),D=E(()=>Wd(X.value,F.value));function $(){ha(()=>{if(f.value&&f.value.$el&&f.value.$el.nextElementSibling){const z=c_(f.value.$el.nextElementSibling);A.value=Math.max(z,680)}})}function C(z){return!z||z.hidden?!1:!z.parentId||z.parentId===""||z.parentId==="0"}function M(){h.value="0",$()}function ee(z){!z||z.hidden||((!z.parentId||z.parentId===""||z.parentId==="0")&&(h.value=z.id),$())}function ye(z){s.value=!0,y.loadAllCategories({force:z}).then(()=>{s.value=!1,T.value=!1,z&&x.value?.showMessage("Category list has been updated"),$()}).catch(se=>{s.value=!1,se&&se.isUpToDate&&(T.value=!1),se.processed||x.value?.showError(se)})}function L(){u.value?.open({type:m.value,parentId:h.value,color:d.value?.color,icon:d.value?.icon}).then(z=>{z&&z.message&&x.value?.showMessage(z.message),$()}).catch(z=>{z&&x.value?.showError(z)})}function Y(z){u.value?.open({id:z.id,currentCategory:z}).then(se=>{se&&se.message&&x.value?.showMessage(se.message),y.transactionCategoryListStateInvalid&&ye(!0),$()}).catch(se=>{se&&x.value?.showError(se)})}function O(z,se){N.value=!0,V.value[z.id]=!0,y.hideCategory({category:z,hidden:se}).then(()=>{N.value=!1,V.value[z.id]=!1,$()}).catch(ue=>{N.value=!1,V.value[z.id]=!1,ue.processed||x.value?.showError(ue)})}function J(z){b.value?.open("Are you sure you want to delete this category?").then(()=>{N.value=!0,p.value[z.id]=!0,y.deleteCategory({category:z}).then(()=>{N.value=!1,p.value[z.id]=!1,$()}).catch(se=>{N.value=!1,p.value[z.id]=!1,se.processed||x.value?.showError(se)})})}function ae(){T.value&&(s.value=!0,y.updateCategoryDisplayOrders({type:m.value,parentId:h.value}).then(()=>{s.value=!1,T.value=!1}).catch(z=>{s.value=!1,z.processed||x.value?.showError(z)}))}function Z(z){if(!z||!z.moved)return;const se=z.moved;if(!se.element||!se.element.id){x.value?.showMessage("Unable to move category");return}y.changeCategoryDisplayOrder({categoryId:se.element.id,from:se.oldIndex,to:se.newIndex}).then(()=>{T.value=!0}).catch(ue=>{x.value?.showError(ue)})}function le(z){z&&z.message&&(x.value?.showMessage(z.message),ye(!1))}return Ft(()=>_.mdAndUp.value,z=>{w.value=z,I.value||(I.value=z)}),ye(!1),(z,se)=>{const ue=Ve("btn-vertical-group"),Ee=Ve("ItemIcon"),me=Ve("draggable-list");return l(),g(fe,null,[t(Ae,{class:"match-height"},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,null,{default:a(()=>[t(Jl,null,{default:a(()=>[t(e(Zl),{ref_key:"navbar",ref:f,permanent:w.value,modelValue:I.value,"onUpdate:modelValue":se[2]||(se[2]=te=>I.value=te)},{default:a(()=>[o("div",m_,[t(ue,{disabled:e(s),buttons:[{name:e(n)("Expense"),value:e(st).Expense},{name:e(n)("Income"),value:e(st).Income},{name:e(n)("Transfer"),value:e(st).Transfer}],modelValue:m.value,"onUpdate:modelValue":[se[0]||(se[0]=te=>m.value=te),M]},null,8,["disabled","buttons","modelValue"])]),t(nt),t(Ja,{"show-arrows":"",class:"my-4",direction:"vertical",disabled:e(s),modelValue:e(h),"onUpdate:modelValue":se[1]||(se[1]=te=>ht(h)?h.value=te:null)},{default:a(()=>[t(Wt,{class:"tab-text-truncate",value:"0",onClick:M},{default:a(()=>[o("span",p_,i(e(n)("Primary Categories")),1)]),_:1}),(l(!0),g(fe,null,$e(j.value,te=>(l(),g(fe,{key:te.id},[te.hidden?r("",!0):(l(),c(Wt,{key:0,class:"tab-text-truncate",value:te.id,onClick:Se=>ee(te)},{default:a(()=>[o("span",v_,i(te.name),1)]),_:2},1032,["value","onClick"]))],64))),128)),e(s)&&(!j.value||j.value.length<1)?(l(),g(fe,{key:0},$e([1,2,3,4,5,6,7,8,9,10],te=>t(ft,{class:"skeleton-no-margin mx-5 mt-4 mb-3",type:"text",key:te,loading:!0})),64)):r("",!0)]),_:1},8,["disabled","modelValue"])]),_:1},8,["permanent","modelValue"]),t(Xl,null,{default:a(()=>[t(qa,{class:"d-flex flex-grow-1 disable-tab-transition w-100-window-container",modelValue:k.value,"onUpdate:modelValue":se[9]||(se[9]=te=>k.value=te)},{default:a(()=>[t(zt,{value:"categoryPage"},{default:a(()=>[t(Me,{variant:"flat","min-height":A.value},{title:a(()=>[o("div",f_,[t(H,{class:"me-3 d-md-none",density:"compact",color:"default",variant:"plain",ripple:!1,icon:!0,onClick:se[3]||(se[3]=te=>I.value=!I.value)},{default:a(()=>[t(ie,{icon:e(ql),size:"24"},null,8,["icon"])]),_:1}),o("span",null,i(e(n)("Transaction Categories")),1),t(H,{class:"ms-3",color:"default",variant:"outlined",disabled:e(s)||N.value,onClick:L},{default:a(()=>[q(i(e(n)("Add")),1)]),_:1},8,["disabled"]),T.value?(l(),c(H,{key:0,class:"ms-3",color:"primary",variant:"tonal",disabled:e(s)||N.value,onClick:ae},{default:a(()=>[q(i(e(n)("Save Display Order")),1)]),_:1},8,["disabled"])):r("",!0),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,loading:e(s)||N.value,onClick:se[4]||(se[4]=te=>ye(!0))},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Refresh")),1)]),_:1})]),_:1},8,["loading"]),t(it),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",disabled:e(s)||N.value,icon:!0},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[F.value?r("",!0):(l(),c(ve,{key:0,"prepend-icon":e(Ma),title:e(n)("Show Hidden Transaction Categories"),onClick:se[5]||(se[5]=te=>F.value=!0)},null,8,["prepend-icon","title"])),F.value?(l(),c(ve,{key:1,"prepend-icon":e(da),title:e(n)("Hide Hidden Transaction Categories"),onClick:se[6]||(se[6]=te=>F.value=!1)},null,8,["prepend-icon","title"])):r("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])])]),default:a(()=>[t(sl,{class:"transaction-category-table table-striped",hover:!e(s)},{default:a(()=>[o("thead",null,[o("tr",null,[o("th",null,[o("div",y_,[o("span",null,i(e(n)("Category Name")),1),t(it),o("span",null,i(e(n)("Operation")),1)])])])]),e(s)&&oe.value?(l(),g("tbody",g_,[(l(),g(fe,null,$e([1,2,3,4,5,6,7,8,9,10],te=>o("tr",{key:te},[o("td",h_,[t(ft,{type:"text",loading:!0})])])),64))])):r("",!0),!e(s)&&oe.value?(l(),g("tbody",b_,[o("tr",null,[o("td",null,[o("div",T_,[o("span",null,i(e(n)("No available category")),1),U.value&&W.value?(l(),c(H,{key:0,class:"ms-3",color:"default",variant:"outlined",onClick:se[7]||(se[7]=te=>S.value=!0)},{default:a(()=>[q(i(e(n)("Add Default Categories")),1)]),_:1})):r("",!0)])])])])):r("",!0),t(me,{tag:"tbody","item-key":"id",handle:".drag-handle","ghost-class":"dragging-item",disabled:oe.value,modelValue:X.value,"onUpdate:modelValue":se[8]||(se[8]=te=>X.value=te),onChange:Z},{item:a(({element:te})=>[F.value||!te.hidden?(l(),g("tr",k_,[o("td",null,[o("div",__,[o("div",{class:be(["d-flex align-center",{"cursor-pointer":C(te)}]),onClick:Se=>ee(te)},[t(Ee,{"icon-type":"category","icon-id":te.icon,color:te.color,"hidden-status":te.hidden},null,8,["icon-id","color","hidden-status"]),o("div",C_,[o("span",w_,i(te.name),1),o("span",A_,i(te.comment),1)])],10,x_),t(it),t(H,{class:be(["px-2 ms-2",{"d-none":e(s),"hover-display":!e(s)}]),color:"default",density:"comfortable",variant:"text","prepend-icon":te.hidden?e(Ma):e(da),loading:V.value[te.id],disabled:e(s)||N.value,onClick:Se=>O(te,!te.hidden)},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20",width:"2"})]),default:a(()=>[q(" "+i(te.hidden?e(n)("Show"):e(n)("Hide")),1)]),_:2},1032,["class","prepend-icon","loading","disabled","onClick"]),t(H,{class:be(["px-2",{"d-none":e(s),"hover-display":!e(s)}]),color:"default",density:"comfortable",variant:"text","prepend-icon":e(hn),disabled:e(s)||N.value,onClick:Se=>Y(te)},{default:a(()=>[q(i(e(n)("Edit")),1)]),_:1},8,["class","prepend-icon","disabled","onClick"]),t(H,{class:be(["px-2",{"d-none":e(s),"hover-display":!e(s)}]),color:"default",density:"comfortable",variant:"text","prepend-icon":e(bn),loading:p.value[te.id],disabled:e(s)||N.value,onClick:Se=>J(te)},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20",width:"2"})]),default:a(()=>[q(" "+i(e(n)("Delete")),1)]),_:1},8,["class","prepend-icon","loading","disabled","onClick"]),o("span",S_,[t(ie,{class:be(!e(s)&&!N.value&&D.value>1?"drag-handle":"disabled"),icon:e(yn)},null,8,["class","icon"]),!e(s)&&!N.value&&D.value>1?(l(),c(vt,{key:0,activator:"parent"},{default:a(()=>[q(i(e(n)("Drag to Reorder")),1)]),_:1})):r("",!0)])])])])):r("",!0)]),_:1},8,["disabled","modelValue"])]),_:1},8,["hover"])]),_:1},8,["min-height"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(a_,{ref_key:"editDialog",ref:u},null,512),t(u_,{"category-type":m.value,show:S.value,"onUpdate:show":se[10]||(se[10]=te=>S.value=te),"onCategory:saved":le},null,8,["category-type","show"]),t(ka,{ref_key:"confirmDialog",ref:b},null,512),t(ct,{ref_key:"snackbar",ref:x},null,512)],64)}}}),I_={class:"title-and-toolbar d-flex align-center"},D_={class:"d-flex align-center"},$_={key:0},N_={class:"px-0"},F_={key:1},E_={key:0,class:"transaction-tags-table-row-tag text-sm"},M_={class:"d-flex align-center"},U_={key:0,class:"d-flex align-center"},P_={class:"transaction-tag-name"},B_={class:"ms-2"},L_={key:2},z_={class:"d-flex align-center"},O_={class:"ms-2"},R_=Oe({__name:"ListPage",setup(v){const{tt:_}=je(),n=rl(),s=xe("confirmDialog"),h=xe("snackbar"),d=P(null),y=P(vo.createNewTag()),f=P(!0),b=P(!1),x=P({}),u=P({}),m=P({}),k=P(!1),N=P(!1),V=E(()=>n.allTransactionTags),p=E(()=>Gd(V.value,N.value)),T=E(()=>Kd(V.value,N.value)),A=E(()=>!!(d.value||y.value.id&&y.value.id!==""));function w(D){return D.id?y.value.name!==""&&y.value.name!==D.name:D.name!==""}function I(){A.value||(f.value=!0,n.loadAllTags({force:!0}).then(()=>{f.value=!1,k.value=!1,h.value?.showMessage("Tag list has been updated")}).catch(D=>{f.value=!1,D&&D.isUpToDate&&(k.value=!1),D.processed||h.value?.showError(D)}))}function F(){d.value=vo.createNewTag()}function S(D){y.value.id=D.id,y.value.name=D.name}function j(D){b.value=!0,x.value[D.id||""]=!0,n.saveTag({tag:D}).then(()=>{b.value=!1,x.value[D.id||""]=!1,D.id?(y.value.id="",y.value.name=""):d.value=null}).catch($=>{b.value=!1,x.value[D.id||""]=!1,$.processed||h.value?.showError($)})}function B(D){D.id?(y.value.id="",y.value.name=""):d.value=null}function U(){k.value&&(f.value=!0,n.updateTagDisplayOrders().then(()=>{f.value=!1,k.value=!1}).catch(D=>{f.value=!1,D.processed||h.value?.showError(D)}))}function X(D,$){b.value=!0,u.value[D.id]=!0,n.hideTag({tag:D,hidden:$}).then(()=>{b.value=!1,u.value[D.id]=!1}).catch(C=>{b.value=!1,u.value[D.id]=!1,C.processed||h.value?.showError(C)})}function oe(D){s.value?.open("Are you sure you want to delete this tag?").then(()=>{b.value=!0,m.value[D.id]=!0,n.deleteTag({tag:D}).then(()=>{b.value=!1,m.value[D.id]=!1}).catch($=>{b.value=!1,m.value[D.id]=!1,$.processed||h.value?.showError($)})})}function W(D){if(!D||!D.moved)return;const $=D.moved;if(!$.element||!$.element.id){h.value?.showMessage("Unable to move tag");return}n.changeTagDisplayOrder({tagId:$.element.id,from:$.oldIndex,to:$.newIndex}).then(()=>{k.value=!0}).catch(C=>{h.value?.showError(C)})}return n.loadAllTags({force:!1}).then(()=>{f.value=!1}).catch(D=>{f.value=!1,D.processed||h.value?.showError(D)}),(D,$)=>{const C=Ve("draggable-list");return l(),g(fe,null,[t(Ae,{class:"match-height"},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,null,{title:a(()=>[o("div",I_,[o("span",null,i(e(_)("Transaction Tags")),1),t(H,{class:"ms-3",color:"default",variant:"outlined",disabled:f.value||b.value||A.value,onClick:F},{default:a(()=>[q(i(e(_)("Add")),1)]),_:1},8,["disabled"]),k.value?(l(),c(H,{key:0,class:"ms-3",color:"primary",variant:"tonal",disabled:f.value||b.value||A.value,onClick:U},{default:a(()=>[q(i(e(_)("Save Display Order")),1)]),_:1},8,["disabled"])):r("",!0),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,disabled:f.value||b.value||A.value,loading:f.value,onClick:I},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(_)("Refresh")),1)]),_:1})]),_:1},8,["disabled","loading"]),t(it),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",disabled:f.value||b.value||A.value,icon:!0},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[N.value?r("",!0):(l(),c(ve,{key:0,"prepend-icon":e(Ma),title:e(_)("Show Hidden Transaction Tags"),onClick:$[0]||($[0]=M=>N.value=!0)},null,8,["prepend-icon","title"])),N.value?(l(),c(ve,{key:1,"prepend-icon":e(da),title:e(_)("Hide Hidden Transaction Tags"),onClick:$[1]||($[1]=M=>N.value=!1)},null,8,["prepend-icon","title"])):r("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])])]),default:a(()=>[t(sl,{class:"transaction-tags-table table-striped",hover:!f.value},{default:a(()=>[o("thead",null,[o("tr",null,[o("th",null,[o("div",D_,[o("span",null,i(e(_)("Tag Title")),1),t(it),o("span",null,i(e(_)("Operation")),1)])])])]),f.value&&p.value&&!d.value?(l(),g("tbody",$_,[(l(),g(fe,null,$e([1,2,3],M=>o("tr",{key:M},[o("td",N_,[t(ft,{type:"text",loading:!0})])])),64))])):r("",!0),!f.value&&p.value&&!d.value?(l(),g("tbody",F_,[o("tr",null,[o("td",null,i(e(_)("No available tag")),1)])])):r("",!0),t(C,{tag:"tbody","item-key":"id",handle:".drag-handle","ghost-class":"dragging-item",class:be({"has-bottom-border":d.value}),disabled:p.value,modelValue:V.value,"onUpdate:modelValue":$[6]||($[6]=M=>V.value=M),onChange:W},{item:a(({element:M})=>[N.value||!M.hidden?(l(),g("tr",E_,[o("td",null,[o("div",M_,[y.value.id!==M.id?(l(),g("div",U_,[M.hidden?(l(),c(Il,{key:0,class:"right-bottom-icon",color:"secondary",location:"bottom right","offset-x":"8",icon:e(da)},{default:a(()=>[t(ie,{size:"20",start:"",icon:e(ea)},null,8,["icon"])]),_:1},8,["icon"])):M.hidden?r("",!0):(l(),c(ie,{key:1,size:"20",start:"",icon:e(ea)},null,8,["icon"])),o("span",P_,i(M.name),1)])):y.value.id===M.id?(l(),c(ot,{key:1,class:"w-100 me-2",type:"text",density:"compact",variant:"underlined",disabled:f.value||b.value,placeholder:e(_)("Tag Title"),modelValue:y.value.name,"onUpdate:modelValue":$[2]||($[2]=ee=>y.value.name=ee),onKeyup:$[3]||($[3]=Gt(ee=>j(y.value),["enter"]))},{prepend:a(()=>[M.hidden?(l(),c(Il,{key:0,class:"right-bottom-icon",color:"secondary",location:"bottom right","offset-x":"8",icon:e(da)},{default:a(()=>[t(ie,{size:"20",start:"",icon:e(ea)},null,8,["icon"])]),_:1},8,["icon"])):M.hidden?r("",!0):(l(),c(ie,{key:1,size:"20",start:"",icon:e(ea)},null,8,["icon"]))]),_:2},1032,["disabled","placeholder","modelValue"])):r("",!0),t(it),y.value.id!==M.id?(l(),c(H,{key:2,class:be(["px-2 ms-2",{"d-none":f.value,"hover-display":!f.value}]),color:"default",density:"comfortable",variant:"text","prepend-icon":M.hidden?e(Ma):e(da),loading:u.value[M.id],disabled:f.value||b.value,onClick:ee=>X(M,!M.hidden)},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20",width:"2"})]),default:a(()=>[q(" "+i(M.hidden?e(_)("Show"):e(_)("Hide")),1)]),_:2},1032,["class","prepend-icon","loading","disabled","onClick"])):r("",!0),y.value.id!==M.id?(l(),c(H,{key:3,class:be(["px-2",{"d-none":f.value,"hover-display":!f.value}]),color:"default",density:"comfortable",variant:"text","prepend-icon":e(hn),loading:x.value[M.id],disabled:f.value||b.value,onClick:ee=>S(M)},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20",width:"2"})]),default:a(()=>[q(" "+i(e(_)("Edit")),1)]),_:1},8,["class","prepend-icon","loading","disabled","onClick"])):r("",!0),y.value.id!==M.id?(l(),c(H,{key:4,class:be(["px-2",{"d-none":f.value,"hover-display":!f.value}]),color:"default",density:"comfortable",variant:"text","prepend-icon":e(bn),loading:m.value[M.id],disabled:f.value||b.value,onClick:ee=>oe(M)},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20",width:"2"})]),default:a(()=>[q(" "+i(e(_)("Delete")),1)]),_:1},8,["class","prepend-icon","loading","disabled","onClick"])):r("",!0),y.value.id===M.id?(l(),c(H,{key:5,class:"px-2",density:"comfortable",variant:"text","prepend-icon":e(Xe),loading:x.value[M.id],disabled:f.value||b.value||!w(M),onClick:$[4]||($[4]=ee=>j(y.value))},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20",width:"2"})]),default:a(()=>[q(" "+i(e(_)("Save")),1)]),_:1},8,["prepend-icon","loading","disabled"])):r("",!0),y.value.id===M.id?(l(),c(H,{key:6,class:"px-2",color:"default",density:"comfortable",variant:"text","prepend-icon":e(vl),disabled:f.value||b.value,onClick:$[5]||($[5]=ee=>B(y.value))},{default:a(()=>[q(i(e(_)("Cancel")),1)]),_:1},8,["prepend-icon","disabled"])):r("",!0),o("span",B_,[t(ie,{class:be(!f.value&&!b.value&&!A.value&&T.value>1?"drag-handle":"disabled"),icon:e(yn)},null,8,["class","icon"]),!f.value&&!b.value&&!A.value&&T.value>1?(l(),c(vt,{key:0,activator:"parent"},{default:a(()=>[q(i(e(_)("Drag to Reorder")),1)]),_:1})):r("",!0)])])])])):r("",!0)]),_:1},8,["class","disabled","modelValue"]),d.value?(l(),g("tbody",L_,[o("tr",{class:be(["text-sm",{"even-row":(T.value&1)===1}])},[o("td",null,[o("div",z_,[t(ot,{class:"w-100 me-2",type:"text",color:"primary",density:"compact",variant:"underlined",disabled:f.value||b.value,placeholder:e(_)("Tag Title"),modelValue:d.value.name,"onUpdate:modelValue":$[7]||($[7]=M=>d.value.name=M),onKeyup:$[8]||($[8]=Gt(M=>j(d.value),["enter"]))},{prepend:a(()=>[t(ie,{size:"20",start:"",icon:e(ea)},null,8,["icon"])]),_:1},8,["disabled","placeholder","modelValue"]),t(it),t(H,{class:"px-2",density:"comfortable",variant:"text","prepend-icon":e(Xe),loading:x.value[""],disabled:f.value||b.value||!w(d.value),onClick:$[9]||($[9]=M=>j(d.value))},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20",width:"2"})]),default:a(()=>[q(" "+i(e(_)("Save")),1)]),_:1},8,["prepend-icon","loading","disabled"]),t(H,{class:"px-2",color:"default",density:"comfortable",variant:"text","prepend-icon":e(vl),disabled:f.value||b.value,onClick:$[10]||($[10]=M=>B(d.value))},{default:a(()=>[q(i(e(_)("Cancel")),1)]),_:1},8,["prepend-icon","disabled"]),o("span",O_,[t(ie,{class:"disabled",icon:e(yn)},null,8,["icon"])])])])],2)])):r("",!0)]),_:1},8,["hover"])]),_:1})]),_:1})]),_:1}),t(ka,{ref_key:"confirmDialog",ref:s},null,512),t(ct,{ref_key:"snackbar",ref:h},null,512)],64)}}}),q_={class:"title-and-toolbar d-flex align-center"},Y_={class:"d-flex align-center"},j_={key:0},H_={class:"px-0"},W_={key:1},G_={key:0},K_={key:1},Q_={key:2},J_={key:0,class:"transaction-templates-table-row text-sm"},Z_={class:"d-flex align-center"},X_={class:"d-flex align-center"},ex={class:"transaction-template-name"},tx={class:"ms-2"},Bs=Oe({__name:"ListPage",props:{initType:{}},setup(v){const _=v,{tt:n}=je(),s=rs(),h=xe("confirmDialog"),d=xe("snackbar"),y=xe("editDialog"),f=P(Da.Normal.type),b=P(!0),x=P(!1),u=P({}),m=P({}),k=P(!1),N=P(!1),V=E(()=>s.allTransactionTemplates[f.value]||[]),p=E(()=>Qd(V.value,N.value)),T=E(()=>Jd(V.value,N.value));function A(){f.value=_.initType,b.value=!0,s.loadAllTemplates({templateType:f.value,force:!1}).then(()=>{b.value=!1}).catch(X=>{b.value=!1,X.processed||d.value?.showError(X)})}function w(){b.value=!0,s.loadAllTemplates({templateType:f.value,force:!0}).then(()=>{b.value=!1,k.value=!1,d.value?.showMessage("Template list has been updated")}).catch(X=>{b.value=!1,X&&X.isUpToDate&&(k.value=!1),X.processed||d.value?.showError(X)})}function I(){y.value?.open({templateType:f.value}).then(X=>{X&&X.message&&d.value?.showMessage(X.message)}).catch(X=>{X&&d.value?.showError(X)})}function F(X){y.value?.open({id:X.id,currentTemplate:X}).then(oe=>{oe&&oe.message&&d.value?.showMessage(oe.message)}).catch(oe=>{oe&&d.value?.showError(oe)})}function S(X,oe){x.value=!0,u.value[X.id]=!0,s.hideTemplate({template:X,hidden:oe}).then(()=>{x.value=!1,u.value[X.id]=!1}).catch(W=>{x.value=!1,u.value[X.id]=!1,W.processed||d.value?.showError(W)})}function j(X){h.value?.open("Are you sure you want to delete this template?").then(()=>{x.value=!0,m.value[X.id]=!0,s.deleteTemplate({template:X}).then(()=>{x.value=!1,m.value[X.id]=!1}).catch(oe=>{x.value=!1,m.value[X.id]=!1,oe.processed||d.value?.showError(oe)})})}function B(){k.value&&(b.value=!0,s.updateTemplateDisplayOrders({templateType:f.value}).then(()=>{b.value=!1,k.value=!1}).catch(X=>{b.value=!1,X.processed||d.value?.showError(X)}))}function U(X){if(!X||!X.moved)return;const oe=X.moved;if(!oe.element||!oe.element.id){d.value?.showMessage("Unable to move template");return}s.changeTemplateDisplayOrder({templateType:f.value,templateId:oe.element.id,from:oe.oldIndex,to:oe.newIndex}).then(()=>{k.value=!0}).catch(W=>{d.value?.showError(W)})}return A(),(X,oe)=>{const W=Ve("draggable-list");return l(),g(fe,null,[t(Ae,{class:"match-height"},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,null,{title:a(()=>[o("div",q_,[o("span",null,i(f.value===e(Da).Schedule.type?e(n)("Scheduled Transactions"):e(n)("Transaction Templates")),1),t(H,{class:"ms-3",color:"default",variant:"outlined",disabled:b.value||x.value,onClick:I},{default:a(()=>[q(i(e(n)("Add")),1)]),_:1},8,["disabled"]),k.value?(l(),c(H,{key:0,class:"ms-3",color:"primary",variant:"tonal",disabled:b.value||x.value,onClick:B},{default:a(()=>[q(i(e(n)("Save Display Order")),1)]),_:1},8,["disabled"])):r("",!0),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,disabled:b.value||x.value,loading:b.value,onClick:w},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Refresh")),1)]),_:1})]),_:1},8,["disabled","loading"]),t(it),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",disabled:b.value||x.value,icon:!0},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[N.value?r("",!0):(l(),c(ve,{key:0,"prepend-icon":e(Ma),title:e(n)("Show Hidden Transaction Templates"),onClick:oe[0]||(oe[0]=D=>N.value=!0)},null,8,["prepend-icon","title"])),N.value?(l(),c(ve,{key:1,"prepend-icon":e(da),title:e(n)("Hide Hidden Transaction Templates"),onClick:oe[1]||(oe[1]=D=>N.value=!1)},null,8,["prepend-icon","title"])):r("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])])]),default:a(()=>[t(sl,{class:"transaction-templates-table table-striped",hover:!b.value},{default:a(()=>[o("thead",null,[o("tr",null,[o("th",null,[o("div",Y_,[o("span",null,i(e(n)("Template Name")),1),t(it),o("span",null,i(e(n)("Operation")),1)])])])]),b.value&&p.value?(l(),g("tbody",j_,[(l(),g(fe,null,$e([1,2,3],D=>o("tr",{key:D},[o("td",H_,[t(ft,{type:"text",loading:!0})])])),64))])):r("",!0),!b.value&&p.value?(l(),g("tbody",W_,[o("tr",null,[f.value===e(Da).Normal.type?(l(),g("td",G_,i(e(n)("No available template. Once you add templates, you can quickly add a new transaction using the dropdown menu of the Add button on the transaction list page")),1)):f.value===e(Da).Schedule.type?(l(),g("td",K_,i(e(n)("No available scheduled transactions")),1)):(l(),g("td",Q_,i(e(n)("No available template")),1))])])):r("",!0),t(W,{tag:"tbody","item-key":"id",handle:".drag-handle","ghost-class":"dragging-item",disabled:p.value,modelValue:V.value,"onUpdate:modelValue":oe[2]||(oe[2]=D=>V.value=D),onChange:U},{item:a(({element:D})=>[N.value||!D.hidden?(l(),g("tr",J_,[o("td",null,[o("div",Z_,[o("div",X_,[D.hidden?(l(),c(Il,{key:0,class:"right-bottom-icon",color:"secondary",location:"bottom right","offset-x":"8",icon:e(da)},{default:a(()=>[t(ie,{size:"20",start:"",icon:f.value===e(Da).Schedule.type?e(Ts):e(Po)},null,8,["icon"])]),_:1},8,["icon"])):D.hidden?r("",!0):(l(),c(ie,{key:1,size:"20",start:"",icon:f.value===e(Da).Schedule.type?e(Ts):e(Po)},null,8,["icon"])),o("span",ex,i(D.name),1)]),t(it),t(H,{class:be(["px-2 ms-2",{"d-none":b.value,"hover-display":!b.value}]),color:"default",density:"comfortable",variant:"text","prepend-icon":D.hidden?e(Ma):e(da),loading:u.value[D.id],disabled:b.value||x.value,onClick:$=>S(D,!D.hidden)},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20",width:"2"})]),default:a(()=>[q(" "+i(D.hidden?e(n)("Show"):e(n)("Hide")),1)]),_:2},1032,["class","prepend-icon","loading","disabled","onClick"]),t(H,{class:be(["px-2",{"d-none":b.value,"hover-display":!b.value}]),color:"default",density:"comfortable",variant:"text","prepend-icon":e(hn),disabled:b.value||x.value,onClick:$=>F(D)},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20",width:"2"})]),default:a(()=>[q(" "+i(e(n)("Edit")),1)]),_:1},8,["class","prepend-icon","disabled","onClick"]),t(H,{class:be(["px-2",{"d-none":b.value,"hover-display":!b.value}]),color:"default",density:"comfortable",variant:"text","prepend-icon":e(bn),loading:m.value[D.id],disabled:b.value||x.value,onClick:$=>j(D)},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20",width:"2"})]),default:a(()=>[q(" "+i(e(n)("Delete")),1)]),_:1},8,["class","prepend-icon","loading","disabled","onClick"]),o("span",tx,[t(ie,{class:be(!b.value&&!x.value&&T.value>1?"drag-handle":"disabled"),icon:e(yn)},null,8,["class","icon"]),!b.value&&!x.value&&T.value>1?(l(),c(vt,{key:0,activator:"parent"},{default:a(()=>[q(i(e(n)("Drag to Reorder")),1)]),_:1})):r("",!0)])])])])):r("",!0)]),_:1},8,["disabled","modelValue"])]),_:1},8,["hover"])]),_:1})]),_:1})]),_:1}),t(vs,{ref_key:"editDialog",ref:y,type:e(Mt).Template},null,8,["type"]),t(ka,{ref_key:"confirmDialog",ref:h},null,512),t(ct,{ref_key:"snackbar",ref:d},null,512)],64)}}}),ax={class:"d-flex align-center justify-center fill-height bg-light-primary"},lx={key:2,class:"avatar-edit-icon"},nx={class:"d-flex flex-column justify-center gap-3"},ox={class:"d-flex text-body-1"},sx={class:"me-1"},ix={key:1},rx={class:"d-flex text-body-1 align-center",style:{height:"40px"}},ux={key:0},dx={key:1},cx=["accept"],mx=Oe({__name:"UserBasicSettingTab",setup(v){const{tt:_}=je(),{newProfile:n,oldProfile:s,emailVerified:h,loading:d,resending:y,saving:f,allAccounts:b,allVisibleAccounts:x,allVisibleCategorizedAccounts:u,allWeekDays:m,allCalendarDisplayTypes:k,allDateDisplayTypes:N,allLongDateFormats:V,allShortDateFormats:p,allLongTimeFormats:T,allShortTimeFormats:A,allFiscalYearFormats:w,allCurrencyDisplayTypes:I,allNumeralSystemTypes:F,allDecimalSeparators:S,allDigitGroupingSymbols:j,allDigitGroupingTypes:B,allCoordinateDisplayTypes:U,allExpenseAmountColorTypes:X,allIncomeAmountColorTypes:oe,allTransactionEditScopeTypes:W,languageTitle:D,supportDigitGroupingSymbol:$,inputIsNotChangedProblemMessage:C,inputInvalidProblemMessage:M,langAndRegionInputInvalidProblemMessage:ee,extendInputInvalidProblemMessage:ye,inputIsNotChanged:L,inputIsInvalid:Y,setCurrentUserProfile:O,reset:J,doAfterProfileUpdate:ae}=Zd(),Z=Za(),le=ta(),z=pa(),se=xe("confirmDialog"),ue=xe("snackbar"),Ee=xe("avatarInput"),me=P(""),te=P(""),Se=P(""),Te=E(()=>le.getUserAvatarUrl(me.value,Se.value));function Ye(){d.value=!0;const ke=[z.loadAllAccounts({force:!1}),le.getCurrentUserProfile()];Promise.all(ke).then(Ie=>{const Et=Ie[1];O(Et),me.value=Et.avatar,te.value=Et.avatarProvider,d.value=!1}).catch(Ie=>{s.value.nickname="",s.value.email="",n.value.nickname="",n.value.email="",d.value=!1,Ie.processed||ue.value?.showError(Ie)})}function He(){const ke=C.value||M.value||ye.value||ee.value;if(ke){ue.value?.showMessage(ke);return}f.value=!0,Z.updateUserProfile(n.value.toProfileUpdateRequest()).then(Ie=>{f.value=!1,ae(Ie.user),ue.value?.showMessage("Your profile has been successfully updated")}).catch(Ie=>{f.value=!1,Ie.processed||ue.value?.showError(Ie)})}function It(ke){if(!ke||!ke.target)return;const Ie=ke.target;if(!Ie.files||!Ie.files.length||!Ie.files[0])return;const Et=Ie.files[0];Ie.value="",f.value=!0,le.updateUserAvatar({avatarFile:Et}).then(yt=>{f.value=!1,yt&&(me.value=yt.avatar,te.value=yt.avatarProvider,Se.value=_l(),O(yt)),ue.value?.showMessage("Your avatar has been successfully updated")}).catch(yt=>{f.value=!1,yt.processed||ue.value?.showError(yt)})}function la(){se.value?.open("Are you sure you want to remove avatar?").then(()=>{f.value=!0,le.removeUserAvatar().then(ke=>{f.value=!1,ke&&(me.value=ke.avatar,te.value=ke.avatarProvider,O(ke)),ue.value?.showMessage("Your profile has been successfully updated")}).catch(ke=>{f.value=!1,ke.processed||ue.value?.showError(ke)})})}function Ot(){y.value=!0,Z.resendVerifyEmailByLoginedUser().then(()=>{y.value=!1,ue.value?.showMessage("Validation email has been sent")}).catch(ke=>{y.value=!1,ke.processed||ue.value?.showError(ke)})}function ze(){Ee.value?.click()}return Ye(),(ke,Ie)=>{const Et=Ve("two-column-select"),yt=Ve("language-select"),Ne=Ve("currency-select"),kt=Ve("fiscal-year-start-select");return l(),g(fe,null,[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,{class:be({disabled:e(d)||e(f)})},{title:a(()=>[o("span",null,i(e(_)("Basic Settings")),1),e(d)?(l(),c(Ze,{key:0,indeterminate:"",size:"20",class:"ms-3"})):r("",!0)]),default:a(()=>[t(ge,{class:"d-flex"},{default:a(()=>[t(ol,{rounded:"lg",variant:"tonal",size:"100",class:be(["me-4 user-profile-avatar-icon",{"cursor-pointer":te.value==="internal","user-profile-avatar-icon-modifiable":te.value==="internal"}]),color:Te.value?"rgba(0,0,0,0)":"primary"},{default:a(()=>[Te.value?(l(),c(wt,{key:0,src:Te.value},{placeholder:a(()=>[o("div",ax,[t(ie,{color:"primary",size:"48",class:"user-profile-avatar-placeholder",icon:e(rn)},null,8,["icon"])])]),_:1},8,["src"])):Te.value?r("",!0):(l(),c(ie,{key:1,size:"48",class:"user-profile-avatar-placeholder",icon:e(rn)},null,8,["icon"])),te.value==="internal"?(l(),g("div",lx,[t(ie,{size:"48",icon:e(zr)},null,8,["icon"])])):r("",!0),te.value==="internal"?(l(),c(mt,{key:3,activator:"parent",width:"200",location:"bottom",offset:"14px"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{disabled:e(f),title:e(_)("Update Avatar"),onClick:ze},null,8,["disabled","title"]),t(ve,{disabled:!Te.value||e(f),title:e(_)("Remove Avatar"),onClick:la},null,8,["disabled","title"])]),_:1})]),_:1})):r("",!0)]),_:1},8,["class","color"]),o("div",nx,[o("div",ox,[o("span",sx,i(e(_)("Username:")),1),e(d)?(l(),c(ft,{key:0,class:"skeleton-no-margin",type:"text",style:{width:"100px"},loading:!0})):r("",!0),e(d)?r("",!0):(l(),g("span",ix,i(e(s).username),1))]),o("div",rx,[!e(d)&&e(h)?(l(),g("span",ux,i(e(_)("Email address is verified")),1)):r("",!0),!e(d)&&!e(h)?(l(),g("span",dx,i(e(_)("Email address is not verified")),1)):r("",!0),e(gn)()&&!e(d)&&!e(h)?(l(),c(H,{key:2,class:"ms-2 px-2",size:"small",variant:"text",disabled:e(d)||e(y),onClick:Ot},{default:a(()=>[q(i(e(_)("Resend Validation Email"))+" ",1),e(y)?(l(),c(Ze,{key:0,indeterminate:"",size:"18",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])):r("",!0),e(d)?(l(),c(ft,{key:3,class:"skeleton-no-margin mt-2 mb-1",type:"text",style:{width:"160px"},loading:!0})):r("",!0)])])]),_:1}),t(nt),t(jt,{class:"mt-6"},{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(ot,{type:"text",autocomplete:"nickname","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Nickname"),placeholder:e(_)("Your nickname"),modelValue:e(n).nickname,"onUpdate:modelValue":Ie[0]||(Ie[0]=Be=>e(n).nickname=Be)},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(ot,{type:"email",autocomplete:"email","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("E-mail"),placeholder:e(_)("Your email address"),modelValue:e(n).email,"onUpdate:modelValue":Ie[1]||(Ie[1]=Be=>e(n).email=Be)},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Et,{"primary-key-field":"id","primary-value-field":"category","primary-title-field":"name","primary-icon-field":"icon","primary-icon-type":"account","primary-sub-items-field":"accounts","primary-title-i18n":!0,"secondary-key-field":"id","secondary-value-field":"id","secondary-title-field":"name","secondary-icon-field":"icon","secondary-icon-type":"account","secondary-color-field":"color",disabled:e(d)||e(f)||!e(x).length,"enable-filter":!0,"filter-placeholder":e(_)("Find account"),"filter-no-items-text":e(_)("No available account"),label:e(_)("Default Account"),placeholder:e(_)("Default Account"),items:e(u),"no-item-text":e(Dl).findAccountNameById(e(b),e(n).defaultAccountId,e(_)("Unspecified")),modelValue:e(n).defaultAccountId,"onUpdate:modelValue":Ie[2]||(Ie[2]=Be=>e(n).defaultAccountId=Be)},null,8,["disabled","filter-placeholder","filter-no-items-text","label","placeholder","items","no-item-text","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Editable Transaction Range"),placeholder:e(_)("Editable Transaction Range"),items:e(W),modelValue:e(n).transactionEditScope,"onUpdate:modelValue":Ie[3]||(Ie[3]=Be=>e(n).transactionEditScope=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1}),t(nt),t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(yt,{disabled:e(d)||e(f),label:e(D),placeholder:e(D),"include-system-default":!0,"use-model-value":!0,modelValue:e(n).language,"onUpdate:modelValue":Ie[4]||(Ie[4]=Be=>e(n).language=Be)},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ne,{disabled:e(d)||e(f),label:e(_)("Default Currency"),placeholder:e(_)("Default Currency"),modelValue:e(n).defaultCurrency,"onUpdate:modelValue":Ie[5]||(Ie[5]=Be=>e(n).defaultCurrency=Be)},null,8,["disabled","label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("First Day of Week"),placeholder:e(_)("First Day of Week"),items:e(m),modelValue:e(n).firstDayOfWeek,"onUpdate:modelValue":Ie[6]||(Ie[6]=Be=>e(n).firstDayOfWeek=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(kt,{"persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Fiscal Year Start Date"),placeholder:e(_)("Fiscal Year Start Date"),"numeral-system":e(n).numeralSystem,modelValue:e(n).fiscalYearStart,"onUpdate:modelValue":Ie[7]||(Ie[7]=Be=>e(n).fiscalYearStart=Be)},null,8,["disabled","label","placeholder","numeral-system","modelValue"])]),_:1})]),_:1})]),_:1}),t(nt),t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Calendar Display Type"),placeholder:e(_)("Calendar Display Type"),items:e(k),modelValue:e(n).calendarDisplayType,"onUpdate:modelValue":Ie[8]||(Ie[8]=Be=>e(n).calendarDisplayType=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Date Display Type"),placeholder:e(_)("Date Display Type"),items:e(N),modelValue:e(n).dateDisplayType,"onUpdate:modelValue":Ie[9]||(Ie[9]=Be=>e(n).dateDisplayType=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Long Date Format"),placeholder:e(_)("Long Date Format"),items:e(V),modelValue:e(n).longDateFormat,"onUpdate:modelValue":Ie[10]||(Ie[10]=Be=>e(n).longDateFormat=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Short Date Format"),placeholder:e(_)("Short Date Format"),items:e(p),modelValue:e(n).shortDateFormat,"onUpdate:modelValue":Ie[11]||(Ie[11]=Be=>e(n).shortDateFormat=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Long Time Format"),placeholder:e(_)("Long Time Format"),items:e(T),modelValue:e(n).longTimeFormat,"onUpdate:modelValue":Ie[12]||(Ie[12]=Be=>e(n).longTimeFormat=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Short Time Format"),placeholder:e(_)("Short Time Format"),items:e(A),modelValue:e(n).shortTimeFormat,"onUpdate:modelValue":Ie[13]||(Ie[13]=Be=>e(n).shortTimeFormat=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Fiscal Year Format"),placeholder:e(_)("Fiscal Year Format"),items:e(w),modelValue:e(n).fiscalYearFormat,"onUpdate:modelValue":Ie[14]||(Ie[14]=Be=>e(n).fiscalYearFormat=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1}),t(nt),t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Currency Display Mode"),placeholder:e(_)("Currency Display Mode"),items:e(I),modelValue:e(n).currencyDisplayType,"onUpdate:modelValue":Ie[15]||(Ie[15]=Be=>e(n).currencyDisplayType=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Numeral System"),placeholder:e(_)("Numeral System"),items:e(F),modelValue:e(n).numeralSystem,"onUpdate:modelValue":Ie[16]||(Ie[16]=Be=>e(n).numeralSystem=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Digit Grouping"),placeholder:e(_)("Digit Grouping"),items:e(B),modelValue:e(n).digitGrouping,"onUpdate:modelValue":Ie[17]||(Ie[17]=Be=>e(n).digitGrouping=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f)||!e($),label:e(_)("Digit Grouping Symbol"),placeholder:e(_)("Digit Grouping Symbol"),items:e(j),modelValue:e(n).digitGroupingSymbol,"onUpdate:modelValue":Ie[18]||(Ie[18]=Be=>e(n).digitGroupingSymbol=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Decimal Separator"),placeholder:e(_)("Decimal Separator"),items:e(S),modelValue:e(n).decimalSeparator,"onUpdate:modelValue":Ie[19]||(Ie[19]=Be=>e(n).decimalSeparator=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1}),t(nt),t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Geographic Location Format"),placeholder:e(_)("Geographic Location Format"),items:e(U),modelValue:e(n).coordinateDisplayType,"onUpdate:modelValue":Ie[20]||(Ie[20]=Be=>e(n).coordinateDisplayType=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1}),t(nt),t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Expense Amount Color"),placeholder:e(_)("Expense Amount Color"),items:e(X),modelValue:e(n).expenseAmountColor,"onUpdate:modelValue":Ie[21]||(Ie[21]=Be=>e(n).expenseAmountColor=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",disabled:e(d)||e(f),label:e(_)("Income Amount Color"),placeholder:e(_)("Income Amount Color"),items:e(oe),modelValue:e(n).incomeAmountColor,"onUpdate:modelValue":Ie[22]||(Ie[22]=Be=>e(n).incomeAmountColor=Be)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1}),t(ge,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[t(H,{disabled:e(L)||e(Y)||e(f),onClick:He},{default:a(()=>[q(i(e(_)("Save Changes"))+" ",1),e(f)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"]),t(H,{color:"default",variant:"tonal",onClick:e(J)},{default:a(()=>[q(i(e(_)("Reset")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["class"])]),_:1})]),_:1}),t(ka,{ref_key:"confirmDialog",ref:se},null,512),t(ct,{ref_key:"snackbar",ref:ue},null,512),o("input",{ref_key:"avatarInput",ref:Ee,type:"file",style:{display:"none"},accept:e(us),onChange:Ie[23]||(Ie[23]=Be=>It(Be))},null,40,cx)],64)}}}),px={class:"text-h4 text-error text-wrap"},vx={class:"w-100"},fx={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},yx=Oe({__name:"UnlinkThirdPartyLoginDialog",setup(v,{expose:_}){const{tt:n}=je(),s=xi();let h=null,d=null;const y=xe("snackbar"),f=P(!1),b=P(!1),x=P(""),u=P(void 0);function m(V){return f.value=!0,b.value=!1,x.value="",u.value=V,new Promise((p,T)=>{h=p,d=T})}function k(){!u.value||!x.value||(b.value=!0,s.unlinkExternalAuth({externalAuthType:u.value,password:x.value}).then(()=>{b.value=!1,h?.(),f.value=!1}).catch(V=>{b.value=!1,V.processed||y.value?.showError(V)}))}function N(){d?.(),f.value=!1}return _({open:m}),(V,p)=>(l(),g(fe,null,[t(xt,{width:"640",persistent:!0,modelValue:f.value,"onUpdate:modelValue":p[1]||(p[1]=T=>f.value=T)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("h4",px,i(e(n)("Are you sure you want to unlink this login method?")),1)]),default:a(()=>[t(ge,{class:"w-100 d-flex justify-center"},{default:a(()=>[o("div",vx,[t(ot,{autocomplete:"current-password",type:"password",variant:"underlined",color:"error",disabled:b.value,placeholder:e(n)("Current Password"),modelValue:x.value,"onUpdate:modelValue":p[0]||(p[0]=T=>x.value=T)},null,8,["disabled","placeholder","modelValue"])])]),_:1}),t(ge,null,{default:a(()=>[o("div",fx,[t(H,{color:"error",disabled:!x.value||b.value,onClick:k},{default:a(()=>[q(i(e(n)("Confirm"))+" ",1),b.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",disabled:b.value,onClick:N},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ct,{ref_key:"snackbar",ref:y},null,512)],64))}}),gx={class:"d-flex flex-wrap align-center justify-center"},hx={class:"text-h4"},bx={key:0},Tx={key:1},kx={class:"w-100 h-100 code-container"},_x=Oe({__name:"UserGenerateTokenDialog",setup(v,{expose:_}){const{tt:n,formatNumberToLocalizedNumerals:s}=je(),h=ms(),d=xe("buttonContainer"),y=xe("snackbar");let f=null,b=null;const x=P(!1),u=P(mo()?"api":po()?"mcp":"api"),m=P(86400),k=P(86400),N=P(""),V=P(!1),p=P(!1),T=P(!1),A=P(""),w=P(""),I=E(()=>u.value==="api"&&p.value&&A.value?"height: 160px":u.value==="mcp"&&T.value&&A.value?"height: 390px":"height: 160px"),F=E(()=>`curl -H 'Authorization: Bearer ${w.value}' '${A.value}/v1/users/profile/get.json'`),S=E(()=>`{
    "mcpServers": {
        "ezbookkeeping-mcp": {
            "type": "streamable-http",
            "url": "`+A.value+`",
            "headers": {
                "Authorization": "Bearer `+w.value+`"
            }
        }
    }
}`);function j(){return x.value=!0,N.value="",u.value=mo()?"api":po()?"mcp":"api",m.value=86400,k.value=86400,V.value=!1,p.value=!1,T.value=!1,A.value="",w.value="",new Promise((W,D)=>{f=W,b=D})}function B(){V.value||!N.value||(V.value=!0,h.generateToken({type:u.value,expiresInSeconds:m.value>=0?m.value:k.value,password:N.value}).then(W=>{V.value=!1,N.value="",u.value==="api"?A.value=W.apiBaseUrl:u.value==="mcp"&&(A.value=W.mcpUrl),w.value=W.token}).catch(W=>{V.value=!1,W.processed||y.value?.showError(W)}))}function U(){u.value==="api"&&p.value?Mn(F.value,d.value):u.value==="mcp"&&T.value?Mn(S.value,d.value):Mn(w.value,d.value),y.value?.showMessage("Data copied")}function X(){b?.(),x.value=!1}function oe(){f?.(),x.value=!1}return _({open:j}),(W,D)=>{const $=Ve("number-input");return l(),g(fe,null,[t(xt,{width:"800",persistent:!0,modelValue:x.value,"onUpdate:modelValue":D[8]||(D[8]=C=>x.value=C)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",gx,[o("h4",hx,i(e(n)("Generate Token")),1),t(it),t(vt,{text:e(n)("Token Type")},{activator:a(({props:C})=>[o("div",_t(C,{class:"d-inline-block"}),[w.value?r("",!0):(l(),c(Ea,{key:0,class:"bidirectional-switch ms-2 pt-1",color:"secondary",disabled:V.value||!e(mo)()||!e(po)(),label:e(n)("MCP Token"),"model-value":u.value==="mcp",onClick:D[0]||(D[0]=M=>u.value=u.value==="api"?"mcp":"api")},{prepend:a(()=>[o("span",null,i(e(n)("API Token")),1)]),_:1},8,["disabled","label","model-value"]))],16)]),_:1},8,["text"]),u.value==="api"&&w.value&&A.value?(l(),c(Ea,{key:0,class:"bidirectional-switch ms-2 pt-1",color:"secondary",label:e(n)("Example"),modelValue:p.value,"onUpdate:modelValue":D[1]||(D[1]=C=>p.value=C),onClick:D[2]||(D[2]=C=>p.value=!p.value)},{prepend:a(()=>[o("span",null,i(e(n)("Token")),1)]),_:1},8,["label","modelValue"])):r("",!0),u.value==="mcp"&&w.value&&A.value?(l(),c(Ea,{key:1,class:"bidirectional-switch ms-2 pt-1",color:"secondary",label:e(n)("Configuration"),modelValue:T.value,"onUpdate:modelValue":D[3]||(D[3]=C=>T.value=C),onClick:D[4]||(D[4]=C=>T.value=!T.value)},{prepend:a(()=>[o("span",null,i(e(n)("Token")),1)]),_:1},8,["label","modelValue"])):r("",!0)])]),default:a(()=>[m.value===0||m.value<0&&k.value===0||u.value==="mcp"?(l(),c(ge,{key:0},{default:a(()=>[t(ls,{type:"warning",variant:"tonal"},{default:a(()=>[m.value===0||m.value<0&&k.value===0?(l(),g("span",bx,i(e(n)("Your token does not expire, please keep it secure.")),1)):r("",!0),u.value==="mcp"?(l(),g("span",Tx,i(e(n)("When connecting to third-party apps, be aware that they and any large language models they use can access your private data.")),1)):r("",!0)]),_:1})]),_:1})):r("",!0),w.value?r("",!0):(l(),c(ge,{key:1,class:"mt-md-2 pt-0"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:m.value>=0?12:6},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"value",disabled:V.value,label:e(n)("Expiration Time"),placeholder:e(n)("Expiration Time"),items:[{displayName:e(n)("No Expiration"),value:0},{displayName:e(n)("format.misc.nHour",{n:e(s)(1)}),value:3600},{displayName:e(n)("format.misc.nDays",{n:e(s)(1)}),value:86400},{displayName:e(n)("format.misc.nDays",{n:e(s)(7)}),value:604800},{displayName:e(n)("format.misc.nDays",{n:e(s)(30)}),value:2592e3},{displayName:e(n)("format.misc.nDays",{n:e(s)(90)}),value:7776e3},{displayName:e(n)("format.misc.nDays",{n:e(s)(180)}),value:15552e3},{displayName:e(n)("format.misc.nDays",{n:e(s)(365)}),value:31536e3},{displayName:e(n)("Custom"),value:-1}],modelValue:m.value,"onUpdate:modelValue":D[5]||(D[5]=C=>m.value=C)},null,8,["disabled","label","placeholder","items","modelValue"])]),_:1},8,["md"]),m.value<0?(l(),c(R,{key:0,cols:"12",md:"6"},{default:a(()=>[t($,{"persistent-placeholder":!0,disabled:V.value,label:e(n)("Custom Expiration Time (Seconds)"),placeholder:e(n)("Custom Expiration Time (Seconds)"),"max-decimal-count":0,"min-value":0,"max-value":4294967295,modelValue:k.value,"onUpdate:modelValue":D[6]||(D[6]=C=>k.value=C)},null,8,["disabled","label","placeholder","modelValue"])]),_:1})):r("",!0),t(R,{cols:"12",md:"12"},{default:a(()=>[t(ot,{autocomplete:"current-password",type:"password","persistent-placeholder":"",autofocus:!0,disabled:V.value,label:e(n)("Current Password"),placeholder:e(n)("Current Password"),modelValue:N.value,"onUpdate:modelValue":D[7]||(D[7]=C=>N.value=C),onKeyup:Gt(B,["enter"])},null,8,["disabled","label","placeholder","modelValue"])]),_:1})]),_:1})]),_:1})),w.value?(l(),c(ge,{key:2,class:"flex-grow-1 overflow-y-auto",style:kl(I.value)},{default:a(()=>[o("div",kx,[u.value==="api"&&(!p.value||!A.value)||u.value==="mcp"&&(!T.value||!A.value)?(l(),c(Oa,{key:0,class:"w-100 h-100 always-cursor-text",readonly:!0,value:w.value},null,8,["value"])):r("",!0),u.value==="api"&&p.value&&A.value?(l(),c(Oa,{key:1,class:"w-100 h-100 always-cursor-text",readonly:!0,value:F.value},null,8,["value"])):r("",!0),u.value==="mcp"&&T.value&&A.value?(l(),c(Oa,{key:2,class:"w-100 h-100 always-cursor-text",readonly:!0,value:S.value},null,8,["value"])):r("",!0)])]),_:1},8,["style"])):r("",!0),t(ge,null,{default:a(()=>[o("div",{ref_key:"buttonContainer",ref:d,class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},[w.value?r("",!0):(l(),c(H,{key:0,disabled:V.value||!N.value,onClick:B},{default:a(()=>[q(i(e(n)("Generate"))+" ",1),V.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])),w.value?r("",!0):(l(),c(H,{key:1,color:"secondary",variant:"tonal",disabled:V.value,onClick:X},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1},8,["disabled"])),w.value?(l(),c(H,{key:2,variant:"tonal",onClick:U},{default:a(()=>[q(i(e(n)("Copy")),1)]),_:1})):r("",!0),w.value?(l(),c(H,{key:3,color:"secondary",variant:"tonal",onClick:oe},{default:a(()=>[q(i(e(n)("Close")),1)]),_:1})):r("",!0)],512)]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ct,{ref_key:"snackbar",ref:y},null,512)],64)}}}),xx={class:"text-body-1"},Cx={class:"d-flex align-center"},wx={class:"text-right"},Ax={class:"px-0",colspan:"4"},Sx={class:"text-sm"},Vx={class:"text-sm"},Ix={class:"text-sm"},Dx={class:"text-sm text-right"},$x={class:"d-flex align-center"},Nx={class:"text-right"},Fx={class:"px-0",colspan:"4"},Ex={class:"text-sm"},Mx={class:"text-sm"},Ux={class:"text-sm"},Px={class:"text-sm text-right"},Bx=Oe({__name:"UserSecuritySettingTab",setup(v){class _{externalAuthType;icon;displayName;linked;externalUsername;createdAt;constructor(le){this.externalAuthType=le.externalAuthType,this.linked=le.linked,this.externalUsername=le.externalUsername?le.externalUsername:"-",this.createdAt=le.createdAt?h(Ia(le.createdAt)):"-",le.externalAuthCategory==="oauth2"?(this.displayName=d(le.externalAuthType,Ro()),le.externalAuthType==="github"?this.icon=Or:this.icon=ks):(this.displayName=le.externalAuthType,this.icon=ks)}}class n extends Xd{icon;lastSeenDateTime;constructor(le){super(le.tokenId,le.isCurrent,le.deviceType,le.deviceInfo,le.deviceName,le.lastSeen),this.icon=this.getTokenIcon(le.deviceType),this.lastSeenDateTime=le.lastSeen?h(Ia(le.lastSeen)):"-"}getTokenIcon(le){return le===on.Phone?Jo:le===on.Wearable?Rr:le===on.Tablet?qr:le===on.TV?Yr:le===on.Api?jr:le===on.MCP?Hr:Wr}}const{tt:s,formatDateTimeToLongDateTime:h,getLocalizedOAuth2ProviderName:d,setLanguage:y}=je(),f=Za(),b=Ya(),x=xi(),u=ms(),m=xe("newPasswordInput"),k=xe("confirmPasswordInput"),N=xe("unlinkThirdPartyLoginDialog"),V=xe("generateTokenDialog"),p=xe("confirmDialog"),T=xe("snackbar"),A=P([]),w=P([]),I=P(""),F=P(""),S=P(""),j=P(!1),B=P(!0),U=P(!0),X=P(!1),oe=P(_l()),W=E(()=>f.generateOAuth2LinkUrl("desktop",oe.value)),D=E(()=>{const Z=[];if(!A.value)return Z;for(const le of A.value)Z.push(new _(le));return Z}),$=E(()=>{const Z=[];if(!w.value)return Z;for(const le of w.value){const z=ec(le);Z.push(new n(z))}return Z}),C=E(()=>!F.value&&!S.value?"Nothing has been modified":!F.value&&S.value?"New password cannot be blank":F.value&&!S.value?"Password confirmation cannot be blank":F.value&&S.value&&F.value!==S.value?"Password and password confirmation do not match":null);function M(){ye(!0),O(!0)}function ee(){const Z=C.value;if(Z){T.value?.showMessage(Z);return}j.value=!0,f.updateUserProfile({password:F.value,oldPassword:I.value}).then(le=>{if(j.value=!1,I.value="",F.value="",S.value="",le.user){const z=y(le.user.language);b.updateLocalizedDefaultSettings(z)}O(!0),T.value?.showMessage("Your profile has been successfully updated")}).catch(le=>{j.value=!1,I.value="",le.processed||T.value?.showError(le)})}function ye(Z){un()&&(B.value=!0,x.getExternalAuths().then(le=>{Z||(bo(A.value,le)?T.value?.showMessage("Third-party logins list is up to date"):T.value?.showMessage("Third-party logins list has been updated")),A.value=le,B.value=!1}).catch(le=>{B.value=!1,le.error&&le.error.errorCode===Tl.ApiNotFound?A.value=[]:le.processed||(A.value=[],T.value?.showError(le))}))}function L(Z){un()&&N.value?.open(Z.externalAuthType).then(()=>{ye(!0)})}function Y(){V.value?.open().then(()=>{O(!0)})}function O(Z){U.value=!0,u.getAllTokens().then(le=>{Z||(bo(w.value,le)?T.value?.showMessage("Session list is up to date"):T.value?.showMessage("Session list has been updated")),w.value=le,U.value=!1}).catch(le=>{U.value=!1,le.processed||T.value?.showError(le)})}function J(Z){p.value?.open("Are you sure you want to logout from this session?").then(()=>{U.value=!0,u.revokeToken({tokenId:Z.tokenId}).then(()=>{U.value=!1;for(const[le,z]of Ra(w.value))le.tokenId===Z.tokenId&&w.value.splice(z,1)}).catch(le=>{U.value=!1,le.processed||T.value?.showError(le)})})}function ae(){$.value.length<2||p.value?.open("Are you sure you want to logout all other sessions?").then(()=>{U.value=!0,u.revokeAllTokens().then(()=>{U.value=!1;for(const[Z,le]of tc(w.value))Z.isCurrent||w.value.splice(le,1);T.value?.showMessage("You have logged out all other sessions")}).catch(Z=>{U.value=!1,Z.processed||T.value?.showError(Z)})})}return M(),(Z,le)=>(l(),g(fe,null,[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,{class:be({disabled:j.value}),title:e(s)("Modify Password")},{default:a(()=>[t(jt,null,{default:a(()=>[t(ge,{class:"pt-0"},{default:a(()=>[o("span",xx,i(e(s)("After changing the password, other devices will be logged out. Please use the new password to log in on other devices.")),1)]),_:1}),t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(e(ot),{autocomplete:"current-password",ref:"currentPasswordInput",type:"password",disabled:j.value,label:e(s)("Current Password"),placeholder:e(s)("Current Password"),modelValue:I.value,"onUpdate:modelValue":le[0]||(le[0]=z=>I.value=z),onKeyup:le[1]||(le[1]=Gt(z=>m.value?.focus(),["enter"]))},null,8,["disabled","label","placeholder","modelValue"])]),_:1})]),_:1}),t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(e(ot),{autocomplete:"new-password",ref_key:"newPasswordInput",ref:m,type:"password",disabled:j.value,label:e(s)("New Password"),placeholder:e(s)("New Password"),modelValue:F.value,"onUpdate:modelValue":le[2]||(le[2]=z=>F.value=z),onKeyup:le[3]||(le[3]=Gt(z=>k.value?.focus(),["enter"]))},null,8,["disabled","label","placeholder","modelValue"])]),_:1})]),_:1}),t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(e(ot),{ref_key:"confirmPasswordInput",ref:k,type:"password",disabled:j.value,label:e(s)("Confirm Password"),placeholder:e(s)("Re-enter the password"),modelValue:S.value,"onUpdate:modelValue":le[4]||(le[4]=z=>S.value=z),onKeyup:Gt(ee,["enter"])},null,8,["disabled","label","placeholder","modelValue"])]),_:1})]),_:1})]),_:1}),t(ge,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[t(H,{disabled:!F.value||!S.value||j.value,onClick:ee},{default:a(()=>[q(i(e(s)("Save Changes"))+" ",1),j.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["class","title"])]),_:1}),e(un)()&&(B.value||D.value&&D.value.length)?(l(),c(R,{key:0,cols:"12"},{default:a(()=>[t(Me,{class:be({disabled:B.value})},{title:a(()=>[o("div",Cx,[o("span",null,i(e(s)("Third-Party Logins")),1),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,loading:B.value,onClick:le[5]||(le[5]=z=>ye(!1))},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(s)("Refresh")),1)]),_:1})]),_:1},8,["loading"])])]),default:a(()=>[t(sl,{class:"table-striped text-no-wrap",hover:!B.value},{default:a(()=>[o("thead",null,[o("tr",null,[o("th",null,i(e(s)("Type")),1),o("th",null,i(e(s)("Username")),1),o("th",null,i(e(s)("Linked Time")),1),o("th",wx,i(e(s)("Operation")),1)])]),o("tbody",null,[(l(!0),g(fe,null,$e(B.value&&(!A.value||A.value.length<1)?[1]:[],z=>(l(),g("tr",{key:z},[o("td",Ax,[t(ft,{type:"text",loading:!0})])]))),128)),(l(!0),g(fe,null,$e(D.value,z=>(l(),g("tr",{key:z.externalAuthType},[o("td",Sx,[t(ie,{start:"",icon:z.icon},null,8,["icon"]),q(" "+i(z.displayName),1)]),o("td",Vx,i(z.externalUsername),1),o("td",Ix,i(z.createdAt),1),o("td",Dx,[!z.linked&&e(un)()&&e(ac)()===z.externalAuthType?(l(),c(H,{key:0,density:"comfortable",variant:"tonal",disabled:X.value,href:W.value,onClick:le[6]||(le[6]=se=>X.value=!0)},{default:a(()=>[q(i(e(s)("Link"))+" ",1),X.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled","href"])):r("",!0),z.linked?(l(),c(H,{key:1,density:"comfortable",color:"error",variant:"tonal",disabled:B.value,onClick:se=>L(z)},{default:a(()=>[q(i(e(s)("Unlink")),1)]),_:1},8,["disabled","onClick"])):r("",!0)])]))),128))])]),_:1},8,["hover"])]),_:1},8,["class"])]),_:1})):r("",!0),t(R,{cols:"12"},{default:a(()=>[t(Me,{class:be({disabled:U.value})},{title:a(()=>[o("div",$x,[o("span",null,i(e(s)("Device & Sessions")),1),e(mo)()||e(po)()?(l(),c(H,{key:0,class:"ms-3",density:"compact",color:"default",variant:"outlined",onClick:Y},{default:a(()=>[q(i(e(s)("Generate Token")),1)]),_:1})):r("",!0),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,loading:U.value,onClick:le[7]||(le[7]=z=>O(!1))},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(s)("Refresh")),1)]),_:1})]),_:1},8,["loading"])])]),default:a(()=>[t(sl,{class:"table-striped text-no-wrap",hover:!U.value},{default:a(()=>[o("thead",null,[o("tr",null,[o("th",null,i(e(s)("Type")),1),o("th",null,i(e(s)("Device Info")),1),o("th",null,i(e(s)("Last Activity Time")),1),o("th",Nx,[t(H,{density:"comfortable",color:"error",variant:"tonal",disabled:$.value.length<2||U.value,onClick:ae},{default:a(()=>[q(i(e(s)("Logout All")),1)]),_:1},8,["disabled"])])])]),o("tbody",null,[(l(!0),g(fe,null,$e(U.value&&(!$.value||$.value.length<1)?[1,2,3]:[],z=>(l(),g("tr",{key:z},[o("td",Fx,[t(ft,{type:"text",loading:!0})])]))),128)),(l(!0),g(fe,null,$e($.value,z=>(l(),g("tr",{key:z.tokenId},[o("td",Ex,[t(ie,{start:"",icon:z.icon},null,8,["icon"]),q(" "+i(e(s)(z.deviceName)),1)]),o("td",Mx,i(z.deviceInfo),1),o("td",Ux,i(z.lastSeenDateTime),1),o("td",Px,[t(H,{density:"comfortable",color:"error",variant:"tonal",disabled:z.isCurrent||U.value,onClick:se=>J(z)},{default:a(()=>[q(i(e(s)("Log Out")),1)]),_:1},8,["disabled","onClick"])])]))),128))])]),_:1},8,["hover"])]),_:1},8,["class"])]),_:1})]),_:1}),t(yx,{ref_key:"unlinkThirdPartyLoginDialog",ref:N},null,512),t(_x,{ref_key:"generateTokenDialog",ref:V},null,512),t(ka,{ref_key:"confirmDialog",ref:p},null,512),t(ct,{ref_key:"snackbar",ref:T},null,512)],64))}}),Lx={key:1,class:"text-body-1"},zx={key:2,class:"text-body-1"},Ox={key:3,class:"text-body-1"},Rx={key:0,class:"text-body-1"},qx=Oe({__name:"UserTwoFactorAuthSettingTab",setup(v,{expose:_}){const{tt:n}=je(),s=lc(),h=xe("snackbar"),d=P(null),y=P(!0),f=P(""),b=P(""),x=P(""),u=P(""),m=P(""),k=P(!1),N=P(!1),V=P(!1),p=P(!1);function T(){y.value=!0,s.get2FAStatus().then(B=>{d.value=B.enable,y.value=!1}).catch(B=>{y.value=!1,B.error&&B.error.errorCode===Tl.ApiNotFound?d.value=null:B.processed||(d.value=null,h.value?.showError(B))})}function A(){b.value="",f.value="",m.value="",k.value=!0,s.enable2FA().then(B=>{k.value=!1,b.value=B.qrcode,f.value=B.secret}).catch(B=>{k.value=!1,B.processed||h.value?.showError(B)})}function w(){if(!u.value){h.value?.showMessage("Passcode cannot be blank");return}if(N.value)return;const B=u.value;m.value="",u.value="",N.value=!0,s.confirmEnable2FA({secret:f.value,passcode:B}).then(U=>{N.value=!1,b.value="",f.value="",d.value=!0,U.recoveryCodes&&U.recoveryCodes.length&&(m.value=U.recoveryCodes.join(`
`))}).catch(U=>{N.value=!1,U.processed||h.value?.showError(U)})}function I(){if(!x.value){h.value?.showMessage("Current password cannot be blank");return}if(V.value)return;const B=x.value;m.value="",x.value="",V.value=!0,s.disable2FA({password:B}).then(()=>{V.value=!1,d.value=!1,h.value?.showMessage("Two-factor authentication has been disabled")}).catch(U=>{V.value=!1,U.processed||h.value?.showError(U)})}function F(){if(!x.value){h.value?.showMessage("Current password cannot be blank");return}if(p.value)return;const B=x.value;m.value="",x.value="",p.value=!0,s.regenerate2FARecoveryCode({password:B}).then(U=>{p.value=!1,m.value=U.recoveryCodes.join(`
`)}).catch(U=>{p.value=!1,U.processed||h.value?.showError(U)})}function S(){f.value="",b.value="",x.value="",u.value="",m.value="",k.value=!1,N.value=!1,V.value=!1,p.value=!1}function j(){Mn(m.value),h.value?.showMessage("Backup codes copied")}return _({reset:S}),T(),(B,U)=>(l(),g(fe,null,[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,{class:be({disabled:y.value})},{title:a(()=>[o("span",null,i(e(n)("Two-Factor Authentication")),1),y.value?(l(),c(Ze,{key:0,indeterminate:"",size:"20",class:"ms-3"})):r("",!0)]),default:a(()=>[t(ge,{class:"pb-0"},{default:a(()=>[y.value?(l(),c(ft,{key:0,class:"skeleton-no-margin pt-2 pb-5",type:"text",style:{width:"150px"},loading:!0})):r("",!0),!y.value&&!b.value?(l(),g("p",Lx,i(d.value===!0?e(n)("Two-factor authentication is already enabled."):e(n)("Two-factor authentication is not enabled yet.")),1)):r("",!0),!y.value&&b.value?(l(),g("p",zx,i(e(n)("Please use a two-factor authentication app to scan the qrcode below and enter the current passcode.")),1)):r("",!0),!y.value&&d.value===!0?(l(),g("p",Ox,i(e(n)("Your current password is required to disable two-factor authentication or regenerate backup codes for two-factor authentication. If you regenerate backup codes, the previous ones will become invalid.")),1)):r("",!0)]),_:1}),d.value===!1&&b.value?(l(),c(ge,{key:0},{default:a(()=>[t(wt,{alt:"qrcode",class:"img-qrcode",src:b.value},null,8,["src"]),t(Ae,{class:"mb-3"},{default:a(()=>[t(R,{cols:"12",md:"3"},{default:a(()=>[t(ot,{type:"number",autocomplete:"one-time-code",variant:"underlined",disabled:y.value||k.value||N.value||V.value,placeholder:e(n)("Passcode"),modelValue:u.value,"onUpdate:modelValue":U[0]||(U[0]=X=>u.value=X),onKeyup:Gt(w,["enter"])},null,8,["disabled","placeholder","modelValue"])]),_:1})]),_:1})]),_:1})):r("",!0),d.value===!0?(l(),c(ge,{key:1,class:"pb-0"},{default:a(()=>[t(Ae,{class:"mb-3"},{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(ot,{autocomplete:"current-password",type:"password",variant:"underlined",disabled:y.value||k.value||N.value||V.value,placeholder:e(n)("Current Password"),modelValue:x.value,"onUpdate:modelValue":U[1]||(U[1]=X=>x.value=X)},null,8,["disabled","placeholder","modelValue"])]),_:1})]),_:1})]),_:1})):r("",!0),t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:a(()=>[d.value===!0?(l(),c(H,{key:0,disabled:!x.value||y.value||V.value,onClick:I},{default:a(()=>[q(i(e(n)("Disable Two-Factor Authentication"))+" ",1),V.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])):r("",!0),d.value===!0?(l(),c(H,{key:1,disabled:!x.value||y.value||p.value,onClick:U[2]||(U[2]=X=>F())},{default:a(()=>[q(i(e(n)("Regenerate Backup Codes"))+" ",1),p.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])):r("",!0),d.value===!1&&!b.value?(l(),c(H,{key:2,disabled:y.value||k.value,onClick:A},{default:a(()=>[q(i(e(n)("Enable Two-Factor Authentication"))+" ",1),k.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])):r("",!0),d.value===!1&&b.value?(l(),c(H,{key:3,disabled:!u.value||y.value||N.value,onClick:w},{default:a(()=>[q(i(e(n)("Continue"))+" ",1),N.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])):r("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[m.value?(l(),c(Me,{key:0},{title:a(()=>[o("span",null,i(e(n)("Backup Code")),1),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,onClick:j},{default:a(()=>[t(ie,{icon:e(si),size:"20"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Copy")),1)]),_:1})]),_:1})]),default:a(()=>[t(ge,null,{default:a(()=>[d.value===!0?(l(),g("p",Rx,i(e(n)("Please copy these backup codes to safe place, the following backup codes will be displayed only once. If these codes were lost, you can regenerate them at any time.")),1)):r("",!0),t(Oa,{class:"backup-code",readonly:!0,rows:10,value:m.value},null,8,["value"])]),_:1})]),_:1})):r("",!0)]),_:1})]),_:1}),t(ct,{ref_key:"snackbar",ref:h},null,512)],64))}}),Yx={class:"d-flex align-center"},jx={class:"d-flex align-center"},Hx={class:"me-3"},Wx={class:"d-flex flex-column"},Gx={class:"text-caption"},Kx={key:1,class:"text-xl"},Qx={class:"text-body-1"},Jx={class:"text-error"},Zx={class:"text-body-1 text-error"},Xx=Oe({__name:"UserDataManagementSettingTab",setup(v){const{tt:_}=je(),{dataStatistics:n,displayDataStatistics:s,getExportFileName:h}=nc(),d=Za(),y=ta(),f=xe("confirmDialog"),b=xe("snackbar"),x=P(!0),u=P(!1),m=P(""),k=P(!1);function N(A){x.value=!0,y.getUserDataStatistics().then(w=>{A&&(bo(n.value,w)?b.value?.showMessage("Data is up to date"):b.value?.showMessage("Data has been updated")),n.value=w,x.value=!1}).catch(w=>{x.value=!1,w.processed||b.value?.showError(w)})}function V(A){u.value||(u.value=!0,y.getExportedUserData(A).then(w=>{tn(h(A),w),u.value=!1}).catch(w=>{u.value=!1,w.processed||b.value?.showError(w)}))}function p(){if(!m.value){b.value?.showMessage("Current password cannot be blank");return}k.value||f.value?.open("Are you sure you want to clear all transactions?",{color:"error"}).then(()=>{k.value=!0,d.clearAllUserTransactions({password:m.value}).then(()=>{k.value=!1,m.value="",b.value?.showMessage("All transactions has been cleared"),N(!1)}).catch(A=>{k.value=!1,A.processed||b.value?.showError(A)})})}function T(){if(!m.value){b.value?.showMessage("Current password cannot be blank");return}k.value||f.value?.open("Are you sure you want to clear all data?",{color:"error"}).then(()=>{k.value=!0,d.clearAllUserData({password:m.value}).then(()=>{k.value=!1,m.value="",b.value?.showMessage("All user data has been cleared"),N(!1)}).catch(A=>{k.value=!1,A.processed||b.value?.showError(A)})})}return N(!1),(A,w)=>(l(),g(fe,null,[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,{class:be({disabled:x.value})},{title:a(()=>[o("div",Yx,[o("span",null,i(e(_)("Data Management")),1),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,loading:x.value,onClick:w[0]||(w[0]=I=>N(!0))},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(_)("Refresh")),1)]),_:1})]),_:1},8,["loading"])])]),default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[(l(!0),g(fe,null,$e([{title:"Transactions",count:e(s)?e(s).totalTransactionCount:"-",icon:e(bl),color:"info-darken-1"},{title:"Accounts",count:e(s)?e(s).totalAccountCount:"-",icon:e(Qo),color:"primary"},{title:"Transaction Categories",count:e(s)?e(s).totalTransactionCategoryCount:"-",icon:e(Os),color:"teal"},{title:"Transaction Tags",count:e(s)?e(s).totalTransactionTagCount:"-",icon:e(Rs),color:"grey"},{title:"Transaction Pictures",count:e(s)?e(s).totalTransactionPictureCount:"-",icon:e(Gr),color:"error-darken-1"},{title:"Transaction Templates",count:e(s)?e(s).totalTransactionTemplateCount:"-",icon:e(qs),color:"secondary-darken-1"},{title:"Scheduled Transactions",count:e(s)?e(s).totalScheduledTransactionCount:"-",icon:e(Ys),color:"success-darken-1"}],(I,F)=>(l(),c(R,{cols:"6",sm:"3",key:F},{default:a(()=>[o("div",jx,[o("div",Hx,[t(ol,{rounded:"",color:I.color,size:"42",class:"elevation-1"},{default:a(()=>[t(ie,{size:"24",icon:I.icon},null,8,["icon"])]),_:2},1032,["color"])]),o("div",Wx,[o("span",Gx,i(e(_)(I.title)),1),x.value?(l(),c(ft,{key:0,class:"skeleton-no-margin pt-2 pb-2",type:"text",style:{width:"60px"},loading:!0})):r("",!0),x.value?r("",!0):(l(),g("span",Kx,i(I.count),1))])])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["class"])]),_:1}),e(Wo)()?(l(),c(R,{key:0,cols:"12"},{default:a(()=>[t(Me,{class:be({disabled:u.value}),title:e(_)("Export Data")},{default:a(()=>[t(ge,null,{default:a(()=>[o("span",Qx,i(e(_)("Export all transaction data to file."))+" "+i(e(_)("It may take a long time, please wait for a few minutes.")),1)]),_:1}),t(ge,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[t(Gl,{variant:"elevated",density:"comfortable",color:"primary"},{default:a(()=>[t(H,{disabled:x.value||u.value||!e(n)||!e(n).totalTransactionCount||e(n).totalTransactionCount==="0"},{default:a(()=>[q(i(e(_)("Export Data"))+" ",1),u.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0),t(mt,{activator:"parent"},{default:a(()=>[t(Je,{disabled:x.value||u.value||!e(n)||!e(n).totalTransactionCount||e(n).totalTransactionCount==="0"},{default:a(()=>[t(ve,{onClick:w[1]||(w[1]=I=>V("csv"))},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(_)("CSV (Comma-separated values) File")),1)]),_:1})]),_:1}),t(ve,{onClick:w[2]||(w[2]=I=>V("tsv"))},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(_)("TSV (Tab-separated values) File")),1)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["class","title"])]),_:1})):r("",!0),t(R,{cols:"12"},{default:a(()=>[t(Me,{class:be({disabled:k.value})},{title:a(()=>[o("span",Jx,i(e(_)("Danger Zone")),1)]),default:a(()=>[t(ge,{class:"py-0"},{default:a(()=>[o("span",Zx,[t(ie,{class:"mt-n1",icon:e(Kr)},null,8,["icon"]),q(" "+i(e(_)('You CANNOT undo this action. "Clear All Transactions" will clear all your transactions data, and "Clear All Data" will clear your accounts, categories, tags and transactions data. Please enter your current password to confirm.')),1)])]),_:1}),t(ge,{class:"pb-0"},{default:a(()=>[t(Ae,{class:"mb-3"},{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(ot,{autocomplete:"current-password",ref:"currentPasswordInput",type:"password",variant:"underlined",color:"error",disabled:x.value||k.value,placeholder:e(_)("Current Password"),modelValue:m.value,"onUpdate:modelValue":w[3]||(w[3]=I=>m.value=I)},null,8,["disabled","placeholder","modelValue"])]),_:1})]),_:1})]),_:1}),t(ge,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[t(H,{color:"error",disabled:x.value||!m.value||k.value},{default:a(()=>[q(i(e(_)("Clear User Data"))+" ",1),k.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0),t(mt,{activator:"parent"},{default:a(()=>[t(Je,{disabled:x.value||!m.value||k.value},{default:a(()=>[t(ve,{onClick:p},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(_)("Clear All Transactions")),1)]),_:1})]),_:1}),t(ve,{onClick:T},{default:a(()=>[t(rt,null,{default:a(()=>[q(i(e(_)("Clear All Data")),1)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1},8,["class"])]),_:1})]),_:1}),t(ka,{ref_key:"confirmDialog",ref:f},null,512),t(ct,{ref_key:"snackbar",ref:b},null,512)],64))}}),e0=Oe({__name:"UserSettingsPage",props:{initTab:{}},setup(v){const _=v,n=Na(),{tt:s}=je(),h=["basicSetting","securitySetting","twoFactorSetting","dataManagementSetting"],d=xe("twoFactorSettingTab"),y=P((()=>{let b=_.initTab||"basicSetting";return h.indexOf(b)<0&&(b="basicSetting"),b})()),f=b=>{n.push(`/user/settings?tab=${b}`)};return Rn(b=>{b.query&&b.query.tab&&h.indexOf(b.query.tab)>=0?y.value=b.query.tab:y.value="basicSetting"}),Ft(y,(b,x)=>{x==="twoFactorSetting"&&b!=="twoFactorSetting"&&d.value?.reset()}),(b,x)=>(l(),g("div",null,[t(Ja,{"show-arrows":"",modelValue:y.value,"onUpdate:modelValue":x[4]||(x[4]=u=>y.value=u)},{default:a(()=>[t(Wt,{value:"basicSetting",onClick:x[0]||(x[0]=u=>f("basicSetting"))},{default:a(()=>[t(ie,{size:"20",start:"",icon:e(Qr)},null,8,["icon"]),q(" "+i(e(s)("Basic")),1)]),_:1}),t(Wt,{value:"securitySetting",onClick:x[1]||(x[1]=u=>f("securitySetting"))},{default:a(()=>[t(ie,{size:"20",start:"",icon:e(ui)},null,8,["icon"]),q(" "+i(e(s)("Security")),1)]),_:1}),t(Wt,{value:"twoFactorSetting",onClick:x[2]||(x[2]=u=>f("twoFactorSetting"))},{default:a(()=>[t(ie,{size:"20",start:"",icon:e(Gs)},null,8,["icon"]),q(" "+i(e(s)("Two-Factor Authentication")),1)]),_:1}),t(Wt,{value:"dataManagementSetting",onClick:x[3]||(x[3]=u=>f("dataManagementSetting"))},{default:a(()=>[t(ie,{size:"20",start:"",icon:e(Jr)},null,8,["icon"]),q(" "+i(e(s)("Data Management")),1)]),_:1})]),_:1},8,["modelValue"]),t(qa,{class:"mt-4 disable-tab-transition",modelValue:y.value,"onUpdate:modelValue":x[5]||(x[5]=u=>y.value=u)},{default:a(()=>[t(zt,{value:"basicSetting"},{default:a(()=>[t(mx)]),_:1}),t(zt,{value:"securitySetting"},{default:a(()=>[t(Bx)]),_:1}),t(zt,{value:"twoFactorSetting"},{default:a(()=>[t(qx,{ref_key:"twoFactorSettingTab",ref:d},null,512)]),_:1}),t(zt,{value:"dataManagementSetting"},{default:a(()=>[t(Xx)]),_:1})]),_:1},8,["modelValue"])]))}}),t0=Oe({__name:"AppBasicSettingTab",setup(v){const _=Kt(),{tt:n,getAllEnableDisableOptions:s,getAllDateRanges:h}=je(),{loadingAccounts:d,loadingTransactionCategories:y,allThemes:f,allTimezones:b,allTimezoneTypesUsedForStatistics:x,allCurrencySortingTypes:u,allAutoSaveTransactionDraftTypes:m,hasAnyAccount:k,hasAnyVisibleAccount:N,hasAnyTransactionCategory:V,timeZone:p,isAutoUpdateExchangeRatesData:T,showAccountBalance:A,showAmountInHomePage:w,itemsCountInTransactionListPage:I,timezoneUsedForStatisticsInHomePage:F,showTotalAmountInTransactionListPage:S,showTagInTransactionListPage:j,autoSaveTransactionDraft:B,isAutoGetCurrentGeoLocation:U,currencySortByInExchangeRatesPage:X,accountsIncludedInHomePageOverviewDisplayContent:oe,accountsIncludedInTotalDisplayContent:W,transactionCategoriesIncludedInHomePageOverviewDisplayContent:D}=oc(),$=Ya(),C=pa(),M=va(),ee=Yn(),ye=xe("snackbar"),L=P(!1),Y=P(!1),O=P(!1),J=E(()=>s()),ae=E(()=>h(ma.InsightsExplore,!1)),Z=E({get:()=>$.appSettings.theme,set:Ee=>{Ee!==$.appSettings.theme&&($.setTheme(Ee),Ee===$t.Light||Ee===$t.Dark?_.change(Ee):_.change(os()))}}),le=E({get:()=>$.appSettings.showAddTransactionButtonInDesktopNavbar,set:Ee=>$.setShowAddTransactionButtonInDesktopNavbar(Ee)}),z=E({get:()=>$.appSettings.insightsExploreDefaultDateRangeType,set:Ee=>$.setInsightsExploreDefaultDateRangeType(Ee)}),se=E({get:()=>$.appSettings.timezoneUsedForInsightsExplorePage,set:Ee=>{$.setTimezoneUsedForInsightsExplorePage(Ee),ee.updateTransactionExploreInvalidState(!0)}});function ue(){d.value=!0,C.loadAllAccounts({force:!1}).then(()=>{d.value=!1}).catch(Ee=>{d.value=!1,Ee.processed||ye.value?.showError(Ee)}),M.loadAllCategories({force:!1}).then(()=>{y.value=!1}).catch(Ee=>{y.value=!1,Ee.processed||ye.value?.showError(Ee)})}return ue(),(Ee,me)=>(l(),g(fe,null,[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(n)("Basic Settings")},{default:a(()=>[t(jt,null,{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"name","item-value":"value","persistent-placeholder":"",label:e(n)("Theme"),placeholder:e(n)("Theme"),items:e(f),modelValue:Z.value,"onUpdate:modelValue":me[0]||(me[0]=te=>Z.value=te)},null,8,["label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(ua,{"item-title":"displayNameWithUtcOffset","item-value":"name","auto-select-first":"","persistent-placeholder":"",label:e(n)("Timezone"),placeholder:e(n)("Timezone"),items:e(b),"no-data-text":e(n)("No results"),modelValue:e(p),"onUpdate:modelValue":me[1]||(me[1]=te=>ht(p)?p.value=te:null)},null,8,["label","placeholder","items","no-data-text","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"value","persistent-placeholder":"",label:e(n)("Auto-update Exchange Rates Data"),placeholder:e(n)("Auto-update Exchange Rates Data"),items:J.value,modelValue:e(T),"onUpdate:modelValue":me[2]||(me[2]=te=>ht(T)?T.value=te:null)},null,8,["label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"value","persistent-placeholder":"",label:e(n)("Show Account Balance"),placeholder:e(n)("Show Account Balance"),items:J.value,modelValue:e(A),"onUpdate:modelValue":me[3]||(me[3]=te=>ht(A)?A.value=te:null)},null,8,["label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(n)("Navigation Bar")},{default:a(()=>[t(jt,null,{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"value","persistent-placeholder":"",label:e(n)("Show Add Transaction Button"),placeholder:e(n)("Show Add Transaction Button"),items:J.value,modelValue:le.value,"onUpdate:modelValue":me[4]||(me[4]=te=>le.value=te)},null,8,["label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(n)("Overview Page")},{default:a(()=>[t(jt,null,{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"value","persistent-placeholder":"",label:e(n)("Show Amount"),placeholder:e(n)("Show Amount"),items:J.value,modelValue:e(w),"onUpdate:modelValue":me[5]||(me[5]=te=>ht(w)?w.value=te:null)},null,8,["label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",label:e(n)("Timezone Used for Statistics"),placeholder:e(n)("Timezone Used for Statistics"),items:e(x),modelValue:e(F),"onUpdate:modelValue":me[6]||(me[6]=te=>ht(F)?F.value=te:null)},null,8,["label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(ot,{class:"always-cursor-pointer","item-title":"displayName","item-value":"type","persistent-placeholder":"",loading:e(d),readonly:!0,disabled:!e(k),label:e(n)("Accounts Included in Overview Statistics"),placeholder:e(n)("Accounts Included in Overview Statistics"),"model-value":e(oe),onClick:me[7]||(me[7]=te=>L.value=!0)},null,8,["loading","disabled","label","placeholder","model-value"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(ot,{class:"always-cursor-pointer","item-title":"displayName","item-value":"type","persistent-placeholder":"",loading:e(y),readonly:!0,disabled:!e(V),label:e(n)("Transaction Categories Included in Overview Statistics"),placeholder:e(n)("Transaction Categories Included in Overview Statistics"),"model-value":e(D),onClick:me[8]||(me[8]=te=>Y.value=!0)},null,8,["loading","disabled","label","placeholder","model-value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(n)("Transaction List Page")},{default:a(()=>[t(jt,null,{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"persistent-placeholder":"",label:e(n)("Transactions Per Page"),placeholder:e(n)("Transactions Per Page"),items:[5,10,15,20,25,30,50],modelValue:e(I),"onUpdate:modelValue":me[9]||(me[9]=te=>ht(I)?I.value=te:null)},null,8,["label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"value","persistent-placeholder":"",label:e(n)("Show Monthly Total Amount"),placeholder:e(n)("Show Monthly Total Amount"),items:J.value,modelValue:e(S),"onUpdate:modelValue":me[10]||(me[10]=te=>ht(S)?S.value=te:null)},null,8,["label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"value","persistent-placeholder":"",label:e(n)("Show Transaction Tag"),placeholder:e(n)("Show Transaction Tag"),items:J.value,modelValue:e(j),"onUpdate:modelValue":me[11]||(me[11]=te=>ht(j)?j.value=te:null)},null,8,["label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(n)("Transaction Edit Page")},{default:a(()=>[t(jt,null,{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"name","item-value":"value","persistent-placeholder":"",label:e(n)("Automatically Save Draft"),placeholder:e(n)("Automatically Save Draft"),items:e(m),modelValue:e(B),"onUpdate:modelValue":me[12]||(me[12]=te=>ht(B)?B.value=te:null)},null,8,["label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"value","persistent-placeholder":"",label:e(n)("Automatically Add Geolocation"),placeholder:e(n)("Automatically Add Geolocation"),items:J.value,modelValue:e(U),"onUpdate:modelValue":me[13]||(me[13]=te=>ht(U)?U.value=te:null)},null,8,["label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(n)("Insights & Explore Page")},{default:a(()=>[t(jt,null,{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",label:e(n)("Default Date Range"),placeholder:e(n)("Default Date Range"),items:ae.value,modelValue:z.value,"onUpdate:modelValue":me[14]||(me[14]=te=>z.value=te)},null,8,["label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",label:e(n)("Timezone Used for Date Range"),placeholder:e(n)("Timezone Used for Date Range"),items:e(x),modelValue:se.value,"onUpdate:modelValue":me[15]||(me[15]=te=>se.value=te)},null,8,["label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(n)("Account List Page")},{default:a(()=>[t(jt,null,{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(ot,{class:"always-cursor-pointer","item-title":"displayName","item-value":"type","persistent-placeholder":"",loading:e(d),readonly:!0,disabled:!e(N),label:e(n)("Accounts Included in Total"),placeholder:e(n)("Accounts Included in Total"),"model-value":e(W),onClick:me[16]||(me[16]=te=>O.value=!0)},null,8,["loading","disabled","label","placeholder","model-value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(n)("Exchange Rates Data Page")},{default:a(()=>[t(jt,null,{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",label:e(n)("Sort by"),placeholder:e(n)("Sort by"),items:e(u),modelValue:e(X),"onUpdate:modelValue":me[17]||(me[17]=te=>ht(X)?X.value=te:null)},null,8,["label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})]),_:1}),t(xt,{width:"800",modelValue:L.value,"onUpdate:modelValue":me[19]||(me[19]=te=>L.value=te)},{default:a(()=>[t($l,{type:"homePageOverview","dialog-mode":!0,"onSettings:change":me[18]||(me[18]=te=>L.value=!1)})]),_:1},8,["modelValue"]),t(xt,{width:"800",modelValue:Y.value,"onUpdate:modelValue":me[21]||(me[21]=te=>Y.value=te)},{default:a(()=>[t(Hn,{type:"homePageOverview","dialog-mode":!0,"category-types":`${e(st).Income},${e(st).Expense}`,"onSettings:change":me[20]||(me[20]=te=>Y.value=!1)},null,8,["category-types"])]),_:1},8,["modelValue"]),t(xt,{width:"800",modelValue:O.value,"onUpdate:modelValue":me[23]||(me[23]=te=>O.value=te)},{default:a(()=>[t($l,{type:"accountListTotalAmount","dialog-mode":!0,"onSettings:change":me[22]||(me[22]=te=>O.value=!1)})]),_:1},8,["modelValue"]),t(ct,{ref_key:"snackbar",ref:ye},null,512)],64))}}),a0={key:0,class:"text-body-1"},l0={key:1,class:"text-body-1"},n0={key:0,class:"text-body-1"},o0={key:1,class:"text-body-1"},s0={style:{"max-width":"428px"}},i0=Oe({__name:"AppLockSettingTab",setup(v){const{tt:_}=je(),{isSupportedWebAuthn:n,isEnableApplicationLock:s,isEnableApplicationLockWebAuthn:h}=sc(),d=Ya(),y=ta(),f=xe("snackbar"),b=P(""),x=P(!1),u=en(),m=E(()=>b.value?.length===6||!1);function k(){s.value?V():N()}function N(){if(d.appSettings.applicationLock){f.value?.showMessage("Application lock has been enabled");return}if(!b.value||b.value.length!==6){b.value="",f.value?.showMessage("Invalid PIN code");return}const p=y.currentUserBasicInfo;if(!p||!p.username){b.value="",f.value?.showMessage("An error occurred");return}ic(p.username,b.value),d.setEnableApplicationLock(!0),u.saveTransactionDraft(),d.setEnableApplicationLockWebAuthn(!1),lo(),b.value=""}function V(){if(!d.appSettings.applicationLock){f.value?.showMessage("Application lock is not enabled");return}if(!rc(b.value)){b.value="",f.value?.showMessage("Incorrect PIN code");return}b.value="",uc(),d.setEnableApplicationLock(!1),u.saveTransactionDraft(),d.setEnableApplicationLockWebAuthn(!1),lo()}return Ft(h,p=>{const T=dc();p&&T&&y.currentUserBasicInfo?(x.value=!0,cc(T,y.currentUserBasicInfo).then(({id:A})=>{x.value=!1,mc(A),d.setEnableApplicationLockWebAuthn(!0),f.value?.showMessage("You have enabled WebAuthn successfully")}).catch(A=>{Xt.error("failed to enable WebAuthn",A),x.value=!1,A.notSupported?f.value?.showMessage("WebAuth is not supported on this device"):A.name==="NotAllowedError"?f.value?.showMessage("User has canceled authentication"):A.invalid?f.value?.showMessage("Failed to enable WebAuthn"):f.value?.showMessage("User has canceled or this device does not support WebAuthn"),h.value=!1,d.setEnableApplicationLockWebAuthn(!1),lo()})):(d.setEnableApplicationLockWebAuthn(!1),lo())}),(p,T)=>{const A=Ve("pin-code-input");return l(),g(fe,null,[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(_)("Application Lock")},{default:a(()=>[t(ge,{class:"pb-0"},{default:a(()=>[e(s)?r("",!0):(l(),g("p",a0,i(e(_)("Application lock is not enabled")),1)),e(s)?(l(),g("p",l0,i(e(_)("Application lock has been enabled")),1)):r("",!0)]),_:1}),e(s)?(l(),c(ge,{key:0},{default:a(()=>[t(Ea,{disabled:!0,label:e(_)("Unlock with PIN Code"),modelValue:e(s),"onUpdate:modelValue":T[0]||(T[0]=w=>ht(s)?s.value=w:null)},null,8,["label","modelValue"]),e(n)?(l(),c(Ea,{key:0,label:e(_)("Unlock with WebAuthn"),loading:x.value,modelValue:e(h),"onUpdate:modelValue":T[1]||(T[1]=w=>ht(h)?h.value=w:null)},null,8,["label","loading","modelValue"])):r("",!0)]),_:1})):r("",!0),t(ge,{class:"pb-0"},{default:a(()=>[e(s)?r("",!0):(l(),g("p",n0,i(e(_)("Please enter a new 6-digit PIN code. The PIN code would encrypt your local data, so you need to enter it every time you open this app. If this PIN code is lost, you will need to log in again.")),1)),e(s)?(l(),g("p",o0,i(e(_)("Your current PIN code is required to disable application lock.")),1)):r("",!0)]),_:1}),t(ge,{class:"pb-0"},{default:a(()=>[t(Ae,{class:"mb-3"},{default:a(()=>[t(R,{cols:"12",md:"12"},{default:a(()=>[o("div",s0,[t(A,{secure:!0,length:6,modelValue:b.value,"onUpdate:modelValue":T[2]||(T[2]=w=>b.value=w),"onPincode:confirm":k},null,8,["modelValue"])])]),_:1})]),_:1})]),_:1}),t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:a(()=>[e(s)?r("",!0):(l(),c(H,{key:0,disabled:!m.value,onClick:N},{default:a(()=>[q(i(e(_)("Enable Application Lock")),1)]),_:1},8,["disabled"])),e(s)?(l(),c(H,{key:1,disabled:!m.value,onClick:V},{default:a(()=>[q(i(e(_)("Disable Application Lock")),1)]),_:1},8,["disabled"])):r("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})]),_:1}),t(ct,{ref_key:"snackbar",ref:f},null,512)],64)}}}),r0=Oe({__name:"AppStatisticsSettingTab",setup(v){const{tt:_}=je(),{allChartDataTypes:n,allTimezoneTypesUsedForStatistics:s,allSortingTypes:h,allCategoricalChartTypes:d,allCategoricalChartDateRanges:y,allTrendChartTypes:f,allTrendChartDateRanges:b,allAssetTrendsChartDateRanges:x,defaultChartDataType:u,defaultTimezoneType:m,defaultSortingType:k,defaultCategoricalChartType:N,defaultCategoricalChartDateRange:V,defaultTrendChartType:p,defaultTrendChartDateRange:T,defaultAssetTrendsChartType:A,defaultAssetTrendsChartDateRange:w}=pc();return(I,F)=>(l(),c(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(_)("Statistics Settings")},{default:a(()=>[t(jt,null,{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",label:e(_)("Default Chart Data Type"),placeholder:e(_)("Default Chart Data Type"),items:e(n),modelValue:e(u),"onUpdate:modelValue":F[0]||(F[0]=S=>ht(u)?u.value=S:null)},null,8,["label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",label:e(_)("Timezone Used for Date Range"),placeholder:e(_)("Timezone Used for Date Range"),items:e(s),modelValue:e(m),"onUpdate:modelValue":F[1]||(F[1]=S=>ht(m)?m.value=S:null)},null,8,["label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",label:e(_)("Default Sort Order"),placeholder:e(_)("Default Sort Order"),items:e(h),modelValue:e(k),"onUpdate:modelValue":F[2]||(F[2]=S=>ht(k)?k.value=S:null)},null,8,["label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(_)("Categorical Analysis Settings")},{default:a(()=>[t(jt,null,{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",label:e(_)("Default Chart Type"),placeholder:e(_)("Default Chart Type"),items:e(d),modelValue:e(N),"onUpdate:modelValue":F[3]||(F[3]=S=>ht(N)?N.value=S:null)},null,8,["label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",label:e(_)("Default Date Range"),placeholder:e(_)("Default Date Range"),items:e(y),modelValue:e(V),"onUpdate:modelValue":F[4]||(F[4]=S=>ht(V)?V.value=S:null)},null,8,["label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(_)("Trend Analysis Settings")},{default:a(()=>[t(jt,null,{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",label:e(_)("Default Chart Type"),placeholder:e(_)("Default Chart Type"),items:e(f),modelValue:e(p),"onUpdate:modelValue":F[5]||(F[5]=S=>ht(p)?p.value=S:null)},null,8,["label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",label:e(_)("Default Date Range"),placeholder:e(_)("Default Date Range"),items:e(b),modelValue:e(T),"onUpdate:modelValue":F[6]||(F[6]=S=>ht(T)?T.value=S:null)},null,8,["label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(_)("Asset Trends Settings")},{default:a(()=>[t(jt,null,{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",label:e(_)("Default Chart Type"),placeholder:e(_)("Default Chart Type"),items:e(f),modelValue:e(A),"onUpdate:modelValue":F[7]||(F[7]=S=>ht(A)?A.value=S:null)},null,8,["label","placeholder","items","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(Ge,{"item-title":"displayName","item-value":"type","persistent-placeholder":"",label:e(_)("Default Date Range"),placeholder:e(_)("Default Date Range"),items:e(x),modelValue:e(w),"onUpdate:modelValue":F[8]||(F[8]=S=>ht(w)?w.value=S:null)},null,8,["label","placeholder","items","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1}),t(R,{cols:"12"},{default:a(()=>[t($l,{type:"statisticsDefault","auto-save":!0})]),_:1}),t(R,{cols:"12"},{default:a(()=>[t(Hn,{type:"statisticsDefault","auto-save":!0})]),_:1})]),_:1}))}}),u0={key:1,class:"text-body-1"},d0={key:2,class:"text-body-1"},c0={class:"d-flex align-center justify-center w-100"},m0={class:"w-100"},p0={key:0,class:"mx-2"},v0={key:1},f0=Oe({__name:"AppCloudSyncSettingTab",setup(v){const{tt:_}=je(),{ALL_APPLICATION_CLOUD_SETTINGS:n,loading:s,enabling:h,disabling:d,enabledApplicationCloudSettings:y,isEnableCloudSync:f,hasEnabledApplicationCloudSettings:b,enabledApplicationCloudSettingKeys:x,isAllSettingsSelected:u,hasSettingSelectedButNotAllChecked:m,updateSettingsSelected:k,selectAllSettings:N,selectNoneSettings:V,selectInvertSettings:p,setUserApplicationCloudSettings:T}=vc(),A=ta(),w=xe("snackbar"),I=P(["synchronizedSettings"]);function F(){s.value=!0,A.getUserApplicationCloudSettings().then(B=>{T(B),s.value=!1}).catch(B=>{s.value=!1,B.processed||w.value?.showError(B)})}function S(B){h.value=!0,A.fullUpdateUserApplicationCloudSettings(x.value).then(()=>{h.value=!1,B?w.value?.showMessage("Synchronized settings have been updated"):w.value?.showMessage("Settings sync has been enabled")}).catch(U=>{h.value=!1,U.processed||w.value?.showError(U)})}function j(){d.value=!0,A.disableUserApplicationCloudSettings().then(()=>{y.value={},d.value=!1,w.value?.showMessage("Settings sync has been disabled")}).catch(B=>{d.value=!1,B.processed||w.value?.showError(B)})}return F(),(B,U)=>(l(),g(fe,null,[t(Ae,null,{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,null,{title:a(()=>[o("span",null,i(e(_)("Settings Sync")),1),e(s)?(l(),c(Ze,{key:0,indeterminate:"",size:"20",class:"ms-3"})):r("",!0)]),default:a(()=>[t(ge,{class:"pb-0"},{default:a(()=>[e(s)?(l(),c(ft,{key:0,class:"skeleton-no-margin pt-2 pb-5",type:"text",style:{width:"150px"},loading:!0})):r("",!0),!e(s)&&!e(f)?(l(),g("p",u0,i(e(_)("Settings sync is not enabled")),1)):r("",!0),!e(s)&&e(f)?(l(),g("p",d0,i(e(_)("Settings sync has been enabled")),1)):r("",!0)]),_:1}),t(ge,null,{default:a(()=>[t(Yl,{class:"synchronized-settings",multiple:"",readonly:!0,"hide-actions":!0,disabled:e(s)||e(h)||e(d),modelValue:I.value,"onUpdate:modelValue":U[0]||(U[0]=X=>I.value=X)},{default:a(()=>[t(jl,{class:"border",value:"synchronizedSettings"},{default:a(()=>[t(Hl,{class:"expand-panel-title-with-bg py-0"},{default:a(()=>[o("div",c0,[o("div",m0,[o("span",null,i(e(_)("Synchronized Settings")),1)]),t(H,{density:"comfortable",color:"default",variant:"text",class:"ms-2",disabled:e(s)||e(h)||e(d),icon:!0},{default:a(()=>[t(ie,{icon:e(sa)},null,8,["icon"]),t(mt,{activator:"parent"},{default:a(()=>[t(Je,null,{default:a(()=>[t(ve,{disable:e(s)||e(h)||e(d),"prepend-icon":e(nl),title:e(_)("Select All"),onClick:e(N)},null,8,["disable","prepend-icon","title","onClick"]),t(ve,{disable:e(s)||e(h)||e(d),"prepend-icon":e(vn),title:e(_)("Select None"),onClick:e(V)},null,8,["disable","prepend-icon","title","onClick"]),t(ve,{disable:e(s)||e(h)||e(d),"prepend-icon":e(fn),title:e(_)("Invert Selection"),onClick:e(p)},null,8,["disable","prepend-icon","title","onClick"])]),_:1})]),_:1})]),_:1},8,["disabled"])])]),_:1}),t(Wl,null,{default:a(()=>[t(Je,{rounded:"",density:"comfortable",class:"pa-0"},{default:a(()=>[(l(!0),g(fe,null,$e(e(n),(X,oe)=>(l(),g(fe,{key:X.categoryName},[oe>0?(l(),c(nt,{key:0})):r("",!0),t(ve,null,{prepend:a(()=>[t(il,{disabled:e(s)||e(h)||e(d),"model-value":e(u)(X),indeterminate:e(m)(X),"onUpdate:modelValue":W=>e(k)(X,!!W)},{label:a(()=>[o("span",null,i(e(_)(X.categoryName)),1),X.categorySubName?(l(),g("span",p0,"/")):r("",!0),X.categorySubName?(l(),g("span",v0,i(e(_)(X.categorySubName)),1)):r("",!0)]),_:2},1032,["disabled","model-value","indeterminate","onUpdate:modelValue"])]),_:2},1024),t(nt),t(Je,{rounded:"",density:"comfortable",class:"pa-0 ms-4"},{default:a(()=>[(l(!0),g(fe,null,$e(X.items,(W,D)=>(l(),g(fe,{key:W.settingKey},[D>0?(l(),c(nt,{key:0})):r("",!0),t(ve,null,{prepend:a(()=>[t(il,{disabled:e(s)||e(h)||e(d),"model-value":e(y)[W.settingKey],"onUpdate:modelValue":$=>e(y)[W.settingKey]=!!$},{label:a(()=>[o("span",null,i(e(_)(W.settingName)),1),W.mobile?(l(),c(ie,{key:0,class:"ms-2 me-0",start:"",size:"16",icon:e(Jo)},null,8,["icon"])):r("",!0),W.desktop?(l(),c(ie,{key:1,class:"ms-2 me-0",start:"",size:"16",icon:e(Zr)},null,8,["icon"])):r("",!0)]),_:2},1032,["disabled","model-value","onUpdate:modelValue"])]),_:2},1024)],64))),128))]),_:2},1024)],64))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","modelValue"])]),_:1}),t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:a(()=>[e(f)?r("",!0):(l(),c(H,{key:0,disabled:e(s)||e(h)||e(d)||!e(b),onClick:U[1]||(U[1]=X=>S(!1))},{default:a(()=>[q(i(e(_)("Enable Settings Sync"))+" ",1),e(h)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])),e(f)?(l(),c(H,{key:1,disabled:e(s)||e(h)||e(d)||!e(b),onClick:U[2]||(U[2]=X=>S(!0))},{default:a(()=>[q(i(e(_)("Update Synchronized Settings"))+" ",1),e(h)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])):r("",!0),e(f)?(l(),c(H,{key:2,disabled:e(s)||e(h)||e(d),onClick:j},{default:a(()=>[q(i(e(_)("Disable Settings Sync"))+" ",1),e(d)?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"])):r("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(ct,{ref_key:"snackbar",ref:w},null,512)],64))}}),y0=Oe({__name:"AppSettingsPage",props:{initTab:{}},setup(v){const _=v,n=Na(),{tt:s}=je(),h=["basicSetting","applicationLockSetting","statisticsSetting","cloudSyncSetting"],d=P((()=>{let f=_.initTab||"basicSetting";return h.indexOf(f)<0&&(f="basicSetting"),f})()),y=f=>{n.push(`/app/settings?tab=${f}`)};return Rn(f=>{f.query&&f.query.tab&&h.indexOf(f.query.tab)>=0?d.value=f.query.tab:d.value="basicSetting"}),(f,b)=>(l(),g("div",null,[t(Ja,{"show-arrows":"",modelValue:d.value,"onUpdate:modelValue":b[4]||(b[4]=x=>d.value=x)},{default:a(()=>[t(Wt,{value:"basicSetting",onClick:b[0]||(b[0]=x=>y("basicSetting"))},{default:a(()=>[t(ie,{size:"20",start:"",icon:e(js)},null,8,["icon"]),q(" "+i(e(s)("Basic")),1)]),_:1}),t(Wt,{value:"applicationLockSetting",onClick:b[1]||(b[1]=x=>y("applicationLockSetting"))},{default:a(()=>[t(ie,{size:"20",start:"",icon:e(ui)},null,8,["icon"]),q(" "+i(e(s)("Application Lock")),1)]),_:1}),t(Wt,{value:"statisticsSetting",onClick:b[2]||(b[2]=x=>y("statisticsSetting"))},{default:a(()=>[t(ie,{size:"20",start:"",icon:e(zs)},null,8,["icon"]),q(" "+i(e(s)("Statistics")),1)]),_:1}),t(Wt,{value:"cloudSyncSetting",onClick:b[3]||(b[3]=x=>y("cloudSyncSetting"))},{default:a(()=>[t(ie,{size:"20",start:"",icon:e(Xr)},null,8,["icon"]),q(" "+i(e(s)("Settings Sync")),1)]),_:1})]),_:1},8,["modelValue"]),t(qa,{class:"mt-4 disable-tab-transition",modelValue:d.value,"onUpdate:modelValue":b[5]||(b[5]=x=>d.value=x)},{default:a(()=>[t(zt,{value:"basicSetting"},{default:a(()=>[t(t0)]),_:1}),t(zt,{value:"applicationLockSetting"},{default:a(()=>[t(i0)]),_:1}),t(zt,{value:"statisticsSetting"},{default:a(()=>[t(r0)]),_:1}),t(zt,{value:"cloudSyncSetting"},{default:a(()=>[t(f0)]),_:1})]),_:1},8,["modelValue"])]))}}),g0={class:"d-flex align-center"},h0={class:"text-h4"},b0={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},T0=Oe({__name:"UpdateDialog",props:{show:{type:Boolean}},setup(v,{expose:_}){const{tt:n}=je(),s=ta(),h=ps(),d=P(!1),y=P(!1),f=P(s.currentUserDefaultCurrency),b=P(1),x=P(s.currentUserDefaultCurrency),u=P(1),m=xe("snackbar");let k=null,N=null;function V(){return d.value=!0,b.value=1,x.value=s.currentUserDefaultCurrency,u.value=1,new Promise((A,w)=>{k=A,N=w})}function p(){y.value=!0,h.updateUserCustomExchangeRate({currency:x.value,rate:u.value/b.value}).then(()=>{y.value=!1,k?.({message:"You have updated exchange rate"}),d.value=!1}).catch(A=>{y.value=!1,A.processed||m.value?.showError(A)})}function T(){N?.(),d.value=!1}return _({open:V}),(A,w)=>{const I=Ve("number-input"),F=Ve("currency-select");return l(),g(fe,null,[t(xt,{width:"800",persistent:y.value||!!b.value&&b.value!==1||x.value!==f.value||!!u.value&&u.value!==1,modelValue:d.value,"onUpdate:modelValue":w[4]||(w[4]=S=>d.value=S)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("div",g0,[o("h4",h0,i(e(n)("Update User Custom Exchange Rate")),1)])]),default:a(()=>[t(ge,{class:"d-flex flex-column flex-md-row mt-2"},{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(I,{disabled:y.value,label:e(n)("Amount"),placeholder:e(n)("Amount"),"persistent-placeholder":!0,"min-value":e(Es),"max-value":e(Fs),"max-decimal-count":4,modelValue:b.value,"onUpdate:modelValue":w[0]||(w[0]=S=>b.value=S)},null,8,["disabled","label","placeholder","min-value","max-value","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(F,{disabled:!0,label:e(n)("Currency"),placeholder:e(n)("Currency"),modelValue:f.value,"onUpdate:modelValue":w[1]||(w[1]=S=>f.value=S)},null,8,["label","placeholder","modelValue"])]),_:1}),t(R,{cols:"12",class:"text-center"},{default:a(()=>[t(ie,{icon:e(eu),size:"24"},null,8,["icon"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(I,{disabled:y.value,label:e(n)("Amount"),placeholder:e(n)("Amount"),"persistent-placeholder":!0,"min-value":e(Es),"max-value":e(Fs),"max-decimal-count":4,modelValue:u.value,"onUpdate:modelValue":w[2]||(w[2]=S=>u.value=S)},null,8,["disabled","label","placeholder","min-value","max-value","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(F,{disabled:y.value,label:e(n)("Currency"),placeholder:e(n)("Currency"),modelValue:x.value,"onUpdate:modelValue":w[3]||(w[3]=S=>x.value=S)},null,8,["disabled","label","placeholder","modelValue"])]),_:1})]),_:1})]),_:1}),t(ge,null,{default:a(()=>[o("div",b0,[t(H,{disabled:y.value||!b.value||!x.value||!u.value,onClick:p},{default:a(()=>[q(i(e(n)("OK"))+" ",1),y.value?(l(),c(Ze,{key:0,indeterminate:"",size:"22",class:"ms-2"})):r("",!0)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",disabled:y.value,onClick:T},{default:a(()=>[q(i(e(n)("Cancel")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["persistent","modelValue"]),t(ct,{ref_key:"snackbar",ref:m},null,512)],64)}}}),k0={class:"mx-6 my-4"},_0={class:"text-subtitle-2"},x0={class:"text-body-1 mt-1 mb-3"},C0=["href"],w0={key:1},A0={key:2},S0={key:3},V0={key:4},I0={key:0,class:"text-subtitle-2"},D0={key:1,class:"text-body-1 mt-1"},$0={key:0},N0={key:1},F0={class:"mx-6 mt-4"},E0={class:"text-subtitle-2"},M0={class:"mx-6 mt-4"},U0={class:"text-subtitle-2"},P0={class:"d-flex w-100"},B0={class:"d-block text-truncate"},L0={class:"smaller ms-1"},z0={key:1,class:"mx-6 mt-2 mb-4"},O0={key:0},R0={key:1},q0={class:"title-and-toolbar d-flex align-center"},Y0={class:"d-flex align-center"},j0={class:"px-0"},H0={key:0},W0={class:"d-flex align-center"},G0={class:"text-sm"},K0={class:"text-caption ms-1"},Q0={class:"ms-3"},J0=Oe({__name:"ListPage",setup(v){const{mdAndUp:_}=Rl(),{tt:n,getCurrentNumeralSystemType:s,formatExchangeRateAmountToWesternArabicNumerals:h}=je(),{baseCurrency:d,baseAmount:y,defaultCurrency:f,exchangeRatesData:b,isUserCustomExchangeRates:x,exchangeRatesDataUpdateTime:u,availableExchangeRates:m,getConvertedAmount:k,setAsBaseline:N}=fc(),V=ps(),p=xe("confirmDialog"),T=xe("snackbar"),A=xe("updateDialog"),w=P("exchangeRatesPage"),I=P(!0),F=P(!1),S=P({}),j=P(_.value),B=P(_.value),U=E(()=>s());function X($){I.value=!0,V.getLatestExchangeRates({silent:!1,force:$}).then(()=>{if(I.value=!1,b.value&&b.value.exchangeRates){const C=b.value.exchangeRates;let M=!1;for(const ee of C)if(ee.currency===d.value){M=!0;break}$?T.value?.showMessage("Exchange rates data has been updated"):M||T.value?.showMessage("There is no exchange rates data for your default currency")}}).catch(C=>{I.value=!1,C.processed||T.value?.showError(C)})}function oe(){A.value?.open().then($=>{$&&$.message&&T.value?.showMessage($.message)}).catch($=>{$&&T.value?.showError($)})}function W($){p.value?.open("Are you sure you want to delete this user custom exchange rate?").then(()=>{F.value=!0,S.value[$]=!0,V.deleteUserCustomExchangeRate({currency:$}).then(()=>{$===d.value&&(d.value=f.value),F.value=!1,S.value[$]=!1}).catch(C=>{F.value=!1,S.value[$]=!1,C.processed||T.value?.showError(C)})})}function D($,C){if(!d.value)return C?U.value.digitZero:Ml.WesternArabicNumerals.digitZero;const M=V.latestExchangeRateMap[d.value];let ee=0;try{ee=k(y.value/100,M,$)}catch(L){ee=0,Xt.warn("failed to convert amount by exchange rates, original base amount is "+y.value,L)}if(!ee)return C?U.value.digitZero:Ml.WesternArabicNumerals.digitZero;let ye=h(ee);return C&&(ye=U.value.replaceWesternArabicDigitsToLocalizedDigits(ye)),ye}return Ft(_,$=>{j.value=$,B.value||(B.value=$)}),X(!1),($,C)=>{const M=Ve("amount-input");return l(),g(fe,null,[t(Ae,{class:"match-height"},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,null,{default:a(()=>[t(Jl,null,{default:a(()=>[t(Zl,{permanent:j.value,modelValue:B.value,"onUpdate:modelValue":C[2]||(C[2]=ee=>B.value=ee)},{default:a(()=>[o("div",k0,[o("span",_0,i(e(n)("Data source")),1),o("p",x0,[!I.value&&e(b)&&!e(x)&&e(b).referenceUrl?(l(),g("a",{key:0,tabindex:"-1",target:"_blank",href:e(b).referenceUrl},i(e(b).dataSource),9,C0)):!I.value&&e(b)&&!e(x)&&!e(b).referenceUrl?(l(),g("span",w0,i(e(b).dataSource),1)):!I.value&&e(b)&&e(x)?(l(),g("span",A0,i(e(n)("User Custom")),1)):!I.value&&!e(b)?(l(),g("span",S0,i(e(n)("None")),1)):I.value?(l(),g("span",V0,[t(ft,{class:"skeleton-no-margin mt-3 mb-4",type:"text",loading:!0})])):r("",!0)]),e(u)||I.value?(l(),g("span",I0,i(e(n)("Last Updated")),1)):r("",!0),e(u)||I.value?(l(),g("p",D0,[I.value?r("",!0):(l(),g("span",$0,i(e(u)),1)),I.value?(l(),g("span",N0,[t(ft,{class:"skeleton-no-margin mt-3 mb-4",type:"text",loading:!0})])):r("",!0)])):r("",!0)]),t(nt),o("div",F0,[o("span",E0,i(e(n)("Base Amount")),1),t(M,{class:"mt-2",density:"compact",currency:e(d),disabled:I.value||!e(b)||!e(b).exchangeRates||!e(b).exchangeRates.length,modelValue:e(y),"onUpdate:modelValue":C[0]||(C[0]=ee=>ht(y)?y.value=ee:null)},null,8,["currency","disabled","modelValue"])]),o("div",M0,[o("span",U0,i(e(n)("Base Currency")),1)]),e(b)&&e(b).exchangeRates&&e(b).exchangeRates.length?(l(),c(Ja,{key:0,"show-arrows":"",class:"mb-4",direction:"vertical",disabled:I.value,modelValue:e(d),"onUpdate:modelValue":C[1]||(C[1]=ee=>ht(d)?d.value=ee:null)},{default:a(()=>[(l(!0),g(fe,null,$e(e(m),ee=>(l(),c(Wt,{class:"tab-text-truncate",key:ee.currencyCode,value:ee.currencyCode},{default:a(()=>[o("div",P0,[o("span",B0,i(ee.currencyDisplayName),1),o("small",L0,i(ee.currencyCode),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["disabled","modelValue"])):!e(b)||!e(b).exchangeRates||!e(b).exchangeRates.length?(l(),g("div",z0,[I.value?I.value?(l(),g("span",R0,[(l(),g(fe,null,$e([1,2,3,4,5,6,7,8,9,10],ee=>t(ft,{class:"skeleton-no-margin pt-2 pb-5",type:"text",key:ee,loading:I.value},null,8,["loading"])),64))])):r("",!0):(l(),g("span",O0,i(e(n)("None")),1))])):r("",!0)]),_:1},8,["permanent","modelValue"]),t(Xl,null,{default:a(()=>[t(qa,{class:"d-flex flex-grow-1 disable-tab-transition w-100-window-container",modelValue:w.value,"onUpdate:modelValue":C[5]||(C[5]=ee=>w.value=ee)},{default:a(()=>[t(zt,{value:"exchangeRatesPage"},{default:a(()=>[t(Me,{variant:"flat","min-height":"680"},{title:a(()=>[o("div",q0,[t(H,{class:"me-3 d-md-none",density:"compact",color:"default",variant:"plain",ripple:!1,icon:!0,onClick:C[3]||(C[3]=ee=>B.value=!B.value)},{default:a(()=>[t(ie,{icon:e(ql),size:"24"},null,8,["icon"])]),_:1}),o("span",null,i(e(n)("Exchange Rates Data")),1),e(x)?(l(),c(H,{key:0,class:"ms-3",color:"default",variant:"outlined",disabled:I.value,onClick:oe},{default:a(()=>[q(i(e(n)("Update")),1)]),_:1},8,["disabled"])):r("",!0),t(H,{density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,loading:I.value,onClick:C[4]||(C[4]=ee=>X(!0))},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20"})]),default:a(()=>[t(ie,{icon:e(Ta),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(n)("Refresh")),1)]),_:1})]),_:1},8,["loading"])])]),default:a(()=>[t(sl,{class:"exchange-rates-table table-striped",hover:!I.value},{default:a(()=>[o("thead",null,[o("tr",null,[o("th",null,[o("div",Y0,[o("span",null,i(e(n)("Currency")),1),t(it),o("span",null,i(e(n)("Amount")),1)])])])]),o("tbody",null,[(l(!0),g(fe,null,$e(I.value&&(!e(b)||!e(b).exchangeRates||e(b).exchangeRates.length<1)?[1,2,3,4,5,6,7,8,9,10,11,12]:[],ee=>(l(),g("tr",{key:ee},[o("td",j0,[t(ft,{type:"text",loading:!0})])]))),128)),!I.value&&(!e(b)||!e(b).exchangeRates||!e(b).exchangeRates.length)?(l(),g("tr",H0,[o("td",null,i(e(n)("No exchange rates data")),1)])):r("",!0),(l(!0),g(fe,null,$e(e(m),ee=>(l(),g("tr",{class:"exchange-rates-table-row-data",key:ee.currencyCode},[o("td",null,[o("div",W0,[o("span",G0,i(ee.currencyDisplayName),1),o("span",K0,i(ee.currencyCode),1),t(it),ee.currencyCode!==e(d)?(l(),c(H,{key:0,class:be(["px-2 ms-2",{"d-none":I.value,"hover-display":!I.value}]),color:"default",density:"comfortable",variant:"text",onClick:ye=>e(N)(ee.currencyCode,D(ee,!1))},{default:a(()=>[q(i(e(n)("Set as Base")),1)]),_:1},8,["class","onClick"])):r("",!0),ee.currencyCode!==e(f)&&e(x)?(l(),c(H,{key:1,class:be(["px-2",{"d-none":I.value,"hover-display":!I.value}]),color:"default",density:"comfortable",variant:"text","prepend-icon":e(bn),loading:S.value[ee.currencyCode],disabled:I.value||F.value,onClick:ye=>W(ee.currencyCode)},{loader:a(()=>[t(Ze,{indeterminate:"",size:"20",width:"2"})]),default:a(()=>[q(" "+i(e(n)("Delete")),1)]),_:1},8,["class","prepend-icon","loading","disabled","onClick"])):r("",!0),o("span",Q0,i(D(ee,!0)),1)])])]))),128))])]),_:1},8,["hover"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(T0,{ref_key:"updateDialog",ref:A},null,512),t(ka,{ref_key:"confirmDialog",ref:p},null,512),t(ct,{ref_key:"snackbar",ref:T},null,512)],64)}}}),Z0={class:"d-flex align-center"},X0={class:"text-body-1"},eC={class:"text-body-1"},tC={class:"text-body-1"},aC={class:"text-body-1"},lC={class:"text-body-1"},nC={class:"text-body-1"},oC={class:"text-body-1"},sC={class:"text-body-1"},iC=["href"],rC={key:1,class:"text-body-1"},uC={class:"text-body-1"},dC=["href"],cC={key:1,class:"text-body-1"},mC={class:"contributors-table"},pC=["href"],vC={class:"contributors-table"},fC=["href"],yC={key:0},gC={key:0},hC={key:0},bC={key:1},TC={key:2},kC=["href"],_C={key:4},xC={key:5,class:"work-break-all"},CC=["href"],wC=Oe({__name:"AboutPage",setup(v){const{tt:_,getLanguageInfo:n}=je(),{clientVersion:s,clientVersionMatchServerVersion:h,clientBuildTime:d,exchangeRatesData:y,isUserCustomExchangeRates:f,mapProviderName:b,mapProviderWebsite:x,contributors:u,licenseLines:m,thirdPartyLicenses:k,refreshBrowserCache:N,init:V}=yc();return V(),(p,T)=>(l(),c(Ae,{class:"match-height"},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[t(Me,null,{title:a(()=>[o("div",Z0,[o("span",null,i(e(_)("global.app.title")),1),e(h)?r("",!0):(l(),c(H,{key:0,density:"compact",color:"default",variant:"text",size:"24",class:"ms-2",icon:!0,onClick:e(N)},{default:a(()=>[t(ie,{icon:e(tu),size:"24"},null,8,["icon"]),t(vt,{activator:"parent"},{default:a(()=>[q(i(e(_)("Refresh Browser Cache")),1)]),_:1})]),_:1},8,["onClick"]))])]),default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,{"no-gutters":""},{default:a(()=>[t(R,{cols:"12",md:"2"},{default:a(()=>[o("span",X0,i(e(_)("Version")),1)]),_:1}),t(R,{cols:"12",md:"10",class:"mb-6"},{default:a(()=>[o("span",eC,i(e(s)),1)]),_:1})]),_:1}),e(d)?(l(),c(Ae,{key:0,"no-gutters":""},{default:a(()=>[t(R,{cols:"12",md:"2"},{default:a(()=>[o("span",tC,i(e(_)("Build Time")),1)]),_:1}),t(R,{cols:"12",md:"10",class:"mb-6"},{default:a(()=>[o("span",aC,i(e(d)),1)]),_:1})]),_:1})):r("",!0),t(Ae,{"no-gutters":""},{default:a(()=>[t(R,{cols:"12",md:"2"},{default:a(()=>[o("span",lC,i(e(_)("Official Website")),1)]),_:1}),t(R,{cols:"12",md:"10",class:"mb-6"},{default:a(()=>[...T[0]||(T[0]=[o("a",{class:"text-body-1",href:"https://github.com/mayswind/ezbookkeeping",target:"_blank"}," https://github.com/mayswind/ezbookkeeping ",-1)])]),_:1})]),_:1}),t(Ae,{"no-gutters":""},{default:a(()=>[t(R,{cols:"12",md:"2"},{default:a(()=>[o("span",nC,i(e(_)("Report Issue")),1)]),_:1}),t(R,{cols:"12",md:"10",class:"mb-6"},{default:a(()=>[...T[1]||(T[1]=[o("a",{class:"text-body-1",href:"https://github.com/mayswind/ezbookkeeping/issues",target:"_blank"}," https://github.com/mayswind/ezbookkeeping/issues ",-1)])]),_:1})]),_:1}),t(Ae,{"no-gutters":""},{default:a(()=>[t(R,{cols:"12",md:"2"},{default:a(()=>[o("span",oC,i(e(_)("Getting help")),1)]),_:1}),t(R,{cols:"12",md:"10"},{default:a(()=>[...T[2]||(T[2]=[o("a",{class:"text-body-1",href:"https://ezbookkeeping.mayswind.net",target:"_blank"}," https://ezbookkeeping.mayswind.net ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(y)&&!e(f)?(l(),c(R,{key:0,cols:"12"},{default:a(()=>[t(Me,{title:e(_)("Exchange Rates Data")},{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,{"no-gutters":""},{default:a(()=>[t(R,{cols:"12",md:"2"},{default:a(()=>[o("span",sC,i(e(_)("Provider")),1)]),_:1}),t(R,{cols:"12",md:"10"},{default:a(()=>[e(y).referenceUrl?(l(),g("a",{key:0,class:"text-body-1",href:e(y).referenceUrl,target:"_blank"},i(e(y).dataSource),9,iC)):r("",!0),e(y).referenceUrl?r("",!0):(l(),g("span",rC,i(e(y).dataSource),1))]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})):r("",!0),e(b)?(l(),c(R,{key:1,cols:"12"},{default:a(()=>[t(Me,{title:e(_)("Map")},{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,{"no-gutters":""},{default:a(()=>[t(R,{cols:"12",md:"2"},{default:a(()=>[o("span",uC,i(e(_)("Provider")),1)]),_:1}),t(R,{cols:"12",md:"10"},{default:a(()=>[e(x)?(l(),g("a",{key:0,class:"text-body-1",href:e(x),target:"_blank"},i(e(b)),9,dC)):r("",!0),e(x)?r("",!0):(l(),g("span",cC,i(e(b)),1))]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})):r("",!0),t(R,{cols:"12"},{default:a(()=>[t(Me,{title:e(_)("License")},{default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,{"no-gutters":""},{default:a(()=>[t(R,{cols:"12"},{default:a(()=>[o("p",null,[(l(!0),g(fe,null,$e(e(m),(A,w)=>(l(),g("span",{key:w,style:kl({display:A?"initial":"block",padding:A?"0":"0 0 1em 0"})},i(A),5))),128))]),t(nt),T[5]||(T[5]=o("br",null,null,-1)),T[6]||(T[6]=o("p",null,[o("span",null,"ezBookkeeping's codebase and localization translation rely on contributions from the community. The following people have contributed to ezBookkeeping:")],-1)),T[7]||(T[7]=o("div",null,[o("strong",null,"Project Maintainer"),o("div",{class:"mt-2"},[o("a",{target:"_blank",href:"https://github.com/mayswind"},"@mayswind")])],-1)),T[8]||(T[8]=o("p",{class:"mt-4"},[o("strong",null,"Code Contributors")],-1)),o("table",mC,[T[3]||(T[3]=o("thead",null,[o("tr",null,[o("th",null,"Contributor")])],-1)),o("tbody",null,[(l(!0),g(fe,null,$e(e(u).code,(A,w)=>(l(),g("tr",{key:w},[o("td",null,[o("a",{target:"_blank",href:`https://github.com/${A}`}," @"+i(A),9,pC)])]))),128))])]),T[9]||(T[9]=o("p",{class:"mt-4"},[o("strong",null,"Translation Contributors")],-1)),o("table",vC,[T[4]||(T[4]=o("thead",null,[o("tr",null,[o("th",null,"Tag"),o("th",null,"Language"),o("th",null,"Contributors")])],-1)),o("tbody",null,[(l(!0),g(fe,null,$e(e(u).translators,(A,w)=>za((l(),g("tr",{key:w},[o("td",null,i(w),1),o("td",null,i(e(n)(w)?.displayName),1),o("td",null,[(l(!0),g(fe,null,$e(A,(I,F)=>(l(),g(fe,{key:I},[o("a",{target:"_blank",href:`https://github.com/${I}`}," @"+i(I),9,fC),F<A.length-1?(l(),g("span",yC,", ")):r("",!0)],64))),128)),!A||A.length<1?(l(),g("span",gC,"/")):r("",!0)])])),[[Ka,!!e(n)(w)?.displayName]])),128))])]),T[10]||(T[10]=o("p",{class:"mt-4 mb-4"},[o("span",null,"ezBookkeeping also contains additional third party software and illustration."),o("br"),o("span",null,"All the third party software / illustration included or linked is redistributed under the terms and conditions of their original licenses.")],-1)),(l(!0),g(fe,null,$e(e(k),A=>(l(),g("p",{key:A.name},[o("strong",null,i(A.name),1),A.copyright?(l(),g("br",hC)):r("",!0),A.copyright?(l(),g("span",bC,i(A.copyright),1)):r("",!0),A.url?(l(),g("br",TC)):r("",!0),A.url?(l(),g("a",{key:3,class:"work-break-all",target:"_blank",href:A.url},i(A.url),9,kC)):r("",!0),A.licenseUrl?(l(),g("br",_C)):r("",!0),A.licenseUrl?(l(),g("span",xC,"License: ")):r("",!0),o("a",{target:"_blank",href:A.licenseUrl},i(A.licenseUrl),9,CC)]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})]),_:1}))}});function Sa(){return xl()?qn()?!0:{path:"/unlock",replace:!0}:{path:"/login",replace:!0}}function AC(){return xl()?qn()?{path:"/",replace:!0}:!0:{path:"/login",replace:!0}}function Uo(){return xl()&&!qn()?{path:"/unlock",replace:!0}:xl()?{path:"/",replace:!0}:!0}const SC=au({history:lu(),routes:[{path:"/",component:jm,beforeEnter:Sa,children:[{path:"",component:Af,beforeEnter:Sa},{path:"/transaction/list",component:Oh,beforeEnter:Sa,props:v=>({initPageType:v.query.pageType,initDateType:v.query.dateType,initMaxTime:v.query.maxTime,initMinTime:v.query.minTime,initType:v.query.type,initCategoryIds:v.query.categoryIds,initAccountIds:v.query.accountIds,initTagFilter:v.query.tagFilter,initAmountFilter:v.query.amountFilter,initKeyword:v.query.keyword})},{path:"/statistics/transaction",component:vb,beforeEnter:Sa,props:v=>({initAnalysisType:v.query.analysisType,initChartDataType:v.query.chartDataType,initChartType:v.query.chartType,initChartDateType:v.query.chartDateType,initStartTime:v.query.startTime,initEndTime:v.query.endTime,initFilterAccountIds:v.query.filterAccountIds,initFilterCategoryIds:v.query.filterCategoryIds,initTagFilter:v.query.tagFilter,initKeyword:v.query.keyword,initSortingType:v.query.sortingType,initTrendDateAggregationType:v.query.trendDateAggregationType,initAssetTrendsDateAggregationType:v.query.assetTrendsDateAggregationType})},{path:"/insights/explore",component:eT,beforeEnter:Sa,props:v=>({initId:v.query.id,initActiveTab:v.query.activeTab,initDateRangeType:v.query.dateRangeType,initStartTime:v.query.startTime,initEndTime:v.query.endTime})},{path:"/account/list",component:Mk,beforeEnter:Sa},{path:"/account/quick_balance_modify",component:Jk,beforeEnter:Sa},{path:"/category/list",component:V_,beforeEnter:Sa},{path:"/tag/list",component:R_,beforeEnter:Sa},{path:"/template/list",component:Bs,beforeEnter:Sa,props:{initType:Da.Normal.type}},{path:"/schedule/list",component:Bs,beforeEnter:Sa,props:{initType:Da.Schedule.type}},{path:"/exchange_rates",component:J0,beforeEnter:Sa},{path:"/user/settings",component:e0,beforeEnter:Sa,props:v=>({initTab:v.query.tab})},{path:"/app/settings",component:y0,beforeEnter:Sa,props:v=>({initTab:v.query.tab})},{path:"/about",component:wC,beforeEnter:Sa}]},{path:"/login",component:ip,beforeEnter:Uo},{path:"/signup",component:wp,beforeEnter:Uo},{path:"/verify_email",component:qp,props:v=>({email:v.query.email,token:v.query.token,hasValidEmailVerifyToken:v.query.emailSent==="true"})},{path:"/forgetpassword",component:tv,beforeEnter:Uo},{path:"/resetpassword",component:pv,props:v=>({token:v.query.token})},{path:"/oauth2_callback",component:Iv,props:v=>({token:v.query.token,provider:v.query.provider,platform:v.query.platform,userName:v.query.userName,errorCode:v.query.errorCode,errorMessage:v.query.errorMessage})},{path:"/unlock",component:qv,beforeEnter:AC}]}),VC=Oe({__name:"ItemIcon",props:{class:{},hiddenStatus:{type:Boolean},iconType:{},iconId:{},color:{},defaultColor:{},additionalColorAttr:{},size:{}},setup(v){const _=v,{getCurrentLanguageTextDirection:n}=je(),{style:s,getAccountIcon:h,getCategoryIcon:d}=gc(_),y=E(()=>n()),f=E(()=>{let b=_.class?_.class+" ":"";return _.iconType==="account"?b+=h(_.iconId):_.iconType==="category"?b+=d(_.iconId):_.iconType==="fixed"&&(b+=_.iconId),b});return(b,x)=>(l(),g(fe,null,[v.hiddenStatus?r("",!0):(l(),g("i",{key:0,class:be(["item-icon",f.value]),style:kl(e(s))},[pn(b.$slots,"default")],6)),v.hiddenStatus?(l(),c(Il,{key:1,class:"right-bottom-icon",color:"secondary","offset-y":"4",location:`bottom ${y.value===e(Tn).LTR?"right":"left"}`,icon:e(da)},{default:a(()=>[o("i",{class:be(["item-icon",f.value]),style:kl(e(s))},[pn(b.$slots,"default")],6)]),_:3},8,["location","icon"])):r("",!0)],64))}}),IC={class:"btn-vertical-group d-flex flex-column"},DC=Oe({__name:"BtnVerticalGroup",props:{modelValue:{},buttons:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(v,{emit:_}){const n=v,s=_,h=E({get:()=>n.modelValue,set:d=>{d!==n.modelValue&&s("update:modelValue",d)}});return(d,y)=>(l(),g("div",IC,[(l(!0),g(fe,null,$e(v.buttons,(f,b)=>(l(),c(H,{border:"",key:b,color:h.value===f.value?"primary":"default",variant:h.value===f.value?"tonal":"outlined",disabled:v.disabled,onClick:x=>h.value=f.value},{default:a(()=>[q(i(f.name),1)]),_:2},1032,["color","variant","disabled","onClick"]))),128))]))}}),$C=Oe({__name:"NumberInput",props:{class:{},density:{},persistentPlaceholder:{type:Boolean},minValue:{},maxValue:{},maxDecimalCount:{},label:{},placeholder:{},disabled:{type:Boolean},readonly:{type:Boolean},modelValue:{}},emits:["update:modelValue"],setup(v,{emit:_}){const n=v,s=_,{currentValue:h,onKeyUpDown:d,onPaste:y}=hc(n,s),f=E(()=>n.class||"");return(b,x)=>(l(),c(ot,{type:"text",class:be(f.value),density:v.density,readonly:!!v.readonly,disabled:!!v.disabled,label:v.label,placeholder:v.placeholder,"persistent-placeholder":!!v.persistentPlaceholder,modelValue:e(h),"onUpdate:modelValue":x[0]||(x[0]=u=>ht(h)?h.value=u:null),onKeydown:e(d),onKeyup:e(d),onPaste:e(y)},null,8,["class","density","readonly","disabled","label","placeholder","persistent-placeholder","modelValue","onKeydown","onKeyup","onPaste"]))}}),NC={key:0,class:"text-no-wrap"},FC={key:0,class:"text-no-wrap"},EC={class:"text-no-wrap"},MC=Oe({__name:"AmountInput",props:{class:{},color:{},density:{},variant:{},currency:{},showCurrency:{type:Boolean},persistentPlaceholder:{type:Boolean},hide:{type:Boolean},enableRules:{type:Boolean},enableFormula:{type:Boolean},flipNegative:{type:Boolean},label:{},placeholder:{},disabled:{type:Boolean},readonly:{type:Boolean},modelValue:{}},emits:["update:modelValue"],setup(v,{emit:_}){const n=v,s=_,{tt:h,getCurrentNumeralSystemType:d,getCurrentDecimalSeparator:y,parseAmountFromLocalizedNumerals:f,formatAmountToLocalizedNumeralsWithoutDigitGrouping:b,getAmountPrependAndAppendText:x}=je(),{currentValue:u,onKeyUpDown:m,onPaste:k}=bc(n,Tc,oe(n.modelValue,n.flipNegative),f,W,X),N=xe("snackbar"),V=[$=>{if($==="")return h("Amount value is not number");try{const C=f($);return Number.isNaN(C)||!Number.isFinite(C)?h("Amount value is not number"):C>=no&&C<=oo||h("Amount value exceeds limitation")}catch(C){return Xt.warn("cannot parse amount in amount input, original value is "+$,C),h("Amount value is not number")}}],p=P(""),T=P(!1),A=E(()=>d()),w=E(()=>{if(!n.currency||!n.showCurrency)return"";const $=D();return $?$.prependText:""}),I=E(()=>{if(!n.currency||!n.showCurrency)return"";const $=D();return $?$.appendText:""}),F=E(()=>{let $=n.class||"";return n.color&&($+=` text-${n.color}`),n.currency&&w.value&&($+=" has-pretend-text"),$});function S(){n.enableFormula&&(p.value=u.value,T.value=!0)}function j(){const $=Ci.Dot.symbol,C=y();let M=p.value;if($!==C&&M.indexOf($)>=0){N.value?.showMessage("Formula is invalid");return}else $!==C&&(M=Vn(p.value,C,$));M=A.value.replaceLocalizedDigitsToWesternArabicDigits(M);try{const ee=kc(M);if(Zt(ee)){const ye=W(ee),L=ye.indexOf(C)>=0;u.value=X(ee,ye,L),T.value=!1}else N.value?.showMessage("Formula is invalid")}catch(ee){Xt.error("cannot evaluate formula in amount input, original formula is "+M,ee),ee instanceof Error&&N.value?.showMessage(ee.message)}}function B(){T.value=!1,p.value=""}function U($){if(!n.disabled&&!n.readonly&&n.modelValue===0&&$.target instanceof HTMLInputElement){const C=$.target;(!C?.selectionStart&&!C?.selectionEnd||C?.selectionStart===C?.selectionEnd)&&C?.select()}}function X($,C,M){let ee=oo.toString().length;return $<0&&(ee=no.toString().length),$<no?W(no):$>oo?W(oo):!M&&C.length>ee?C.substring(0,ee):M&&C.length>ee+1?C.substring(0,ee+1):C}function oe($,C){return C&&($=-$),W($)}function W($){return!Number.isNaN($)&&Number.isFinite($)?b($,n.currency):A.value.digitZero}function D(){const $=f(u.value),C=$!==100&&$!==-100;return x(n.currency,C)}return Ft(()=>n.currency,()=>{const $=oe(n.modelValue,n.flipNegative);$===A.value.digitZero&&u.value===""||(u.value=$)}),Ft(()=>n.flipNegative,$=>{const C=oe(n.modelValue,$);C===A.value.digitZero&&u.value===""||(u.value=C)}),Ft(()=>n.modelValue,$=>{n.flipNegative&&($=-$);const C=f(u.value);if($!==C){const M=W($);M===A.value.digitZero&&u.value===""||(u.value=M)}}),Ft(u,$=>{let C,M="";if($){const ee=y();if($[0]==="-"||$[0]===ee?C=Ml.detect($.charAt(1)):C=Ml.detect($.charAt(0)),C&&(C.type===Ml.WesternArabicNumerals.type||C.type===A.value.type)){for(let ye=0;ye<$.length;ye++){const L=$.charAt(ye);if(!Ml.WesternArabicNumerals.isDigit(L)&&!A.value.isDigit(L)&&L!=="-"&&L!==ee)break;M+=L}M=A.value.replaceWesternArabicDigitsToLocalizedDigits(M)}else($==="-"||$===ee||$===`-${ee}`)&&(M=$)}if(M!==$)u.value=M;else{let ee=f(M);(Number.isNaN(ee)||!Number.isFinite(ee))&&(ee=0),n.flipNegative&&(ee=-ee),s("update:modelValue",ee)}}),($,C)=>(l(),g(fe,null,[!v.hide&&!T.value?(l(),c(ot,{key:0,type:"text",class:be(["text-field-with-colored-label",F.value]),color:v.color,"base-color":v.color,density:v.density,variant:v.variant,readonly:!!v.readonly,disabled:!!v.disabled,label:v.label,placeholder:v.placeholder,"persistent-placeholder":!!v.persistentPlaceholder,rules:v.enableRules?V:[],modelValue:e(u),"onUpdate:modelValue":C[0]||(C[0]=M=>ht(u)?u.value=M:null),onKeydown:e(m),onKeyup:e(m),onPaste:e(k),onClick:U},ro({"append-inner":a(()=>[v.currency&&I.value?(l(),g("div",NC,i(I.value),1)):r("",!0),t(vt,{text:e(h)("Enter formula mode")},{activator:a(({props:M})=>[v.enableFormula&&!T.value?(l(),c(ie,_t({key:0,class:"ms-2",icon:e(ri),onKeydown:[Gt(S,["enter"]),Gt(S,["space"])],onClick:S},M),null,16,["icon"])):r("",!0)]),_:1},8,["text"])]),_:2},[v.currency&&w.value?{name:"prepend-inner",fn:a(()=>[o("div",null,i(w.value),1)]),key:"0"}:void 0]),1032,["class","color","base-color","density","variant","readonly","disabled","label","placeholder","persistent-placeholder","rules","modelValue","onKeydown","onKeyup","onPaste"])):r("",!0),!v.hide&&T.value?(l(),c(ot,{key:1,type:"text",class:be(["text-field-with-colored-label",F.value]),color:v.color,"base-color":v.color,density:v.density,readonly:!!v.readonly,disabled:!!v.disabled,label:v.label,placeholder:v.placeholder,"persistent-placeholder":!!v.persistentPlaceholder,modelValue:p.value,"onUpdate:modelValue":C[1]||(C[1]=M=>p.value=M),onKeydown:Gt(j,["enter"]),onClick:U},ro({"append-inner":a(()=>[v.currency&&I.value?(l(),g("div",FC,i(I.value),1)):r("",!0),t(vt,{text:e(h)("Calculate formula result")},{activator:a(({props:M})=>[T.value?(l(),c(ie,_t({key:0,class:"ms-2",color:"primary",icon:e(Xe),onClick:j},M),null,16,["icon"])):r("",!0)]),_:1},8,["text"]),t(vt,{text:e(h)("Exit formula mode")},{activator:a(({props:M})=>[T.value?(l(),c(ie,_t({key:0,class:"ms-2",color:"secondary",icon:e(vl),onClick:B},M),null,16,["icon"])):r("",!0)]),_:1},8,["text"])]),_:2},[v.currency&&w.value?{name:"prepend-inner",fn:a(()=>[o("div",null,i(w.value),1)]),key:"0"}:void 0]),1032,["class","color","base-color","density","readonly","disabled","label","placeholder","persistent-placeholder","modelValue"])):r("",!0),v.hide?(l(),c(ot,{key:2,type:"password",class:be(["text-field-with-colored-label",F.value]),color:v.color,"base-color":v.color,density:v.density,readonly:!!v.readonly,disabled:!!v.disabled,label:v.label,placeholder:v.placeholder,"persistent-placeholder":!!v.persistentPlaceholder,rules:v.enableRules?V:[],modelValue:e(u),"onUpdate:modelValue":C[2]||(C[2]=M=>ht(u)?u.value=M:null),onKeydown:e(m),onKeyup:e(m),onPaste:e(k),onClick:U},ro({_:2},[v.currency&&w.value?{name:"prepend-inner",fn:a(()=>[o("div",null,i(w.value),1)]),key:"0"}:void 0,v.currency&&I.value?{name:"append-inner",fn:a(()=>[o("div",EC,i(I.value),1)]),key:"1"}:void 0]),1032,["class","color","base-color","density","readonly","disabled","label","placeholder","persistent-placeholder","rules","modelValue","onKeydown","onKeyup","onPaste"])):r("",!0),t(ct,{ref_key:"snackbar",ref:N},null,512)],64))}}),UC={class:"d-flex align-center"},PC={key:1,class:"text-field-append-text"},BC=Oe({__name:"LanguageSelect",props:{label:{},placeholder:{},disabled:{type:Boolean},includeSystemDefault:{type:Boolean},useModelValue:{type:Boolean},modelValue:{}},emits:["update:modelValue"],setup(v,{emit:_}){const n=v,s=_,{getCurrentLanguageTag:h}=je(),{allLanguages:d,updateLanguage:y,isLanguageSelected:f}=wi(n,s),b=E({get:()=>n.useModelValue?n.modelValue??"":h(),set:x=>{y(x)}});return(x,u)=>(l(),c(Ge,{"item-title":"nativeDisplayName","item-value":"languageTag","persistent-placeholder":"",disabled:v.disabled,label:v.label,placeholder:v.placeholder,items:e(d),modelValue:b.value,"onUpdate:modelValue":u[0]||(u[0]=m=>b.value=m)},{item:a(({props:m,item:k})=>[t(ve,_t({value:k.value},m),{title:a(()=>[t(rt,null,{default:a(()=>[o("div",UC,[o("span",null,i(k.title),1),t(it,{style:{"min-width":"40px"}}),e(f)(k.raw.languageTag)?(l(),c(ie,{key:0,icon:e(Xe)},null,8,["icon"])):r("",!0),e(f)(k.raw.languageTag)?r("",!0):(l(),g("span",PC,i(k.raw.displayName),1))])]),_:2},1024)]),_:2},1040,["value"])]),_:1},8,["disabled","label","placeholder","items","modelValue"]))}}),LC={class:"d-flex align-center"},zC={key:1,class:"text-field-append-text"},OC=Oe({__name:"LanguageSelectButton",props:{disabled:{type:Boolean},includeSystemDefault:{type:Boolean},useModelValue:{type:Boolean},modelValue:{}},emits:["update:modelValue"],setup(v,{emit:_}){const n=v,s=_,{allLanguages:h,currentLanguageName:d,updateLanguage:y,isLanguageSelected:f}=wi(n,s),b=xe("languageMenu");function x(u){u&&ha(()=>{Ol(b.value?.$el,null,null,"div.v-list-item.list-item-selected")})}return(u,m)=>(l(),c(mt,{location:"bottom","max-height":"500","onUpdate:modelValue":x},{activator:a(({props:k})=>[t(H,_t({variant:"text",disabled:v.disabled},k),{default:a(()=>[q(i(e(d)),1)]),_:1},16,["disabled"])]),default:a(()=>[t(e(Je),{ref_key:"languageMenu",ref:b},{default:a(()=>[(l(!0),g(fe,null,$e(e(h),k=>(l(),c(ve,{key:k.languageTag,value:k.languageTag,class:be({"list-item-selected":e(f)(k.languageTag)})},{default:a(()=>[t(rt,{class:"cursor-pointer",onClick:N=>e(y)(k.languageTag)},{default:a(()=>[o("div",LC,[o("span",null,i(k.nativeDisplayName),1),t(it,{style:{"min-width":"40px"}}),e(f)(k.languageTag)?(l(),c(ie,{key:0,color:"primary",icon:e(Xe)},null,8,["icon"])):r("",!0),e(f)(k.languageTag)?r("",!0):(l(),g("span",zC,i(k.displayName),1))])]),_:2},1032,["onClick"])]),_:2},1032,["value","class"]))),128))]),_:1},512)]),_:1}))}}),RC={class:"text-field-append-text smaller"},qC={class:"d-flex align-center"},YC={key:1,class:"text-field-append-text"},jC=Oe({__name:"CurrencySelect",props:{disabled:{type:Boolean},label:{},placeholder:{},modelValue:{}},emits:["update:modelValue"],setup(v,{emit:_}){const n=v,s=_,{tt:h,getAllCurrencies:d}=je(),y=E(()=>d()),f=E({get:()=>n.modelValue,set:x=>{x===null?s("update:modelValue",""):s("update:modelValue",x)}});function b(x,u,m){if(!m)return!1;const k=u.toLowerCase()||"";return k?m.raw.displayName.toLowerCase().indexOf(k)>=0||m.raw.currencyCode.toLowerCase().indexOf(k)>=0:!0}return(x,u)=>(l(),c(ua,{"item-title":"displayName","item-value":"currencyCode","auto-select-first":"","persistent-placeholder":"",disabled:v.disabled,label:v.label,placeholder:v.placeholder,items:y.value,"no-data-text":e(h)("No results"),"custom-filter":b,modelValue:f.value,"onUpdate:modelValue":u[0]||(u[0]=m=>f.value=m)},{"append-inner":a(()=>[o("small",RC,i(f.value),1)]),item:a(({props:m,item:k})=>[t(ve,_t({value:k.value},m),{title:a(()=>[t(rt,null,{default:a(()=>[o("div",qC,[o("span",null,i(k.title),1),t(it,{style:{"min-width":"40px"}}),f.value===k.raw.currencyCode?(l(),c(ie,{key:0,icon:e(Xe)},null,8,["icon"])):r("",!0),f.value!==k.raw.currencyCode?(l(),g("small",YC,i(k.raw.currencyCode),1)):r("",!0)])]),_:2},1024)]),_:2},1040,["value"])]),_:1},8,["disabled","label","placeholder","items","no-data-text","modelValue"]))}}),HC={class:"text-truncate cursor-pointer"},WC={class:"date-time-select-time-picker-container"},GC=Oe({__name:"DateTimeSelect",props:{modelValue:{},timezoneUtcOffset:{},disabled:{type:Boolean},readonly:{type:Boolean},label:{}},emits:["update:modelValue","error"],setup(v,{emit:_}){const n=v,s=_,h=Kt(),{tt:d,getCurrentNumeralSystemType:y,parseDateTimeFromLongDateTime:f,parseDateTimeFromShortDateTime:b,formatDateTimeToLongDateTime:x}=je(),{is24Hour:u,isHourTwoDigits:m,isMinuteTwoDigits:k,isSecondTwoDigits:N,isMeridiemIndicatorFirst:V,getLocalDatetimeFromSameDateTimeOfUnixTime:p,getUnixTimeFromSameDateTimeOfLocalDatetime:T,getDisplayTimeValue:A,generateAllHours:w,generateAllMinutesOrSeconds:I}=_c(),F=xe("hourInput"),S=xe("minuteInput"),j=xe("secondInput"),B=E(()=>h.global.name.value===$t.Dark),U=E(()=>y()),X=E({get:()=>p(n.modelValue,n.timezoneUtcOffset),set:ae=>{const Z=T(ae,n.timezoneUtcOffset);if(Z<0){s("error","Date is too early");return}s("update:modelValue",Z)}}),oe=E(()=>x(go(n.modelValue,n.timezoneUtcOffset))),W=E(()=>w(1,m.value)),D=E(()=>I(1,k.value)),$=E(()=>I(1,N.value)),C=E({get:()=>xc(X.value.getHours()),set:ae=>{ae!==Sn.AM.name&&ae!==Sn.PM.name||(X.value=so(X.value,U.value,M.value,ee.value,ye.value,ae,u.value))}}),M=E({get:()=>A(u.value?X.value.getHours():Cc(X.value.getHours()),m.value),set:ae=>{const Z=U.value.parseInt(ae);isNaN(Z)||Z<0||(u.value?Z>23:Z>12)||(X.value=so(X.value,U.value,ae,ee.value,ye.value,C.value,u.value))}}),ee=E({get:()=>A(X.value.getMinutes(),k.value),set:ae=>{const Z=U.value.parseInt(ae);isNaN(Z)||Z<0||Z>59||(X.value=so(X.value,U.value,M.value,ae,ye.value,C.value,u.value))}}),ye=E({get:()=>A(X.value.getSeconds(),N.value),set:ae=>{const Z=U.value.parseInt(ae);isNaN(Z)||Z<0||Z>59||(X.value=so(X.value,U.value,M.value,ee.value,ae,C.value,u.value))}});function L(){C.value===Sn.AM.name?C.value=Sn.PM.name:C.value=Sn.AM.name}function Y(ae){if(!ae.clipboardData||n.readonly||n.disabled){ae.preventDefault();return}let Z=ae.clipboardData.getData("Text");if(!Z){ae.preventDefault();return}Z=Z.trim();const le=fo.detect(Z);let z;if(le&&le.length===1&&(z=bi(Z,le[0]),z)){X.value=Eo(Mo(z).getUnixTime());return}if(z=f(Z),z){X.value=Eo(Mo(z).getUnixTime());return}if(z=b(Z),z){X.value=Eo(Mo(z).getUnixTime());return}ae.preventDefault()}function O(ae,Z){ae&&Z&&ha(()=>{sn(ae?.$el,"input")})}function J(ae,Z){if(Z.altKey||Z.ctrlKey||Z.metaKey||Z.key.indexOf("F")===0&&(Z.key.length===2||Z.key.length===3)||Z.key==="ArrowLeft"||Z.key==="ArrowRight"||Z.key==="Home"||Z.key==="End"||Z.key==="Backspace"||Z.key==="Delete"||Z.key==="Del"||Z.key.length===1&&U.value.isDigit(Z.key))return;let le="";if(Z.target instanceof HTMLInputElement&&(le=Z.target.value),!!le){if((Z.key==="Tab"||Z.key==="Enter")&&(ae==="hour"?M.value=le:ae==="minute"?ee.value=le:ae==="second"&&(ye.value=le)),Z.shiftKey&&Z.key==="Tab"){ae==="minute"?ha(()=>{setTimeout(()=>{sn(F.value?.$el,"input")},50)}):ae==="second"&&ha(()=>{setTimeout(()=>{sn(S.value?.$el,"input")},50)}),Z.preventDefault(),Z.stopPropagation();return}!Z.shiftKey&&(Z.key==="Tab"||Z.key==="Enter")&&(ae==="hour"?ha(()=>{setTimeout(()=>{sn(S.value?.$el,"input")},50)}):ae==="minute"&&ha(()=>{setTimeout(()=>{sn(j.value?.$el,"input")},50)})),Z.preventDefault()}}return(ae,Z)=>{const le=Ve("date-time-picker");return l(),c(Ge,{"persistent-placeholder":"",readonly:v.readonly,disabled:v.disabled,label:v.label,"menu-props":{contentClass:"date-time-select-menu"},modelValue:X.value,"onUpdate:modelValue":Z[13]||(Z[13]=z=>X.value=z),onPaste:Y},{selection:a(()=>[o("span",HC,i(oe.value),1)]),"no-data":a(()=>[t(le,{"is-dark-mode":B.value,"enable-time-picker":!1,vertical:!0,"show-alternate-dates":!0,modelValue:X.value,"onUpdate:modelValue":Z[0]||(Z[0]=z=>X.value=z)},null,8,["is-dark-mode","modelValue"]),o("div",WC,[!e(u)&&e(V)?(l(),c(H,{key:0,class:"px-3",color:"primary",variant:"flat",onClick:L},{default:a(()=>[q(i(e(d)(`datetime.${C.value}.content`)),1)]),_:1})):r("",!0),t(e(ua),{eager:"",ref_key:"hourInput",ref:F,density:"compact","max-width":"70px","item-title":"value","item-value":"value","auto-select-first":"exact",items:W.value,"hide-no-data":!0,modelValue:M.value,"onUpdate:modelValue":Z[1]||(Z[1]=z=>M.value=z),"onUpdate:focused":Z[2]||(Z[2]=z=>O(F.value,z)),onClick:Z[3]||(Z[3]=z=>O(F.value,!0)),onKeydown:Z[4]||(Z[4]=z=>J("hour",z))},null,8,["items","modelValue"]),Z[14]||(Z[14]=o("span",null,":",-1)),t(e(ua),{eager:"",ref_key:"minuteInput",ref:S,density:"compact","max-width":"70px","item-title":"value","item-value":"value","auto-select-first":"exact",items:D.value,"hide-no-data":!0,modelValue:ee.value,"onUpdate:modelValue":Z[5]||(Z[5]=z=>ee.value=z),"onUpdate:focused":Z[6]||(Z[6]=z=>O(S.value,z)),onClick:Z[7]||(Z[7]=z=>O(S.value,!0)),onKeydown:Z[8]||(Z[8]=z=>J("minute",z))},null,8,["items","modelValue"]),Z[15]||(Z[15]=o("span",null,":",-1)),t(e(ua),{eager:"",ref_key:"secondInput",ref:j,density:"compact","max-width":"70px","item-title":"value","item-value":"value","auto-select-first":"exact",items:$.value,"hide-no-data":!0,modelValue:ye.value,"onUpdate:modelValue":Z[9]||(Z[9]=z=>ye.value=z),"onUpdate:focused":Z[10]||(Z[10]=z=>O(j.value,z)),onClick:Z[11]||(Z[11]=z=>O(j.value,!0)),onKeydown:Z[12]||(Z[12]=z=>J("second",z))},null,8,["items","modelValue"]),!e(u)&&!e(V)?(l(),c(H,{key:1,class:"px-3",color:"primary",variant:"flat",onClick:L},{default:a(()=>[q(i(e(d)(`datetime.${C.value}.content`)),1)]),_:1})):r("",!0)])]),_:1},8,["readonly","disabled","label","modelValue"])}}}),KC={class:"text-truncate cursor-pointer"},QC=Oe({__name:"DateSelect",props:{modelValue:{},disabled:{type:Boolean},readonly:{type:Boolean},clearable:{type:Boolean},label:{},noDataText:{}},emits:["update:modelValue"],setup(v,{emit:_}){const n=v,s=_,h=Kt(),{tt:d,formatGregorianTextualYearMonthDayToLongDate:y}=je(),f=E({get:()=>n.modelValue?Ac(n.modelValue):null,set:u=>s("update:modelValue",u?wc(u):"")}),b=E(()=>h.global.name.value===$t.Dark),x=E({get:()=>n.modelValue?y(n.modelValue):n.noDataText?n.noDataText:d("Unspecified"),set:u=>{u||(f.value=null)}});return(u,m)=>{const k=Ve("date-time-picker");return l(),c(Ge,{"persistent-placeholder":"",readonly:v.readonly,disabled:v.disabled,clearable:v.modelValue?v.clearable:!1,label:v.label,"menu-props":{contentClass:"date-select-menu"},modelValue:x.value,"onUpdate:modelValue":m[1]||(m[1]=N=>x.value=N)},{selection:a(()=>[o("span",KC,i(x.value),1)]),"no-data":a(()=>[t(k,{"is-dark-mode":b.value,"enable-time-picker":!1,clearable:!0,"show-alternate-dates":!0,modelValue:f.value,"onUpdate:modelValue":m[0]||(m[0]=N=>f.value=N)},null,8,["is-dark-mode","modelValue"])]),_:1},8,["readonly","disabled","clearable","label","modelValue"])}}}),JC={class:"text-truncate cursor-pointer"},ZC=Oe({__name:"FiscalYearStartSelect",props:{modelValue:{},disabled:{type:Boolean},readonly:{type:Boolean},label:{},numeralSystem:{}},emits:["update:modelValue"],setup(v,{emit:_}){const n=v,s=_,h=Kt(),d=E(()=>h.global.name.value===$t.Dark),{disabledDates:y,selectedFiscalYearStart:f,selectedFiscalYearStartValue:b,displayFiscalYearStartDate:x,allowedMinDate:u,allowedMaxDate:m}=Sc(n);return Ft(()=>n.modelValue,k=>{k&&(f.value=k)}),Ft(f,k=>{s("update:modelValue",k)}),(k,N)=>{const V=Ve("date-time-picker");return l(),c(Ge,{"persistent-placeholder":"",readonly:v.readonly,disabled:v.disabled,label:v.label,"menu-props":{contentClass:"fiscal-year-start-select-menu"},modelValue:e(b),"onUpdate:modelValue":N[1]||(N[1]=p=>ht(b)?b.value=p:null)},{selection:a(()=>[o("span",JC,i(e(x)),1)]),"no-data":a(()=>[t(V,{"is-dark-mode":d.value,"numeral-system":v.numeralSystem,vertical:!0,"enable-time-picker":!1,"disable-year-select":!0,"no-swipe-and-scroll":!0,"min-date":e(u),"max-date":e(m),"disabled-dates":e(y),modelValue:e(b),"onUpdate:modelValue":N[0]||(N[0]=p=>ht(b)?b.value=p:null)},null,8,["is-dark-mode","numeral-system","min-date","max-date","disabled-dates","modelValue"])]),_:1},8,["readonly","disabled","label","modelValue"])}}}),XC=["onClick"],e2=Oe({__name:"ColorSelect",props:{modelValue:{},disabled:{type:Boolean},label:{},columnCount:{},allColorInfos:{}},emits:["update:modelValue"],setup(v,{emit:_}){const n=v,s=_,{getCurrentLanguageTextDirection:h}=je(),d=xe("dropdownMenu"),y=P(n.columnCount||7),f=E(()=>h()),b=E(()=>Vc(n.allColorInfos,y.value)),x=E({get:()=>n.modelValue,set:k=>s("update:modelValue",k)});function u(k){return Ai(k,"id",n.modelValue)}function m(k){k&&ha(()=>{d.value&&d.value.parentElement&&Ol(d.value.parentElement,null,null,".row-has-selected-item")})}return(k,N)=>(l(),c(Ge,{density:"comfortable","item-title":"icon","item-value":"id","persistent-placeholder":"",disabled:v.disabled,label:v.label,modelValue:x.value,"onUpdate:modelValue":N[0]||(N[0]=V=>x.value=V),"onUpdate:menu":m},{selection:a(({item:V})=>[t(ns,{class:"cursor-pointer",style:{"padding-top":"3px"}},{default:a(()=>[t(ie,{size:"28",icon:e($n),color:e(En)(V.raw)},null,8,["icon","color"])]),_:2},1024)]),"no-data":a(()=>[o("div",{class:"color-select-dropdown px-2",ref_key:"dropdownMenu",ref:d},[(l(!0),g(fe,null,$e(b.value,(V,p)=>(l(),g("div",{class:be(["color-item",{"row-has-selected-item":u(V)}]),style:kl(`grid-template-columns: repeat(${y.value}, minmax(0, 1fr));`),key:p},[(l(!0),g(fe,null,$e(V,T=>(l(),g("div",{class:"text-center",key:T.color},[o("div",{class:"cursor-pointer",onClick:A=>x.value=T.color},[!v.modelValue||v.modelValue!==T.color?(l(),c(ie,{key:0,class:"ma-2",size:"28",icon:e($n),color:e(En)(T.color)},null,8,["icon","color"])):r("",!0),v.modelValue&&v.modelValue===T.color?(l(),c(Il,{key:1,class:"right-bottom-icon",color:"primary","offset-x":"8","offset-y":"8",location:`bottom ${f.value===e(Tn).LTR?"right":"left"}`,icon:e(Xe)},{default:a(()=>[t(ie,{class:"ma-2",size:"28",icon:e($n),color:e(En)(T.color)},null,8,["icon","color"])]),_:2},1032,["location","icon"])):r("",!0)],8,XC)]))),128))],6))),128))],512)]),_:1},8,["disabled","label","modelValue"]))}}),t2=["onClick"],a2=Oe({__name:"IconSelect",props:{modelValue:{},disabled:{type:Boolean},label:{},iconType:{},color:{},columnCount:{},allIconInfos:{}},emits:["update:modelValue"],setup(v,{emit:_}){const n=v,s=_,{getCurrentLanguageTextDirection:h}=je(),d=xe("dropdownMenu"),y=P(n.columnCount||7),f=E(()=>h()),b=E(()=>Ic(n.allIconInfos,y.value)),x=E({get:()=>n.modelValue,set:k=>s("update:modelValue",k)});function u(k){return Ai(k,"id",n.modelValue)}function m(k){k&&ha(()=>{d.value&&d.value.parentElement&&Ol(d.value.parentElement,null,null,".row-has-selected-item")})}return(k,N)=>{const V=Ve("ItemIcon");return l(),c(Ge,{density:"comfortable","item-title":"icon","item-value":"id","persistent-placeholder":"",disabled:v.disabled,label:v.label,modelValue:x.value,"onUpdate:modelValue":N[0]||(N[0]=p=>x.value=p),"onUpdate:menu":m},{selection:a(()=>[t(ns,{class:"cursor-pointer"},{default:a(()=>[t(V,{"icon-type":v.iconType,"icon-id":x.value,color:v.color},null,8,["icon-type","icon-id","color"])]),_:1})]),"no-data":a(()=>[o("div",{class:"icon-select-dropdown px-2",ref_key:"dropdownMenu",ref:d},[(l(!0),g(fe,null,$e(b.value,(p,T)=>(l(),g("div",{class:be(["icon-item",{"row-has-selected-item":u(p)}]),style:kl(`grid-template-columns: repeat(${y.value}, minmax(0, 1fr));`),key:T},[(l(!0),g(fe,null,$e(p,A=>(l(),g("div",{class:"text-center",key:A.id},[o("div",{class:"cursor-pointer",onClick:w=>x.value=A.id},[!v.modelValue||v.modelValue!==A.id?(l(),c(V,{key:0,class:"ma-2","icon-type":"fixed","icon-id":A.icon,color:v.color},null,8,["icon-id","color"])):r("",!0),v.modelValue&&v.modelValue===A.id?(l(),c(Il,{key:1,class:"right-bottom-icon",color:"primary","offset-x":"8","offset-y":"10",location:`bottom ${f.value===e(Tn).LTR?"right":"left"}`,icon:e(Xe)},{default:a(()=>[t(V,{class:"ma-2","icon-type":"fixed","icon-id":A.icon,color:v.color},null,8,["icon-id","color"])]),_:2},1032,["location","icon"])):r("",!0)],8,t2)]))),128))],6))),128))],512)]),_:1},8,["disabled","label","modelValue"])}}}),l2={class:"d-flex align-center text-truncate cursor-pointer"},n2={key:0,class:"text-truncate"},o2={key:2,class:"text-truncate"},s2={key:3,class:"text-truncate"},i2={key:4,class:"text-truncate"},r2={key:7,class:"text-truncate"},u2={key:0,class:"mx-2 mt-2"},d2={class:"primary-list-container"},c2={key:0,class:"list-item-header text-truncate"},m2={class:"text-truncate"},p2={key:1,class:"list-item-footer text-truncate"},v2={class:"secondary-list-container"},f2={key:0,class:"list-item-header text-truncate"},y2={class:"text-truncate"},g2={key:1,class:"list-item-footer text-truncate"},h2=Oe({__name:"TwoColumnSelect",props:{density:{},variant:{},disabled:{type:Boolean},readonly:{type:Boolean},label:{},showSelectionPrimaryText:{type:Boolean},showSelectionSecondaryIcon:{type:Boolean},customSelectionPrimaryText:{},customSelectionSecondaryText:{},noItemText:{},autoUpdateMenuPosition:{type:Boolean},primaryValueField:{},primaryHeaderField:{},primaryHeaderI18n:{type:Boolean},primaryFooterField:{},primaryFooterI18n:{type:Boolean},secondaryHeaderField:{},secondaryHeaderI18n:{type:Boolean},secondaryFooterField:{},secondaryFooterI18n:{type:Boolean},modelValue:{},primaryKeyField:{},primaryTitleField:{},primaryTitleI18n:{type:Boolean},primaryIconField:{},primaryIconType:{},primaryColorField:{},primaryHiddenField:{},primarySubItemsField:{},secondaryKeyField:{},secondaryValueField:{},secondaryTitleField:{},secondaryTitleI18n:{type:Boolean},secondaryIconField:{},secondaryIconType:{},secondaryColorField:{},secondaryHiddenField:{},enableFilter:{type:Boolean},filterPlaceholder:{},filterNoItemsText:{},items:{}},emits:["update:modelValue"],setup(v,{emit:_}){const n=v,s=_,{tt:h,ti:d}=je(),{filterContent:y,filteredItems:f,getFilteredSubItems:b,getCurrentPrimaryValueBySecondaryValue:x,isSecondaryValueSelected:u,getSelectedPrimaryItem:m,getSelectedSecondaryItem:k,updateCurrentPrimaryValue:N,updateCurrentSecondaryValue:V}=Dc(n),p=xe("twoColumnMainSelect"),T=xe("filterInput"),A=xe("dropdownMenu"),w=P(!1),I=E(()=>b(j.value)),F=E({get:()=>x(n.modelValue),set:ye=>{const L=$c(f.value,ye,n.primaryValueField);if(!L)return;const Y=Nc(b(L),n.primaryHiddenField);Y&&n.secondaryValueField&&s("update:modelValue",Y[n.secondaryValueField])}}),S=E({get:()=>n.modelValue,set:ye=>{w.value=!1,s("update:modelValue",ye)}}),j=E(()=>m(F.value)),B=E(()=>k(S.value,j.value)),U=E(()=>n.noItemText?n.noItemText:h("None")),X=E(()=>n.primaryValueField&&n.primaryTitleField?F.value?Ms(n.items,F.value,n.primaryValueField,n.primaryTitleField,U.value):U.value:F.value),oe=E(()=>n.secondaryValueField&&n.secondaryTitleField?S.value&&j.value&&j.value[n.primarySubItemsField]?Ms(j.value[n.primarySubItemsField],S.value,n.secondaryValueField,n.secondaryTitleField,U.value):U.value:S.value);function W(ye){return u(S.value,ye)}function D(){n.autoUpdateMenuPosition&&ha(()=>{const ye=p.value?.$el.getBoundingClientRect(),L=A.value?.parentElement?.parentElement,Y=L?.getBoundingClientRect();if(ye&&L&&Y){const O=Math.round(ye.top+ye.height);O+Y.height<document.documentElement.scrollHeight&&(L.style.top=O+"px")}})}function $(ye){N(F,ye),D()}function C(ye){V(S,ye)}function M(ye){ye&&ha(()=>{A.value&&A.value.parentElement&&(Ol(A.value.parentElement,".primary-list-container",".primary-list-container",".primary-list-item-selected"),Ol(A.value.parentElement,".secondary-list-container",".secondary-list-container",".secondary-list-item-selected"))})}function ee(ye,L){ye&&L&&ha(()=>{sn(ye?.$el,"input"),D()})}return(ye,L)=>{const Y=Ve("ItemIcon");return l(),c(e(Ge),{ref_key:"twoColumnMainSelect",ref:p,"persistent-placeholder":"",density:v.density,variant:v.variant,readonly:v.readonly,disabled:v.disabled,label:v.label,"menu-props":{contentClass:"two-column-select-menu"},modelValue:S.value,"onUpdate:modelValue":L[3]||(L[3]=O=>S.value=O),menu:w.value,"onUpdate:menu":[L[4]||(L[4]=O=>w.value=O),M]},{selection:a(()=>[o("div",l2,[v.customSelectionPrimaryText?(l(),g("span",n2,i(v.customSelectionPrimaryText),1)):r("",!0),v.customSelectionPrimaryText&&v.customSelectionSecondaryText?(l(),c(ie,{key:1,class:"icon-with-direction disabled",icon:e(_s),size:"23"},null,8,["icon"])):r("",!0),v.customSelectionPrimaryText&&v.customSelectionSecondaryText?(l(),g("span",o2,i(v.customSelectionSecondaryText),1)):r("",!0),!v.customSelectionPrimaryText&&!j.value&&!B.value?(l(),g("span",s2,i(U.value),1)):r("",!0),!v.customSelectionPrimaryText&&v.showSelectionPrimaryText&&j.value?(l(),g("span",i2,i(X.value),1)):r("",!0),!v.customSelectionPrimaryText&&v.showSelectionPrimaryText&&j.value&&B.value?(l(),c(ie,{key:5,class:"icon-with-direction disabled",icon:e(_s),size:"23"},null,8,["icon"])):r("",!0),!v.customSelectionPrimaryText&&B.value&&v.showSelectionSecondaryIcon?(l(),c(Y,{key:6,class:"me-2",size:"21.5px","icon-type":v.secondaryIconType,"icon-id":B.value&&v.secondaryIconField?B.value[v.secondaryIconField]:null,color:B.value&&v.secondaryColorField?B.value[v.secondaryColorField]:null},null,8,["icon-type","icon-id","color"])):r("",!0),!v.customSelectionPrimaryText&&B.value?(l(),g("span",r2,i(oe.value),1)):r("",!0)])]),"no-data":a(()=>[v.enableFilter?(l(),g("div",u2,[t(e(ot),{eager:"",ref_key:"filterInput",ref:T,density:"compact","prepend-inner-icon":e(Ql),placeholder:v.filterPlaceholder,modelValue:e(y),"onUpdate:modelValue":L[0]||(L[0]=O=>ht(y)?y.value=O:null),"onClick:control":L[1]||(L[1]=O=>ee(T.value,!0)),"onUpdate:focused":L[2]||(L[2]=O=>ee(T.value,O))},null,8,["prepend-inner-icon","placeholder","modelValue"])])):r("",!0),za(o("div",{class:"mx-4 my-3"},i(v.filterNoItemsText),513),[[Ka,!e(f)||!e(f).length]]),za(o("div",{ref_key:"dropdownMenu",ref:A,class:"two-column-list-container"},[o("div",d2,[t(Je,{class:be({"list-item-with-header":!!v.primaryHeaderField,"list-item-with-footer":!!v.primaryFooterField})},{default:a(()=>[(l(!0),g(fe,null,$e(e(f),O=>(l(),c(ve,{class:be({"primary-list-item-selected v-list-item--active text-primary":O===j.value}),key:v.primaryKeyField?O[v.primaryKeyField]:JSON.stringify(O),onClick:J=>$(O)},{prepend:a(()=>[v.primaryIconField?(l(),c(Y,{key:0,class:"me-2","icon-type":v.primaryIconType,"icon-id":v.primaryIconField?O[v.primaryIconField]:void 0,color:v.primaryColorField?O[v.primaryColorField]:void 0},null,8,["icon-type","icon-id","color"])):r("",!0)]),title:a(()=>[v.primaryHeaderField?(l(),g("div",c2,i(v.primaryHeaderField?e(d)(O[v.primaryHeaderField],!!v.primaryHeaderI18n):""),1)):r("",!0),o("div",m2,i(v.primaryTitleField?e(d)(O[v.primaryTitleField],!!v.primaryTitleI18n):""),1),v.primaryFooterField?(l(),g("div",p2,i(v.primaryFooterField?e(d)(O[v.primaryFooterField],!!v.primaryFooterI18n):""),1)):r("",!0)]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["class"])]),o("div",v2,[j.value&&v.primarySubItemsField&&j.value[v.primarySubItemsField]?(l(),c(Je,{key:0,class:be({"list-item-with-header":!!v.secondaryHeaderField,"list-item-with-footer":!!v.secondaryFooterField})},{default:a(()=>[(l(!0),g(fe,null,$e(I.value,O=>(l(),c(ve,{class:be({"secondary-list-item-selected v-list-item--active text-primary":W(O)}),key:v.secondaryKeyField?O[v.secondaryKeyField]:JSON.stringify(O),onClick:J=>C(O)},{prepend:a(()=>[v.secondaryIconField?(l(),c(Y,{key:0,class:"me-2","icon-type":v.secondaryIconType,"icon-id":v.secondaryIconField?O[v.secondaryIconField]:void 0,color:v.secondaryColorField?O[v.secondaryColorField]:void 0},null,8,["icon-type","icon-id","color"])):r("",!0)]),title:a(()=>[v.secondaryHeaderField?(l(),g("div",f2,i(v.secondaryHeaderField?e(d)(O[v.secondaryHeaderField],!!v.secondaryHeaderI18n):""),1)):r("",!0),o("div",y2,i(e(d)(v.secondaryTitleField?O[v.secondaryTitleField]:"",!!v.secondaryTitleI18n)),1),v.secondaryFooterField?(l(),g("div",g2,i(v.secondaryFooterField?e(d)(O[v.secondaryFooterField],!!v.secondaryFooterI18n):""),1)):r("",!0)]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["class"])):r("",!0)])],512),[[Ka,e(f)&&e(f).length]])]),_:1},8,["density","variant","readonly","disabled","label","modelValue","menu"])}}}),b2={class:"text-truncate cursor-pointer"},T2={class:"schedule-frequency-type-container"},k2={class:"schedule-frequency-value-container"},_2=Oe({__name:"ScheduleFrequencySelect",props:{type:{},modelValue:{},disabled:{type:Boolean},readonly:{type:Boolean},label:{}},emits:["update:type","update:modelValue"],setup(v,{emit:_}){const n=v,s=_,{tt:h,getMultiMonthdayShortNames:d,getMultiWeekdayLongNames:y}=je(),{allTransactionScheduledFrequencyTypes:f,allWeekDays:b,allAvailableMonthDays:x,getFrequencyValues:u}=Fc(),m=ta(),k=xe("dropdownMenu"),N=P(!1),V=E(()=>m.currentUserFirstDayOfWeek),p=E({get:()=>n.type,set:S=>{n.type!==S&&(s("update:type",S),S===hl.Weekly.type?T.value=[V.value]:S===hl.Monthly.type?T.value=[1]:T.value=[])}}),T=E({get:()=>u(n.modelValue),set:S=>{s("update:modelValue",Us(S).join(","))}}),A=E(()=>p.value===hl.Disabled.type?h("Disabled"):p.value===hl.Weekly.type?T.value.length?h("format.misc.everyMultiDaysOfWeek",{days:y(T.value,V.value)}):h("Weekly"):p.value===hl.Monthly.type?T.value.length?h("format.misc.everyMultiDaysOfMonth",{days:d(T.value)}):h("Monthly"):"");function w(S,j){const B=T.value,U=[];for(const X of B)(X!==S||j)&&U.push(X);j&&U.push(S),T.value=Us(U)}function I(S){return T.value.indexOf(S)>=0}function F(S){S&&ha(()=>{k.value&&k.value.parentElement&&Ol(k.value.parentElement,".schedule-frequency-value-container",".schedule-frequency-value-container",".frequency-value-selected")})}return(S,j)=>(l(),c(Ge,{"persistent-placeholder":"",readonly:v.readonly,disabled:v.disabled,label:v.label,"menu-props":{contentClass:"schedule-frequency-select-menu"},modelValue:p.value,"onUpdate:modelValue":j[2]||(j[2]=B=>p.value=B),menu:N.value,"onUpdate:menu":[j[3]||(j[3]=B=>N.value=B),F]},{selection:a(()=>[o("span",b2,i(A.value),1)]),"no-data":a(()=>[o("div",{ref_key:"dropdownMenu",ref:k,class:"schedule-frequency-container"},[o("div",T2,[t(Je,null,{default:a(()=>[(l(!0),g(fe,null,$e(e(f),B=>(l(),c(ve,{class:be({"v-list-item--active text-primary":B.type===p.value}),key:B.type,title:B.displayName,onClick:U=>p.value=B.type},null,8,["class","title","onClick"]))),128))]),_:1})]),o("div",k2,[p.value===e(hl).Disabled.type?(l(),c(Je,{key:0},{default:a(()=>[t(ve,{title:e(h)("None")},null,8,["title"])]),_:1})):p.value===e(hl).Weekly.type?(l(),c(Je,{key:1,"select-strategy":"classic",selected:T.value,"onUpdate:selected":j[0]||(j[0]=B=>T.value=B)},{default:a(()=>[(l(!0),g(fe,null,$e(e(b),B=>(l(),c(ve,{key:B.type,value:B.type,title:B.displayName,class:be({"frequency-value-selected v-list-item--active text-primary":I(B.type)})},{prepend:a(({isActive:U})=>[t(il,{density:"compact",class:"me-1","model-value":U,"onUpdate:modelValue":X=>w(B.type,X)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1032,["value","title","class"]))),128))]),_:1},8,["selected"])):p.value===e(hl).Monthly.type?(l(),c(Je,{key:2,"select-strategy":"classic",selected:T.value,"onUpdate:selected":j[1]||(j[1]=B=>T.value=B)},{default:a(()=>[(l(!0),g(fe,null,$e(e(x),B=>(l(),c(ve,{key:B.day,value:B.day,title:B.displayName,class:be({"frequency-value-selected v-list-item--active text-primary":I(B.day)})},{prepend:a(({isActive:U})=>[t(il,{density:"compact",class:"me-1","model-value":U,"onUpdate:modelValue":X=>w(B.day,X)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1032,["value","title","class"]))),128))]),_:1},8,["selected"])):r("",!0)])],512)]),_:1},8,["readonly","disabled","label","modelValue","menu"]))}}),x2=["onClick"],C2={class:"d-flex align-center gap-x-2"},w2={class:"d-flex align-center gap-2"},A2={class:"text-h4 step-number"},S2={style:{"line-height":"0"}},V2={class:"text-sm font-weight-medium step-title"},I2={class:"text-xs step-subtitle"},D2={key:0,class:"slide-group-stepper-link-line"},$2=["onClick"],N2={class:"d-flex align-center gap-x-2"},F2={class:"d-flex align-center gap-2"},E2={class:"text-h4 step-number"},M2={style:{"line-height":"0"}},U2={class:"text-sm font-weight-medium step-title"},P2={class:"text-xs step-subtitle"},B2=Oe({__name:"StepsBar",props:{steps:{},currentStep:{},clickable:{type:[String,Boolean]},minWidth:{}},emits:["step:change"],setup(v,{emit:_}){const n=v,s=_,{getCurrentNumeralSystemType:h}=je(),d=E(()=>h()),y=E(()=>n.clickable!=="false"&&n.clickable!==!1);function f(m){return d.value.replaceWesternArabicDigitsToLocalizedDigits(m.toString().padStart(2,Ml.WesternArabicNumerals.digitZero))}function b(m){y.value&&s("step:change",m.name)}function x(m){return n.currentStep===m.name}function u(m){for(const[k,N]of Ra(n.steps))if(k.name===n.currentStep)return m<N;return!1}return(m,k)=>(l(),g(fe,null,[v.minWidth?(l(),g("div",{key:0,class:"d-flex",style:kl(`min-width: ${v.minWidth}px`)},null,4)):r("",!0),t(Lo,{class:"slide-group-with-stepper mb-6 hidden-xs","show-arrows":""},{default:a(()=>[(l(!0),g(fe,null,$e(v.steps,(N,V)=>(l(),c(zo,{key:V},{default:a(()=>[o("div",{class:be(["mx-1",{"slide-group-step-active":x(N),"slide-group-step-completed":u(V),"cursor-pointer":y.value}]),onClick:p=>b(N)},[o("div",C2,[o("div",w2,[k[0]||(k[0]=o("div",{class:"d-flex align-center justify-center",style:{"block-size":"24px","inline-size":"24px"}},[o("div",{class:"slide-group-stepper-indicator"})],-1)),o("h4",A2,i(f(V+1)),1)]),o("div",S2,[o("h6",V2,i(N.title),1),o("span",I2,i(N.subTitle),1)]),V<v.steps.length-1?(l(),g("div",D2)):r("",!0)])],10,x2)]),_:2},1024))),128))]),_:1}),t(Lo,{class:"slide-group-with-stepper mb-3 hidden-sm-and-up",direction:"vertical"},{default:a(()=>[(l(!0),g(fe,null,$e(v.steps,(N,V)=>(l(),c(zo,{key:V},{default:a(()=>[o("div",{class:be(["mx-1 mb-3",{"slide-group-step-active":x(N),"slide-group-step-completed":u(V),"cursor-pointer":y.value}]),onClick:p=>b(N)},[o("div",N2,[o("div",F2,[k[1]||(k[1]=o("div",{class:"d-flex align-center justify-center",style:{"block-size":"24px","inline-size":"24px"}},[o("div",{class:"slide-group-stepper-indicator"})],-1)),o("h4",E2,i(f(V+1)),1)]),o("div",M2,[o("h6",U2,i(N.title),1),o("span",P2,i(N.subTitle),1)])])],10,$2)]),_:2},1024))),128))]),_:1})],64))}}),L2=Oe({__name:"PieChart",props:{skeleton:{type:Boolean},items:{},idField:{},nameField:{},valueField:{},percentField:{},colorField:{},hiddenField:{},minValidPercent:{},amountValue:{type:Boolean},defaultCurrency:{},showValue:{type:Boolean},showPercent:{type:Boolean},enableClickItem:{type:Boolean}},emits:["click"],setup(v,{emit:_}){const n=v,s=_,h=Kt(),{formatAmountToLocalizedNumeralsWithCurrency:d}=je(),{selectedIndex:y,validItems:f}=Ec(n),b=P({}),x=E(()=>h.global.name.value===$t.Dark),u=E(()=>{const A={};for(const w of n.items){let I="";n.idField&&w[n.idField]?I=w[n.idField]:I=w[n.nameField],A[I]=w}return A}),m=E(()=>{const A=[];for(const w of f.value)A.push({...w,itemStyle:{color:w.color},selected:!0});return A}),k=E(()=>{for(const A of f.value)if(Yo(b.value)&&!b.value[A.id])return!0;return!1}),N=E(()=>{let A=0,w=null,I=0;for(const[F,S]of Ra(f.value))Yo(b.value)&&!b.value[F.id]||(w===null&&(w=F.value),w!==null&&(S<y.value?I+=F.value:S===y.value&&(I+=F.value/2)),A+=F.value);return I&&A>0?I/A:0}),V=E(()=>({tooltip:{trigger:"item",backgroundColor:x.value?"#333":"#fff",borderColor:x.value?"#333":"#fff",textStyle:{color:x.value?"#eee":"#333"},formatter:A=>{const w=A.data,I=w?w.displayName:"",F=w?w.displayValue:d(A.value);let S=w?w.displayPercent:A.percent+"%";k.value&&(S=A.percent+"%");let j=`<div><span class="chart-pointer" style="background-color: ${A.color}"></span>`;return I&&(j+=`<div class="d-inline-flex">${I}</div><br/>`),n.showValue&&n.showPercent?j+=`<div class="d-inline-flex"><span>${F}</span><span class="ms-1">(${S})</span></div>`:n.showValue&&!n.showPercent?j+=`<div class="d-inline-flex">${F}</div>`:!n.showValue&&n.showPercent&&(j+=`<div class="d-inline-flex">${S}</div>`),j+="</div>",j}},legend:{orient:"horizontal",type:"scroll",top:0,data:f.value.map(A=>A.name),selected:b.value,textStyle:{color:x.value?"#eee":"#333"},formatter:A=>{const w=u.value[A];return w&&n.nameField&&w[n.nameField]?w[n.nameField]:A}},series:[{type:"pie",data:m.value,top:50,startAngle:-90+N.value*360,radius:[0,"75%"],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},label:{color:x.value?"#eee":"#333",formatter:A=>{const w=A.data;return w?w.displayName:""}},animation:!n.skeleton}],media:[{query:{minWidth:600},option:{legend:{orient:"vertical",left:"left"},series:[{type:"pie",top:0}]}}]}));function p(A){if(!n.enableClickItem||A.componentType!=="series"||A.seriesType!=="pie")return;if(A.event&&A.event.target&&A.event.target.currentStates&&A.event.target.currentStates[0]&&A.event.target.currentStates[0]==="emphasis"){y.value=A.dataIndex;return}if(!A.data)return;const w=A.data;"sourceItem"in w&&s("click",w.sourceItem)}function T(A){b.value=A.selected;const w=f.value[y.value];if(!w||!b.value[w.id]){let I=0;for(const[F,S]of Ra(f.value))if(b.value[F.id]){I=S;break}y.value=I}}return(A,w)=>{const I=Ve("v-chart");return l(),c(I,{autoresize:"",class:be(["pie-chart-container",{"transition-in":v.skeleton}]),option:V.value,onClick:p,onLegendselectchanged:T},null,8,["class","option"])}}}),z2=kn(L2,[["__scopeId","data-v-04070ab0"]]),O2=Oe({__name:"RadarChart",props:{skeleton:{type:Boolean},items:{},nameField:{},valueField:{},percentField:{},colorField:{},hiddenField:{},minValidPercent:{},amountValue:{type:Boolean},defaultCurrency:{},showValue:{type:Boolean},showPercent:{type:Boolean}},setup(v){const _=v,n=Kt(),{formatAmountToLocalizedNumeralsWithCurrency:s,formatPercentToLocalizedNumerals:h}=je(),d=E(()=>n.global.name.value===$t.Dark),y=E(()=>{let b=0,x=0;const u=[],m=[];let k="";if(_.items.length){for(const V of _.items){const p=V[_.valueField];Zt(p)&&p>0&&(!_.hiddenField||!V[_.hiddenField])&&(b+=p,p>x&&(x=p))}for(const V of _.items){const p=V[_.valueField],T=_.percentField?V[_.percentField]:-1;if(Zt(p)&&p>0&&(!_.hiddenField||!V[_.hiddenField])&&(!_.minValidPercent||p/b>_.minValidPercent)){const A=V[_.nameField],w=En(_.colorField&&V[_.colorField]?V[_.colorField]:Ll[u.length%Ll.length]),I=Zt(T)&&T>=0?T:p/b*100,F=h(I,2,"&lt;0.01"),S=_.amountValue?s(p,_.defaultCurrency):p.toString();u.push({name:A,max:x,color:d.value?"#ccc":"#333"}),m.push(p),k+='<div><span class="chart-pointer" style="background-color: '+w+'"></span>',k+=`<span>${A}</span>`,_.showValue&&_.showPercent?k+=`<span class="ms-1" style="float: inline-end">(${F})</span><span class="ms-5" style="float: inline-end">${S}</span>`:_.showValue&&!_.showPercent?k+=`<span class="ms-5" style="float: inline-end">${S}</span>`:!_.showValue&&_.showPercent&&(k+=`<span class="ms-5" style="float: inline-end">${F}</span>`),k+="</div>"}}}else for(let V=0;V<6;V++)u.push({name:"",max:0,color:d.value?"#ccc":"#333"}),m.push(0);return{totalValidValue:b,maxValue:x,indicators:u,values:m,tooltip:k}}),f=E(()=>({tooltip:{trigger:"item",backgroundColor:d.value?"#333":"#fff",borderColor:d.value?"#333":"#fff",textStyle:{color:d.value?"#eee":"#333"},formatter:()=>y.value.tooltip},radar:{radius:"75%",splitNumber:!_.skeleton&&_.items.length?5:1,splitLine:{lineStyle:{color:!_.skeleton&&_.items.length?"#e8e8e7":"#d3d3d3"}},splitArea:{areaStyle:{color:!_.skeleton&&_.items.length?d.value?["#363534","#1a1a1a"]:["#faf8f4","#fff"]:["#d3d3d3","#d3d3d3"]}},indicator:y.value.indicators},series:!_.skeleton&&_.items.length?[{type:"radar",data:[{value:y.value.values,itemStyle:{color:"#c07d43"},lineStyle:{color:"#c07d43"},areaStyle:{color:d.value?"#c07d4380":"#c07d4340"}}],top:0,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},animation:!_.skeleton}]:[]}));return(b,x)=>{const u=Ve("v-chart");return l(),c(u,{autoresize:"",class:be(["radar-chart-container",{"transition-in":v.skeleton}]),option:f.value},null,8,["class","option"])}}}),R2=kn(O2,[["__scopeId","data-v-3d622c16"]]),q2={class:"text-h4"},Y2={class:"text-body-1 text-wrap mt-2"},j2={key:0},H2={key:1},W2={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},G2=Oe({__name:"DateRangeSelectionDialog",props:{persistent:{type:Boolean},minTime:{},maxTime:{},title:{},hint:{},show:{type:Boolean}},emits:["update:show","dateRange:change","error"],setup(v,{emit:_}){const n=v,s=_,h=Kt(),{tt:d}=je(),{dateRange:y,beginDateTime:f,endDateTime:b,presetRanges:x,getLocalDatetimeFromSameDateTimeOfUnixTime:u,getFinalDateRange:m}=Mc(n),k=E(()=>h.global.name.value===$t.Dark),N=E({get:()=>n.show||!1,set:T=>s("update:show",T)});function V(){try{const T=m();if(!T)return;s("dateRange:change",T.minUnixTime,T.maxUnixTime)}catch(T){T instanceof Error&&s("error",T.message)}}function p(){s("update:show",!1)}return Ft(()=>n.minTime,T=>{T&&(y.value[0]=u(T))}),Ft(()=>n.maxTime,T=>{T&&(y.value[1]=u(T))}),(T,A)=>{const w=Ve("date-time-picker");return l(),c(xt,{class:"date-range-selection-dialog",width:"640",persistent:!!v.persistent,modelValue:N.value,"onUpdate:modelValue":A[1]||(A[1]=I=>N.value=I)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("h4",q2,i(v.title),1)]),subtitle:a(()=>[o("div",Y2,[v.hint?(l(),g("p",j2,i(v.hint),1)):r("",!0),e(f)&&e(b)?(l(),g("span",H2,[o("span",null,i(e(f)),1),A[2]||(A[2]=o("span",null," - ",-1)),o("span",null,i(e(b)),1)])):r("",!0),pn(T.$slots,"default")])]),default:a(()=>[t(ge,{class:"w-100 d-flex justify-center"},{default:a(()=>[t(w,{"is-dark-mode":k.value,"enable-time-picker":!0,vertical:!0,"preset-dates":e(x),"show-alternate-dates":!0,modelValue:e(y),"onUpdate:modelValue":A[0]||(A[0]=I=>ht(y)?y.value=I:null)},null,8,["is-dark-mode","preset-dates","modelValue"])]),_:1}),t(ge,null,{default:a(()=>[o("div",W2,[t(H,{disabled:!e(y)[0]||!e(y)[1],onClick:V},{default:a(()=>[q(i(e(d)("OK")),1)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",onClick:p},{default:a(()=>[q(i(e(d)("Cancel")),1)]),_:1})])]),_:1})]),_:3})]),_:3},8,["persistent","modelValue"])}}}),K2={class:"text-h4"},Q2={key:0,class:"text-body-1 text-wrap mt-2"},J2={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},Z2=Oe({__name:"MonthSelectionDialog",props:{modelValue:{},title:{},hint:{},show:{type:Boolean},persistent:{type:Boolean}},emits:["update:modelValue","update:show","error"],setup(v,{emit:_}){const n=v,s=_,h=Kt(),{tt:d}=je(),y=P(Uc(Pc())),f=E(()=>h.global.name.value===$t.Dark),b=E({get:()=>n.show||!1,set:m=>s("update:show",m)});function x(){if(y.value.year<=0||y.value.month0base<0){s("error","Date is too early");return}s("update:modelValue",y.value)}function u(){s("update:show",!1)}return Ft(()=>n.modelValue,m=>{m&&(y.value=m)}),Ft(()=>n.show,m=>{m&&n.modelValue&&(y.value=n.modelValue)}),(m,k)=>{const N=Ve("month-picker");return l(),c(xt,{class:"month-selection-dialog",width:"640",persistent:!!v.persistent,modelValue:b.value,"onUpdate:modelValue":k[1]||(k[1]=V=>b.value=V)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("h4",K2,i(v.title),1)]),subtitle:a(()=>[v.hint?(l(),g("div",Q2,[o("p",null,i(v.hint),1),pn(m.$slots,"default")])):r("",!0)]),default:a(()=>[t(ge,{class:"w-100 d-flex justify-center"},{default:a(()=>[t(Ae,{class:"match-height"},{default:a(()=>[t(R,null,{default:a(()=>[t(N,{"is-dark-mode":f.value,modelValue:y.value,"onUpdate:modelValue":k[0]||(k[0]=V=>y.value=V)},null,8,["is-dark-mode","modelValue"])]),_:1})]),_:1})]),_:1}),t(ge,null,{default:a(()=>[o("div",J2,[t(H,{disabled:!y.value,onClick:x},{default:a(()=>[q(i(e(d)("OK")),1)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",onClick:u},{default:a(()=>[q(i(e(d)("Cancel")),1)]),_:1})])]),_:1})]),_:3})]),_:3},8,["persistent","modelValue"])}}}),X2={class:"text-h4"},ew={class:"text-body-1 text-wrap mt-2"},tw={key:0},aw={key:1},lw={class:"w-100 d-flex justify-center mt-2 gap-4"},nw=Oe({__name:"MonthRangeSelectionDialog",props:{persistent:{type:Boolean},minTime:{},maxTime:{},title:{},hint:{},show:{type:Boolean}},emits:["update:show","dateRange:change","error"],setup(v,{emit:_}){const n=v,s=_,h=Kt(),{tt:d}=je(),{dateRange:y,beginDateTime:f,endDateTime:b,getFinalMonthRange:x}=Bc(n),u=E(()=>h.global.name.value===$t.Dark),m=E({get:()=>n.show||!1,set:V=>s("update:show",V)});function k(){try{const V=x();if(!V)return;s("dateRange:change",V.minYearMonth,V.maxYearMonth)}catch(V){V instanceof Error&&s("error",V.message)}}function N(){s("update:show",!1)}return Ft(()=>n.minTime,V=>{if(V){const p=Ps(V);p&&(y.value[0]=p)}}),Ft(()=>n.maxTime,V=>{if(V){const p=Ps(V);p&&(y.value[1]=p)}}),(V,p)=>{const T=Ve("month-picker");return l(),c(xt,{class:"month-range-selection-dialog",width:"640",persistent:!!v.persistent,modelValue:m.value,"onUpdate:modelValue":p[2]||(p[2]=A=>m.value=A)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("h4",X2,i(v.title),1)]),subtitle:a(()=>[o("div",ew,[v.hint?(l(),g("p",tw,i(v.hint),1)):r("",!0),e(f)&&e(b)?(l(),g("span",aw,[o("span",null,i(e(f)),1),p[3]||(p[3]=o("span",null," - ",-1)),o("span",null,i(e(b)),1)])):r("",!0),pn(V.$slots,"default")])]),default:a(()=>[t(ge,{class:"d-flex flex-column flex-md-row flex-grow-1 overflow-y-auto"},{default:a(()=>[t(Ae,{class:"match-height"},{default:a(()=>[t(R,{cols:"12",md:"6"},{default:a(()=>[t(T,{"is-dark-mode":u.value,modelValue:e(y)[0],"onUpdate:modelValue":p[0]||(p[0]=A=>e(y)[0]=A)},null,8,["is-dark-mode","modelValue"])]),_:1}),t(R,{cols:"12",md:"6"},{default:a(()=>[t(T,{"is-dark-mode":u.value,modelValue:e(y)[1],"onUpdate:modelValue":p[1]||(p[1]=A=>e(y)[1]=A)},null,8,["is-dark-mode","modelValue"])]),_:1})]),_:1})]),_:1}),t(ge,null,{default:a(()=>[o("div",lw,[t(H,{disabled:!e(y)[0]||!e(y)[1],onClick:k},{default:a(()=>[q(i(e(d)("OK")),1)]),_:1},8,["disabled"]),t(H,{color:"secondary",variant:"tonal",onClick:N},{default:a(()=>[q(i(e(d)("Cancel")),1)]),_:1})])]),_:1})]),_:3})]),_:3},8,["persistent","modelValue"])}}}),ow=Oe({__name:"AccountBalanceTrendsChart",props:{legendName:{},skeleton:{type:Boolean},type:{},items:{},dateAggregationType:{},fiscalYearStart:{},account:{}},setup(v){const _=v,n=Kt(),{tt:s,getCurrentLanguageTextDirection:h,formatAmountToLocalizedNumeralsWithCurrency:d}=je(),{allDataItems:y,allDisplayDateRanges:f}=Lc(_),b=ta(),x=E(()=>h()),u=E(()=>n.global.name.value===$t.Dark),m=E(()=>{const V={id:"accountBalance",name:_.legendName,itemStyle:{color:`#${Ll[0]}`},selected:!0,type:"line",stack:"a",animation:!_.skeleton,data:[]};if(_.type===pl.Area.type)V.areaStyle={};else if(_.type===pl.Column.type)V.type="bar";else if(_.type===pl.Candlestick.type){const p=is(b.currentUserExpenseAmountColor,b.currentUserIncomeAmountColor,u.value);V.type="candlestick",V.itemStyle.color=p.incomeAmountColor,V.itemStyle.color0=p.expenseAmountColor,V.itemStyle.borderColor=p.incomeAmountColor,V.itemStyle.borderColor0=p.expenseAmountColor}for(const p of y.value)_.type===pl.Candlestick.type?V.data.push([p.openingBalance,p.closingBalance,p.minimumBalance,p.maximumBalance]):V.data.push(p.closingBalance);return[V]}),k=E(()=>{let V=Number.MIN_SAFE_INTEGER,p=Number.MAX_SAFE_INTEGER,T=90;if(!m.value||!m.value.length)return T;for(const j of m.value)for(const B of j.data){let U;Fn(B)?U=B[1]:U=B,U>V&&(V=U),U<p&&(p=U)}const A=d(V,_.account.currency),w=d(p,_.account.currency),I=A.length>w.length?A:w,S=document.createElement("canvas").getContext("2d");if(S){S.font="12px Arial";const j=S.measureText(I),B=Math.round(j.width)+20;B>=200&&(T=200),B>90&&(T=B)}return T}),N=E(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:u.value?"#333":"#fff",color:u.value?"#eee":"#333"}},backgroundColor:u.value?"#333":"#fff",borderColor:u.value?"#333":"#fff",textStyle:{color:u.value?"#eee":"#333"},formatter:V=>{if(_.type===pl.Candlestick.type){const p=V[0].dataIndex,T=y.value[p],A=[{name:s("Opening Balance"),value:d(T.openingBalance,_.account.currency)},{name:s("Closing Balance"),value:d(T.closingBalance,_.account.currency)},{name:s("Minimum Balance"),value:d(T.minimumBalance,_.account.currency)},{name:s("Maximum Balance"),value:d(T.maximumBalance,_.account.currency)},{name:s("Median Balance"),value:d(T.medianBalance,_.account.currency)},{name:s("Average Balance"),value:d(T.averageBalance,_.account.currency)}];let w=`${V[0].name} ${_.legendName}<br/>`;for(const[I,F]of Ra(A))w+=`<div><span class="chart-pointer" style="background-color: #${Ll[F]}"></span><span>${I.name}</span><span class="ms-5" style="float: inline-end">${I.value}</span><br/></div>`;return w}else{const p=V[0].data,T=d(p,_.account.currency);return`${V[0].name}<br/><div><span class="chart-pointer" style="background-color: #`+Ll[0]+`"></span><span>${_.legendName}</span><span class="ms-5" style="float: inline-end">${T}</span><br/></div>`}}},grid:{left:k.value,right:20,top:0,bottom:20},xAxis:[{type:"category",data:f.value,inverse:x.value===Tn.RTL,axisLabel:{color:u.value?"#888":"#666"}}],yAxis:[{type:"value",axisLabel:{color:u.value?"#888":"#666",formatter:V=>d(parseInt(V),_.account.currency)},axisPointer:{label:{formatter:V=>d(Math.trunc(V.value),_.account.currency)}},splitLine:{lineStyle:{color:u.value?"#4f4f4f":"#e1e6f2"}}}],series:m.value}));return(V,p)=>{const T=Ve("v-chart");return l(),c(T,{autoresize:"",class:be(["account-balance-trends-chart-container",{"transition-in":v.skeleton}]),option:N.value},null,8,["class","option"])}}}),sw=kn(ow,[["__scopeId","data-v-194db71b"]]);const iw=Oe({__name:"AccountAndCategorySankeyChart",props:{skeleton:{type:Boolean},items:{},defaultCurrency:{},enableClickItem:{type:Boolean}},emits:["click"],setup(v,{emit:_}){const n=v,s=_,h=Kt(),{tt:d,formatAmountToLocalizedNumeralsWithCurrency:y,formatPercentToLocalizedNumerals:f}=je(),b=ta(),x={[qt.IncomeByPrimaryCategory]:"category",[qt.IncomeBySecondaryCategory]:"category",[qt.IncomeByAccount]:"account",[qt.ExpenseByAccount]:"account",[qt.NetCashFlow]:"netCashFlow",[qt.ExpenseBySecondaryCategory]:"category",[qt.ExpenseByPrimaryCategory]:"category"},u={[qt.IncomeByPrimaryCategory]:0,[qt.IncomeBySecondaryCategory]:1,[qt.IncomeByAccount]:2,[qt.ExpenseByAccount]:3,[qt.NetCashFlow]:4,[qt.ExpenseBySecondaryCategory]:4,[qt.ExpenseByPrimaryCategory]:5},m=E(()=>h.global.name.value===$t.Dark),k=E(()=>{const p=[],T=[];for(const w of n.items){if(w.hidden)continue;const I=x[w.type],F=u[w.type];if(!I||I==="netCashFlow"||F===void 0||w.totalAmount===0&&w.outflows.length===0)continue;const S={dateItemType:w.type,itemType:I,itemId:w.id,name:`${w.type}:${w.id}`,displayName:w.name,totalAmount:w.totalAmount,percent:w.percent,depth:F};if(!Zt(S.percent)&&S.dateItemType===qt.IncomeByAccount&&(S.itemStyle={color:"#aaa",opacity:.5}),S.dateItemType===qt.ExpenseByAccount)for(const B of w.outflows)B.relatedItem.type===qt.NetCashFlow&&(S.accountNetCashFlow=(S.accountNetCashFlow??0)+B.amount);p.push(S);const j={};for(const B of w.outflows)if(B.relatedItem&&B.relatedItem){const X=`${w.type}:${w.id}-${B.relatedItem.type}:${B.relatedItem.id}`;let oe=j[X];oe||(oe={relatedItem:B.relatedItem,amount:0},j[X]=oe),oe.amount+=B.amount}for(const B of cs(j)){const U=B.relatedItem,X=x[U.type];if(!X)continue;const oe={sourceItemType:I,sourceItemId:w.id,source:`${w.type}:${w.id}`,sourceDisplayName:w.name,targetItemType:X,targetItemId:U.id,target:`${U.type}:${U.id}`,targetDisplayName:U.name,value:B.amount};T.push(oe)}}return{nodes:p,links:T}}),N=E(()=>{const p=is(b.currentUserExpenseAmountColor,b.currentUserIncomeAmountColor,m.value);return{tooltip:{trigger:"item",backgroundColor:m.value?"#333":"#fff",borderColor:m.value?"#333":"#fff",textStyle:{color:m.value?"#eee":"#333"},formatter:T=>{if(T.dataType==="node"){const A=T.data,w=A.totalAmount,I=y(w,n.defaultCurrency);let F="";A.dateItemType===qt.IncomeByPrimaryCategory?F=d("Income By Primary Category"):A.dateItemType===qt.IncomeBySecondaryCategory?F=d("Income By Secondary Category"):A.dateItemType===qt.IncomeByAccount?F=d("Income By Account"):A.dateItemType===qt.ExpenseByAccount?F=d("Expense By Account"):A.dateItemType===qt.NetCashFlow?F=d("Net Cash Flow"):A.dateItemType===qt.ExpenseBySecondaryCategory?F=d("Expense By Secondary Category"):A.dateItemType===qt.ExpenseByPrimaryCategory&&(F=d("Expense By Primary Category"));let S=`<div><span>${A.displayName}</span>`;if(F&&(A.dateItemType!==qt.IncomeByAccount||Zt(A.percent))?S=`<div class="mb-1">${F}</div>`+S:A.dateItemType===qt.IncomeByAccount&&(S=`<div class="mb-1">${d("Account Balance")}</div>`+S),Zt(A.percent)&&A.percent>0){const j=f(A.percent,2,"&lt;0.01");S+=`<span class="ms-1" style="float: inline-end">(${j})</span>`}if(S+=`<span class="ms-5" style="float: inline-end">${I}</span></div>`,Zt(A.accountNetCashFlow)&&A.accountNetCashFlow!==0){const j=y(A.accountNetCashFlow,n.defaultCurrency);S+=`<div class="mt-1"><span>${d("Net Cash Flow")}</span><span class="ms-5" style="float: inline-end">${j}</span></div>`}return S}else if(T.dataType==="edge"){const A=T.data,w=Zt(T.value)?T.value:0,I=y(w,n.defaultCurrency);return`<div><span>${A.sourceDisplayName} → ${A.targetDisplayName}</span><span class="ms-5" style="float: inline-end">${I}</span></div>`}else return""}},series:[{type:"sankey",left:10,top:0,bottom:10,roam:!0,layoutIterations:0,label:{formatter:T=>T.data.displayName},levels:[{depth:0,itemStyle:{color:p.incomeAmountColor,opacity:.6},lineStyle:{color:"source",opacity:.3}},{depth:1,itemStyle:{color:p.incomeAmountColor,opacity:.4},lineStyle:{color:"source",opacity:.2}},{depth:2,itemStyle:{color:"#c07d43",opacity:.5},lineStyle:{color:"source",opacity:.2}},{depth:3,itemStyle:{color:"#c07d43",opacity:.5},lineStyle:{color:"source",opacity:.2}},{depth:4,itemStyle:{color:p.expenseAmountColor,opacity:.4},lineStyle:{color:"source",opacity:.2}},{depth:5,itemStyle:{color:p.expenseAmountColor,opacity:.6},lineStyle:{color:"source",opacity:.3}}],emphasis:{focus:"adjacency"},data:k.value.nodes,links:k.value.links,animation:!n.skeleton}]}});function V(p){if(!(!n.enableClickItem||p.componentType!=="series"||p.seriesType!=="sankey")&&p.data){if(p.dataType==="node"){const T=p.data;if(T.itemType==="netCashFlow")return;s("click",T.itemType,T.itemId)}else if(p.dataType==="edge"){const T=p.data;if(T.sourceItemType==="netCashFlow")return;T.sourceItemType===T.targetItemType&&T.sourceItemId===T.targetItemId?s("click",T.sourceItemType,T.sourceItemId):T.targetItemType!=="netCashFlow"&&s("click",T.sourceItemType,T.sourceItemId,T.targetItemType,T.targetItemId)}}}return(p,T)=>{const A=Ve("v-chart");return l(),c(A,{autoresize:"",class:be(["account-category-sankey-chart-container",{"transition-in":v.skeleton}]),option:N.value,onClick:V},null,8,["class","option"])}}}),rw=kn(iw,[["__scopeId","data-v-249883a9"]]),uw={class:"text-h4"},dw={class:"text-body-1 text-wrap mt-4"},cw={class:"w-100 d-flex justify-center"},mw=["src"],pw={class:"w-100 d-flex justify-center flex-wrap mt-sm-1 mt-md-2 gap-4"},vw=Oe({__name:"SwitchToMobileDialog",props:{show:{type:Boolean}},emits:["update:show"],setup(v,{emit:_}){const n=v,s=_,{tt:h}=je(),d=zc(),y=Oc(),f=E({get:()=>n.show,set:b=>{s("update:show",b)}});return(b,x)=>(l(),c(xt,{width:"420",modelValue:f.value,"onUpdate:modelValue":x[1]||(x[1]=u=>f.value=u)},{default:a(()=>[t(Me,{class:"pa-sm-1 pa-md-2"},{title:a(()=>[o("h4",uw,i(e(h)("Use on Mobile Device")),1)]),subtitle:a(()=>[o("div",dw,i(e(h)("You can scan the QR code below on your mobile device.")),1)]),default:a(()=>[t(ge,null,{default:a(()=>[t(Ae,null,{default:a(()=>[t(R,{cols:"12",md:"12"},{default:a(()=>[o("div",cw,[o("img",{alt:"qrcode",class:"img-url-qrcode",src:e(d)},null,8,mw)])]),_:1})]),_:1})]),_:1}),t(ge,null,{default:a(()=>[o("div",pw,[t(H,{href:e(y)},{default:a(()=>[q(i(e(h)("Switch to Mobile Version")),1)]),_:1},8,["href"]),t(H,{color:"secondary",variant:"tonal",onClick:x[0]||(x[0]=u=>f.value=!1)},{default:a(()=>[q(i(e(h)("Close")),1)]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});function Ls(v,_,n){const s=v.querySelector("input");if(!s)return;const h=v.parentElement?.querySelector(`span#${_.auxSpanId}`);if(!h)return;const d=h;if(n){const f=window.getComputedStyle(s);d.style.position="absolute",d.style.visibility="hidden",d.style.whiteSpace="pre",d.style.font=f.font,d.style.letterSpacing=f.letterSpacing,d.style.padding="0",d.style.margin="0"}d.textContent=s.value||s.placeholder||"";let y=d.offsetWidth;_.minWidth&&(y=Math.max(y,_.minWidth)),_.maxWidth&&(y=Math.min(y,_.maxWidth)),v.style.width=`${y}px`}const fw={mounted(v,_){Ls(v,_.value,!0)},updated(v,_){Ls(v,_.value,!1)}},yw={class:"d-inline-flex"},gw=["src"],hw={class:"ms-2"},bw=Oe({__name:"DesktopApp",setup(v){const{tt:_,getCurrentLanguageInfo:n,setLanguage:s,initLocale:h}=je(),d=Kt(),y=Za(),f=Ya(),b=ta(),x=ms(),u=ps(),m=(()=>{if(!window.location.hash)return"/";const p=window.location.hash,T=p.indexOf("#/");if(T<0)return"/";const A=p.substring(T+1),w=A.indexOf("?");return w<0?A:A.substring(0,w)})(),k=P(!1),N=E(()=>y.currentNotification);Go(()=>{document.addEventListener("DOMContentLoaded",()=>{const p=n();Rc(p?.alternativeLanguageTag)})}),Ft(N,p=>{k.value=!!p}),f.appSettings.theme===$t.Light?d.change($t.Light):f.appSettings.theme===$t.Dark?d.change($t.Dark):d.change(os()),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(p){f.appSettings.theme==="auto"&&(p.matches?d.change($t.Dark):d.change($t.Light))});let V=h(b.currentUserLanguage,f.appSettings.timeZone);return f.updateLocalizedDefaultSettings(V),Oo(b.currentUserExpenseAmountColor,b.currentUserIncomeAmountColor),xl()&&m!=="/verify_email"&&m!=="/resetpassword"&&m!=="/oauth2_callback"&&(!f.appSettings.applicationLock||qn())&&(x.refreshTokenAndRevokeOldToken().then(p=>{p.user&&(V=s(p.user.language),f.updateLocalizedDefaultSettings(V),Oo(p.user.expenseAmountColor,p.user.incomeAmountColor),p.notificationContent&&y.setNotificationContent(p.notificationContent))}),f.appSettings.autoUpdateExchangeRatesData&&u.getLatestExchangeRates({silent:!0,force:!1})),qc()&&Ki("./sw.js",{registrationOptions:{scope:"./"}}),(p,T)=>{const A=Ve("router-view");return l(),g(fe,null,[t(di,null,{default:a(()=>[t(A)]),_:1}),t(Ko,{class:"cursor-pointer",color:"notification-background",location:"top","multi-line":!0,timeout:-1,"close-on-content-click":!0,modelValue:k.value,"onUpdate:modelValue":T[0]||(T[0]=w=>k.value=w)},{default:a(()=>[t(vt,{activator:"parent"},{default:a(()=>[q(i(e(_)("Click to close")),1)]),_:1}),o("div",yw,[o("img",{alt:"logo",class:"notification-logo",src:e(fl)},null,8,gw),o("span",hw,i(e(_)("global.app.title")),1)]),o("div",null,i(N.value),1)]),_:1},8,["modelValue"])],64)}}}),Tt=Qi(bw),Tw=Ji(),Di=Zi(Yc()),kw=nu({components:{VAlert:ls,VApp:di,VAvatar:ol,VAutocomplete:ua,VBadge:Il,VBtn:H,VBtnGroup:Gl,VBtnToggle:Ul,VCard:Me,VCardActions:Un,VCardItem:mu,VCardSubtitle:ni,VCardText:ge,VCardTitle:oi,VCheckbox:il,VCheckboxBtn:Xs,VChip:Jt,VDataTable:Kl,VDialog:xt,VDivider:nt,VExpansionPanel:jl,VExpansionPanelText:Wl,VExpansionPanelTitle:Hl,VExpansionPanels:Yl,VForm:jt,VContainer:cu,VCol:R,VRow:Ae,VSpacer:it,VIcon:ie,VImg:wt,VInput:du,VLabel:ns,VLayout:Jl,VList:Je,VListGroup:ei,VListImg:uu,VListItem:ve,VListItemAction:Zo,VListItemMedia:ru,VListItemSubtitle:iu,VListItemTitle:rt,VListSubheader:Pn,VMain:Xl,VMenu:mt,VNavigationDrawer:Zl,VOverlay:Hs,VPagination:Zs,VProgressCircular:Ze,VProgressLinear:Bo,VSelect:Ge,VSkeletonLoader:ft,VSlideGroup:Lo,VSlideGroupItem:zo,VSnackbar:Ko,VSwitch:Ea,VTabs:Ja,VTab:Wt,VTable:sl,VTextarea:Oa,VTextField:ot,VToolbar:Xo,VTooltip:vt,VWindow:qa,VWindowItem:zt},icons:{defaultSet:"mdi",aliases:su,sets:{mdi:ou}},defaults:{VAlert:{VBtn:{color:void 0}},VAutocomplete:{variant:"outlined",density:"comfortable",color:"primary",hideDetails:"auto"},VAvatar:{variant:"flat",VIcon:{size:24}},VBadge:{color:"primary"},VBtn:{color:"primary"},VCheckbox:{color:"primary",hideDetails:"auto"},VChip:{elevation:0},VList:{color:"primary"},VPagination:{density:"comfortable",activeColor:"primary"},VRadio:{density:"comfortable",color:"primary",hideDetails:"auto"},VSelect:{variant:"outlined",density:"comfortable",color:"primary",hideDetails:"auto"},VSlider:{color:"primary",hideDetails:"auto"},VSwitch:{inset:!0,color:"primary",hideDetails:"auto"},VProgressCircular:{size:40},VSnackbar:{timeout:3e3},VTable:{hover:!0},VTabs:{color:"primary",VSlideGroup:{showArrows:!0}},VTextarea:{variant:"outlined",density:"comfortable",color:"primary",hideDetails:"auto"},VTextField:{variant:"outlined",density:"comfortable",color:"primary",hideDetails:"auto"},VToolbar:{color:"primary"},VTooltip:{location:"top"},VWindow:{touch:!1}},theme:{defaultTheme:"light",themes:{light:{dark:!1,colors:{primary:"#c67e48","primary-darken-1":"#b67443","on-primary":"#ffffff",secondary:"#8c8c8c","secondary-darken-1":"#595754","on-secondary":"#ffffff",success:"#4cd964","success-darken-1":"#40b654","on-success":"#ffffff",info:"#2196f3","info-darken-1":"#1e85d7","on-info":"#ffffff",warning:"#ff9500","warning-darken-1":"#de8201","on-warning":"#ffffff",error:"#ff3b30","error-darken-1":"#e1342b","on-error":"#ffffff",teal:"#009688",background:"#faf8f4","on-background":"#413935",surface:"#fff","on-surface":"#413935","notification-background":"#ffffff","on-notification-background":"#000",grey:"#8c8c8c","grey-50":"#fafafa","grey-100":"#f0f2f8","grey-200":"#eeeeee","grey-300":"#e0e0e0","grey-400":"#bdbdbd","grey-500":"#9e9e9e","grey-600":"#757575","grey-700":"#616161","grey-800":"#424242","grey-900":"#212121","perfect-scrollbar-thumb":"#dedcda","skin-bordered-background":"#fff","skin-bordered-surface":"#fff","expansion-panel-text-custom-bg":"#fafafa"},variables:{"code-color":"#ff8000","overlay-scrim-background":"#413935","tooltip-background":"#212121","tooltip-color":"#ffffff","overlay-scrim-opacity":.5,"hover-opacity":.04,"focus-opacity":.1,"selected-opacity":.08,"activated-opacity":.16,"pressed-opacity":.14,"dragged-opacity":.1,"disabled-opacity":.4,"border-color":"#413f3b","border-opacity":.12,"table-header-color":"#fdfcf9","high-emphasis-opacity":.9,"medium-emphasis-opacity":.7,"shadow-key-umbra-color":"#413935","shadow-xs-opacity":"0.16","shadow-sm-opacity":"0.18","shadow-md-opacity":"0.20","shadow-lg-opacity":"0.22","shadow-xl-opacity":"0.24"}},dark:{dark:!0,colors:{primary:"#c67e48","primary-darken-1":"#b67443","on-primary":"#ffffff",secondary:"#9d9b99","secondary-darken-1":"#3e3d3c","on-secondary":"#fff",success:"#4cd964","success-darken-1":"#40b654","on-success":"#ffffff",info:"#2196f3","info-darken-1":"#1e85d7","on-info":"#ffffff",warning:"#ff9500","warning-darken-1":"#de8201","on-warning":"#ffffff",error:"#ff3b30","error-darken-1":"#e1342b","on-error":"#ffffff",teal:"#009688",background:"#060504","on-background":"#fcf0e3",surface:"#1a1a1a","on-surface":"#fcf0e3","notification-background":"#1e1e1e","on-notification-background":"#fff",grey:"#4d4c4b","grey-50":"#212121","grey-100":"#424242","grey-200":"#616161","grey-300":"#757575","grey-400":"#909090","grey-500":"#a2a2a2","grey-600":"#b4b4b4","grey-700":"#c6c6c6","grey-800":"#d8d8d8","grey-900":"#eaeaea","perfect-scrollbar-thumb":"#725b4a","skin-bordered-background":"#4b3b2d","skin-bordered-surface":"#4b3b2d","expansion-panel-text-custom-bg":"#503f33"},variables:{"code-color":"#ff8000","overlay-scrim-background":"#1a1a1a","tooltip-background":"#333333","tooltip-color":"#eeeeee","overlay-scrim-opacity":.6,"hover-opacity":.04,"focus-opacity":.1,"selected-opacity":.08,"activated-opacity":.16,"pressed-opacity":.14,"disabled-opacity":.4,"dragged-opacity":.1,"border-color":"#edece9","border-opacity":.12,"table-header-color":"#242322","high-emphasis-opacity":.9,"medium-emphasis-opacity":.7,"shadow-key-umbra-color":"#383736","shadow-xs-opacity":"0.20","shadow-sm-opacity":"0.22","shadow-md-opacity":"0.24","shadow-lg-opacity":"0.26","shadow-xl-opacity":"0.28"}}}},locale:{rtl:jc(),adapter:(v=>{const _={name:"ezBookkeeping i18n",decimalSeparator:P(Ci.Default.symbol),messages:v.messages,current:v.locale,fallback:v.locale,t:(n,...s)=>{if(!n)return"";if(!n.startsWith("$vuetify."))return n;n=n.substring(9);const h=_w[n];return h?s&&s.length>0?v.t(h,...s):v.t(h):n},n:n=>v.n(n),provide:()=>_};return _})(Di.global)}}),_w={open:"Open",close:"Close"};pu([vu,fu,yu,gu,hu,bu,Tu,ku,_u,xu,Cu]);Tt.use(Tw);Tt.use(Di);Tt.use(kw);Tt.use(SC);Tt.component("VChart",wu);Tt.component("PerfectScrollbar",Au);Tt.component("VueDatePicker",Xi);Tt.component("DraggableList",Su);Tt.component("PinCodeInput",Hc);Tt.component("MapView",yi);Tt.component("DateTimePicker",Wc);Tt.component("MonthPicker",Gc);Tt.component("TransactionCalendar",Kc);Tt.component("ItemIcon",VC);Tt.component("BtnVerticalGroup",DC);Tt.component("NumberInput",$C);Tt.component("AmountInput",MC);Tt.component("AmountInputDialog",Ii);Tt.component("LanguageSelect",BC);Tt.component("LanguageSelectButton",OC);Tt.component("CurrencySelect",jC);Tt.component("DateTimeSelect",GC);Tt.component("DateSelect",QC);Tt.component("FiscalYearStartSelect",ZC);Tt.component("ColorSelect",e2);Tt.component("IconSelect",a2);Tt.component("TwoColumnSelect",h2);Tt.component("ScheduleFrequencySelect",_2);Tt.component("StepsBar",B2);Tt.component("ConfirmDialog",ka);Tt.component("SnackBar",ct);Tt.component("PieChart",z2);Tt.component("RadarChart",R2);Tt.component("TrendsChart",In);Tt.component("DateRangeSelectionDialog",G2);Tt.component("MonthSelectionDialog",Z2);Tt.component("MonthRangeSelectionDialog",nw);Tt.component("AccountBalanceTrendsChart",sw);Tt.component("AccountAndCategorySankeyChart",rw);Tt.component("SwitchToMobileDialog",vw);Tt.directive("TextFieldAutoWidth",fw);Tt.mount("#app");
